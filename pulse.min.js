!function(e,t){"function"==typeof define&&define.amd?define(["exports"],(function(n){t(e._=n)})):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e._={})}("undefined"!=typeof self?self:this,(function(exports){"use strict";function DataType(){Object.apply(this),this.type="DataType"}function L(){DataType.apply(this);var e,t=[],n=arguments.length;for(e=0;e<n;e++)t.push(arguments[e]);return t=L.toL(t)}function iL(){for(var e=[],t=arguments.length,n=0;n<t;n++)e[n]=arguments[n];var r=L.apply(this,e);return r=iL.toL(r)}function cL(){var e,t=[],n=arguments.length;for(e=0;e<n;e++)t[e]=arguments[e];var r=L.apply(this,t);return r=cL.toL(r)}function P(e,t){DataType.apply(this,arguments),this.type="P",this.x=Number(e)||0,this.y=Number(t)||0}function P3D(e,t,n){P.apply(this,arguments),this.type="P3D",this.z=n}function Pol(){var e=L.apply(this,arguments);return e=Pol.toL(e)}function Pol3D(){var e=L.apply(this,arguments);return e=Pol3D.toL(e)}function Rec(e,t,n,r){DataType.apply(this),this.type="Rec",this.x=Number(e)||0,this.y=Number(t)||0,this.width=Number(n)||0,this.height=Number(r)||0}function T(){var e,t=[],n=arguments.length;for(e=0;e<n;e++)t[e]=arguments[e].isList?arguments[e]:new L(arguments[e]);var r=L.apply(this,t);return r=T.toL(r)}function nT(){var e=arguments,t=[];if(1==arguments.length)if("number"==typeof e[0])for(var n=0;n<e[0];n++)t.push(new nL);else Array.isArray(e[0])&&(t=i(e[0],1));else if(arguments.length>1)if("number"==typeof e[0]){var r=new nL;for(n=0;n<e.length;n++)r.push(e[n]);t.push(r)}else{var o=Array.prototype.slice.call(e);t=i(o,1)}function i(e,t){var n;if(void 0!==e.type)return"nT"==(n=e.clone()).type?n:"nL"==n.type&&1==t?[n]:"nL"==n.type&&t>1?n:[];n=[];for(var r=0;r<e.length;r++)Array.isArray(e[r])&&(e[r]=i(e[r],++t)),n[r]=e[r];return 0==n.length?[]:"number"==typeof n[0]&&1==t?[n]:n}return t=nT.toL(t)}function polL(){var e=T.apply(this,arguments);return e=polL.toL(e)}function Nd(e,t){this.id=null==e?"":e,this.name=null!=t?t:e,this.type="Nd",this.nodeType=null,this.x=0,this.y=0,this.z=0,this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL,this.weight=1,this.descentWeight=1,this.level=0,this.parent=null,this.vx=0,this.vy=0,this.vz=0,this.ax=0,this.ay=0,this.az=0}function sL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=String(arguments[t]);var n=L.apply(this,e);return n=sL.toL(n)}function ndL(){var e=ndL.toL([]);if(arguments&&arguments.length>0){var t=Array.prototype.slice.call(arguments);t.forEach((function(t){e.addNode(t)}))}return e}function relL(){var e=ndL.apply(this,arguments);return e.name="",e=relL.toL(e)}function recL(){var e=L.apply(this,arguments);return e=recL.toL(e)}function Rel(e,t,n,r,o,i){Nd.call(this,e,t),this.type="Rel",this.node0=n,this.node1=r,this.weight=null==o?1:o,this.content=null==i?"":i}function Net(){this.type="Net",this.nodes=new ndL,this.relations=new relL}function Tr(){Net.apply(this),this.type="Tr",this.nLevels=0,this._createRelation=this.createRelation,this.createRelation=this._newCreateRelation}function dI(e,t){DataType.apply(this,arguments),this.date0=e,this.date1=t,this.type="dI"}function dL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=Number(arguments[t]);var n=L.apply(this,e);return n=dL.toL(n)}function nL(){for(var e=[],t=arguments.length,n=0;n<t;n++)e[n]=Number(arguments[n]);var r=L.apply(this,e);return r=nL.toL(r)}function I(e,t){DataType.apply(this,arguments),this.x=Number(e),this.y=Number(t),this.type="I"}function pol3DL(){var e=L.apply(this,arguments);return e=pol3DL.toL(e)}function cScale(e){DataType.apply(this,arguments),this.name="",this.type="cScale",this.colorScaleFunction=e||blackScale}function MetaCanvas(e){null==e&&(e={container:document.querySelector("#maindiv"),cycle:function(){},onResize:function(){}}),this.container=e.container,this.container=this.container||document.querySelector("#maindiv"),"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.dimensions=e.dimensions,this.init=e.init||noOperation,this.cycle=e.cycle||noOperation,this.onResize=e.onResize||e.resize||noOperation,this._cycleInterval=void 0===e.cycleInterval?30:e.cycleInterval,e.noLoop&&(this._cycleInterval=0),this._init(!e.noStart)}function Engine3D(e){e=null==e?{}:e,this.lens=null==e.lens?300:e.lens,this._freeRotation=!1,this.setBasis(new Pol3D(new P3D(1,0,0),new P3D(0,1,0),new P3D(0,0,1))),this._cuttingPlane=10,this._dx=0,null!=e.angles&&this.setAngles(e.angles)}function Forces(e){this.k=e&&e.k?e.k:.01,this.dEqSprings=e&&e.dEqSprings?e.dEqSprings:100,this.dEqRepulsors=e&&e.dEqRepulsors?e.dEqRepulsors:500,this.friction=e&&e.friction?e.friction:.8,this.nodes=new ndL,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this._i0=0}DataType.prototype={},DataType.prototype.constructor=DataType,DataType.prototype.setType=function(e){this.type=e},DataType.prototype.getType=function(){return this.type},DataType.prototype.toString=function(){},L.prototype=new DataType,L.prototype.constructor=L,L.toL=function(e,t){if(null!=e){if(t){switch(t){case"number":case"nL":return nL.toL(e,!1);case"string":case"sL":return sL.toL(e,!1);case"Date":case"dL":return dL.toL(e,!1)}e.pushNew=L.prototype.pushNew,e.concatNew=L.prototype.concatNew}return e.type="L",e.name=e.name||"",e.setType=L.prototype.setType,e.toArray=L.prototype.toArray,e._constructor=L,e.downcast=L.prototype.downcast,e.get=L.prototype.get,e.getElements=L.prototype.getElements,e.isEqual=L.prototype.isEqual,e.getTypeOfElements=L.prototype.getTypeOfElements,e.getTypes=L.prototype.getTypes,e.getType=L.prototype.getType,e.getLengths=L.prototype.getLengths,e.getWithoutRepetitions=L.prototype.getWithoutRepetitions,e.getSimplified=L.prototype.getSimplified,e.getFrequenciesTable=L.prototype.getFrequenciesTable,e.allElementsAreEqual=L.prototype.allElementsAreEqual,e.countElement=L.prototype.countElement,e.countOccurrences=L.prototype.countOccurrences,e.countDifferentElements=L.prototype.countDifferentElements,e.getMode=L.prototype.getMode,e.getMin=L.prototype.getMin,e.getMax=L.prototype.getMax,e.indexOfElement=L.prototype.indexOfElement,e.indexesOf=L.prototype.indexesOf,e.indexOfElements=L.prototype.indexOfElements,e.indexesOfElements=L.prototype.indexesOfElements,e.getElementByName=L.prototype.getElementByName,e.getElementsByNames=L.prototype.getElementsByNames,e.getFirstElementByPropertyValue=L.prototype.getFirstElementByPropertyValue,e.add=L.prototype.add,e.getElementNumberOfOccurrences=L.prototype.getElementNumberOfOccurrences,e.getPropertyValues=L.prototype.getPropertyValues,e.getRandomElement=L.prototype.getRandomElement,e.getRandomElements=L.prototype.getRandomElements,e.isSorted=L.prototype.isSorted,e.getSortedByIndexes=L.prototype.getSortedByIndexes,e.getReversed=L.prototype.getReversed,e.getSortedByProperty=L.prototype.getSortedByProperty,e.getSorted=L.prototype.getSorted,e.getSortedByList=L.prototype.getSortedByList,e.getSortedRandom=L.prototype.getSortedRandom,e.getSubList=L.prototype.getSubList,e.getSubListByType=L.prototype.getSubListByType,e.getFilteredByPropertyValue=L.prototype.getFilteredByPropertyValue,e.getFilteredByBooleanList=L.prototype.getFilteredByBooleanList,e.toStringList=L.prototype.toStringList,e.toNumberList=L.prototype.toNumberList,e.toColorList=L.prototype.toColorList,e.clone=L.prototype.clone,e.toString=L.prototype.toString,e.getNames=L.prototype.getNames,e.getLabels=L.prototype.getLabels,e.getDescriptions=L.prototype.getDescriptions,e.getCategories=L.prototype.getCategories,e.applyFunction=L.prototype.applyFunction,e.getWithoutElementAtIndex=L.prototype.getWithoutElementAtIndex,e.getWithoutElement=L.prototype.getWithoutElement,e.getWithoutElements=L.prototype.getWithoutElements,e.getWithoutElementsAtIndexes=L.prototype.getWithoutElementsAtIndexes,e.getFilteredByFunction=L.prototype.getFilteredByFunction,e.insert=L.prototype.insert,e.insertMany=L.prototype.insertMany,e._concat=Array.prototype.concat,e.concat=L.prototype.concat,e.removeElement=L.prototype.removeElement,e.removeElementAtIndex=L.prototype.removeElementAtIndex,e.removeElementsAtIndexes=L.prototype.removeElementsAtIndexes,e.removeElements=L.prototype.removeElements,e.pushIfUnique=L.prototype.pushIfUnique,e.replace=L.prototype.replace,e.setNames=L.prototype.setNames,e.setPropertyValues=L.prototype.setPropertyValues,e._splice=Array.prototype.splice,e.splice=L.prototype.splice,e.isList=!0,e}},iL.prototype=new L,iL.prototype.constructor=iL,iL.toL=function(e){var t=L.toL(e);return t.type="iL",t.getInterval=iL.prototype.getInterval,t.getAmplitudes=iL.prototype.getAmplitudes,t},cL.prototype=new L,cL.prototype.constructor=cL,cL.toL=function(e){var t=L.toL(e);return t.type="cL",t.name=e.name||"",t.getRgbArrays=cL.prototype.getRgbArrays,t.getInterpolated=cL.prototype.getInterpolated,t.getInverted=cL.prototype.getInverted,t.addAlpha=cL.prototype.addAlpha,t},P.prototype=new DataType,P.prototype.constructor=P,P3D.prototype=new P,P3D.prototype.constructor=P3D,Pol.prototype=new L,Pol.prototype.constructor=Pol,Pol.toL=function(e){var t=L.toL(e);return t.type="Pol",t.getFrame=Pol.prototype.getFrame,t.getBarycenter=Pol.prototype.getBarycenter,t.getCenter=Pol.prototype.getCenter,t.add=Pol.prototype.add,t.factor=Pol.prototype.factor,t.getRotated=Pol.prototype.getRotated,t.getClosestPoint=Pol.prototype.getClosestPoint,t.toNumberList=Pol.prototype.toNumberList,t.containsPoint=Pol.prototype.containsPoint,t.touchesPolygon=Pol.prototype.touchesPolygon,t.approach=Pol.prototype.approach,t.clone=Pol.prototype.clone,t},Pol3D.prototype=new L,Pol3D.prototype.constructor=Pol3D,Pol3D.toL=function(e){var t=L.toL(e);return t.type="Pol3D",t.getBarycenter=Pol3D.prototype.getBarycenter,t},Rec.prototype=new DataType,Rec.prototype.constructor=Rec,T.prototype=new L,T.prototype.constructor=T,T.toL=function(e){for(var t=0;t<e.length;t++)Array.isArray(e[t])&&!e[t].isList&&(e[t]=L.toL(e[t]));var n=L.toL(e);return n.type="T",n.applyFunction=T.prototype.applyFunction,n.getListsDowncasted=T.prototype.getListsDowncasted,n.get=T.prototype.get,n.getColumns=T.prototype.getColumns,n.getWithoutColumn=T.prototype.getWithoutColumn,n.getWithoutColumns=T.prototype.getWithoutColumns,n.getRow=T.prototype.getRow,n.getRows=T.prototype.getRows,n.getCell=T.prototype.getCell,n.getLengths=T.prototype.getLengths,n.getListLength=T.prototype.getListLength,n.sliceRows=T.prototype.sliceRows,n.getRows=T.prototype.getRows,n.getWithoutRow=T.prototype.getWithoutRow,n.getWithoutRows=T.prototype.getWithoutRows,n.transpose=T.prototype.transpose,n.sortRowsByList=T.prototype.sortRowsByList,n.sortRowsByLists=T.prototype.sortRowsByLists,n.clone=T.prototype.clone,n.cloneWithEmptyLists=T.prototype.cloneWithEmptyLists,n.appendRows=T.prototype.appendRows,n.insertRow=T.prototype.insertRow,n.trim=T.prototype.trim,n.removeRow=T.prototype.removeRow,n.pushRow=T.prototype.pushRow,n.isTable=!0,n},nT.prototype=new T,nT.prototype.constructor=nT,nT.toL=function(e){var t=T.toL(e);return t.type="nT",t.getSums=nT.prototype.getSums,t.getRowsSums=nT.prototype.getRowsSums,t.getAverages=nT.prototype.getAverages,t.getRowsAverages=nT.prototype.getRowsAverages,t.getIntervals=nT.prototype.getIntervals,t.factor=nT.prototype.factor,t.add=nT.prototype.add,t.getMax=nT.prototype.getMax,t.getMaxValues=nT.prototype.getMaxValues,t.getMaxCell=nT.prototype.getMaxCell,t.getMin=nT.prototype.getMin,t.getMinValues=nT.prototype.getMinValues,t.getMinCell=nT.prototype.getMinCell,t.getInterval=nT.prototype.getInterval,t.getFrame=nT.prototype.getFrame,t},polL.prototype=new T,polL.prototype.constructor=polL,polL.toL=function(e){var t=T.toL(e);return t.type="polL",t.getFrame=polL.prototype.getFrame,t.getBarycenter=polL.prototype.getBarycenter,t.getCenter=polL.prototype.getCenter,t.add=polL.prototype.add,t.factor=polL.prototype.factor,t.getRotated=polL.prototype.getRotated,t.clone=polL.prototype.clone,t},Nd.prototype=new DataType,Nd.prototype.constructor=Nd,sL.prototype=new L,sL.prototype.constructor=sL,sL.toL=function(e,t){t=null==t||t;var n=L.toL(e);if(t)for(var r=0;r<n.length;r++)n[r]=String(n[r]);return n.type="sL",n.getLengths=sL.prototype.getLengths,n.countTags=sL.prototype.countTags,n.includesSubString=sL.prototype.includesSubString,n.indexesOfSubString=sL.prototype.indexesOfSubString,n.toLowerCase=sL.prototype.toLowerCase,n.toUpperCase=sL.prototype.toUpperCase,n.append=sL.prototype.append,n.getSurrounded=sL.prototype.getSurrounded,n.replace=sL.prototype.replace,n.getConcatenated=sL.prototype.getConcatenated,n.trim=sL.prototype.trim,n.clone=sL.prototype.clone,n},ndL.prototype=new L,ndL.prototype.constructor=ndL,ndL.toL=function(e,t){t=null!=t&&t;var n=L.toL(e);if(t)for(var r=n.length,o=0;o<r;o++)n[o]="Nd"==_typeOf(n[o])?n[o]:new Nd(String(n[o]),String(n[o]));return n.type="ndL",n.ids={},Array(),n.addNode=ndL.prototype.addNode,n.addNodes=ndL.prototype.addNodes,n.removeNode=ndL.prototype.removeNode,n.removeNodes=ndL.prototype.removeNodes,n.removeNodeAtIndex=ndL.prototype.removeNodeAtIndex,n.getNodeByName=ndL.prototype.getNodeByName,n.get=ndL.prototype.get,n.getNodesByIds=ndL.prototype.getNodesByIds,n.normalizeWeights=ndL.prototype.normalizeWeights,n.getWeights=ndL.prototype.getWeights,n.getIds=ndL.prototype.getIds,n.getDegrees=ndL.prototype.getDegrees,n.getPolygon=ndL.prototype.getPolygon,n._push=Array.prototype.push,n.getWithoutRepetitions=ndL.prototype.getWithoutRepetitions,n.removeElements=ndL.prototype.removeElements,n.clone=ndL.prototype.clone,n},relL.prototype=new ndL,relL.prototype.constructor=relL,relL.toL=function(e){var t=ndL.toL(e);return t.type="relL",t.addRelation=relL.prototype.addRelation,t.removeRelation=relL.prototype.removeRelation,t.getRelationsWithNode=relL.prototype.getRelationsWithNode,t.getFirstRelationBetweenNodes=relL.prototype.getFirstRelationBetweenNodes,t.getFirstRelationByIds=relL.prototype.getFirstRelationByIds,t.getAllRelationsBetweenNodes=relL.prototype.getAllRelationsBetweenNodes,t.getRelatedNodesToNode=relL.prototype.getRelatedNodesToNode,t.nodesAreConnected=relL.prototype.nodesAreConnected,t.getChildrenOfNode=relL.prototype.getChildrenOfNode,t},recL.prototype=new L,recL.prototype.constructor=recL,recL.toL=function(e){var t=L.toL(e);return t.type="recL",t.getFrame=recL.prototype.getFrame,t.add=recL.prototype.add,t.clone=recL.prototype.clone,t.factor=recL.prototype.factor,t.getIntersectionArea=recL.prototype.getIntersectionArea,t.intersectsRectangle=recL.prototype.intersectsRectangle,t},Rel.prototype=new Nd,Rel.prototype.constructor=Rel,Net.prototype=new DataType,Net.prototype.constructor=Net,Tr.prototype=new Net,Tr.prototype.constructor=Tr,dI.prototype=new DataType,dI.prototype.constructor=dI,dL.prototype=new L,dL.prototype.constructor=dL,dL.toL=function(e,t){t=null==t||t;var n=L.toL(e);if(t)for(var r=0;r<n.length;r++)n[r]=new Date(n[r]);return n.type="dL",n.getTimes=dL.prototype.getTimes,n.getYears=dL.prototype.getYears,n.getFullYears=dL.prototype.getFullYears,n.getMin=dL.prototype.getMin,n.getMax=dL.prototype.getMax,n.getInterval=dL.prototype.getInterval,n},nL.prototype=new L,nL.prototype.constructor=nL,nL.toL=function(e,t){t=null==t||t;var n=L.toL(e),r=n.length;if(t)for(var o=0;o<r;o++)n[o]=Number(n[o]);return n.type="nL",n.getMin=nL.prototype.getMin,n.getMax=nL.prototype.getMax,n.getAmplitude=nL.prototype.getAmplitude,n.getIndexOfMin=nL.prototype.getIndexOfMin,n.getIndexOfMax=nL.prototype.getIndexOfMax,n.getSum=nL.prototype.getSum,n.getProduct=nL.prototype.getProduct,n.getInterval=nL.prototype.getInterval,n.getIntervalWithAverage=nL.prototype.getIntervalWithAverage,n.getNumbersSimplified=nL.prototype.getNumbersSimplified,n.getMean=nL.prototype.getMean,n.getNorm=nL.prototype.getNorm,n.getStandardDeviation=nL.prototype.getStandardDeviation,n.getVariance=nL.prototype.getVariance,n.getMedian=nL.prototype.getMedian,n.getQuantiles=nL.prototype.getQuantiles,n.getSorted=nL.prototype.getSorted,n.getSortIndexes=nL.prototype.getSortIndexes,n.cleanNonFinites=nL.prototype.cleanNonFinites,n.getNormalized=nL.prototype.getNormalized,n.getNormalizedToMax=nL.prototype.getNormalizedToMax,n.getNormalizedToSum=nL.prototype.getNormalizedToSum,n.factor=nL.prototype.factor,n.add=nL.prototype.add,n.subtract=nL.prototype.subtract,n.divide=nL.prototype.divide,n.sqrt=nL.prototype.sqrt,n.pow=nL.prototype.pow,n.log=nL.prototype.log,n.floor=nL.prototype.floor,n.isEqual=nL.prototype.isEqual,n.addRandom=nL.prototype.addRandom,n.trim=nL.prototype.trim,n.getGeometricMean=nL.prototype.getGeometricMean,n.approach=nL.prototype.approach,n.clone=nL.prototype.clone,n},I.prototype=new P,I.prototype.constructor=I,pol3DL.prototype=new L,pol3DL.prototype.constructor=pol3DL,pol3DL.toL=function(e){var t=L.toL(e);return t.type="pol3DL",t.getBarycenter=pol3DL.prototype.getBarycenter,t},cScale.prototype=new DataType,cScale.prototype.constructor=cScale,MetaCanvas.prototype.constructor=MetaCanvas,Engine3D.prototype.constructor=Engine3D,Forces.prototype.constructor=Forces,P.prototype.getNorm=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},P.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},P.prototype.factor=function(e){return e>=0||e<0?new P(this.x*e,this.y*e):null!=e.type&&"P"==e.type?new P(this.x*e.x,this.y*e.y):void 0},P.prototype.normalize=function(){var e=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x/e,this.y/e)},P.prototype.normalizeToValue=function(e){var t=e/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x*t,this.y*t)},P.prototype.subtract=function(e){return new P(this.x-e.x,this.y-e.y)},P.prototype.add=function(e){return new P(e.x+this.x,e.y+this.y)},P.prototype.addCoordinates=function(e,t){return new P(e+this.x,t+this.y)},P.prototype.distanceToPoint=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},P.prototype.distanceToPointSquared=function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},P.prototype.angleToPoint=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},P.prototype.expandFromPoint=function(e,t){return new P(e.x+t*(this.x-e.x),e.y+t*(this.y-e.y))},P.prototype.interpolate=function(e,t){return new P((1-t)*this.x+t*e.x,(1-t)*this.y+t*e.y)},P.prototype.cross=function(e){return this.x*e.y-this.y*e.x},P.prototype.dot=function(e){return this.x*e.x+this.y*e.y},P.prototype.getRotated=function(e,t){return t=null==t?new P:t,new P(Math.cos(e)*(this.x-t.x)-Math.sin(e)*(this.y-t.y)+t.x,Math.sin(e)*(this.x-t.x)+Math.cos(e)*(this.y-t.y)+t.y)},P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},L.prototype.downcast=function(){if(0===this.length)return this;var e;switch(this.getTypeOfElements()){case"number":return(e=nL.toL(this,!1)).name=this.name,e;case"string":return(e=sL.toL(this,!1)).name=this.name,e;case"Rec":return this;case"date":return(e=dL.toL(this,!1)).name=this.name,e;case"L":case"dL":case"iL":case"sL":case"T":e=T.toL(this,!1);break;case"Array":e=T.toL(this,!1).getListsDowncasted();break;case"nL":return(e=nT.toL(this,!1)).name=this.name,e;case"P":e=Pol.toL(this,!1);break;case"Pol":e=polL.toL(this,!1);break;case"Nd":e=ndL.toL(this,!1);break;case"Rel":e=relL.toL(this,!1)}var t,n=this.length,r=!1,o=!0;if(null==e||null==e.type&&""==e){for(t=0;t<n;t++)if(null==this[t]&&(r=!0),null==this[t]||!this[t].isList){o=!1;break}o&&(e=T.toL(this,!1))}if(null!=e?e.name=this.name:e=this,o){for(t=0;t<n;t++)if(null==e[t]||e[t].containsNulls){r=!0;break}}else if(!r)for(t=0;t<n;t++)if(null==e[t]){r=!0;break}return e.containsNulls=r,e},L.prototype.get=function(e){if(Array.isArray(e))return this.getElements(e);if("string"==typeof e){e=e.trim();for(var t=!1,n=0;n<this.length;n++)if(this[n].name==e){t=!0,e=n;break}if(!t)return null}else(e=null==e?0:e)<0&&(e+=this.length),e>=this.length&&(e=Math.floor(e)%this.length);return this[e]},L.prototype.getElements=function(e,t){if(null!=e){var n=instanceSameType(this);n.name=this.name;var r,o,i=e.length,s=_typeOf(n),a="sL"==_typeOf(e);for(r=0;r<i;r++)null==(o=a?this.getElementByName(e[r]):this[e[r]<0?e[r]+this.length:e[r]])?(t||!a&&null===this[e[r]])&&n.push(null):"ndL"==s?n.addNode(o):n.push(o);return"L"!=n.type?n:n.downcast()}},L.prototype.toArray=function(){var e=this.slice(0);return e.name=this.name,e.type=this.type,e},L.prototype.isEqual=function(e){if(null==e||this.length!=e.length)return!1;var t,n=this.length;if(this.isTable){for(t=0;t<n;t++)if(!this[t].isEqual(e[t]))return!1;return!0}for(t=0;t<n;t++)if(this[t]!=e[t])return!1;return!0},L.prototype.getLengths=function(){return tonL(this.map((e=>e.length)))},L.prototype.getTypeOfElements=function(){for(var e=_typeOf(this[0]),t=this.length,n=1;n<t;n++)if(_typeOf(this[n])!=e)return"";return e},L.prototype.getTypes=function(){for(var e=new sL,t=this.length,n=0;n<t;n++)e[n]=_typeOf(this[n]);return e},L.prototype.getNames=function(e,t,n){var r=new sL;r.name=n?"labels":"names";var o,i=this.length;e&&this.isTable&&buildInformationObjectForTable(this);for(var s=0;s<i;s++)o=n&&null!=this[s].label?this[s].label:this[s].name,e&&this[s].isList?this[s].infoObject.isCategorical&&this[s].infoObject.isNumeric?r[s]="[#c] "+o:this[s].infoObject.isCategorical?r[s]="[c] "+o:this[s].infoObject.isNumeric?r[s]="[#] "+o:r[s]=o:r[s]=o,t&&(r[s]+=" ("+this[s].countDifferentElements()+")");return r},L.prototype.getLabels=function(e,t){return this.getNames(e,t,!0)},L.prototype.getDescriptions=function(){for(var e=new sL,t=this.length,n=0;n<t;n++)e[n]=this[n].description;return e},L.prototype.getCategories=function(){for(var e=new sL,t=this.length,n=0;n<t;n++)e[n]=this[n].category;return e},L.prototype.getReversed=function(){var e=this.clone();return e.reverse(),e},L.prototype.getSubList=function(){var e,t;if(null!=arguments[0]){if(arguments[0].isList)return this.getElements(arguments[0]);"number"==_typeOf(arguments[0])?e=null!=_typeOf(arguments[1])&&"number"==_typeOf(arguments[1])?new I(arguments[0],arguments[1]):new I(arguments[0],this.length-1):null!=arguments[0].x&&(e=arguments[0]),e.x<0&&(e.x=this.length+e.x),e.y<0&&(e.y=this.length+e.y);var n,r=new I(Math.max(Math.min(Math.floor(e.x),this.length),0),Math.max(Math.min(Math.floor(e.y),this.length-1),0));if(arguments[2]&&(r.y+=arguments[2]),"nL"==this.type)return(n=nL.toL(this.slice(r.x,r.y+1),!1)).name=this.name,n;if("sL"==this.type)return(n=sL.toL(this.slice(r.x,r.y+1),!1)).name=this.name,n;var o=this.type;if(n="L"==o||"T"==o?new L:instantiate(o),"ndL"==o)for(t=r.x;t<=r.y;t++)n.addNode(this[t]);else for(t=r.x;t<=r.y;t++)n.push(this[t]);return n.name=this.name,"L"==o||"T"==o?n.downcast():n}},L.prototype.getSubListByType=function(e){var t=new L;t.name=this.name;for(var n=0;n<this.length;n++)_typeOf(this[n])==e&&t.push(this[n]);return t.downcast()},L.prototype.getElementNumberOfOccurrences=function(e){for(var t=0,n=0,r=this.indexOf(e,n);r>-1;)t++,n=r+1,r=this.indexOf(e,n);return t},L.prototype.clone=function(){var e,t=instanceSameType(this),n=this.length;for(e=0;e<n;e++)t.push(this[e]);return t.name=this.name,t.fnDerived=this.fnDerived,t},L.prototype.getWithoutRepetitions=function(e,t){return toL([...new Set(this)]).downcast()},L.prototype.getSimplified=function(e,t,n){if(e){var r,o=this.getFrequenciesTable(!0,!1,!1,n),i=getFirstOccurrenceDictionaryForList(o[0]),s=this.length;null==t&&(t="other");var a="sL"==this.type?new sL:new L;for(a.name=this.name,r=0;r<s;r++)a.push(i[this[r]]<e-1?this[r]:t);return a}},L.prototype.countElement=function(e){for(var t=0,n=this.length,r=0;r<n;r++)e==this[r]&&t++;return t},L.prototype.countOccurrences=function(){for(var e=new nL,t={},n=this.length,r=0;r<n;r++)null==t[this[r]]&&(t[this[r]]=0),t[this[r]]++;for(r=0;r<n;r++)e[r]=t[this[r]];return e},L.prototype.countDifferentElements=function(){if(this.infoObject)return this.infoObject.numberDifferentElements;for(var e={},t=0,n=0;n<this.length;n++)null==e[this[n]]&&(e[this[n]]=1,t++);return t},L.prototype.getFrequenciesTable=function(e=!0,t,n,r){var o,i,s;if(this.freqTable)a=(o=this.freqTable.getColumns([0,1]))[0],l=o[1];else{o=new T;var a=instanceSameType(this),l=new nL;o[0]=a,o[1]=l,o._indexesDictionary={};var u=this.length;for(i=0;i<u;i++)null==(s=o._indexesDictionary[this[i]])&&(a[s=a.length]=this[i],l[s]=0,o._indexesDictionary[this[i]]=s),r&&i<r.length?l[s]+=r[i]:l[s]++}var h=0;if(e){var c=[];for(i=0;i<l.length;i++)c[i]=[l[i],a[i]],h+=l[i];var f=c.sort((function(e,t){return t[0]-e[0]}));for(o[0]=instanceSameType(a),o[1]=new nL,i=0;i<l.length;i++)o[0][i]=f[i][1],o[1][i]=f[i][0];o._indexesDictionary=null}if(o[0].name=""==this.name?"Element":this.name,o[1].name="Frequency",t&&(0==h&&(h=o[1].getSum()),o[2]=normalizeToSum(o[1],1,h),o[2].name="Occurrences normalized to sum"),n){var p=stringsToColors(o[0]);p.name="Categorical colors",o.push(p)}return this.freqTable=o,o},L.prototype.allElementsAreEqual=function(){var e;if(this.length<2)return!0;var t=this[0],n=this.length;for(e=1;e<n;e++)if(this[e]!=t)return!1;return!0},L.prototype.getMode=function(){for(var e,t={},n=0,r=0;r<this.length&&(null==t[this[r]]&&(t[this[r]]=0),t[this[r]]++,!(t[this[r]]>n&&(n=t[this[r]],e=this[r],n>.5*this.length)));r++);return e},L.prototype.getMin=function(){if(0===this.length)return null;var e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.min(t,this[e]);return t},L.prototype.getMax=function(){if(0===this.length)return null;var e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.max(t,this[e]);return t},L.prototype.add=function(e){if(e.constructor==Number){var t,n=this.length,r=instanceSameType(this);for(t=0;t<n;t++)r.push(this[t]+e);return r}},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*random())]},L.prototype.getRandomElements=function(e,t,n,r){if(null!=e){var o=null!=n?new _Alea("my",n,"seeds"):NumberOperators_random;t=null==t||t,e=Math.min(e,this.length);var i,s=instanceSameType(this);if(r){var a=this;if(t)a=u=this.getWithoutRepetitions();e=Math.min(e,a.length);var l=new T;l.push(createSortedNumberList(a.length,0,1)),l.push(createNumberListWithinInterval(a.length,new I(0,1),0,n)),l=(l=(l=l.sortRowsByList(1)).sliceRows(0,e-1)).sortRowsByList(0),s=a.getElements(l[0])}else if(t){var u=this.getWithoutRepetitions();e=Math.min(e,u.length);for(var h=createNumberListWithinInterval(u.length,new I(0,1),0,n),c=u.getSortedByList(h),f=0;f<e;f++)s.push(c[f])}else for(;s.length<e;)i=this[Math.floor(this.length*o())],s.push(i);return s.name=this.name,s}},L.prototype.getPropertyValues=function(e,t){var n,r=new L;r.name=e;for(var o=this.length,i=0;i<o;i++)n=getPropertyValue(this[i],e),r[i]=null==n?t:n;return r.downcast()},L.prototype.isSorted=function(e){e=null==e||Boolean(e);var t,n=this.length;if(e){for(t=1;t<n;t++)if(this[t]<this[t-1])return!1}else for(t=1;t<n;t++)if(this[t]>this[t-1])return!1;return!0},L.prototype.getSortedByIndexes=function(e){if(null!=e){var t,n=instanceSameType(this);n.name=this.name;var r=this.length;for(t=0;t<r;t++)-1!=e[t]&&n.push(this[e[t]]);return n}},L.prototype.getSortedByProperty=function(e,t,n){if(e.includes("."))return this.getSortedByList(this.getPropertyValues(e),t,null!=n?this.getPropertyValues(e):null);if(t=null==t||t,0==this.length)return this.clone();var r,o=_typeOf(this[0][e]),i="number"!=o&&"date"!=o;return r=n?t?i?function(t,r){return t[e]==r[e]?t[n]>r[n]?1:-1:t[e]>r[e]?1:-1}:function(t,r){return t[e]==r[e]?t[n]-r[n]:t[e]-r[e]}:i?function(t,r){return t[e]==r[e]?r[n]>t[n]?1:-1:r[e]>t[e]?1:-1}:function(t,r){return t[e]==r[e]?r[n]-t[n]:r[e]-t[e]}:t?i?function(t,n){return t[e]>n[e]?1:-1}:function(t,n){return t[e]-n[e]}:i?function(t,n){return n[e]>t[e]?1:-1}:function(t,n){return n[e]-t[e]},this.clone().sort(r)},L.prototype.getSorted=function(e){return this.getSortedByList(this,e)},L.prototype.getSortedByList=function(e,t,n,r){if(null==e)return null;t=null==t||t,r=null!=r&&r;var o,i=[],s=this.length;if(n&&"nL"==e.type)for(o=0;o<s;o++)i[o]=[this[o],e[o]+1e4*Math.random()*Number.MIN_VALUE,o];else if("dL"==e.type)for(o=0;o<s;o++)i[o]=[this[o],e[o].getTime(),o];else for(o=0;o<s;o++)i[o]=[this[o],e[o],o];var a,l=("nL"==e.type||"dL"==e.type)&&!r;a=t?l?function(e,t){return e[1]-t[1]}:r?function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[2]-t[2]}:function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:0}:l?function(e,t){return t[1]-e[1]}:r?function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:e[2]-t[2]}:function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:0},i=i.sort(a);var u=instanceSameType(this);for(u.name=this.name,o=0;o<s;o++)u[o]=i[o][0];return u},L.prototype.getSortedRandom=function(){var e=this.clone();return e.name=this.name,e.sort((function(){return random()-.5})),e},L.prototype.indexOfElement=function(e){var t,n=this.length;for(t=0;t<n;t++)if(this[t]==e)return t;return-1},L.prototype.indexesOf=function(e){for(var t=this.indexOf(e),n=new nL;-1!=t;)n.push(t),t=this.indexOf(e,t+1);return n},L.prototype.indexOfElements=function(e){if(null!=e){for(var t=new nL,n=e.length,r=0;r<n;r++)t[r]=this.indexOf(e[r]);return t}},L.prototype.indexesOfElements=function(e,t){if(null!=e){var n,r,o,i=new nL;this.length;if(n=getFirstOccurrenceDictionaryForList(this),t)for(r=0;r<e.length;r++)o=n[e[r]],i[r]=null==o?-1:o;else for(r=0;r<e.length;r++)null!=(o=n[e[r]])&&i.push(o);return i}},L.prototype.getElementByName=function(e,t){if(null==e)return null;for(var n=this.length,r=0;r<n;r++)if(this[r].name==e)return t?r:this[r];return t?-1:null},L.prototype.getElementsByNames=function(e,t,n,r){if(null!=e){var o,i,s,a,l=t?new nL:new L,u=this.length;for(o=0;o<e.length;o++){for(s=e[o],a=!1,i=0;i<u;i++)if(this[i].name==s){l.push(t?i:this[i]),a=!0;break}n&&!a&&l.push(t?-1:r)}return t?l:l.downcast()}},L.prototype.getFirstElementByPropertyValue=function(e,t){for(var n=this.length,r=0;r<n;r++)if(this[r][e]==t)return this[r];return null},L.prototype.getFilteredByBooleanList=function(e){var t,n=new L;n.name=this.name;var r=this.length;for(t=0;t<r;t++)e[t]&&n.push(this[t]);return n.downcast()},L.prototype.getFilteredByPropertyValue=function(e,t,n){n=null==n?"equal":n;var r,o=new L;o.name="filtered_"+this.name;var i=this.length;switch(n){case"equal":for(r=0;r<i;r++)this[r][e]==t&&o.push(this[r]);break;case"different":for(r=0;r<i;r++)this[r][e]!=t&&o.push(this[r]);break;case"greater":for(r=0;r<i;r++)this[r][e]>t&&o.push(this[r]);break;case"lower":for(r=0;r<i;r++)this[r][e]<t&&o.push(this[r])}return o.downcast()},L.prototype.getWithoutElementsAtIndexes=function(e){var t,n,r=this.length;for(n="L"==this.type?new L:instantiate(_typeOf(this)),e=nL.toL(e.slice(),!1),t=0;t<e.length;t++)e[t]<0&&(e[t]+=this.length);for(t=0;t<r;t++)e.includes(t)||n.push(this[t]);return"L"==this.type?n.downcast():(n.name=this.name,n)},L.prototype.getWithoutElementAtIndex=function(e){var t,n=this.length;e<0&&(e+=n),t="L"==this.type?new L:instanceSameType(this);for(var r=0;r<n;r++)r!=e&&t.push(this[r]);return t.name=this.name,"L"==this.type?t.downcast():t},L.prototype.getWithoutElement=function(e){if(null==e&&(e=null),null!=e&&!this.includes(e))return this;var t,n=new L;n.name=this.name;var r=this.length;for(t=0;t<r;t++)this[t]!=e&&n.push(this[t]);return n.downcast()},L.prototype.getWithoutElements=function(e){var t,n,r=this.length;if(t="L"==this.type?new L:instanceSameType(this),this.isTable)for(n=0;n<r;n++)e.includes(this[n])||t.push(this[n]);else{var o=getBooleanDictionaryForList(e);for(n=0;n<r;n++)o[this[n]]||t.push(this[n])}return t.name=this.name,"L"==this.type?t.downcast():t},L.prototype.getFilteredByFunction=function(e,t){for(var n=instanceSameType(this),r=this.length,o=0;o<r;o++)e(this[o],o,this)&&("ndL"==n.type?n.addNode(this[o]):n.push(this[o]));return n.name=t||this.name,"L"==this.type?n.downcast():n},L.prototype.insert=function(e,t,n){if(n=null==n||n,t=null==t?0:t,null!=e){if("string"==typeof t&&(t=this.getNames().indexOf(t)),-1==t)throw new Error("element with given name not found");var r;if(n)return(r=this.clone()).name=this.name,r[t]=e,r.downcast();(r=new L).name=this.name;for(var o=0;o<this.length+1;o++)r[o]=o<t?this[o]:o==t?e:this[o-1];return r.downcast()}},L.prototype.insertMany=function(e,t,n){if(null==e||null==t)return null;if(n=null==n||n,e.length!=t.length)throw new Error("indexes and elements need to be the same length");if("sL"==t.type&&(t=this.getNames().indexesOfElements(t)),null==t||t.length!=e.length)throw new Error("some elements with given names not found");var r;if(n){var o=Math.min(e.length,t.length);(r=this.clone()).name=this.name;for(var i=0;i<o;i++)r[t[i]]=e[i];return r.downcast()}(r=new L).name=this.name,e=e.getSortedByList(t),t=t.getSorted();for(i=0;i<e.length;i++)r[t[i]+i]=e[i];var s=0;for(i=0;i<this.length;i++){for(;null!=r[s];)s++;r[s]=this[i],s++}return r.downcast()},L.prototype.concat=function(){if(null==arguments[0])return this;if(arguments[0].type==this.type){if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nL"==this.type)return nL.toL(this._concat.apply(this,arguments),!1);if("sL"==this.type)return sL.toL(this._concat.apply(this,arguments),!1);if("dL"==this.type)return dL.toL(this._concat.apply(this,arguments),!1);if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nT"==this.type)return nT.toL(this._concat.apply(this,arguments),!1);if("ndL"==this.type){var e,t=this.clone(),n=arguments[0],r=n.length;for(e=0;e<r;e++)t.addNode(n[e]);return t}}return L.toL(this._concat.apply(this,arguments)).downcast()},L.prototype.toNumberList=function(e,t){if("nL"==this.type)return this;t=null==t?0:t;var n,r=new nL,o=this.length,i=!1;if("dL"==this.type)for(""==r.name&&(r.name="decimal date"),n=0;n<o;n++)r[n]=getDecimalDate(this[n]);else for(n=0;n<o;n++)r[n]=0==t?parseFloat(this[n]):Number(this[n]),isNaN(r[n])&&(r[n]=e,null==e&&(i=!0));return i&&(r=L.toL(r)),r.name=this.name,r.downcast()},L.prototype.toStringList=function(){if("sL"==this.type)return this;var e,t=this.length,n=new sL;for(n.name=this.name,e=0;e<t;e++)n[e]=String(this[e]);return n},L.prototype.toColorList=function(e,t){var n;if("cL"==this.type)return this;if("nL"==this.type){let e=this.getInterval();if(e.x<0&&e.y>0){let t=Math.max(e.x,e.y);n=new _.cL,this.forEach((e=>{let r=e?.5-.5*e/t:.5;n.push(_.interpolateColors(_.blueWhiteRed(r),"rgb(255,255,255)",.6))}))}else n=createColorListFromNumberList(this,t);return n.name="colors",n}if(e)return colorsForCategoricalList(this,null,!0);if("sL"==this.type){var r,o=new cL;o.name=this.name;for(var i=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,s=0;s<this.length&&null!=(r=colorStringToRGB(this[s]));s++)i.test(this[s])?o.push(this[s]):o.push("rgb("+r[0]+","+r[1]+","+r[2]+")");if(o.name="colors",null!=r)return o}return(n=colorsForCategoricalList(this)).name="colors",n},L.prototype.removeElements=function(e){var t,n={},r=this.length,o=e.length;for(t=0;t<o;t++)n[e[t]]=!0;for(t=0;t<r;t++)n[this[t]]&&(this.splice(t,1),t--)},L.prototype.removeElement=function(e){var t=this.indexOf(e);-1!=t&&this.splice(t,1)},L.prototype.pushIfUnique=function(e){let t=!this.includes(e);return t&&this.push(e),t},L.prototype.removeElementAtIndex=function(e){this.splice(e,1)},L.prototype.removeElementsAtIndexes=function(e){e=e.sort((function(e,t){return e-t}));for(var t=0;null!=e[t];t++)this.splice(e[t]-t,1)},L.prototype.setNames=function(e,t=!0,n){if(null==e)return this;var r,o;"string"==typeof e&&-1!=e.search(/\n|\r|\,/)&&(e=e.split(/\n|\r|\,/g)),"string"==typeof e&&(e=[e]);var i=null==n?createSortedNumberList(e.length):n;"sL"==i.type&&(i=this.getElementsByNames(i,!0,!0));var s=Math.min(i.length,e.length),a=t?this:this.clone();for(r=0;r<s;r++){if(-1==(o=i[r])&&"sL"==n.type)throw new Error("No element found with name: "+n[r]);if(o<0||o>=this.length)throw new Error("Invalid index: "+o);a[o].name=e[r]}return a},L.prototype.setPropertyValues=function(e,t,n){if(null==e||null==t)return null;Array.isArray(t)||(t=[t]);for(var r=t.length,o=this.length,i=n?this:this.clone(),s=0;s<o;s++)i[s]=setPropertyValue(this[s],e,t[s%r],n);return i},L.prototype.splice=function(){switch(this.type){case"nL":return nL.toL(this._splice.apply(this,arguments));case"sL":return sL.toL(this._splice.apply(this,arguments));case"ndL":return ndL.toL(this._splice.apply(this,arguments));case"dL":return dL.toL(this._splice.apply(this,arguments))}return L.toL(this._splice.apply(this,arguments)).downcast()},iL.prototype.getInterval=function(){if(0===this.length)return null;var e,t=Math.max(this[0].x,this[0].y),n=Math.min(this[0].x,this[0].y),r=this.length;for(e=1;e<r;e++)t=Math.max(t,this[e].x,this[e].y),n=Math.min(n,this[e].x,this[e].y);return new I(n,t)},iL.prototype.getAmplitudes=function(){if(0===this.length)return null;var e,t=new nL;for(e=0;e<this.length;e++)t[e]=this[e].getAmplitude();return t},cL.prototype.getRgbArrays=function(){for(var e=new L,t=this.length,n=0;n<t;n++)e[n]=colorStringToRGB(this[n]);return e},cL.prototype.getInterpolated=function(e,t){for(var n=new cL,r=this.length,o=0;o<r;o++)n[o]=interpolateColors(this[o],e,t);return n.name=this.name,n},cL.prototype.getInverted=function(){for(var e=new cL,t=this.length,n=0;n<t;n++)e[n]=invertColor(this[n]);return e.name=this.name,e},cL.prototype.addAlpha=function(e){for(var t=new cL,n=this.length,r=0;r<n;r++)t[r]=addAlpha(this[r],e);return t.name=this.name,t},P3D.prototype.distanceToPoint3D=function(e){return Math.sqrt(Math.pow(Math.abs(this.x-e.x),2)+Math.pow(Math.abs(this.y-e.y),2)+Math.pow(Math.abs(this.z-e.z),2))},P3D.prototype.distanceToPointSquared=function(e){return Math.pow(Math.abs(this.x-e.x),2)+Math.pow(Math.abs(this.y-e.y),2)+Math.pow(Math.abs(this.z-e.z),2)},P3D.prototype.getNorm2=function(){return this.x*this.x+this.y*this.y+this.z*this.z},P3D.prototype.getNorm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},P3D.prototype.normalizeToValue=function(e){var t=e/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2));return new P3D(this.x*t,this.y*t,this.z*t)},P3D.prototype.cross=function(e){return new P3D(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},P3D.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},P3D.prototype.angleToPoint=function(e){var t=this.getNorm(),n=e.getNorm();return Math.acos(this.dot(e)/(t*n))},P3D.prototype.add=function(e){return new P3D(e.x+this.x,e.y+this.y,e.z+this.z)},P3D.prototype.subtract=function(e){return new P3D(this.x-e.x,this.y-e.y,this.z-e.z)},P3D.prototype.factor=function(e){return new P3D(this.x*e,this.y*e,this.z*e)},P3D.prototype.interpolate=function(e,t){return new P3D((1-t)*this.x+t*e.x,(1-t)*this.y+t*e.y,(1-t)*this.z+t*e.z)},P3D.prototype.getAngles=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),t=.5*Math.PI-Math.atan2(this.z/e,this.y/e),n=-Math.asin(this.x/e);return t<-Math.PI&&(t+=2*Math.PI),t>Math.PI&&(t-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(t,n,0)},P3D.prototype.getInverseAngles=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),t=-.5*Math.PI+Math.atan2(-this.z/e,-this.y/e),n=Math.asin(-this.x/e);return t<-Math.PI&&(t+=2*Math.PI),t>Math.PI&&(t-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(t,n,0)},P3D.prototype.clone=function(){return new P3D(this.x,this.y,this.z)},P3D.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"},Pol3D.prototype.getBarycenter=function(){for(var e=0,t=0,n=0,r=0;r<this.length;r++)e+=this[r].x,t+=this[r].y,n+=this[r].z;return new P3D(e/this.length,t/this.length,n/this.length)},Rec.prototype.getRight=function(){return this.x+this.width},Rec.prototype.getBottom=function(){return this.y+this.height},Rec.prototype.setRight=function(e){this.width=e-this.x},Rec.prototype.setBottom=function(e){this.height=e-this.y},Rec.prototype.getTopLeft=function(){return new P(this.x,this.y)},Rec.prototype.getTopRight=function(){return new P(this.x+this.width,this.y)},Rec.prototype.getBottomRight=function(){return new P(this.x+this.width,this.y+this.height)},Rec.prototype.getBottomLeft=function(){return new P(this.x,this.y+this.height)},Rec.prototype.getCenter=function(){return new P(this.x+.5*this.width,this.y+.5*this.height)},Rec.prototype.getRandomPoint=function(){return new P(this.x+Math.random()*this.width,this.y+Math.random()*this.height)},Rec.prototype.getIntersection=function(e){if(e.x+e.width<this.x||e.x>this.x+this.width||e.y+e.height<this.y||e.y>this.y+this.height)return null;var t=Math.max(e.x,this.x),n=Math.max(e.y,this.y);return new Rec(t,n,Math.min(e.x+e.width,this.x+this.width)-t,Math.min(e.y+e.height,this.y+this.height)-n)},Rec.prototype.interpolate=function(e,t){var n=1-t;return new Rec(n*this.x+t*e.x,n*this.y+t*e.y,n*this.width+t*e.width,n*this.height+t*e.height)},Rec.prototype.getRatio=function(){return Math.max(this.width,this.height)/Math.min(this.width,this.height)},Rec.prototype.getArea=function(){return this.width*this.height},Rec.prototype.containsPoint=function(e){return this.x<=e.x&&this.x+this.width>=e.x&&this.y<=e.y&&this.y+this.height>=e.y},Rec.prototype.pointIsOnBorder=function(e,t){if(t=null==t?1:t,e.x>=this.x-t&&e.x<=this.x+this.width+t){if(e.y>=this.y-t&&e.y<=this.y+t)return!0;if(e.y>=this.y+this.height-t&&e.y<=this.y+this.height+t)return!0;if(e.y>=this.y-t&&e.y<=this.y+this.height+t&&(e.x<this.x+t||e.x>this.x+this.width-t))return!0}return!1},Rec.prototype.getNormalRectangle=function(){return new Rec(Math.min(this.x,this.x+this.width),Math.min(this.y,this.y+this.height),Math.abs(this.width),Math.abs(this.height))},Rec.prototype.intersectsRectangle=function(e){return this.x+this.width>=e.x&&this.y+this.height>=e.y&&e.x+e.width>=this.x&&e.y+e.height>=this.y},Rec.prototype.containsRectangle=function(e){return e.getRight()<=this.getRight()&&e.x>=this.x&&e.getBottom()<=this.getBottom()&&e.y>=this.y},Rec.prototype.expand=function(e,t){return t=t||new P(this.x+.5*this.width,this.y+.5*this.height),new Rec((this.x-t.x)*e+t.x,(this.y-t.y)*e+t.y,this.width*e,this.height*e)},Rec.prototype.expandHorizontal=function(e,t){return t=t||this.x+.5*this.width,new Rec((this.x-t)*e+t,this.y,this.width*e,this.height)},Rec.prototype.expandVertical=function(e,t){return t=t||this.y+.5*this.height,new Rec(this.x,(this.y-t)*e+t,this.width,this.height*e)},Rec.prototype.isEqual=function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},Rec.prototype.clone=function(){return new Rec(this.x,this.y,this.width,this.height)},Rec.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"},T.prototype.applyFunction=function(e){var t,n=new T;for(n.name=this.name,t=0;null!=this[t];t++)n[t]=this[t].applyFunction(e);return n.downcast()},T.prototype.getListsDowncasted=function(){return T.toL(this.map((function(e){return e.downcast()})))},T.prototype.get=function(e,t,n,r){var o,i;if(e&&Array.isArray(e))return this.getColumns(e);if("string"==typeof e){for(e=e.trim(),i=!1,o=0;o<this.length;o++)if(this[o].name==e){i=!0,e=o;break}if(!i)return null}else(e=null==e?0:e)<0&&(e+=this.length);var s=this[e];if(null==s){if("number"==typeof e){if(e>this.length)throw new Error("provided indexElementInColumn bigger than list in indexOrNameOfColumn");return null}if("string"!=typeof e)throw new Error("indexOrNameOfColumn should be a number or a string")}if(null==s)return null;if(r)return s.getWithoutRepetitions();if(null==t&&null==n)return s;var a=s.length;null==t&&(t=0),null==n&&(n=a-1),t<0&&(t+=s.length),n<0&&(n+=s.length),n=Math.min(n,a-1);var l=new L;for(l.name=s.name,o=t;o<=n;o++)l.push(s[o]);return l.downcast()},T.prototype.getColumns=function(e,t,n,r,o){if(null!=e){var i;if("string"==_typeOf(e)&&e.includes(",")&&(e=e.split(",")),null!=e.length&&"string"!=_typeOf(e)||(e=[e]),o)return i=this.getWithoutColumns(e),null==t&&null==n||(i=i.sliceRows(t,n)),i.name=this.name,i.downcast();i=new T;var s,a,l=e.length;for(s=0;s<l;s++)null==(a=this.get(e[s],t,n))?r&&i.push(new L):i.push(a);return i.downcast()}},T.prototype.getWithoutColumn=function(e){if(null!=e){var t=this.get(e);return null==t?this:this.getWithoutElement(t)}},T.prototype.getWithoutColumns=function(e){if(null!=e){var t=this.getColumns(e);return null==t||0==t.length?this:this.getWithoutElements(t)}},T.prototype.getRow=function(e){if((e=null==e?0:e)<0&&(e+=this.length>0?this[0].length:0),!Number.isInteger(Number(e)))return null;var t,n=new L,r=this.length;for(t=0;t<r;t++)n[t]=this[t][e];return n.downcast()},T.prototype.getRows=function(e,t){if(null==e)return t?this:void 0;"I"==e.type&&(e.x<0&&this.length>0&&(e.x+=this[0].length),e.y<0&&this.length>0&&(e.y+=this[0].length),e=createSortedNumberList(Math.floor(e.y-e.x+1),e.x));var n,r,o,i,s=new T,a=this.length,l=e.length;for(r=0;r<a;r++){for(n=instanceSameType(this[r]),o=0;o<l;o++)(i=e[o])<0&&(i+=this[0].length,!0),n[o]=this[r][i];"nL"!=n.type&&(n=n.downcast()),n.name=this[r].name,s[r]=n}return s.name=this.name,s.downcast()},T.prototype.getCell=function(e,t){return this.get(e).get(t)},T.prototype.getListLength=function(e){if(!((e=e||0)>=this.length))return this[e].length},T.prototype.getLengths=function(){for(var e=new nL,t=this.length,n=0;n<t;n++)e[n]=null==this[n]?0:this[n].length;return e},T.prototype.sliceRows=function(e,t){if(null==e)return this;var n;e.x&&(t=e.y,e=e.x),e=null==e?0:e,t=null==t?this[0].length-1:t;var r,o=new T,i=this.length;for(o.name=this.name,n=0;n<i;n++)(r=this[n].getSubList(e,t))&&(r.name=this[n].name),o.push(r);return o.downcast()},T.prototype.getWithoutRow=function(e){var t=new T,n=this.length;if(t.name=this.name,e<0&&(e+=this.length>0?this[0].length:0),!Number.isInteger(Number(e)))return this;for(var r=0;r<n;r++)t[r]=L.toL(this[r].slice(0,e).concat(this[r].slice(e+1))).downcast(),t[r].name=this[r].name;return t.downcast()},T.prototype.getWithoutRows=function(e){var t,n=new T,r=this.length;n.name=this.name,e=nL.toL(e.slice(),!1);for(var o=0;o<e.length;o++)e[o]<0&&(e[o]+=this.length>0?this[0].length:0);var i=getBooleanDictionaryForList(e);for(o=0;o<r;o++){n[o]=instanceSameType(this[o]),t=this[o].length;for(var s=0;s<t;s++)null==i[s]&&n[o].push(this[o][s]);n[o].name=this[o].name}return n.downcast()},T.prototype.sortRowsByList=function(e,t,n){if(null!=e){var r=e.isList?e.clone():this.get(e);if(null!=r){t=null==t||t,n=null!=n&&n;for(var o=instanceSameType(this),i=this.length,s=[],a=0;a<r.length;a++)s[a]=[a,r[a]];var l,u,h=("nL"==r.type||"dL"==r.type)&&!n;for(l=t?h?function(e,t){return e[1]-t[1]}:n?function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[0]-t[0]}:function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:0}:h?function(e,t){return t[1]-e[1]}:n?function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:e[0]-t[0]}:function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:0},s=s.sort(l),o.name=this.name,a=0;a<i;a++){(u=instanceSameType(this[a])).name=this[a].name,o[a]=u;for(var c=0;c<r.length;c++)u[c]=this[a][s[c][0]]}return o}}},T.prototype.sortRowsByLists=function(e,t){if(null!=e){if("number"==typeof e)(r=new nL).push(e),e=r;else if("string"==typeof e){(r=new sL).push(e),e=r}if("sL"==e.type){for(var n=this.getNames(),r=new nL,o=0;o<e.length;o++){if(-1==(h=n.indexOf(e[o])))throw new Error("No list with name "+e[o]);r.push(h)}e=r}null==t&&(t=!0),null==t.isList&&(t=createListWithSameElement(e.length,t));var i=new nL;for(o=0;o<t.length;o++)1==t[o]||"true"==t[o]||1==t[o]?i.push(1):i.push(-1);var s=instanceSameType(this),a=this.length,l=[];for(o=0;o<this[0].length;o++)l[o]={i:o,t:this,lists:e,polarity:i};var u;for(l=l.sort((function(e,t){for(var n,r,o,i=0;i<e.lists.length;i++){if(n=e.t[e.lists[i]][e.i],r=t.t[t.lists[i]][t.i],o=i<e.polarity.length?e.polarity[i]:1,n<r)return-1*o;if(n>r)return 1*o;if(i==e.lists.length-1)return e.i-t.i}return 0})),s.name=this.name,o=0;o<a;o++){(u=instanceSameType(this[o])).name=this[o].name,s[o]=u;for(var h=0;h<this[o].length;h++)u[h]=this[o][l[h].i]}return s}},T.prototype.transpose=function(e,t){var n,r,o,i=e?this.getSubList(1):this,s=i.length,a=instantiate(_typeOf(i));if(0===i.length)return a;for(r=0;r<s;r++)for(n=i[r].length,o=0;o<n;o++)0===r&&(a[o]="nT"==this.type?new nL:new L),a[o][r]=i[r][o];if(n=i[0].length,"nT"!=this.type)for(o=0;o<n;o++)a[o]=a[o].downcast();if(e)for(n=this[0].length,o=0;o<n;o++)a[o].name=String(this[0][o]);if(t){var l=new sL,u=e?1:0;for(s=this.length,r=u;r<s;r++)l.push(this[r].name);a._splice(0,0,l),a=a.downcast(),e&&(l.name=this[0].name)}return a},T.prototype.removeRow=function(e){for(var t=0;null!=this[t];t++)this[t].splice(e,1)},T.prototype.pushRow=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;var e=arguments;1==e.length&&e[0].length==this.length&&(e=e[0]);for(var t=0;t<e.length&&t<this.length;t++)this[t].push(e[t])},T.prototype.clone=function(){var e,t=this.length,n=instanceSameType(this);for(n.name=this.name,e=0;e<t;e++)n.push(this[e].clone());return void 0!==this.containsNulls&&(n.containsNulls=this.containsNulls),n},T.prototype.cloneWithEmptyLists=function(){var e,t,n=this.length,r=instanceSameType(this);for(r.name=this.name,e=0;e<n;e++)(t=instanceSameType(this[e])).name=this[e].name,r.push(t);return r},T.prototype.appendRows=function(e){if(null==e)return this;var t,n;for(e==this&&(e=e.clone()),t=0;t<e.length;t++)for(t>=this.length&&(this[t]=instanceSameType(e[t]),this[t].name=e[t].name),n=0;n<e[t].length;n++)this[t].push(e[t][n]);return this},T.prototype.insertRow=function(e,t,n,r){if(null==e)return null;n=null!=n&&n;var o,i,s=(r=null!=r&&r)?this:this.clone();for(o=0;o<s.length&&o<e.length;o++)i="nL"!=s[o].type||isNaN(e[o])?e[o]:Number(e[o]),s[o]=s[o].insert(i,null==t?s[o].length:t,n);return s},T.prototype.trim=function(){return this.reduce(((e,t)=>(e.push("sL"==t.type?t.trim():t),e)),new T).downcast()},polL.prototype.getFrame=function(){if(0===this.length)return null;for(var e=this[0].getFrame(),t=new Rec(e.x,e.y,e.getRight(),e.getBottom()),n=1;null!=this[n];n++)e=this[n].getFrame(),t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.width=Math.max(t.width,e.getRight()),t.height=Math.max(t.height,e.getBottom());return t.width-=t.x,t.height-=t.y,t},polL.prototype.getCenter=function(){var e=this.getFrame();return new P(e.x+.5*e.width,e.y+.5*e.height)},polL.prototype.getBarycenter=function(){var e;if(0===this.length)return null;var t=new P(this[0].x,this[0].y);for(e=1;null!=this[e];e++)t.x+=this[e].getBarycenter().x,t.y+=this[e].getBarycenter().y;return t.x/=this.length,t.y/=this.length,t},polL.prototype.add=function(e){var t;if("P"===_typeOf(e)){var n=new polL;for(t=0;null!=this[t];t++)n[t]=this[t].add(e);return n.name=this.name,n}},polL.prototype.factor=function(e){for(var t=new polL,n=0;null!=this[n];n++)t[n]=this[n].factor(e);return t.name=this.name,t},polL.prototype.getRotated=function(e,t){for(var n=new polL,r=0;null!=this[r];r++)n[r]=this[r].getRotated(e,t);return n.name=this.name,n},polL.prototype.clone=function(){for(var e=new polL,t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},Pol.prototype.getFrame=function(){if(0===this.length)return null;for(var e,t=new Rec(this[0].x,this[0].y,this[0].x,this[0].y),n=1;null!=this[n];n++)e=this[n],t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.width=Math.max(t.width,e.x),t.height=Math.max(t.height,e.y);return t.width-=t.x,t.height-=t.y,t},Pol.prototype.getCenter=function(){var e=this.getFrame();return new P(e.x+.5*e.width,e.y+.5*e.height)},Pol.prototype.getBarycenter=function(e){var t;e=null==e||e;var n=1-Number(e);if(0===this.length)return null;var r=new P(this[0].x,this[0].y);for(t=1;null!=this[t+n];t++)r.x+=this[t].x,r.y+=this[t].y;return r.x/=this.length,r.y/=this.length,r},Pol.prototype.add=function(e){var t;if("P"===_typeOf(e)){var n=new Pol;for(t=0;null!=this[t];t++)n[t]=this[t].add(e);return n.name=this.name,n}},Pol.prototype.factor=function(e){var t,n=new Pol;if(n.name=this.name,e>=0||e<0){for(t=0;null!=this[t];t++)n[t]=new P(this[t].x*e,this[t].y*e);return n}if(null!=e.type&&"P"==e.type){for(t=0;null!=this[t];t++)n[t]=new P(this[t].x*e.x,this[t].y*e.y);return n}return null},Pol.prototype.getRotated=function(e,t){t=null==t?this.getCenter():t;for(var n=new Pol,r=0;null!=this[r];r++)n[r]=new P(Math.cos(e)*(this[r].x-t.x)-Math.sin(e)*(this[r].y-t.y)+t.x,Math.sin(e)*(this[r].x-t.x)+Math.cos(e)*(this[r].y-t.y)+t.y);return n.name=this.name,n},Pol.prototype.getClosestPoint=function(e){for(var t,n=this[0],r=Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2),o=1;null!=this[o];o++)(t=Math.pow(e.x-this[o].x,2)+Math.pow(e.y-this[o].y,2))<r&&(r=t,n=this[o]);return n},Pol.prototype.toNumberList=function(){var e,t=new nL;for(e=0;null!=this[e];e++)t[2*e]=this[e].x,t[2*e+1]=this[e].y;return t},Pol.prototype.containsPoint=function(e){var t,n,r,o;for(o=!1,t=-1,n=(r=this.length)-1;++t<r;n=t)(this[t].y<=e.y&&e.y<this[n].y||this[n].y<=e.y&&e.y<this[t].y)&&e.x<(this[n].x-this[t].x)*(e.y-this[t].y)/(this[n].y-this[t].y)+this[t].x&&(o=!o);return o},Pol.prototype.touchesPolygon=function(e){var t=this.getFrame(),n=e.getFrame();if(t.x>n.x+n.width||t.x+t.width<n.x||t.y>n.y+n.height||t.y+t.height<n.y)return!1;for(var r=0;r<this.length;r++)if(e.containsPoint(this[r]))return!0;return!1},Pol.prototype.approach=function(e,t){var n=1-(t=t||.5);this.forEach((function(r,o){r.x=n*r.x+t*e[o].x,r.y=n*r.y+t*e[o].y}))},Pol.prototype.clone=function(){for(var e=new Pol,t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},Nd.prototype.cleanRelations=function(){this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL},Nd.prototype.getDegree=function(){return this.relations.length},Nd.prototype.getParent=function(){return this.parent},Nd.prototype.getLeaves=function(){var e=new ndL,t=function(n){0!==n.to.length?n.to.forEach(t):e.addNode(n)};return t(this),e},Nd.prototype.loadImage=function(e){Loader.loadImage(e,(function(e){this.image=e.result}),this)},Nd.prototype.clone=function(e){var t=new Nd(this.id,this.name);return t.x=this.x,t.y=this.y,t.z=this.z,t.nodeType=this.nodeType,t.weight=this.weight,t.descentWeight=this.descentWeight,e?.forEach((e=>{t[e]=this[e]})),t},sL.prototype.getLengths=function(){var e=new nL;return this.forEach((function(t){e.push(null==t?0:t.length)})),e},sL.prototype.countTags=function(e=","){var t=new nL;return this.forEach((function(n){n.includes(e)?t.push(n.split(e).length):t.push(0)})),t},sL.prototype.includesSubString=function(e){for(var t=0;t<this.length;t++)if(this[t].includes(e))return!0;return!1},sL.prototype.indexesOfSubString=function(e){for(var t=new nL,n=0;n<this.length;n++)this[n].includes(e)&&t.push(n);return t},sL.prototype.append=function(e,t){t=null==t||t;var n=new sL;n.name=this.name;var r,o="sL"==_typeOf(e);if(t)for(r=0;null!=this[r];r++)n[r]=this[r]+(o?e[r]:e);else for(r=0;null!=this[r];r++)n[r]=(o?e[r]:e)+this[r];return n},sL.prototype.getSurrounded=function(e,t){t=null==t?"":t;var n,r=new sL;r.name=this.name;var o=Array.isArray(e),i=Array.isArray(t);for(n=0;null!=this[n];n++)r[n]=(o?e[n]:e)+this[n]+(i?t[n]:t);return r},sL.prototype.replace=function(e,t){if(null==e)return this;var n,r=new sL,o=this.length;for(r.name=this.name,n=0;n<o;n++)r[n]=this[n].replace(e,t);return r},sL.prototype.getConcatenated=function(e){var t;e=null==e?" ":e;var n="",r=this.length;for(t=0;t<r;t++)n+=this[t],t<this.length-1&&(n+=e);return n},sL.prototype.toLowerCase=function(){var e,t=new sL;t.name=this.name;var n=this.length;for(e=0;e<n;e++)t[e]=this[e].toLowerCase();return t},sL.prototype.toUpperCase=function(){var e,t=new sL;t.name=this.name;var n=this.length;for(e=0;e<n;e++)t[e]=this[e].toUpperCase();return t},sL.prototype.trim=function(e){if(this.isTable)return this.trim();if("sL"!=this.type)return null;var t,n=this.length,r=new sL;for(t=0;t<n;t++)r[t]=e?this[t].substring(0,e).trim():this[t].trim();return r.name=this.name,r},sL.prototype.clone=function(){var e=sL.toL(this.slice(),!1);return e.name=this.name,e.fnDerived=this.fnDerived,e},ndL.prototype.removeNodes=function(){var e,t=this.length;for(e=0;e<t;e++)this.ids[this[e].id]=null,this.removeElement(this[e])},ndL.prototype.addNode=function(e){this.ids[e.id]=e,this._push(e)},ndL.prototype.addNodes=function(e){var t;for(t=0;null!=e[t];t++)this.addNode(e[t])},ndL.prototype.removeNode=function(e){this.ids[e.id]=null,this.removeElement(e)},ndL.prototype.removeNodeAtIndex=function(e){this.ids[this[e].id]=null,this.splice(e,1)},ndL.prototype.normalizeWeights=function(){var e,t=-9999999,n=this.length;for(e=0;e<n;e++)t=Math.max(this[e].weight,t);for(e=0;e<n;e++)this[e].weight/=t},ndL.prototype.getNodeByName=function(e){var t,n=this.length;for(t=0;t<n;t++)if(this[t].name==e)return this[t];return null},ndL.prototype.get=function(e){return this.ids[e]},ndL.prototype.getNodesByIds=function(e){for(var t,n=new ndL,r=e.length,o=0;o<r;o++)null!=(t=this.ids[e[o]])&&n.addNode(t);return n},ndL.prototype.getWeights=function(){var e,t=new nL;for(e=0;null!=this[e];e++)t[e]=this[e].weight;return t},ndL.prototype.getIds=function(){for(var e=new sL,t=this.length,n=0;n<t;n++)e[n]=this[n].id;return e},ndL.prototype.getDegrees=function(){for(var e=new nL,t=0;null!=this[t];t++)e[t]=this[t].nodes.length;return e},ndL.prototype.getPolygon=function(e){for(var t=new Pol,n=0;null!=this[n];n++)t[n]=new P(this[n].x+e.cX,this[n].y+e.cY);return t},ndL.prototype.clone=function(){var e,t=new ndL,n=this.length;for(e=0;e<n;e++)t.addNode(this[e]);return t.name=this.name,t},ndL.prototype.getWithoutRepetitions=function(){var e,t=new ndL;for(t.name=this.name,e=0;null!=this[e];e++)null==t.get(this[e].id)&&t.addNode(this[e]);return t},ndL.prototype.removeElements=function(e){var t;for(t=0;null!=this[t];t++)null!=e.get(this[t].id)&&(this.ids[this[t].id]=null,this.splice(t,1),t--)},relL.prototype.addRelation=function(e){this.addNode(e)},relL.prototype.removeRelation=function(e){this.removeNode(e)},relL.prototype.getRelationsWithNode=function(e){var t,n=[];for(t=0;null!=this[t];t++){var r=this[t];r.node0!=e&&r.node1!=e||n.push(r)}return n},relL.prototype.getRelatedNodesToNode=function(e){var t,n=new ndL;for(t=0;t<this.length;t++){var r=this[t];r.node0.id==e.id&&n.push(r.node1),r.node1.id==e.id&&n.push(r.node0)}return n},relL.prototype.getChildrenOfNode=function(e){var t,n=new ndL;for(t=0;t<this.length;t++){var r=this[t];r.node0.id==e.id&&n.addNode(r.node1)}return n},relL.prototype.getAllRelationsBetweenNodes=function(e,t,n){var r;n=null!=n&&n;var o=[];for(r=0;null!=this[r];r++){var i=this[r];(i.node0==e&&i.node1==t||!n&&i.node0==t&&i.node1==e)&&o.push(i)}return o},relL.prototype.nodesAreConnected=function(e,t,n){return null!=e.to.get(t.id)||!n&&null!=t.to.get(e.id)},relL.prototype.getFirstRelationBetweenNodes=function(e,t,n){n=null!=n&&n;for(var r=0;null!=this[r];r++)if(this[r].node0.id==e.id&&this[r].node1.id==t.id||!n&&this[r].node1.id==e.id&&this[r].node0.id==t.id)return this[r];return null},relL.prototype.getFirstRelationByIds=function(e,t,n){var r,o,i=n||!1;for(r=0;null!=this[r];r++)if((o=this[r]).node0.id==e&&o.node1.id==t)return o;if(i)return null;for(r=0;null!=this[r];r++)if((o=this[r]).node0.id==t&&o.node1.id==e)return o;return null},recL.prototype.getFrame=function(){if(0===this.length)return null;var e=this[0].clone();e.width=e.getRight(),e.height=e.getBottom();for(var t=1;null!=this[t];t++)e.x=Math.min(e.x,this[t].x),e.y=Math.min(e.y,this[t].y),e.width=Math.max(this[t].getRight(),e.width),e.height=Math.max(this[t].getBottom(),e.height);return e.width-=e.x,e.height-=e.y,e},recL.prototype.clone=function(){for(var e=new recL,t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},recL.prototype.add=function(){},recL.prototype.factor=function(){},recL.prototype.getIntersectionArea=function(){for(var e,t,n,r=0,o=0;null!=this[o+1];o++){e=this[o];for(var i=o+1;null!=this[i];i++)t=this[i],r+=null==(n=e.getIntersection(t))?0:n.getArea()}return r},recL.prototype.intersectsRectangle=function(e){if(null==e)return!1;for(var t=0;t<this.length;t++)if(this[t].intersectsRectangle(e))return!0;return!1},Rel.prototype.getOther=function(e){return e==this.node0?this.node1:this.node0},Rel.prototype.clone=function(e,t){var n;return(n=t?new Rel(this.id,this.name,t.nodes.get(this.node0.id),t.nodes.get(this.node1.id)):new Rel(this.id,this.name,this.node0,this.node1)).x=this.x,n.y=this.y,n.z=this.z,n.nodeType=this.nodeType,n.weight=this.weight,n.descentWeight=this.descentWeight,e?.forEach((e=>{n[e]=this[e]})),n},Net.prototype.getNodes=function(){return this.nodes},Net.prototype.getRelations=function(){return this.relations},Net.prototype.getNodesIds=function(){return this.nodes.getIds()},Net.prototype.addNode=function(e){this.nodes.addNode(e)},Net.prototype.getNodeByName=function(e){return this.nodes.getNodeByName(e)},Net.prototype.get=function(e){return this.nodes.get(e)},Net.prototype.createRelation=function(e,t,n,r,o,i){null==e.type&&(e=this.createNode(e)),null==t.type&&(t=this.createNode(t)),null==n&&(n=e.id+"_"+t.id);var s=this.relations.get(n);return s||(null==i&&(i=e.name+"_"+t.name),s=new Rel(n,i,e,t,r,o),this.addRelation(s),s)},Net.prototype.addRelation=function(e){this.relations.addNode(e),e.node0.nodes.addNode(e.node1),e.node0.relations.addNode(e),e.node0.to.addNode(e.node1),e.node0.toRelations.addNode(e),e.node1.nodes.addNode(e.node0),e.node1.relations.addNode(e),e.node1.from.addNode(e.node0),e.node1.fromRelations.addNode(e)},Net.prototype.connect=function(e,t,n,r,o){var i=new Rel(n=n||e.id+"_"+t.id,n,e,t,r=r||1);return this.addRelation(i),i.content=o,i},Net.prototype.removeNode=function(e){this.removeNodeRelations(e),this.nodes.removeNode(e)},Net.prototype.removeNodeRelations=function(e){for(var t=0;null!=e.relations[t];t++)this.removeRelation(e.relations[t]),t--},Net.prototype.removeNodes=function(){this.nodes.deleteNodes(),this.relations.deleteNodes()},Net.prototype.removeRelation=function(e){this.relations.removeElement(e),e.node0.nodes.removeNode(e.node1),e.node0.relations.removeRelation(e),e.node0.to.removeNode(e.node1),e.node0.toRelations.removeRelation(e),e.node1.nodes.removeNode(e.node0),e.node1.relations.removeRelation(e),e.node1.from.removeNode(e.node0),e.node1.fromRelations.removeRelation(e)},Net.prototype.removeIsolatedNodes=function(e=1){var t,n=0;for(t=0;null!=this.nodes[t];t++)this.nodes[t].getDegree()<e&&(this.nodes[t]._toRemove=!0);for(t=0;null!=this.nodes[t];t++)this.nodes[t]._toRemove&&(this.removeNode(this.nodes[t]),n++,t--);return n},Net.prototype.lightClone=function(){var e=new Net;return e.nodes=this.nodes,e.relations=this.relations,e},Net.prototype.clone=function(e,t,n,r){var o,i,s=new Net;return null==e&&(e=[]),null==t&&(t=[]),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(t){o=new Nd(n+t.id,r+t.name),""!==n&&(o.basicId=t.id),""!==r&&(o.basicName=t.name),e&&(e.forEach((function(e){null!=t[e]&&(o[e]=t[e])})),o.weight=t.weight,o.color=t.color,o.kind=t.kind),s.addNode(o)})),this.relations.forEach((function(e){i=new Rel(n+e.id,r+e.name,s.nodes.get(n+e.node0.id),s.nodes.get(n+e.node1.id),e.weight),""!==n&&(i.basicId=e.id),""!==r&&(i.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(i[t]=e[t])})),s.addRelation(i)})),s},Tr.prototype.addNodeToTree=function(e,t){if(this.addNode(e),null==t)e.level=0,e.parent=null;else{var n=new Rel(t.id+"_"+e.id,t.id+"_"+e.id,t,e);this.addRelation(n),e.level=t.level+1,e.parent=t,t.weight++}e.weight=1,this.nLevels=Math.max(this.nLevels,e.level+1)},Net.prototype._newCreateRelation=function(e,t,n,r){null==n&&(n=this.relations.getNewId()),this._createRelation(e,t,n,r),t.level=e.level+1,t.parent=e,this.nLevels=Math.max(this.nLevels,t.level+1)},Tr.prototype.addFather=function(e,t){if(null!=t.parent||-1==this.nodes.indexOf(t))return!1;this.addNode(e),t.parent=e,t.level=1,this.nLevels=Math.max(this.nLevels,1),this.createRelation(e,t)},Tr.prototype.getLevel=function(e){e=0===e?0:e;var t=new ndL;t.name="level_"+e;var n,r=this.nodes.length;for(n=0;n<r;n++)this.nodes[n].level==e&&t.addNode(this.nodes[n]);return t},Tr.prototype.getLeaves=function(e){var t,n,r=new ndL;if(r.name="leaves",e){if(0===e.to.length)return r.addNode(e),r;var o=function(e){if(0===e.to.length)r.addNode(e);else for(n=e.to.length,t=0;t<n;t++)o(e.to[t])};for(n=e.to.length,t=0;t<n;t++)o(e.to[t])}else for(n=this.nodes.length,t=0;t<n;t++)0===this.nodes[t].to.length&&r.addNode(this.nodes[t]);return r},Tr.prototype.assignDescentWeightsToNodes=function(){this._assignDescentWeightsToNode(this.nodes[0])},Tr.prototype._assignDescentWeightsToNode=function(e){var t;if(0===e.to.length)return e.descentWeight=e.weight,e.descentWeight;for(e.descentWeight=0,t=0;null!=e.to[t];t++)e.descentWeight+=this._assignDescentWeightsToNode(e.to[t]);return e.weight=e.descentWeight,e.descentWeight},Tr.prototype.getReport=function(){return"Tr contains "+this.nodes.length+" nodes and "+this.relations.length+" relations"},Tr.prototype.traverse=function(e,t,n){if(null!=this&&"Tr"==this.type){if(null==e)if(null==(e=this.getLevel(0)[0]))return;t=null==t?0:t;for(var r,o,i,s,a=[e],l=0,u=new ndL;a.length>0;)if(o=0==t?a.pop():a.shift(),s=!0,n&&(s=n(o,l++,this)),u.addNode(o),s&&0!=(i=this.relations.getChildrenOfNode(o)).length)if(0==t)for(r=i.length-1;r>=0;r--)a.push(i[r]);else for(r=0;r<i.length;r++)a.push(i[r]);return u}},Tr.prototype.getAncestorsOf=function(e){if(null!=this&&"Tr"==this.type){var t,n,r;if("Nd"==e.type)(r=new ndL).addNode(e);else{if("ndL"!=e.type)return;r=e}var o=new ndL;for(n=0;n<r.length;n++)for(t=r[n];null!=t.parent;)o.addNode(t.parent),t=t.parent;return o=o.getWithoutRepetitions()}},Tr.prototype.buildFilteredTree=function(e){if(null!=this&&"Tr"==this.type){if("ndL"!=e.type)throw new Error("Invalid input type for buildFilteredTree");var t,n,r=this.clone(),o=this.getAncestorsOf(e),i=new ndL;for(n=0;n<r.nodes.length;n++)t=r.nodes[n],null==o.get(t.id)&&null==e.get(t.id)&&i.addNode(t);for(n=0;n<i.length;n++)r.removeNode(i[n]);return r}},Tr.prototype.clone=function(e,t,n,r){var o,i,s=new Tr;return s.nLevels=this.nLevels,null==e&&(e=[]),null==t&&(t=[]),e.push("parent"),e.push("level"),e.push("bOpen"),e.push("color"),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(t){o=new Nd(n+t.id,r+t.name),""!==n&&(o.basicId=t.id),""!==r&&(o.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(o[e]=t[e])})),s.addNode(o)})),this.relations.forEach((function(e){i=new Rel(n+e.id,r+e.name,s.nodes.get(n+e.node0.id),s.nodes.get(n+e.node1.id),e.weight),""!==n&&(i.basicId=e.id),""!==r&&(i.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(i[t]=e[t])})),s.addRelation(i)})),s},dI.prototype.toString=function(){return"DateInterval["+this.date0+", "+this.date1+"]"},dI.prototype.getMax=function(){return this.date1>this.date0?this.date1:this.date0},dI.prototype.getMin=function(){return this.date0<this.date1?this.date0:this.date1},dI.prototype.getTimesInterval=function(){return new I(this.date0.getTime(),this.date1.getTime())},dI.prototype.getProduct=function(e){if(null!=e){if("I"==e.type){var t=this.date0.getTime(),n=this.date1.getTime()-t;return new dI(new Date(t+e.x*n),new Date(t+e.y*n))}return null}},nT.prototype.getMax=function(){if(0===this.length)return null;var e,t=this[0].getMax();for(e=1;null!=this[e];e++)t=Math.max(this[e].getMax(),t);return t},nT.prototype.getMaxValues=function(){if(0===this.length)return null;var e,t=new nL;for(e=0;null!=this[e];e++)t[e]=this[e].getMax();return t},nT.prototype.getMaxCell=function(){if(0===this.length)return null;var e,t,n,r=createListWithSameElement(2,0);for(n=this[0][0],e=0;e<this.length;e++)for(t=0;t<this[e].length;t++)this[e][t]>n&&(n=this[e][t],r[0]=e,r[1]=t);return r},nT.prototype.getMin=function(){if(0===this.length)return null;var e,t=this[0].getMin();for(e=1;null!=this[e];e++)t=Math.min(this[e].getMin(),t);return t},nT.prototype.getMinValues=function(){if(0===this.length)return null;var e,t=new nL;for(e=0;null!=this[e];e++)t[e]=this[e].getMin();return t},nT.prototype.getMinCell=function(){if(0===this.length)return null;var e,t,n,r=createListWithSameElement(2,0);for(n=this[0][0],e=0;e<this.length;e++)for(t=0;t<this[e].length;t++)this[e][t]<n&&(n=this[e][t],r[0]=e,r[1]=t);return r},nT.prototype.getInterval=function(e){if(0===this.length)return null;for(var t=this[0].getInterval(e),n=this.length,r=1;r<n;r++){var o=this[r].getInterval(e);t.x=Math.min(t.x,o.x),t.y=Math.max(t.y,o.y)}return t},nT.prototype.getFrame=function(){if(!(this.length<2)){var e=this[0].getInterval(),t=this[1].getInterval();return new Rec(e.x,t.x,e.getAmplitude(),t.getAmplitude())}},nT.prototype.getSums=function(e=1){for(var t=new nL,n=this.length,r=0;r<n;r++)t[r]=this[r].getSum()*e;return t},nT.prototype.getRowsSums=function(){for(var e,t=this[0].clone(),n=1;null!=this[n];n++){e=this[n];for(var r=0;null!=e[r];r++)t[r]+=e[r]}return t},nT.prototype.getAverages=function(){for(var e=new nL,t=0;null!=this[t];t++)e[t]=this[t].getMean();return e},nT.prototype.getRowsAverages=function(){var e,t,n,r,o=this.length,i=this[0].clone().factor(1/o);for(t=1;t<o;t++)for(r=(e=this[t]).length,n=0;n<r;n++)i[n]+=e[n]/o;return i},nT.prototype.getIntervals=function(){var e,t,n=this.length,r=new L;for(t=0;t<n;t++)e=this[t],r.push(e.getInterval());return r},nT.prototype.factor=function(e){var t,n,r=new nT,o=this.length;switch(_typeOf(e)){case"number":for(t=0;t<o;t++)n=this[t],r[t]=n.factor(e);break;case"nL":for(t=0;t<o;t++)n=this[t],r[t]=n.factor(e[t])}return r.name=this.name,r},nT.prototype.add=function(e){var t,n,r=new nT,o=this.length;for(n=0;n<o;n++)t=this[n],r[n]=t.add(e);return r.name=this.name,r},dL.prototype.getTimes=function(){var e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getTime());return t},dL.prototype.getYears=function(){var e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getYear());return t},dL.prototype.getFullYears=function(){var e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getFullYear());return t},dL.prototype.getMin=function(){if(0===this.length)return null;var e,t=this[0];for(e=1;null!=this[e];e++)t=t<this[e]?t:this[e];return t},dL.prototype.getMax=function(){if(0===this.length)return null;var e,t=this[0];for(e=1;null!=this[e];e++)t=t>this[e]?t:this[e];return t},dL.prototype.getInterval=function(){if(0===this.length)return null;var e=this[0],t=this[0];for(let n=1;n<this.length;n++)e=Math.min(this[n],e),t=Math.max(this[n],t);return new dI(e,t)},nL.prototype.getMin=function(){if(0===this.length)return null;var e,t=this[0];for(e=1;e<this.length;e++)t=Math.min(t,this[e]);return t},nL.prototype.getMax=function(){if(0===this.length)return null;var e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.max(t,this[e]);return t},nL.prototype.getIndexOfMin=function(){if(0===this.length)return null;var e,t=this[0],n=0;for(e=1;e<this.length;e++)this[e]<t&&(t=this[e],n=e);return n},nL.prototype.getIndexOfMax=function(){if(0===this.length)return null;var e,t=this[0],n=0;for(e=1;e<this.length;e++)this[e]>t&&(t=this[e],n=e);return n},nL.prototype.getAmplitude=function(){if(0===this.length)return 0;for(var e=this[0],t=this[0],n=this.length,r=1;r<n;r++)e=Math.min(e,this[r]),t=Math.max(t,this[r]);return t-e},nL.prototype.getSum=function(){if(0===this.length)return 0;var e,t=this[0],n=this.length;for(e=1;e<n;e++)t+=this[e];return t},nL.prototype.getProduct=function(){if(0===this.length)return null;var e,t=this[0],n=this.length;for(e=1;e<n;e++)t*=this[e];return t},nL.prototype.getInterval=function(e){if(0===this.length)return null;e=null!=e&&e;var t,n=-1/0,r=1/0,o=this.length;for(t=0;t<o;t++)e&&isNaN(this[t])||(n=Math.max(n,this[t]),r=Math.min(r,this[t]));return n==-1/0&&r==1/0&&(r=-1/0,n=1/0),new I(r,n)},nL.prototype.getIntervalWithAverage=function(){if(0===this.length)return null;var e,t=this[0],n=this[0],r=this[0],o=this.length;for(e=1;e<o;e++)t=Math.max(t,this[e]),n=Math.min(n,this[e]),r+=this[e];var i=new I(n,t);return i.average=r/o,i},nL.prototype.getNumbersSimplified=function(e,t){var n,r,o,i=this.length;switch(e=e||0,t=t||0,(n=new nL).name=this.name,e){case 0:var s=Math.pow(10,t);this.forEach((function(e){n.push(Math.floor(e/s)*s)}));break;case 6:(n=this.getQuantiles(t,2)).name=this.name;break;case 1:case 2:t=Math.min(t||10,Math.floor(this.length/2));var a,l=this.getQuantiles(t),u=l.length;for(r=0;r<i;r++)if((a=this[r])<l[0])1==e?n.push(0):n.push(l._min);else for(o=0;o<u;o++)if(a>=l[o]&&(o+1==l.length||a<l[o+1])){1==e?n.push(o+1):n.push(l[o]);break}1==e&&(n.name=this.name+" (n quantile)");break;case 3:for(n.name=this.name+" (order of magnitude)",r=0;r<i;r++)n.push(Math.floor(Math.log(this[r])/Math.log(10)));break;case 4:for(n.name=this.name+" (rounded by order of magnitude)",r=0;r<i;r++)n.push(Math.pow(10,Math.floor(Math.log(this[r])/Math.log(10))));break;case 5:for(t=t||1,n.name=this.name+" (significant digits)",r=0;r<i;r++)n.push(Number(this[r].toPrecision(t)))}return n},nL.prototype.toPolygon=nL.prototype.getMean=function(){return this.getSum()/this.length},nL.prototype.getGeometricMean=function(){if(0==this.length)return 0;for(var e=this[0],t=1;t<this.length;t++)e*=this[t];return Math.pow(e,1/this.length)},nL.prototype.getNorm=function(){for(var e=0,t=this.length,n=0;n<t;n++)e+=Math.pow(this[n],2);return Math.sqrt(e)},nL.prototype.getVariance=function(e){for(var t=0,n=e||this.getMean(),r=this.length,o=0;o<r;o++)t+=Math.pow(this[o]-n,2);return t/this.length},nL.prototype.getStandardDeviation=function(e){return Math.sqrt(this.getVariance(e))},nL.prototype.getMedian=function(){var e=this.getSorted(!0),t=(this.length-1)/2,n=Math.floor(t);return t==n?e[t]:.5*e[n]+.5*e[n+1]},nL.prototype.getQuantiles=function(e,t){e=null==e?4:e,t=t||0;var n,r,o,i,s=this.length,a=this.getSorted(!0),l=s/e,u=Math.floor(l),h=l==u,c=new nL;for(c.name=this.name,n=0;n<e-1;n++)c[n]=h?a[(n+1)*l]:.5*a[(n+1)*u]+.5*a[(n+1)*u+1];if(c._sorted=a,c._min=a[0],c._max=a[a.length-1],0===t)return c;for((r=1==t?new nL:new sL).name=this.name,3==t&&(i=2==e?["low","high"]:["low","medium","high"]),n=0;n<s;n++){for(o=0;o<c.length;o++)if(this[n]<c[o]){r[n]=3==t?i[o]:1==t?o:(0==o?c._min:c[o-1])+"-"+c[o];break}null==r[n]&&(r[n]=3==t?i[o]:1==t?c.length:c[c.length-1]+"-"+c._max)}return r._quantiles=c,r},nL.prototype.getSorted=function(e){var t;return(t=(e=null==e||e)?nL.toL(this.slice().sort((function(e,t){return e-t})),!1):nL.toL(this.slice().sort((function(e,t){return t-e})),!1)).name=this.name,t},nL.prototype.getSortIndexes=function(e){null==e&&(e=!0);var t=[],n=new nL,r=this.length;if(0===this.length)return n;for(var o=0;o<r;o++)t.push([o,this[o]]);for(e?t.sort((function(e,t){return e[1]<t[1]?1:-1})):t.sort((function(e,t){return e[1]<t[1]?-1:1})),o=0;null!=t[o];o++)n.push(t[o][0]);return n.name=this.name,n},nL.prototype.cleanNonFinites=function(e){if(null==e&&(e=this.getInterval()),!isFinite(e.x)||!isFinite(e.y)){var t,n,r=new nL,o=new nL,s=new nL,a=new nL;for(a.name=this.name,i=0;i<this.length;i++)isFinite(this[i])?(null==t&&(t=this[i]),null==n&&(n=this[i]),t=Math.min(t,this[i]),n=Math.max(n,this[i]),a[i]=this[i]):this[i]==1/0?o.push(i):this[i]==-1/0?r.push(i):s.push(i);for(null==t&&(t=0),null==n&&(n=0),t--,n++,i=0;i<r.length;i++)a[r[i]]=t;for(i=0;i<o.length;i++)a[o[i]]=n;for(i=0;i<s.length;i++)a[s[i]]=0;return a}return this},nL.prototype.getNormalized=function(e){if(null!=this){if(e=null==e?1:e,0===this.length)return null;var t,n=this.getInterval(),r=this.cleanNonFinites(n);if(this!=r)return r.getNormalized(e);var o,i=n.getAmplitude();if(0===i)return(o=createListWithSameElement(this.length,1)).name=this.name,o.interval=n,o;for(o=new nL,e/=i,t=0;t<this.length;t++)o[t]=e*(this[t]-n.x);return o.name=this.name,o.interval=n,o}},nL.prototype.getNormalizedToSum=function(e,t){return normalizeToSum(this,e,t)},nL.prototype.getNormalizedToMax=function(e){if(null!=this){if(e=null==e?1:e,0===this.length)return null;var t,n=this.getMax(),r=this.cleanNonFinites();if(this!=r)return r.getNormalizedToMax(e);var o=new nL;for(t=0;t<this.length;t++)o[t]=e*this[t]/n;return o.name=this.name,o}},nL.prototype.factor=function(e){var t,n=new nL,r=this.length;if(Array.isArray(e))for(t=0;t<r;t++)n.push(this[t]*e[t%this.length]);else for(t=0;t<r;t++)n.push(this[t]*e);return n.name=this.name,n},nL.prototype.add=function(e){var t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]+e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]+e[t%e.length]}return n.name=this.name,n},nL.prototype.subtract=function(e){var t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]-e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]-e[t%e.length]}return n.name=this.name,n},nL.prototype.divide=function(e){var t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]/e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]/e[t%e.length]}return n.name=this.name,n},nL.prototype.sqrt=function(){var e,t=new nL,n=this.length;for(e=0;e<n;e++)t.push(Math.sqrt(this[e]));return t.name=this.name,t},nL.prototype.pow=function(e){var t,n=new nL,r=this.length;for(t=0;t<r;t++)n.push(Math.pow(this[t],e));return n.name=this.name,n},nL.prototype.log=function(e){var t;e=e||0;var n=new nL,r=this.length;for(t=0;t<r;t++)n[t]=Math.log(this[t]+e);return n.name=this.name,n},nL.prototype.floor=function(){var e,t=new nL,n=this.length;for(e=0;e<n;e++)t.push(Math.floor(this[e]));return t.name=this.name,t},nL.prototype.approach=function(e,t){var n,r=1-(t=t||.5),o=this.length;for(n=0;n<o;n++)this[n]=r*this[n]+t*e[n];return!0},nL.prototype.isEqual=function(e){var t=this.length;if(null==e||e.length!=t)return!1;for(var n=0;n<t;n++)if(this[n]!=e[n])return!1;return!0},nL.prototype.addRandom=function(e){var t;null==e&&(e=new I(0,1));var n=new nL,r=this.length,o=e.getAmplitude();for(t=0;t<r;t++)n[t]=this[t]+Math.random()*o+e.x;return n.name=this.name,n},nL.prototype.trim=function(e,t){if(null==e&&null==t)return this;for(var n=new nL,r=0;r<this.length;r++)null!=e&&(n[r]=Math.max(this[r],e)),null!=t&&(n[r]=Math.min(this[r],t));return n.name=this.name,n},nL.prototype.clone=function(){var e=nL.toL(this.slice(),!1);return e.name=this.name,e.fnDerived=this.fnDerived,e},I.prototype.getMin=function(){return Math.min(this.x,this.y)},I.prototype.getMax=function(){return Math.max(this.x,this.y)},I.prototype.getAmplitude=function(){return Math.abs(this.y-this.x)},I.prototype.getSignedAmplitude=function(){return this.y-this.x},I.prototype.getMiddle=function(){return.5*(this.x+this.y)},I.prototype.getRandom=function(){return this.x+(this.y-this.x)*random()},I.prototype.getSign=function(){return this.x==this.y?0:Math.abs(this.y-this.x)/(this.y-this.x)},I.prototype.getScaled=function(e){var t=.5*(this.y-this.x),n=.5*(this.x+this.y);return new I(n-t*e,n+t*e)},I.prototype.getScaledFromProportion=function(e,t){var n=1-t,r=t*(this.y-this.x),o=n*(this.y-this.x),i=n*this.x+t*this.y;return new I(i-r*e,i+o*e)},I.prototype.add=function(e){return new I(this.x+e,this.y+e)},I.prototype.invert=function(){var e=this.x;this.x=this.y,this.y=e},I.prototype.adjustToContain=function(e){e<this.x&&(this.x=e),e>this.y&&(this.y=e)},I.prototype.getInterpolatedValue=function(e){return e*(this.y-this.x)+this.x},I.prototype.getInverseInterpolatedValue=function(e){return(e-this.x)/(this.y-this.x)},I.prototype.getInterpolatedValues=function(e){for(var t=new nL,n=e.length,r=0;r<n;r++)t[r]=this.getInterpolatedValue(e[r]);return t},I.prototype.getInverseInterpolatedValues=function(e){for(var t=new nL,n=e.length,r=0;r<n;r++)t.push(this.getInverseInterpolatedValue(e[r]));return t},I.prototype.intersect=function(e){return new I(Math.max(this.x,e.x),Math.min(this.y,e.y))},I.prototype.unite=function(e){return new I(Math.min(this.x,e.x),Math.max(this.y,e.y))},I.prototype.clone=function(){var e=new I(this.x,this.y);return e.name=name,e},I.prototype.contains=function(e){return this.y>this.x?e>=this.x&&e<=this.y:e>=this.y&&e<=this.y},I.prototype.isEqual=function(e){return this.x==e.x&&this.y==e.y},I.prototype.remap=function(e,t){var n=this.getInverseInterpolatedValue(e);return t.getInterpolatedValue(n)},I.prototype.toString=function(){return"Interval[x:"+this.x+"| y:"+this.y+"| amplitude:"+this.getAmplitude()+"]"},pol3DL.prototype.getBarycenter=function(){for(var e,t=0,n=0,r=0,o=0;o<this.length;o++)t+=(e=this[o].getBarycenter()).x,n+=e.y,r+=e.z;return new P3D(t/this.length,n/this.length,r/this.length)},cScale.prototype.getColor=function(e){return this.colorScaleFunction(e)},cScale.prototype.getColorList=function(e){var t,n=new cL;for(t=0;t<e;t++)n.push(this.getColor(t/(e-1)));return n},MetaCanvas.prototype._init=function(e){this.W=1,this.H=1,this.cX=1,this.cY=1,this.mX=0,this.mY=0,this.mP=new P(0,0),this.nF=0,this.MOUSE_DOWN=!1,this.MOUSE_UP=!1,this.MOUSE_UP_FAST=!1,this.WHEEL_CHANGE=0,this.NF_DOWN=void 0,this.NF_UP=void 0,this.MOUSE_PRESSED=void 0,this.MOUSE_IN_DOCUMENT=!0,this.mX_DOWN=void 0,this.mY_DOWN=void 0,this.mX_UP=void 0,this.mY_UP=void 0,this.MOUSE_MOVED=!1,this.PREV_mX=0,this.PREV_mY=0,this.DX_MOUSE=0,this.DY_MOUSE=0,this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0,this.T_MOUSE_PRESSED=0,this.KEY_PRESSED=null,this.KEY_JUST_PRESSED=null,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1,this.IS_TOUCH="ontouchstart"in window||navigator.msMaxTouchPoints>0,this.force=0,this.cursorStyle="auto",this.backGroundColor="white",this.backGroundColorRGB=[255,255,255],this.cycleActive=void 0,this._prevMouseX=0,this._prevMouseY=0,this._setIntervalId=void 0,this._setTimeOutId=void 0,this._interactionCancelledFrame=void 0,this._tLastMouseDown=void 0,this._alphaRefresh=0,this.END_CYCLE_DELAY=3e3,this._LISTENERS_ADDED=!1,this.fontColor="#000000",this.fontSize="14",this.fontName="Arial",this.fontAlign="left",this.fontBaseline="top",this.fontStyle="",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("tabindex","10000"),this.canvas.setAttribute("style","outline:none"),this.container&&this.container.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this._adjustCanvas(this.dimensions);var t=this._onMouseOrKeyBoard.bind(this);this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",t,!1),this.canvas.addEventListener("touchend",t,!1),this.canvas.addEventListener("touchmove",t,!1)),this.canvas.addEventListener("mousemove",t,!1),this.canvas.addEventListener("mousedown",t,!1),this.canvas.addEventListener("mouseup",t,!1),this.canvas.addEventListener("mouseenter",t,!1),this.canvas.addEventListener("mouseleave",t,!1),this.canvas.addEventListener("click",t,!1),this.canvas.addEventListener("DOMMouseScroll",t,!1),this.canvas.addEventListener("mousewheel",t,{passive:!1}),this.canvas.addEventListener("keydown",t,!1),document.addEventListener("keydown",t,!1),this.canvas.addEventListener("keyup",t,!1),document.addEventListener("keyup",t,!1);var n,r=this._onResize.bind(this);(null!=this.container&&(n=this.container.ownerDocument)?n.defaultView||n.parentWindow:window).addEventListener("resize",resizeThrottler(r,66),!1),parent.addEventListener("resize",resizeThrottler(r,66),!1),this._listeners={mousemove:[],mousedown:[],mouseup:[],mouseenter:[],mouseleave:[],mousewheel:[],click:[],keydown:[],keyup:[]},this.IS_TOUCH&&(this._listeners.touchstart=[],this._listeners.touchend=[],this._listeners.touchmove=[]),this.context.fillStyle="black",this.init(),e&&this._startCycle(),this.memory={}},MetaCanvas.prototype._getRelativeMousePos=function(e){var t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},MetaCanvas.prototype._onMouseOrKeyBoard=function(e){var t;if(this.IS_TOUCH)var n=null!=e.touches&&null!=e.touches[0]?e.touches[0]:e.targetTouches[0];switch(e.type){case"touchmove":this.force=n.force;case"mousemove":t="mousemove"==e.type?this._getRelativeMousePos(e):{x:null==n.clientX?n.pageX:n.clientX,y:(n.clientY,n.clientY)},this.mX=t.x,this.mY=t.y,this.mP.x=this.mX,this.mP.y=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mousedown":case"touchstart":"touchstart"==e.type&&(this.mX=n.clientX,this.mY=n.clientY),this.NF_DOWN=this.nF,this.MOUSE_PRESSED=!0,this.T_MOUSE_PRESSED=0,this._tLastMouseDown=(new Date).getTime(),this.mX_DOWN=this.mX,this.mY_DOWN=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mouseup":case"touchend":this.NF_UP=this.nF,this.MOUSE_PRESSED=!1,this.T_MOUSE_PRESSED=0,this.mX_UP=this.mX,this.mY_UP=this.mY,this.MOUSE_IN_DOCUMENT=!0,this.MOUSE_UP=!0;break;case"mouseenter":this.MOUSE_IN_DOCUMENT=!0;break;case"mouseleave":this.MOUSE_IN_DOCUMENT=!1,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1;break;case"keydown":this.SHIFT_PRESSED=e.shiftKey,this.KEY_PRESSED=e.key,this.KEY_JUST_PRESSED=e.key,this.COMMAND_PRESSED=91==e.keyCode;break;case"keyup":this.SHIFT_PRESSED=!1,this.KEY_PRESSED=null,this.COMMAND_PRESSED=!1}this._emit(e.type,e),this.cycleActive&&(new Date).getTime()>this._LAST_TIME+33&&this._onCycle()},MetaCanvas.prototype._onResize=function(e){var t=this.W,n=this.H;if(void 0===this.dimensions&&this._adjustCanvas(),this.onResize!==noOperation){var r=this._containerDimensions();r.width===t&&r.height===n||this.onResize(e)}},MetaCanvas.prototype._containerDimensions=function(){return this.container?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0}},MetaCanvas.prototype._adjustCanvas=function(e){if(void 0!==e)this.W=e.width,this.H=e.height;else{var t=this._containerDimensions();this.W=t.width,this.H=t.height}this.cX=Math.floor(.5*this.W),this.cY=Math.floor(.5*this.H),this.canvas.setAttribute("width",this.W),this.canvas.setAttribute("height",this.H),e&&null!=e.x&&this.canvas.setAttribute("x",e.x),e&&null!=e.y&&this.canvas.setAttribute("y",e.y)},MetaCanvas.prototype._startCycle=function(){this.cycleActive=!0,0===this._cycleInterval?setTimeout(this._onCycle.bind(this),10):(clearInterval(this._setIntervalId),this._setIntervalId=setInterval(this._onCycle.bind(this),this._cycleInterval))},MetaCanvas.prototype._stopCycle=function(e){clearInterval(this._setIntervalId),this.cycleActive=!1,this._setIntervalId=void 0,e&&e()},MetaCanvas.prototype.setDimensions=function(e,t,n,r){var o,i,s,a;null!=n&&null!=r?(o=e,i=t,s=n,a=r):(o=0,i=0,s=e,a=t),this.W=s,this.H=a,this.cX=.5*s,this.cY=.5*a,this.canvas.width=s,this.canvas.height=a,this.canvas.style.left=o+"px",this.canvas.style.top=i+"px",this.canvas.style.position="absolute",this._startCycle()},MetaCanvas.prototype.cycleFor=function(e){0===e?(this._setIntervalId&&clearTimeout(this._setTimeOutId),this._startCycle()):1==e?(this._stopCycle(),this._onCycle()):(this._setIntervalId?clearTimeout(this._setTimeOutId):this._startCycle(),this._stopAfter(e))},MetaCanvas.prototype._stopAfter=function(e,t){var n=this;this._setTimeOutId=setTimeout((function(){n._stopCycle(),t&&t()}),e)},MetaCanvas.prototype._onCycle=function(){if(0===this._alphaRefresh?null!=this.backGroundColorRGB?(this.context.fillStyle="rgb("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+")",this.context.fillRect(0,0,this.W,this.H)):this.context.clearRect(0,0,this.W,this.H):(this.context.fillStyle="rgba("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+","+this._alphaRefresh+")",this.context.fillRect(0,0,this.W,this.H)),this.setCursor("default"),this.MOUSE_DOWN=this.NF_DOWN==this.nF,this.MOUSE_UP=this.NF_UP==this.nF,this.MOUSE_UP_FAST=!this.MOUSE_UP_FAST&&this.MOUSE_UP&&this.nF-this.NF_DOWN<9,this.DX_MOUSE=this.mX-this.PREV_mX,this.DY_MOUSE=this.mY-this.PREV_mY,this.MOUSE_MOVED=0!==this.DX_MOUSE||0!==this.DY_MOUSE,this.MOUSE_PRESSED?(this.T_MOUSE_PRESSED=(new Date).getTime()-this._tLastMouseDown,this.DX_MOUSE_PRESSED=this.DX_MOUSE,this.DY_MOUSE_PRESSED=this.DY_MOUSE,this.DX_MOUSE_DRAGGED=this.mX-this.mX_DOWN,this.DY_MOUSE_DRAGGED=this.mY-this.mY_DOWN,this.DRAGGABLE&&(this.x0+=this.DX_MOUSE_PRESSED,this.y0+=this.DY_MOUSE_PRESSED)):(this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0),this.ZOOMABLE){let e=1+.3*this.WHEEL_CHANGE;(this.ZOOM*e>=this.MAX_ZOOM||this.ZOOM*e<=this.MIN_ZOOM)&&(e=1),this.ZOOM*=e,this.ZOOM=Math.max(Math.min(this.ZOOM,this.MAX_ZOOM),this.MIN_ZOOM),this.x0=(this.x0-this.mX)*e+this.mX,this.y0=(this.y0-this.mY)*e+this.mY}this.cycle(),this.WHEEL_CHANGE=0,this.PREV_mX=this.mX,this.PREV_mY=this.mY,this.nF++,this.KEY_JUST_PRESSED=null,this._LAST_TIME=(new Date).getTime()},MetaCanvas.prototype._emit=function(e,t){switch(e){case"mousewheel":case"DOMMouseScroll":e="mousewheel",t||(t=window.event),t.wheelDelta?this.WHEEL_CHANGE=t.wheelDelta/120:t.detail&&(this.WHEEL_CHANGE=-t.detail/3),t.value=this.WHEEL_CHANGE}for(var n=this._listeners[e].length,r=0;r<n;r++){var o=this._listeners[e][r];o.call(o.__context,t)}},MetaCanvas.prototype.getCycleInterval=function(){return this._cycleInterval},MetaCanvas.prototype.setCycleInterval=function(e){this._cycleInterval=e,this.cycleActive&&this._startCycle()},MetaCanvas.prototype.start=function(){return this._startCycle()},MetaCanvas.prototype.stop=function(){return this._stopCycle()},MetaCanvas.prototype.cycleOnMouseMovement=function(e){var t=this;this.cycleOnMouseMovementListener&&this._LISTENERS_ADDED&&e<=1&&(this.canvas.removeEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousewheel",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.removeEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!1),e>1&&(this.cycleOnMouseMovementListener=function(){t.cycleFor(e)},this._LISTENERS_ADDED||(this.canvas.addEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("mousewheel",this.cycleOnMouseMovementListener,{passive:!1}),this.canvas.addEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keydown",this.cycleOnMouseMovementListener,!1),document.addEventListener("keydown",boundMouseOrKeyboard,!1),this.canvas.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),document.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!0)),t.cycleFor(e)},MetaCanvas.prototype.on=function(e,t,n){t.__context=n,this._listeners[e].push(t)},MetaCanvas.prototype.off=function(e,t){var n=this._listeners[e].indexOf(t);n>-1&&this._listeners[e].splice(n,1)},MetaCanvas.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.W,this.H)},MetaCanvas.prototype.setBackgroundColor=function(e){"number"==typeof e?e=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":Array.isArray(e)&&(e=RGBtoHEX(e[0],e[1],e[2])),this.backGroundColor=e,this.backGroundColorRGB=colorStringToRGB(this.backGroundColor)},MetaCanvas.prototype.setBackgroundAlpha=function(e){this._alphaRefresh=e},MetaCanvas.prototype.fRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.fillRect(e,t,n,r)},MetaCanvas.prototype.sRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.strokeRect(e,t,n,r)},MetaCanvas.prototype.fsRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.fillRect(e,t,n,r),this.context.strokeRect(e,t,n,r)},MetaCanvas.prototype.fArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fCircle=function(e,t,n){this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.fill()},MetaCanvas.prototype.sCircle=function(e,t,n){this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke()},MetaCanvas.prototype.fsCircle=function(e,t,n){this.fCircle(e,t,n),this.context.stroke()},MetaCanvas.prototype.fEllipse=function(e,t,n,r){var o=.5522848,i=n*o,s=r*o,a=e+n,l=t+r;this.context.beginPath(),this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,a,t-s,a,t),this.context.bezierCurveTo(a,t+s,e+i,l,e,l),this.context.bezierCurveTo(e-i,l,e-n,t+s,e-n,t),this.context.moveTo(e-n,t),this.context.closePath(),this.context.fill()},MetaCanvas.prototype.sEllipse=function(e,t,n,r){var o=.5522848,i=n*o,s=r*o,a=e+n,l=t+r;this.context.beginPath(),this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,a,t-s,a,t),this.context.bezierCurveTo(a,t+s,e+i,l,e,l),this.context.bezierCurveTo(e-i,l,e-n,t+s,e-n,t),this.context.moveTo(e-n,t),this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsEllipse=function(e,t,n,r){this.fEllipse(e,t,n,r),this.context.stroke()},MetaCanvas.prototype._solidArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,o,n,r),this.context.lineTo(e+i*Math.cos(r),t+i*Math.sin(r)),this.context.arc(e,t,i,r,n,!0),this.context.lineTo(e+o*Math.cos(n),t+o*Math.sin(n))},MetaCanvas.prototype.fSolidArc=function(e,t,n,r,o,i){this._solidArc(e,t,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sSolidArc=function(e,t,n,r,o,i){this._solidArc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fsSolidArc=function(e,t,n,r,o,i){this.fSolidArc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.line=function(e,t,n,r){this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(n,r),this.context.stroke()},MetaCanvas.prototype.bezier=function(e,t,n,r,o,i,s,a){this.context.beginPath(),this.context.moveTo(e,t),this.context.bezierCurveTo(n,r,o,i,s,a),this.context.stroke()},MetaCanvas.prototype._lines=function(){if(null!=arguments){var e=arguments[0];this.context.beginPath(),this.context.moveTo(e[0],e[1]);for(var t=2;null!=e[t+1];t+=2)this.context.lineTo(e[t],e[t+1])}},MetaCanvas.prototype._linesM=function(){if(null!=arguments){var e=arguments[0],t=new Pol;this.context.beginPath(),this.context.moveTo(e[0],e[1]),t[0]=new P(e[0],e[1]);for(var n=2;null!=e[n+1];n+=2)this.context.lineTo(e[n],e[n+1]),t.push(new P(e[n],e[n+1]));return t.containsPoint(this.mP)}},MetaCanvas.prototype.fLines=function(){this._lines(arguments),this.context.fill()},MetaCanvas.prototype.sLines=function(){this._lines(arguments),this.context.stroke()},MetaCanvas.prototype.fsLines=function(){this._lines(arguments),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fsLinesM=function(){var e=this._linesM(arguments);return this.context.fill(),this.context.stroke(),e},MetaCanvas.prototype._polygon=function(e){this.context.beginPath(),this.context.moveTo(e[0].x,e[0].y);for(var t=1;null!=e[t];t++)this.context.lineTo(e[t].x,e[t].y)},MetaCanvas.prototype.fPolygon=function(e){this._polygon(e),this.context.fill()},MetaCanvas.prototype.sPolygon=function(e,t){this._polygon(e),t&&this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsPolygon=function(e,t){this._polygon(e),t&&this.context.closePath(),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.fill()},MetaCanvas.prototype.sEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.stroke()},MetaCanvas.prototype.fsEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.fill(),this.context.stroke()},MetaCanvas.prototype._eqTriangle=function(e,t,n,r){this.context.beginPath(),n=n||0,this.context.moveTo(r*Math.cos(n)+e,r*Math.sin(n)+t),this.context.lineTo(r*Math.cos(n+2.0944)+e,r*Math.sin(n+2.0944)+t),this.context.lineTo(r*Math.cos(n+4.1888)+e,r*Math.sin(n+4.1888)+t),this.context.lineTo(r*Math.cos(n)+e,r*Math.sin(n)+t)},MetaCanvas.prototype.fRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.fillRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.sRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.strokeRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.fsRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.fillRect(e,t,n,r),this.context.strokeRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.fCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.fill(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.sCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.fsCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke(),this.context.fill(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.lineM=function(e,t,n,r,o=4){return this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(n,r),this.context.stroke(),this._distToSegmentSquared(e,t,n,r)<o*o},MetaCanvas.prototype._distToSegmentSquared=function(e,t,n,r){var o=Math.pow(e-n,2)+Math.pow(t-r,2);if(0===o)return Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2);var i=((this.mX-e)*(n-e)+(this.mY-t)*(r-t))/o;if(i<=0)return Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2);if(i>=1)return Math.pow(n-this.mX,2)+Math.pow(r-this.mY,2);var s=e+i*(n-e),a=t+i*(r-t);return Math.pow(s-this.mX,2)+Math.pow(a-this.mY,2)},MetaCanvas.prototype.bezierM=function(e,t,n,r,o,i,s,a,l){return l=null==l?2:l,this.context.beginPath(),this.context.moveTo(e,t),this.context.bezierCurveTo(n,r,o,i,s,a),this.context.stroke(),!(this.mX<Math.min(e,s,n,o)-l||this.mX>Math.max(e,s,n,o)+l||this.mY<Math.min(t,a,r,i)-l||this.mY>Math.max(t,a,r,i)+l)&&distanceToBezierCurve(e,t,n,r,o,i,s,a,this.mP,!1)<l},MetaCanvas.prototype.drawImage=function(e){if(null!=e)switch(arguments.length){case 1:this.context.drawImage(e);break;case 3:this.context.drawImage(e,arguments[1],arguments[2]);break;case 5:this.context.drawImage(e,arguments[1],arguments[2],arguments[3],arguments[4]);break;case 9:this.context.drawImage(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}},MetaCanvas.prototype.fitImage=function(e,t,n){if(null!=e&&null!=t){null==n&&(n=0);var r,o=e.width/e.height,i=t.width/t.height,s=o/i;switch(n){case 0:r=o>=i;break;case 1:r=o<i;break;case 2:return void this.context.drawImage(e,t.x+.5*t.width-.5*e.width,t.y+.5*t.height-.5*e.height)}r?this.context.drawImage(e,.5*(e.width-e.width/s),0,e.width/s,e.height,t.x,t.y,t.width,t.height):this.context.drawImage(e,0,.5*(e.height-e.height*s),e.width,e.height*s,t.x,t.y,t.width,t.height)}},MetaCanvas.prototype.fill=function(e){if("number"==typeof e)return arguments.length>3?void(this.context.fillStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.fillStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.fillStyle=e},MetaCanvas.prototype.stroke=function(e,t){if("number"==typeof e)return arguments.length>3?void(this.context.strokeStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.strokeStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.strokeStyle=e,t&&(this.context.lineWidth=t)},MetaCanvas.prototype.setLW=function(e){this.context.lineWidth=e},MetaCanvas.prototype.clipCircle=function(e,t,n){this.context.save(),this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi,!1),this.context.closePath(),this.context.clip()},MetaCanvas.prototype.clipRect=function(e,t,n,r){this.context.save(),this.context.beginPath(),"Rec"==e.type&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.moveTo(e,t),this.context.lineTo(e+n,t),this.context.lineTo(e+n,t+r),this.context.lineTo(e,t+r),this.context.clip()},MetaCanvas.prototype.save=function(){this.context.save()},MetaCanvas.prototype.clip=function(){this.context.clip()},MetaCanvas.prototype.restore=function(){this.context.restore()},MetaCanvas.prototype.fText=function(e,t,n){this.context.fillText(e,t,n)},MetaCanvas.prototype.sText=function(e,t,n){this.context.strokeText(e,t,n)},MetaCanvas.prototype.fsText=function(e,t,n){this.context.strokeText(e,t,n),this.context.fillText(e,t,n)},MetaCanvas.prototype.fTextW=function(e,t,n){return this.context.fillText(e,t,n),this.context.measureText(e).width},MetaCanvas.prototype.fsTextW=function(e,t,n){return this.context.strokeText(e,t,n),this.context.fillText(e,t,n),this.context.measureText(e).width},MetaCanvas.prototype.fTextRotated=function(e,t,n,r){this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.fillText(e,0,0),this.context.restore()},MetaCanvas.prototype.fsTextRotated=function(e,t,n,r){this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.strokeText(e,0,0),this.context.fillText(e,0,0),this.context.restore()},MetaCanvas.prototype.fTextArc=function(e,t,n,r,o,i){if(null!=e&&""!==e){var s,a,l,u=Math.sqrt(Math.pow(t-r,2)+Math.pow(n-o,2)),h=Math.atan2(n-o,t-r);i&&(h-=.5*this.getTextW(e)/u);var c=e.split("");for(s=0;null!=c[s];s++)a=r+u*Math.cos(h),l=o+u*Math.sin(h),this.fTextRotated(c[s],a,l,h+HalfPi),h+=this.getTextW(c[s])/u}},MetaCanvas.prototype.fTextM=function(e,t,n,r){return r=Number(r||this.fontSize),this.context.fillText(e,t,n),this.mY>n&&this.mY<n+r&&this.mX>t&&this.mX<t+this.context.measureText(e).width},MetaCanvas.prototype.fsTextM=function(e,t,n,r){return r=Number(r||this.fontSize),this.context.strokeText(e,t,n),this.context.fillText(e,t,n),this.mY>n&&this.mY<n+r&&this.mX>t&&this.mX<t+this.context.measureText(e).width},MetaCanvas.prototype.fTextRotatedM=function(e,t,n,r,o){o=o||12,this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.fillText(e,0,0),this.context.restore();var i=this.mX-t,s=this.mY-n,a=Math.sqrt(i*i+s*s),l=Math.atan2(s,i)-r,u=t+a*Math.cos(l),h=n+a*Math.sin(l);return h>n&&h<n+o&&u>t&&u<t+this.context.measureText(e).width},MetaCanvas.prototype.setTextDefaults=function(e,t,n,r,o,i){this.fontColor=ifDef(e,this.fontColor),this.fontSize=ifDef(String(t),this.fontSize),this.fontName=ifDef(n,this.fontName),this.fontAlign=ifDef(r,this.fontAlign),this.fontBaseline=ifDef(o,this.fontBaseline),this.fontStyle=ifDef(i,this.fontStyle),this.setText()},MetaCanvas.prototype.setText=function(e,t,n,r,o,i){var s=ifDef(e,this.fontColor),a=ifDef(String(t),this.fontSize),l=ifDef(n,this.fontName),u=ifDef(r,this.fontAlign),h=ifDef(o,this.fontBaseline),c=ifDef(i,this.fontStyle);""!==c&&(c+=" "),this.context.fillStyle=s,this.context.font=c+a+"px "+l,this.context.textAlign=u,this.context.textBaseline=h},MetaCanvas.prototype.fTextWidth=function(e,t,n,r,o=12){let i=this._textWidthSectionsInfo(e,r),s=i.sections,a=0;return e=i.newText,s.forEach((r=>{this.context.fillText(e.substr(a,r-a),t,n),a=r,n+=o})),this.context.fillText(e.substr(a),t,n),i.nLines},MetaCanvas.prototype.getFontFamily=function(){return this.fontName},MetaCanvas.prototype.setFontFamily=function(e){this.setText(void 0,void 0,e)},MetaCanvas.prototype.getTextW=function(e){return this.context.measureText(e).width},MetaCanvas.prototype.nLines=function(e,t){return this._textWidthSectionsInfo(e,t).nLines},MetaCanvas.prototype._textWidthSectionsInfo=function(e,t){if(this["sections_"+t+"_"+e])return this["sections_"+t+"_"+e];let n=e.replace(/[\s\n]+/g," ").trim(),r=n.split(" ").filter((e=>""!=e)),o=0,i=[],s=1,a="",l=0;return r.forEach((e=>{this.context.measureText(a+e).width>t&&(s++,o+=a.length+1,i.push(o),l=Math.max(this.context.measureText(a).width,l),a=""),a+=(""==a?"":" ")+e})),l=Math.max(this.context.measureText(a).width,l),this["sections_"+t+"_"+e]={sections:i,nLines:s,maxWidth:l,newText:n},this["sections_"+t+"_"+e]},MetaCanvas.prototype.getPixelColor=function(e,t){var n=this.context.getImageData(e,t,1,1).data;return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},MetaCanvas.prototype.getPixelColorRGBA=function(e,t){return Array.prototype.slice.call(this.context.getImageData(e,t,1,1).data)},MetaCanvas.prototype.captureCanvas=function(e,t,n,r){var o=new Image;if(null==e)return o.src=this.canvas.toDataURL(),o;var i=document.createElement("canvas");return i.width=n,i.height=r,i.getContext("2d").drawImage(this.canvas,e,t,n,r,0,0,n,r),o.src=i.toDataURL(),o},MetaCanvas.prototype.setCursor=function(e="default"){this.canvas.style.cursor=e},MetaCanvas.prototype.pointer=function(){this.canvas.style.cursor="pointer"},MetaCanvas.prototype.getFrame=function(){return new Rec(0,0,this.W,this.H)},MetaCanvas.prototype._linesInFrame=function(e,t,n){var r,o=Math.min(t.length,n.length);for(this.context.beginPath(),this.context.moveTo(e.projectX(t[0]),e.projectY(n[0])),r=1;r<o;r++)this.context.lineTo(e.projectX(t[r]),e.projectY(n[r]))},MetaCanvas.prototype.sLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.stroke()},MetaCanvas.prototype.fLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.fill()},MetaCanvas.prototype.fsLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.drawSmoothPolygon=function(e,t,n=30){var r,o;if(e.length<2)return null;if(this.context.beginPath(),2==e.length){var i=Math.atan2(e[1].y-e[0].y,e[1].x-e[0].x)-.5*Math.PI,s=n*Math.cos(i),a=n*Math.sin(i);return this.context.moveTo(e[0].x,e[0].y),this.context.bezierCurveTo(e[0].x+s,e[0].y+a,e[1].x+s,e[1].y+a,e[1].x,e[1].y),this.context.bezierCurveTo(e[1].x-s,e[1].y-a,e[0].x-s,e[0].y-a,e[0].x,e[0].y),void this.context.stroke()}var l,u=e.length,h=e[u-1],c=e[0],f=e[1],p=(r=getSoftenControlPoints(h,c,f,n))[1];this.context.moveTo(c.x,c.y),h=c;var g=u+Number(t);for(o=1;o<g;o++)c=e[o%u],f=e[(o+1)%u],l=(r=getSoftenControlPoints(h,c,f,n))[0],this.context.bezierCurveTo(p.x,p.y,l.x,l.y,c.x,c.y),p=r[1],h=c;this.context.stroke()},MetaCanvas.prototype.drawEllipse=function(e,t,n,r){var o=.5522848,i=n*o,s=r*o,a=e+n,l=t+r;this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,a,t-s,a,t),this.context.bezierCurveTo(a,t+s,e+i,l,e,l),this.context.bezierCurveTo(e-i,l,e-n,t+s,e-n,t),this.context.moveTo(e-n,t)},MetaCanvas.prototype.drawPolygon=function(e,t,n,r){var o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+e[0].x,r+e[0].y),o=1;null!=e[o];o++)this.context.lineTo(n+e[o].x,r+e[o].y);t&&this.context.lineTo(n+e[0].x,r+e[0].y),this.context.stroke()},MetaCanvas.prototype.drawPolygonWithControlPoints=function(e,t,n,r){var o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+e[0].x,r+e[0].y),o=1;null!=e[o];o++)this.context.bezierCurveTo(n+t[2*(o-1)].x,r+t[2*(o-1)].y,n+t[2*o-1].x,r+t[2*o-1].y,n+e[o].x,r+e[o].y);this.context.stroke()},MetaCanvas.prototype.drawBezierPolygon=function(e,t,n){var r;t=t||0,n=n||0;var o,i=Math.floor((e.length-1)/3);for(this.context.moveTo(t+e[0].x,n+e[0].y),o=0;o<i;o++)r=3*o+1,this.context.bezierCurveTo(t+e[r].x,n+e[r].y,t+e[r+1].x,n+e[r+1].y,t+e[r+2].x,n+e[r+2].y)},MetaCanvas.prototype.drawMultiStyleCurve=function(e,t,n,r,o,i,s){var a,l,u,h,c;this.context.save(),this.context.lineJoin=this.context.lineCap="round";var f=new I(r,s),p=new I(n,i);for(a=0;a<e.length-1;a++)l=a/(e.length-2),h=f.getInterpolatedValue(l),c=p.getInterpolatedValue(l),u=interpolateColors(t,o,l),u=addAlpha(u,c),this.context.beginPath(),this.context.moveTo(e[a].x,e[a].y),this.context.lineTo(e[a+1].x,e[a+1].y),this.stroke(u,h),this.context.stroke();this.context.restore()},MetaCanvas.prototype.drawRoundRect=function(e,t,n,r,o){o=o||0;var i=t+r;this.context.moveTo(e+o,t),this.context.lineTo(e+n-o,t),this.context.quadraticCurveTo(e+n,t,e+n,t+o),this.context.lineTo(e+n,t+r-o),this.context.quadraticCurveTo(e+n,i,e+n-o,i),this.context.lineTo(e+o,i),this.context.quadraticCurveTo(e,i,e,i-o),this.context.lineTo(e,t+o),this.context.quadraticCurveTo(e,t,e+o,t)},MetaCanvas.prototype.drawTriangleFromBase=function(e,t,n,r,o){this.context.moveTo(e+.5*n*Math.cos(o+.5*Math.PI),t+.5*n*Math.sin(o+.5*Math.PI)),this.context.lineTo(e+.5*n*Math.cos(o-.5*Math.PI),t+.5*n*Math.sin(o-.5*Math.PI)),this.context.lineTo(e+r*Math.cos(o),t+r*Math.sin(o)),this.context.lineTo(e+.5*n*Math.cos(o+.5*Math.PI),t+.5*n*Math.sin(o+.5*Math.PI))},MetaCanvas.prototype.applyTransformationFunctions=function(e,t,n){if(null==this._fRect&&(this._line=this.line,this._sLines=function(){this.__lines(arguments),this.context.stroke()},this._fCircle=this.fCircle,this._sCircle=this.sCircle,this._fCircleM=this.fCircleM,this._sCircleM=this.sCircleM,this._fRect=this.fRect,this._sRect=this.sRect,this._fRectM=this.fRectM,this._sRectM=this.sRectM,this.__lines=this._lines,this.__polygon=this._polygon,this._fText=this.fText,this._fTextM=this.fTextM,this._sText=this.sText,this._fsText=this.fsText,this._fsTextM=this.fsTextM,this._clipRect=this.clipRect,this._drawImage=this.drawImage),null==e&&null==t)return this.line=this._line,this.sLines=this._sLines,this.fCircle=this._fCircle,this.sCircle=this._sCircle,this.fCircleM=this._fCircleM,this.sCircleM=this._sCircleM,this.fRect=this._fRect,this.sRect=this._sRect,this.fRectM=this._fRectM,this.sRectM=this._sRectM,this._lines=this.__lines,this._polygon=this.__polygon,this.fText=this._fText,this.fTextM=this._fTextM,this.sText=this._sText,this.fsText=this._fsText,this.fsTextM=this._fsTextM,this.clipRect=this._clipRect,void(this.drawImage=this._drawImage);this.fX=e,this.fY=t,this.sX=function(e){return this.fX(e+.5)-this.fX(e-.5)},this.sY=function(e){return this.fY(e+.5)-this.fY(e-.5)},null==e&&(this.fX=function(e){return e}),null==t&&(this.fY=function(e){return e}),this.line=function(e,t,n,r){this._line(this.fX(e),this.fY(t),this.fX(n),this.fY(r))},this.fRect=function(e,t,n,r){this._fRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.sRect=function(e,t,n,r){this._sRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.fRectM=function(e,t,n,r){return this._fRectM(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.sRectM=function(e,t,n,r){return this._sRectM(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.fCircle=function(e,t,n){this._fCircle(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.sCircle=function(e,t,n){this._sCircle(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.fCircleM=function(e,t,n){return this._fCircleM(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.sCircleM=function(e,t,n){return this._sCircleM(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this._lines=function(){if(null!=arguments){var e=arguments[0];this.context.beginPath(),this.context.moveTo(this.fX(e[0]),this.fY(e[1]));for(var t=2;null!=e[t+1];t+=2)this.context.lineTo(this.fX(e[t]),this.fY(e[t+1]))}},this._polygon=function(e){this.context.beginPath(),this.context.moveTo(this.fX(e[0].x),this.fY(e[0].y));for(var t=1;null!=e[t];t++)this.context.lineTo(this.fX(e[t].x),this.fY(e[t].y))},this.fText=function(e,t,n){this._fText(e,this.fX(t),this.fY(n))},this.fTextM=function(e,t,n){this._fTextM(e,this.fX(t),this.fY(n))},this.sText=function(e,t,n){this._sText(e,this.fX(t),this.fY(n))},this.fsText=function(e,t,n){this._fsText(e,this.fX(t),this.fY(n))},this.fsTextM=function(e,t,n){this._fsTextM(e,this.fX(t),this.fY(n))},this.clipRect=function(e,t,n,r){this._clipRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.drawImage=function(e,t,n,r,o){null==r&&this._drawImage(e,this.fX(t),this.fY(n)),this._drawImage(e,this.fX(t),this.fY(n),this.fX(t+r)-this.fX(t),this.fY(n+o)-this.fY(n))},this._fLines=function(){this.__lines(arguments),this.context.fill()}},MetaCanvas.prototype.resetTransformation=function(){this.applyTransformationFunctions(null,null)},MetaCanvas.prototype.mapRegion=function(e,t){this.applyTransformationFunctions((function(n){return(n-t.x)*e.width/t.width+e.x}),(function(n){return(n-t.y)*e.height/t.height+e.y})),this.invfX=function(n){return(n-e.x)*t.width/e.width+t.x},this.invfY=function(n){return(n-e.y)*t.height/e.height+t.y}},MetaCanvas.prototype.mapCanvas=function(e){this.applyTransformationFunctions((function(t){return(t-e.x)*this.W/e.width}),(function(t){return(t-e.y)*this.H/e.height})),this.invfX=function(t){return t*e.width/this.W+e.x},this.invfY=function(t){return t*e.height/this.H+e.y}},Forces.prototype.forcesForNetwork=function(e,t,n,r,o){var i,s;t=t||0,n=n||new P(0,0),r=null==r?0:r,o=null!=o&&o,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this.nodes=new ndL;var a,l,u=e.nodes.length,h=e.relations;if(this.previousNetwork){t=0;for(var c=1e5,f=-1e5,p=1e5,g=-1e5,d=0;d<this.previousNetwork.nodes.length;d++)c=Math.min(c,this.previousNetwork.nodes[d].x),f=Math.max(f,this.previousNetwork.nodes[d].x),p=Math.min(p,this.previousNetwork.nodes[d].y),g=Math.max(g,this.previousNetwork.nodes[d].y);var m=f-c,y=g-p;for(d=0;d<u;d++){var v=e.nodes[d];if(i=this.previousNetwork.nodes.get(v.id))v.x=i.x,v.y=i.y;else{for(a=0;a<v.nodes.length;a++)if(i=this.previousNetwork.nodes.get(v.nodes[a].id)){v.x=i.x+.05*m*(Math.random()-.5),v.y=i.y+.05*y*(Math.random()-.5);break}null==i&&(v.x=c+m*Math.random(),v.y=p+y*Math.random())}}}for(e.nodes.forEach(((e,t)=>{null==e.x&&(e.x||(e.x=100*(Math.random()-.5),e.y=100*(Math.random()-.5)),e.vx=0,e.vy=0,e.ax=0,e.ay=0)})),d=0;d<u;d++)0===t?this.addNode(e.nodes[d],new P(e.nodes[d].x,e.nodes[d].y)):(l=Math.random()*TwoPi,this.addNode(e.nodes[d],new P(n.x+t*Math.cos(l),n.y+t*Math.sin(l))));for(d=0;d<u-1;d++)for(i=e.nodes[d],a=d+1;a<u;a++)if(s=e.nodes[a],h.nodesAreConnected(i,s)){switch(r){case 0:this.equilibriumDistances.push(this.dEqSprings);break;case 1:this.equilibriumDistances.push((1.1-h.getFirstRelationByIds(i.id,s.id,!1).weight)*this.dEqSprings);break;case 2:this.equilibriumDistances.push(Math.sqrt(Math.min(i.nodes.length,s.nodes.length))*this.dEqSprings*.1)}this.addForce(i,s,"Spring"),o&&this.addForce(i,s,"Repulsor",.5*this.dEqRepulsors)}else this.addForce(i,s,"Repulsor",this.dEqRepulsors);this.previousNetwork=e},Forces.prototype.addNode=function(e,t,n){t=null==t?new P(200*Math.random()-100,200*Math.random()-100):t,n=null==n?new P(0,0):n,this.nodes.addNode(e),e.x=t.x,e.y=t.y,e.vx=n.x,e.vy=n.y,e.ax=0,e.ay=0,e.r=1},Forces.prototype.addForce=function(e,t,n,r){this.from.addNode(e),this.to.addNode(t),this.forcesList.push(e.id+"*"+t.id+"*"+n),this.forcesTypeList.push(n),null!=r&&this.equilibriumDistances.push(r)},Forces.prototype.calculate=function(){var e,t,n,r,o,i,s,a,l;for(e=0;null!=this.forcesList[e];e++)if(t=this.from[e],n=this.to[e],r=this.forcesTypeList[e],i=n.x-t.x,s=n.y-t.y,a=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),l=this.equilibriumDistances[e],!("Repulsor"==r&&a>l||"Attractor"==r&&a<l))switch(r){case"Spring":case"Repulsor":case"Attractor":o=this.k*(a-l)/a,t.ax+=o*i,t.ay+=o*s,n.ax-=o*i,n.ay-=o*s;break;case"DirectedSpring":o=this.k*(a-l)/a,n.ax-=o*i,n.ay-=o*s;break;case"DirectedRepulsor":a<l&&(o=this.k*(a-l)/a,n.ax-=o*i,n.ay-=o*s)}},Forces.prototype.applyForces=function(){for(var e,t=0;t<this.nodes.length;t++)null!=(e=this.nodes[t]).fixed_x&&(e.x=.95*e.x+.05*e.fixed_x,e.ax=0,e.vx=0),null!=e.fixed_y&&(e.y=.95*e.y+.05*e.fixed_y,e.ay=0,e.vy=0),null!=e.fixed_x&&null!=e.fixed_y||(e.vx+=e.ax,e.vy+=e.ay,e.vx*=this.friction,e.vy*=this.friction,e.x+=e.vx,e.y+=e.vy,e.ax=0,e.ay=0)},Forces.prototype.calculateAndApplyForces=function(e){this.calculate(),this.applyForces()},Forces.prototype.iterate=function(e){for(var t=0;t<e;t++)this.calculate(),this.applyForces()},Forces.prototype.attractionToPoint=function(e,t,n){var r,o,i,s,a;t=null==t?1:t;for(var l=0;null!=this.nodes[l];l++)r=this.nodes[l],i=e.x-r.x,s=e.y-r.y,a=Math.pow(i,2)+Math.pow(s,2),o=null!=n?Math.min(t/a,n):t/a,r.ax+=o*i,r.ay+=o*s},Forces.prototype.avoidOverlapping=function(e=0){var t,n,r,o,i,s,a,l,u,h,c,f,p,g=.5*e,d=this.nodes.length;for(t=0;null!=this.nodes[t+1];t++){o=(n=this.nodes[(t+this._i0)%d]).x-.5*n.width-g,s=n.x+.5*n.width+g,i=n.y-.5*n.height-g,a=n.y+.5*n.height+g;for(var m=t+1;null!=this.nodes[m];m++)l=(r=this.nodes[(m+this._i0+t)%d]).x-.5*r.width-g,h=r.x+.5*r.width+g,u=r.y-.5*r.height-g,c=r.y+.5*r.height+g,(o>l&&o<h||s>l&&s<h)&&(i>u&&i<c||a>u&&a<c)&&(f=r.x-n.x,p=r.y-n.y,Math.abs(f)>Math.abs(p)?f>0?(n.x-=.5*(s-l),r.x+=.5*(s-l)):(n.x+=.5*(h-o),r.x-=.5*(h-o)):p>0?(n.y-=.5*(a-u),r.y+=.5*(a-u)):(n.y+=.5*(c-i),r.y-=.5*(c-i)))}this._i0++},Forces.prototype.avoidOverlappingRadial=function(e,t){var n,r,o;e=e||0,t=t||1;var i,s,a,l,u,h=this.nodes.length,c=2*e;for(n=0;null!=this.nodes[n+1];n++){r=this.nodes[(n+this._i0)%h];for(var f=n+1;null!=this.nodes[f];f++)i=(o=this.nodes[(f+this._i0+n)%h]).x-r.x,s=o.y-r.y,(a=Math.pow(i,2)+Math.pow(s,2))<(l=Math.pow(r.r+o.r+c,2))&&(u=.5*((l=Math.sqrt(l))-(a=Math.sqrt(a)))/a,r.x-=t*u*i,r.y-=t*u*s,o.x+=t*u*i,o.y+=t*u*s)}this._i0++},Forces.prototype.deactivateForcesFromNode=function(e){e.vx=e.vy=e.ax=e.ay=0},Forces.prototype._resetAccelerations=function(){for(var e,t=0;null!=this.nodes[t];t++)(e=this.nodes[t]).ax=0,e.ay=0},Engine3D.prototype.setBasis=function(e){this._basis=e.clone(),this._basisBase=e.clone(),this._provisionalBase=e.clone()},Engine3D.prototype.setAngles=function(e){this._angles=e.clone(),this._freeRotation=!1,this._basis=this.basis3DRotation(this._basisBase,this._angles)},Engine3D.prototype.applyRotation=function(e){this._freeRotation||(this._freeRotation=!0,this.updateAngles(),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()),this._basis[0]=this.point3DRotation(this._provisionalBase[0],new P3D(-e.y,e.x,0)),this._basis[1]=this.point3DRotation(this._provisionalBase[1],new P3D(-e.y,e.x,0)),this._basis[2]=this.point3DRotation(this._provisionalBase[2],new P3D(-e.y,e.x,0)),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()},Engine3D.prototype.projectPoint3D_complete=function(e){return new P3D(1*(this._basis[0].x*e.x+this._basis[1].x*e.y+this._basis[2].x*e.z),1*(this._basis[0].y*e.x+this._basis[1].y*e.y+this._basis[2].y*e.z),1*(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z))},Engine3D.prototype.projectPoint3D=function(e){var t=this.lens/(this.lens+(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z));return new P3D((this._basis[0].x*e.x+this._basis[1].x*e.y+this._basis[2].x*e.z)*t,(this._basis[0].y*e.x+this._basis[1].y*e.y+this._basis[2].y*e.z)*t,t)},Engine3D.prototype.projectCoordinates=function(e,t,n){var r=this.lens/(this.lens+(this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n));return new P3D((this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n)*r,(this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n)*r,r)},Engine3D.prototype.scale=function(e){return this.lens/(this.lens+(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z))},Engine3D.prototype.sortedIndexesByPointsScale=function(e){var t,n=[];for(t=0;null!=e[t];t++)n[t]=[e[t],t];n=n.sort(this._sortingCriteria.bind(this));var r=new nL;for(t=0;null!=e[t];t++)r[t]=n[t][1];return r},Engine3D.prototype.sortListByPointsScale=function(e,t){var n,r=[];for(n=0;null!=e[n];n++)r[n]=[t[n],e[n]];r=r.sort(this._sortingCriteria.bind(this));var o=instanceSameType(e);for(o.name=e,n=0;null!=e[n];n++)o[n]=r[n][1];return o},Engine3D.prototype._sortingCriteria=function(e,t){var n=e[0],r=t[0];return this._basis[0].z*n.x+this._basis[1].z*n.y+this._basis[2].z*n.z<this._basis[0].z*r.x+this._basis[1].z*r.y+this._basis[2].z*r.z?1:-1},Engine3D.prototype.updateAngles=function(){this._angles=this.getEulerAngles()},Engine3D.prototype.getEulerAngles=function(){return new P3D(Math.atan2(-this._basis[1].z,this._basis[2].z),Math.asin(this._basis[0].z),Math.atan2(-this._basis[0].y,this._basis[0].x))},Engine3D.prototype.basis3DRotation=function(e,t){var n=Math.cos(t.x),r=Math.sin(t.x),o=Math.cos(t.y),i=Math.sin(t.y),s=Math.cos(t.z),a=Math.sin(t.z);return new Pol3D(new P3D(e[0].x*s*o+e[0].y*(s*r*i+a*n)+e[0].z*(a*r-s*n*i),-e[0].x*a*o+e[0].y*(s*n-a*r*i)+e[0].z*(a*n*i+s*r),e[0].x*i-e[0].y*r*o+e[0].z*o*n),new P3D(e[1].x*s*o+e[1].y*(s*r*i+a*n)+e[1].z*(a*r-s*n*i),-e[1].x*a*o+e[1].y*(s*n-a*r*i)+e[1].z*(a*n*i+s*r),e[1].x*i-e[1].y*r*o+e[1].z*o*n),new P3D(e[2].x*s*o+e[2].y*(s*r*i+a*n)+e[2].z*(a*r-s*n*i),-e[2].x*a*o+e[2].y*(s*n-a*r*i)+e[2].z*(a*n*i+s*r),e[2].x*i-e[2].y*r*o+e[2].z*o*n))},Engine3D.prototype.point3DRotation=function(e,t){var n=Math.cos(t.x),r=Math.sin(t.x),o=Math.cos(t.y),i=Math.sin(t.y),s=Math.cos(t.z),a=Math.sin(t.z);return new P3D(e.x*s*o+e.y*(s*r*i+a*n)+e.z*(a*r-s*n*i),-e.x*a*o+e.y*(s*n-a*r*i)+e.z*(a*n*i+s*r),e.x*i-e.y*r*o+e.z*o*n)},Engine3D.prototype.line3DCoordinates=function(e,t,n,r,o,i){var s=new Pol,a=this.lens/(this.lens+(this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n)),l=this.lens/(this.lens+(this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i));if(a>0||l>0){if(a>0&&l>0)return s.push(new P((this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n+this._dx)*a,(this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n)*a)),s.push(new P((this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i+this._dx)*l,(this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i)*l)),s;var u=new P3D(this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n,this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n,this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n),h=new P3D(this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i,this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i,this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i),c=(-this.lens+this._cuttingPlane-u.z)/(h.z-u.z),f=new P3D(u.x+c*(h.x-u.x),u.y+c*(h.y-u.y),-this.lens+this._cuttingPlane),p=this.lens/(this.lens+f.z);return a>0?(s.push(new P((u.x+this._dx)*a,u.y*a)),s.push(new P((f.x+this._dx)*p,f.y*p))):(s.push(new P((f.x+this._dx)*p,f.y*p)),s.push(new P((h.x+this._dx)*l,h.y*l))),s}return null},Engine3D.prototype.line3D=function(e,t){return this.line3DCoordinates(e.x,e.y,e.z,t.x,t.y,t.z)},Engine3D.prototype.quadrilater=function(e,t,n,r){var o=new Pol3D,i=this.line3D(e,t),s=this.line3D(t,n),a=this.line3D(n,r),l=this.line3D(r,e);return null!=i&&((null==l||i[0].x!=l[1].x&&i[0].y!=l[1].y)&&o.push(i[0]),o.push(i[1])),null!=s&&((null==i||s[0].x!=i[1].x&&s[0].y!=i[1].y)&&o.push(s[0]),o.push(s[1])),null!=a&&((null==s||a[0].x!=s[1].x&&a[0].y!=s[1].y)&&o.push(a[0]),o.push(a[1])),null!=l&&((null==a||l[0].x!=a[1].x&&l[0].y!=a[1].y)&&o.push(l[0]),o.push(l[1])),o};var interpolateColors=function(e,t,n,r){var o=interpolateColorsRGB(colorStringToRGB(e),colorStringToRGB(t),n,r);return"rgb("+Math.floor(o[0])+","+Math.floor(o[1])+","+Math.floor(o[2])+")"},interpolateColorsRGB=function(e,t,n,r){var o=1-n;return r?[Math.floor(Math.sqrt(o*e[0]*e[0]+n*t[0]*t[0])),Math.floor(Math.sqrt(o*e[1]*e[1]+n*t[1]*t[1])),Math.floor(Math.sqrt(o*e[2]*e[2]+n*t[2]*t[2]))]:[Math.floor(o*e[0]+n*t[0]),Math.floor(o*e[1]+n*t[1]),Math.floor(o*e[2]+n*t[2])]},distanceColorsRGB=function(e,t){var n=Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])+Math.abs(e[2]-t[2]);return Number((n/765).toFixed(4))},addAlpha=function(e,t){t=null==t?1:t;var n=colorStringToRGB(e);return null==n?"black":"rgba("+n[0]+","+n[1]+","+n[2]+","+t+")"},invertColor=function(e){var t=colorStringToRGB(e);return t=invertColorRGB(t[0],t[1],t[2]),RGBtoHEX(t[0],t[1],t[2])},stringToColor=function(e){if(null!=e){if("null"==e||"undefined"==e)return"#202020";for(var t=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f","#d62720","#1f77b0","#2ca02a","#ff7f08","#9467ba","#bcbd20","#8c564f","#17bece","#dd4418","#206011","#e377c9","#3330fe","#dd8818","#ff220a","#1f66a9","#8c453f","#2ba01f","#dfc508","#945608","#ff008f","#e37708"],n=0,r=0;r<e.length;r++)n+=e.charCodeAt(r)*(r*r+1);return t[Math.floor(getRandomWithSeed(n)*t.length)]}},HEXtoRGB=function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]},RGBtoHEX=function(e,t,n){return"#"+toHex(Math.floor(e))+toHex(Math.floor(t))+toHex(Math.floor(n))},RGBArrayToString=function(e){return"rgb("+e[0]+","+e[1]+","+e[2]+")"},colorStringToHEX=function(e){var t=colorStringToRGB(e);return RGBtoHEX(t[0],t[1],t[2])},numberToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},uinttoRGB=function(e){return new Array(e>>16,(e>>8)-(e>>16<<8),e-(e>>8<<8))},uinttoHEX=function(e){var t=uinttoRGB(e);return RGBToHEX(t[0],t[1],t[2])},RGBtouint=function(e,t,n){return Number(e)<<16|Number(t)<<8|Number(n)},HEXtouint=function(e){var t=HEXtoRGB(e);return RGBtouint(t[0],t[1],t[2])},grayByLevel=function(e){return"rgb("+(e=Math.floor(255*e))+","+e+","+e+")"},HEXtoHSV=function(e){var t=HEXtoRGB(e);return RGBtoHSV(t[0],t[1],t[2])},HSVtoHEX=function(e,t,n){var r=HSVtoRGB(e,t,n);return RGBtoHEX(r[0],r[1],r[2])},HSLtoHEX=function(e,t,n){var r=HSLtoRGB(e,t,n);return RGBtoHEX(r[0],r[1],r[2])},RGBtoHSV=function(e,t,n){var r,o,i,s=Math.min(Math.min(e,t),n),a=Math.max(Math.max(e,t),n);i=a/255;var l=a-s;return 0===l?new Array(0,0,e/255):0===a?(o=0,r=-1,new Array(r,o,i)):(o=l/a,r=e==a?(t-n)/l:t==a?2+(n-e)/l:4+(e-t)/l,(r*=60)<0&&(r+=360),new Array(r,o,i))},HSVtoRGB=function(e,t,n){var r,o,i,s,a,l,u,h;if(e=e||0,n=n||0,0===(t=t||0))return r=o=i=n,[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)];switch(l=n*(1-t),u=n*(1-t*(a=(e/=60)-(s=Math.floor(e)))),h=n*(1-t*(1-a)),s){case 0:r=n,o=h,i=l;break;case 1:r=u,o=n,i=l;break;case 2:r=l,o=n,i=h;break;case 3:r=l,o=u,i=n;break;case 4:r=h,o=l,i=n;break;default:r=n,o=l,i=u}return new Array(Math.floor(255*r),Math.floor(255*o),Math.floor(255*i))},HSLtoRGB=function(e,t,n){var r,o,i;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0===t)r=o=i=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=s(l,a,e/360+1/3),o=s(l,a,e/360),i=s(l,a,e/360-1/3)}return[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)]},invertColorRGB=function(e,t,n){return[255-e,255-t,255-n]},toHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},getRandomColor=function(){return"rgb("+String(Math.floor(256*Math.random()))+","+String(Math.floor(256*Math.random()))+","+String(Math.floor(256*Math.random()))+")"},colorStringToRGB=function(e,t){if(null!=e){t=null==t?1:t,"#"==(e=(e=(e=String(e)).replace(/ /g,"")).toLowerCase())[0]&&(e=e.substr(1,6));var n={beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",cyan:"00ffff",fuchsia:"ff00ff",gold:"ffd700",gray:"808080",grey:"808080",green:"008000",magenta:"ff00ff",navy:"000080",pink:"ffc0cb",salmon:"fa8072",silver:"c0c0c0",turquoise:"40e0d0",violet:"ee82ee",white:"ffffff",yellow:"ffff00"};null!=n[e]&&(e=n[e]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(e){return[parseInt(e[1])*t,parseInt(e[2])*t,parseInt(e[3])*t]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,process:function(e){return[parseInt(e[1])*t,parseInt(e[2])*t,parseInt(e[3])*t]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(e){return[parseInt(e[1],16)*t,parseInt(e[2],16)*t,parseInt(e[3],16)*t]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(e){return[parseInt(e[1]+e[1],16)*t,parseInt(e[2]+e[2],16)*t,parseInt(e[3]+e[3],16)*t]}}],o=0;o<r.length;o++){var i=r[o].re,s=r[o].process,a=i.exec(e);if(a)return s(a)}return null}},createSortedNumberList=function(e,t,n,r){if(null==e)return null;var o;Array.isArray(e)&&(e=e.length),e=Number(e),t=t||0,n=null==n?1:n;var i=new nL;for(o=0;o<e;o++)i.push(t+o*n);return null!=r&&(i.name=r),i},createNumberListWithinInterval=function(e,t,n,r){if(null==t&&(t=new I(0,1)),1==n)return createSortedNumberList(e,t.x,(t.y-t.x)/e);n=null==n?0:n;var o,i=null!=r?new _Alea("my",r,"seeds"):NumberOperators_random,s=new nL,a=t.getAmplitude(),l=Number(t.getMin());if(0===n)for(o=0;o<e;o++)s.push(l+Number(i()*a));return s},createRandomNormalDistribution=function(e,t,n){var r,o=new o;for(r=0;r<e;r++)o.push(normal(t,n));return o},createRandomBetaPERTDistribution=function(e,t,n,r,o,i){t=null==t?0:t,n=null==n?1:n,r=null==r?.5:r,o=null==o?1:o,i&&i(i);var s,a=new a;for(s=0;s<e;s++)a.push(betaPERT(t,n,r,o));return i&&randomSeedPop(),a},createRandomBimodalDistribution=function(e,t,n,r,o,i,s,a){t=null==t?0:t,n=null==n?1:n,r=null==r?.25:r,o=null==o?.75:o,i=null==i?1:i,s=null==s?.5:s,null!=a&&a(a);var l,u=new u;for(l=0;l<e;l++)random()>s?u.push(betaPERT(t,n,r,i)):u.push(betaPERT(t,n,o,i));return a&&randomSeedPop(),u},createRandomNumbers=function(e,t,n,r){n=null==n?-1:n,t=null==t?new I(0,1):t;for(var o=new nL,i=t.getAmplitude(),s=-1==n?NumberOperators_random:new _Alea("my",n,"seeds"),a=0;a<e;a++)o[a]=null==r?s()*i+t.x:r(s()*i+t.x);return o},createUniformTable=function(e,t,n,r){for(var o=new T,i=0;i<e;i++)o[i]=createListWithSameElement(t,n),r&&r[i]&&(o[i].name=r[i]);return o.downcast()},dotProduct=function(e,t){var n,r=0,o=Math.min(e.length,t.length);for(n=0;n<o;n++)r+=e[n]*t[n];return r},linearRegression=function(e,t,n){n=null==n||n>2?0:n;var r=new nL;if(null==e||null!=t&&e.length!=t.length||0===e.length)return 0===n?r:new P;null==t&&(t=e,e=createSortedNumberList(e.length,0,1));for(var o=0,i=0,s=0,a=0,l=0,u=e.length,h=0;h<u;h++)o+=e[h],i+=t[h],s+=e[h]*e[h],a+=e[h]*t[h],l+=t[h]*t[h];var c=u*s-o*o,f=0===c?0:(u*a-o*i)/c;if(2==n)return f;var p=i/u-f*o/u;if(1==n)return new P(f,p);var g=Math.pow((u*a-o*i)/Math.sqrt((u*s-o*o)*(u*l-i*i)),2);return r.push(f),r.push(p),r.push(g),r.push(u),r},distance=function(e,t,n){if(null!=e&&null!=t){var r,o=0,i=Math.min(e.length,t.length);if("cosine"==(n=(n=null==n?"euclidean":n).toLowerCase()))return 1-cosineSimilarity(e,t);if("manhattan"==n){for(r=0;r<i;r++)o+=Math.abs(e[r]-t[r]);return o}if("euclidean"!=n)throw new Error("Invalid distanceMetric.");for(r=0;r<i;r++)o+=Math.pow(e[r]-t[r],2);return Math.sqrt(o)}},cosineSimilarity=function(e,t,n,r){var o=(n=null==n?e.getNorm():n)*(r=null==r?t.getNorm():r);return 0===o?0:dotProduct(e,t)/o},covariance=function(e,t,n){if(null!=e&&null!=t){var r,o,i,s=Math.min(e.length,t.length),a=0;for(o=n&&e.infoObject?e.infoObject.average:null!=e.mean?e.mean:e.getMean(),i=n&&t.infoObject?t.infoObject.average:t.mean?t.mean:t.getMean(),r=0;r<s;r++)a+=(e[r]-o)*(t[r]-i);return a/s}},standardDeviationTwoNumberLists=function(e,t){if(null!=e&&null!=t){var n,r=0,o=Math.min(e.length,t.length);for(n=0;n<o;n++)r+=Math.pow(e[n]-t[n],2);return r/o}},numericCorrelation=function(e,t,n,r){if(null!=e&&null!=t){e?.infoObject?.standardDeviation&&(n=e.infoObject.standardDeviation),t?.infoObject?.standardDeviation&&(r=t.infoObject.standardDeviation),e?.standardDeviation&&(n=e.standardDeviation),t?.standardDeviation&&(r=t.standardDeviation),null==n&&(n=e.getStandardDeviation()),null==r&&(r=t.getStandardDeviation());var o=n*r;return 0===o?0:covariance(e,t)/o}},slidingWindowCorrelation=function(e,t,n){if(null!=e&&null!=t&&e.length==t.length){var r,o,i,s,a;(null==n||isNaN(n)||n<1)&&(n=5),n=Math.round(n);var l=e.length,u=new nL;for(r=0;r<l;r++){for(i=new nL,s=new nL,o=Math.max(0,r-n);o<=r+n;o++)o<0||o>=l||(i.push(e[o]),s.push(t[o]));a=numericCorrelation(i,s),u.push(a)}return u}},normalizeToSum=function(e,t,n){if(null!=e){t=null==t?1:t;var r,o=new nL;if(o.name=e.name,0===e.length)return o;if(0===(n=null==n?e.getSum():n))return e.clone();for(t/=n,r=0;r<e.length;r++)o[r]=t*e[r];return o}},normalizeByZScore=function(e,t,n){if(null!=e){if(0===e.length)return null;var r;t=t||e.getMean();var o=n||e.getStandardDeviation(t);0===o&&(o=1);var i=new nL;for(r=0;r<e.length;r++)i.push((e[r]-t)/o);return i.name=e.name,i}},normalizeToMax=function(e,t){if(null!=e){if(t=null==t?1:t,0===e.length)return null;var n=e.getMax();if(0===n&&0===(n=e.getMin()))return createListWithSameElement(e.length,0);for(var r=new nL,o=0;null!=e[o];o++)r.push(t*(e[o]/n));return r.name=e.name,r}},normalizeToInterval=function(e,t){if(null!=e&&null!=t&&0!==e.length){var n;t=null==t?e.getInterval():t;var r=e.getInterval(),o=r.getAmplitude();if(0===o)return ListGenerators.createListWithSameElement(e.length,t.x,e.name);var i=t.getSignedAmplitude()/o,s=new nL;for(n=0;n<e.length;n++)s.push(t.x+i*(e[n]-r.x));return s.name=e.name,s}},trimNumberList=function(e,t,n){return e.trim(t,n)},getAccumulativeSum=function(e){if(null!=e&&0!==e.length){var t=new nL;t[0]=e[0];for(var n=1;n<e.length;n++)t[n]=e[n]+t[n-1];return t}},shorten=function(e,t){if(null==e)return null;if(null==t||t>=e.length)return e;var n,r,o,i,s=e.length/t,a=new nL,l=Math.floor(s);for(a.name=e.name,r=0;r<t;r++){for(i=Math.floor(r*s),n=0,o=0;o<l;o++)n+=e[i+o];a[r]=n/l}return a},simplify=function(e,t,n){if(null!=e){t=t||0,n=n||0;var r=new nL;if(r.name=e.name,0===t){var o=Math.pow(10,n);e.forEach((function(e){r.push(Math.floor(e/o)*o)}))}return r}},segmentNumberList=function(e,t,n){if(null==e||null==t)return null;var r=0==(n=null==n?0:n)?new e:new sL;r.name="segments "+e.name;for(var o=0;o<e.length;o++){for(var i=!1,s=0;s<t.length;s++)if(e[o]<t[s]){i=!0,r[o]=0==n?s:0==s?"<"+t[s]:t[s-1]+"-"+t[s];break}i||(r[o]=0==n?t.length:">="+t[t.length-1])}return r},averageSmoother=function(e,t,n){if(null!=e){n=null==n?1:n,t=null==t?.1:t,t=Math.max(Math.min(t,.5),0),t*=.6;var r,o,i,s,a,l,u=e.length,h=e.clone(),c=e.clone();for(r=0;r<n;r++)for(i=r%2?c:h,s=r%2?h:c,o=0;o<u;o++)l=0,a=0,o-1>=0&&(a++,l+=i[o-1]*t),o+1<u&&(a++,l+=i[o+1]*t),s[o]=l+i[o]*(1-a*t);return s}},closestValue=function(e,t,n,r){if(null!=e){n=null==n||n;for(var o,i=Math.abs(e[0]-t),s=0,a=1;a<e.length;a++)if((o=Math.abs(e[a]-t))<i){if(1==r&&e[a]>t||2==r&&e[a]<t||3==r&&e[a]>=t||4==r&&e[a]<=t)continue;i=o,s=a}return n?e[s]:s}},filterNumberListByInterval=function(e,t,n,r,o,i){return null},filterNumberListByNumber=function(e,t,n,r){r=r||!1;var o,i=new nL;if(r)switch(n){case"<":for(o=0;null!=e[o];o++)e[o]<t&&i.push(o);break;case"<=":for(o=0;null!=e[o];o++)e[o]<=t&&i.push(o);break;case">":for(o=0;null!=e[o];o++)e[o]>t&&i.push(o);break;case">=":for(o=0;null!=e[o];o++)e[o]>=t&&i.push(o);break;case"==":for(o=0;null!=e[o];o++)e[o]==t&&i.push(o);break;case"!=":for(o=0;null!=e[o];o++)e[o]!=t&&i.push(o)}else switch(n){case"<":for(o=0;null!=e[o];o++)e[o]<t&&i.push(e[o]);break;case"<=":for(o=0;null!=e[o];o++)e[o]<=t&&i.push(e[o]);break;case">":for(o=0;null!=e[o];o++)e[o]>t&&i.push(e[o]);break;case">=":for(o=0;null!=e[o];o++)e[o]>=t&&i.push(e[o]);break;case"==":for(o=0;null!=e[o];o++)e[o]==t&&i.push(e[o]);break;case"!=":for(o=0;null!=e[o];o++)e[o]!=t&&i.push(e[o])}return i},frameFromTwoNumberLists=function(e,t){if(null!=e&&null!=t){var n=e.getInterval(),r=t.getInterval();return new Rec(n.x,r.x,n.getAmplitude(),r.getAmplitude())}},rangeCounts=function(e,t,n,r){if(null!=e){t=null==t?10:t;var o=1==(r=r||0)?[]:createListWithSameElement(t,0);if(null==(n=null==n?e.getInterval():n))return o;for(var i,s=n.y-n.x,a=e.length,l=new nL,u=0;u<a;u++)i=Math.min(Math.floor(t*(e[u]-n.x)/s),t-1),l[u]=i,0===r&&o[i]++;return 1==r?l:o}},simpleCompression=function(e,t){if(null==e)return null;var n;t=null==t||t;var r=new nL;if(r.name=e.name,0===e.length)return r;if(r[0]=e[0],t)for(n=1;n<e.length;n++)r[n]=e[n]-e[n-1]-1;else for(n=1;n<e.length;n++)r[n]=r[n-1]+e[n]+1;return r},regression=function(e,t,n,r){if(null==e||0==e.length)return null;if(null==t&&(t=createSortedNumberList(e.length,1)),"string"!=typeof(n=null==n?"linear":n)||"linear"!=n&&"exponential"!=n&&"logarithmic"!=n&&"power"!=n&&"polynomial"!=n)throw new Error("Invalid method in NumberListOperators.regression: "+n);r=null==r?2:r;for(var o=[],i=0;i<t.length;i++)o.push([t[i],null==e[i]?null:e[i]]);var s=_Regression(n,o,r,{precision:3}),a=new nL;for(a.name=n+" Regression Series",i=0;i<s.points.length;i++)a.push(s.points[i][1]);var l=nL.toL(s.equation);return l.name="Coefficients",[{type:"nL",name:"Y Results",description:"Y Results are the forecasted values",value:a},{type:"nL",name:"Coefficients",description:"Coefficients of the regression equation",value:l},{type:"String",name:"Equation",description:"Equation in string form",value:s.string},{type:"Number",name:"R^2",description:"R^2 value",value:s.r2},{type:"Function",name:"fnModel",description:"Function that takes input and calculates output based on model",value:s.func}]},getDecimalsInterval=function(e){if(null==e)return null;var t,n,r=new I(0,0);for(t=0;t<e.length;t++)n=decimalPlaces(e[t]),r.adjustToContain(n);return r},setDecimals=function(e,t){if(null==e)return null;var n,r;if(e.isTable){var o=instanceSameType(e);for(o.name=e.name,n=0;n<e.length;n++)"nL"==e[n].type?o.push(setDecimals(e[n],t)):o.push(e[n].clone());return o}var i=new nL;for(i.name=e.name,n=0;n<e.length;n++)r=null==e[n]?null:Number(e[n].toFixed(t)),i.push(r);return i},getDistributionHeights=function(e,t,n){if(null==e)return null;var r,o,i;t=null==t||1!=t?0:t;var s=rangeCounts(e,n=null==n?50:n,null,0),a=rangeCounts(e,n,null,1),l=new e;for(randomSeed(1),r=0;r<e.length;r++)i=s[a[r]],0==t?(o=i-1,s[a[r]]--):o=random()*i,l.push(o);return randomSeedPop(),l},kNearestNeighbours=function(e,t,n,r,o,i,s){if(null!=e&&null!=t&&0!=e.length){n=null==n?1:n,r=null==r?0:r,s=null!=s&&s;var a,l="number"==typeof t;if((o=null!=o&&o)||(e=e.transpose()),l){if(t<0||t>=e.length||Math.floor(t)!=t)throw new Error("Invalid value for second inlet.");t=e[a=t]}if(t.length!=e[0].length)throw new Error("The input nl must have the same number of values as columns of the numberTable.");var u=new e;u.push(new t),u.push(new t),u.assignNames("index,distance");for(var h=0;h<e.length;h++)l&&h==a||(u[0].push(h),u[1].push(distance(e[h],t,i)));return u=(u=u.sortRowsByList(1,!s,!0)).sliceRows(0,n-1),0==r?e.getColumns(u[0]):1==r?u[0]:u}},skewness=function(e,t){if(null!=e){var n=e.getMean();if((t=null==t?0:t)>=2)return Math.log2(n/e.getMedian());var r=e.getStandardDeviation();if(0==r)return 0;switch(t){case 0:for(var o=0,i=0;i<e.length;i++)o+=Math.pow(e[i]-n,3);return o/e.length/Math.pow(r,3);case 1:if(0==r)return 0;for(o=0,i=0;i<e.length;i++)o+=Math.pow(e[i]-n,3);var s=o/e.length/Math.pow(r,3),a=e.length;return a*a/((a-1)*(a-2))*s}}},TableToObject=function(e,t){if(e){t||(t=e.getNames());for(var n=[],r=0;r<e[0].length;r++){for(var o={},i=0;i<t.length;i++)o[t[i]]=e[i][r];n.push(o)}return{array:n}}},ArrayOfArraysToTable=function(e){if(null!==e&&isArray(e)){var t,n=e.length,r=new T;for(t=0;t<n;t++)isArray(e[t])&&r.push(L.toL(e[t]).downcast());return r.downcast()}},tableToHtml=function(e,t,n,r,o,i,s,a,l,u){if(null!=e){if(0==e.length)return"";if(!e.isTable&&(e.isList||Array.isArray(e))){var h=new T;h.push(e),e=h}n=null==n?"font-family: arial, sans-serif; border-collapse: collapse; width: 100%;":n,r=null==r?"border:1px solid rgba(200,200,200,.5); text-align: left; padding: 4px;":r,o=null==o?"background-color: #ffffff;":o,i=null==i?"background-color: #f0f0f0;":"same"==i?o:i,t=null==t?e[0].length:Math.min(t,e[0].length),a=null==a||a,u=null==u?"rgba(100,160,255,.5)":u;var c,f,p,g="string"==typeof r?'<td style="'+r+'">':"",d='<tr style="'+o+'">',m='<tr style="'+i+'">',y="";l&&(c=function(e,t,n){0==t&&(t=1);var r='<div style="background-color: #eee; width:100%; border-style: solid; border-width: 1px; border-color:#aaa; display: inline-block;">';return r+='<div style="background-color:'+n+"; width:"+Math.max(0,Math.round(100*e/t))+'%; height: 100%; font-size:14px; color:black;">',r+="&nbsp;"+e+"</div></div>"},buildInformationObjectForTable(e)),y+='<table style="'+n+'">';var v=!1;for(f=0;f<e.length;f++)if(""!=e[f].name&&null!=e[f].name){v=!0;break}if(v){for(y+=d,f=0;f<e.length;f++)r.isList&&(g='<td style="'+r[f]+'">'),y+=g+"<b>"+(""==e[f].name?"Column "+(f+1):e[f].name)+"</b></td>";y+="</tr>"}for(p=0;p<t;p++){for(y+=p%2==1?d:m,f=0;f<e.length;f++){if(s&&null!=s[f]&&null!=s[f][p]&&""!=s[f][p]?y+='<td style="'+s[f][p]+'">':(r.isList&&(g='<td style="'+r[f]+'">'),y+=g),a){var x=null==e[f][p]?"":String(e[f][p]).toLowerCase();if(0==x.indexOf("http")&&(-1!=x.indexOf(".jpg")||-1!=x.indexOf(".jpeg")||-1!=x.indexOf(".png")||-1!=x.indexOf("photo")||-1!=x.indexOf("image"))){y+='<img src="'+e[f][p]+'" width=200>';continue}}"nL"==e[f].type&&("all"==l||l&&-1!=l.indexOf(f))?u&&"cL"==u.type&&u.length==e[0].length?y+=c(e[f][p],e[f].infoObject.max,u[p]):y+=c(e[f][p],e[f].infoObject.max,u):y+=e[f][p],y+="</td>"}y+="</tr>"}return y+="</table>"}},tableToList=function(e){if(null!=e){for(var t=new L,n=0;n<e.length;n++)t=t.concat(e[n]);return t.downcast()}},createColorScaleFromColors=function(e,t){if(null==e)return null;if(1==e.length)(function(t){return e[0]});else if(2==e.length){return e.rgbs=e.getRgbArrays(),function(t){var n=1-t;return"rgb("+Math.floor(n*e.rgbs[0][0]+t*e.rgbs[1][0])+","+Math.floor(n*e.rgbs[0][1]+t*e.rgbs[1][1])+","+Math.floor(n*e.rgbs[0][2]+t*e.rgbs[1][2])+")"}}if(null==t){var n=1/(e.length-1);t=createSortedNumberList(e.length-2,n,n)}return null==e.rgbs&&(e.rgbs=e.getRgbArrays()),(t=t.slice()).unshift(0),t.push(1),function(n){var r,o,i;for(r=0;null!=t[r+1];r++)if(n<=t[r+1])return i=1-(o=(n-t[r])/(t[r+1]-t[r])),"rgb("+Math.floor(i*e.rgbs[r][0]+o*e.rgbs[r+1][0])+","+Math.floor(i*e.rgbs[r][1]+o*e.rgbs[r+1][1])+","+Math.floor(i*e.rgbs[r][2]+o*e.rgbs[r+1][2])+")"}},blackScale=function(){return"black"},grayscale=function(e){var t=interpolateColorsRGB([0,0,0],[255,255,255],e);return RGBtoHEX(t[0],t[1],t[2])},antiGrayscale=function(e){var t=interpolateColorsRGB([255,255,255],[0,0,0],e);return RGBtoHEX(t[0],t[1],t[2])},antiTemperature=function(e){return temperature(1-e)},temperature=function(e){return e<.2?interpolateColors("#000000",HSVtoHEX(234,1,1),5*e):e>.85?interpolateColors(HSVtoHEX(0,1,1),"#FFFFFF",(e-.85)/.15):HSVtoHEX(Math.round(360*(.65-(e-.2))),1,1)},lightTemperature=function(e){return temperature(.1+.9*e)},sqrtTemperature=function(e){return temperature(Math.sqrt(e))},sqrt4Temperature=function(e){return temperature(Math.pow(e,.25))},quadraticTemperature=function(e){return temperature(Math.pow(e,2))},cubicTemperature=function(e){return temperature(Math.pow(e,3))},greenToRed=function(e){var t=interpolateColorsRGB([50,255,50],[255,50,50],e);return RGBtoHEX(t[0],t[1],t[2])},greenToBlue=function(e){var t=interpolateColorsRGB([50,255,50],[50,50,255],e);return RGBtoHEX(t[0],t[1],t[2])},grayToOrange=function(e){return"rgb("+Math.floor(100+155*e)+","+Math.floor(100+10*e)+","+Math.floor(100-100*e)+")"},sqrt4GrayToOrange=function(e){return grayToOrange(Math.pow(e,.25))},blueToRed=function(e){return"rgb("+Math.floor(255*e)+",0,"+Math.floor(255*(1-e))+")"},whiteToRed=function(e){var t=Math.floor(255-255*e);return"rgb(255,"+t+","+t+")"},redToBlue=function(e){var t=interpolateColorsRGB([255,0,0],[0,0,255],e);return RGBtoHEX(t[0],t[1],t[2])},greenWhiteRed=function(e){var t=[0,0,0];return"rgb("+(t=e<.5?interpolateColorsRGB([50,255,50],[255,255,255],2*e):interpolateColorsRGB([255,255,255],[255,50,50],2*(e-.5)))[0]+","+t[1]+","+t[2]+")"},blueWhiteRed=function(e){return"rgb("+(e<.5?Math.floor(510*e):255)+","+(e<.5?Math.floor(510*e):Math.floor(510*(1-e)))+","+(e<.5?255:Math.floor(510*(1-e)))+")"},blueBlackRed=function(e){return"rgb("+(e<.5?0:Math.floor(512*(e-.5)))+",0,"+(e<.5?Math.floor(255-512*e):0)+")"},grayBlackOrange=function(e){var t=[0,0,0];return"rgb("+(t=e<.5?interpolateColorsRGB([100,100,100],[0,0,0],2*e):interpolateColorsRGB([0,0,0],[255,110,0],2*(e-.5)))[0]+","+t[1]+","+t[2]+")"},grayWhiteOrange=function(e){var t=[0,0,0];return"rgb("+(t=e<.5?interpolateColorsRGB([100,100,100],[255,255,255],2*e):interpolateColorsRGB([255,255,255],[255,110,0],2*(e-.5)))[0]+","+t[1]+","+t[2]+")"},solar=function(e){var t=interpolateColorsRGB([0,0,0],interpolateColorsRGB([255,0,0],[255,255,0],e),Math.pow(.99*e+.01,.2));return RGBtoHEX(t[0],t[1],t[2])},antiSolar=function(e){return invertColor(solar(e))},get=function(e,t){return e.get(t)},getFirstElements=function(e,t){return null==e&&(t=0,e=[null,null,null,null,null,null,null,null,null,null]),[{type:"Object",name:"first value",description:"first value",value:e[(t=null==t?0:Number(t))+0]},{type:"Object",name:"second value",description:"second value",value:e[t+1]},{type:"Object",name:"third value",description:"third value",value:e[t+2]},{type:"Object",name:"fourth value",description:"fourth value",value:e[t+3]},{type:"Object",name:"fifth value",description:"fifth value",value:e[t+4]},{type:"Object",name:"sixth value",description:"sixth value",value:e[t+5]},{type:"Object",name:"seventh value",description:"seventh value",value:e[t+6]},{type:"Object",name:"eight value",description:"eight value",value:e[t+7]},{type:"Object",name:"ninth value",description:"ninth value",value:e[t+8]},{type:"Object",name:"tenth value",description:"tenth value",value:e[t+9]}]},containSameElements=function(e,t){if(null==e||null==t)return null;var n,r=e.length;if(r==t.length){for(n=0;n<r;n++)if(e[n]!=t[n])return!1;return!0}},fractionOfSameElements=function(e,t){if(null==e||null==t)return null;var n,r=Math.max(e.length,t.length),o=0;for(n=0;n<r;n++)e[n]==t[n]&&o++;return 0==r?0:o/r},getCorrespondenceBetweenLists=function(e,t,n,r){if(null==e||null==t)return null;if(e.length!=t.length)throw new Error("The two lists must be the same length");r=null!=r&&r;var o,i=new L,s=Math.max(e.length,t.length);for(o=0;o<s;o++)e[o]==t[o]?i.push(null==n?e[o]:n):i.push(r);return i.downcast()},getConfusionMatrix=function(e,t){if(null==e||null==t)return null;if(e.length!=t.length)throw new Error("The two lists must be the same length");var n,r,o=union(e,t).getWithoutRepetitions().getSorted(),i={},s="-|-";for(n=0;n<o.length;n++)for(r=0;r<o.length;r++)i[o[n]+s+o[r]]=0;for(n=0;n<e.length;n++)i[e[n]+s+t[n]]++;var a=new T;for(a.name="Confusion Mx",n=0;n<=o.length;n++)for(0==n?(a.push(new sL),a[n].name="Predicted Class"):(a.push(new nL),a[n].name="Actual:"+o[n-1]),r=0;r<o.length;r++)0==n?a[n].push(o[r]):a[n].push(i[o[n-1]+s+o[r]]);return a},indexOf=function(e,t){if(null!=e)return e.indexOf(t)},replaceElement=function(e,t,n){if(null==e||null==t)return null;var r=new L;r.name=e.name;var o,i=e.length;for(o=0;o<i;o++)r[o]=e[o]==t?n:e[o];return r.downcast()},replaceElementAtIndex=function(e,t,n){if(null==e||null==n)return null;if("number"!=typeof(t=null==t?0:t)||t%1!=0||t<0||t>=e.length)throw new Error("Invalid index in replaceElement");var r=e.clone();return r[t]=n,r.downcast()},replaceNullsInList=function(e,t,n,r){if(null!=e&&null!=t){if(0===t&&null==n)throw new Error("when mode is 0, must provide a non-null element to replace nulls");var o,i,s,a,l,u,h=e.length,c=0,f=0,p=new L;switch(t){case 6:return n=e.getWithoutElement(null).getMode(),replaceNullsInList(e,0,n);case 3:for(o=0;o<h;o++)"number"==typeof e[o]&&(c+=e[o],f++);return replaceNullsInList(e,0,n=c/f);case 7:n=(n=e.getWithoutElement(null).getSorted()).length>1&&n.length/2==Math.floor(n.length/2)?.5*(n[n.length/2-1]+n[n.length/2]):n[Math.floor(n.length/2)];case 0:for(o=0;o<h;o++)p[o]=e[o]==r?n:e[o];break;case 1:for(o=0;o<h;o++)if(e[o]!=r){i=e[o];break}for(o=0;o<h;o++)e[o]==r?p[o]=i:p[o]=i=e[o];break;case 2:for(o=h-1;o>=0;o--)if(e[o]!=r){s=e[o];break}for(o=h-1;o>=0;o--)e[o]==r?p[o]=s:p[o]=s=e[o];break;case 4:for(l=0,o=0;o<h;o++)if(e[o]!=r){u=o,p[o]=n=e[o];break}if(n==r)return e;for(o==h&&(u=h);l<h;){for(o=l;o<u;o++)p[o]=n;for(o=u;o<h;o++){if(e[o]==r){l=o;break}p[o]=e[o]}if(o==h)l=u=h;else{for(o=l;o<h;o++)if(e[o]!=r){u=o;break}o==h&&(u=h)}l>=0&&(n=u==h?e[l-1]:.5*(e[l-1]+e[u]))}break;case 5:for(l=0,o=0;o<h;o++)if(e[o]!=r){u=o,p[o]=i=s=e[o];break}if(i==r)return e;for(o==h&&(u=h);l<h;){for(a=(s-i)/(1+u-l),o=l;o<u;o++)p[o]=i+(o-l+1)*a;for(o=u;o<h;o++){if(e[o]==r){l=o;break}p[o]=e[o]}if(o==h)l=u=h;else{for(o=l;o<h;o++)if(e[o]!=r){u=o;break}o==h&&(u=h)}l>0&&(i=e[l-1]),s=u==h?i:e[u]}}return p.name=e.name,p.downcast()}},concat=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var e,t=arguments[0].concat(arguments[1]);for(e=2;e<arguments.length;e++)t=t.concat(arguments[e]);return t},reverse=function(e){if(null!=e)return e.getReversed()},getBooleanDictionaryForList=function(e){if(null!=e){var t,n={},r=e.length;for(t=0;t<r;t++)n[e[t]]=!0;return n}},getFirstOccurrenceDictionaryForList=function(e){if(null!=e){var t,n=e.length,r={};for(t=0;t<n;t++)r[e[t]]=t;return r}},getIndexesDictionary=function(e){if(null!=e){var t,n={},r=e.length;for(t=0;t<r;t++)null==n[e[t]]&&(n[e[t]]=new nL),n[e[t]].push(t);return n}},getIndexesTable=function(e){if(null!=e){var t=new T;t[0]=new L,t[1]=new nT;var n,r,o,i={};for(o=0;o<e.length;o++)null==(n=i[r=e[o]])?(t[0].push(r),t[1].push(new nL(o)),i[r]=t[0].length-1):t[1][n].push(o);return t[0]=t[0].downcast(),t}},buildDictionaryObjectForDictionary=function(e){if(!(null==e||e.length<2||null==e[0]||null==e[1])){var t={};return e[0].forEach((function(n,r){t[n]=e[1][r]})),t}},mapWithTable=function(e,t,n,r){if(!(null==e||null==t||t.length<2)){var o=buildDictionaryObjectForDictionary(t),i=mapWithObject(e,o,n,r);return i.dictionaryObject=o,i}},mapWithObject=function(e,t,n,r){if(null!=e&&null!=t){var o,i=new L,s=e.length;for(o=0;o<s;o++)i[o]=t[e[o]];if(null!=n||r){var a=e.length;for(o=0;o<a;o++)null==i[o]&&(i[o]=r?e[o]:n)}return i.name=e.name,i.downcast()}},sortListByNumberList=function(e,t,n){return null==n&&(n=!0),null==t||0===t.length?e:e.getSortedByList(t,!n,!1,!0)},getRankingsList=function(e,t,n,r){if(null==e)return null;t=null==t||t;var o=createSortedNumberList(e.length);o=o.getSortedByList(e,t,n);var i,s=new nL,a=e.length;for(i=0;i<a;i++)s[o[i]]=i;return r&&(s=s.getNormalized()),s.name=e.name,s},sortListByIndexes=function(e,t){var n=instantiate(_typeOf(e));n.name=e.name;var r,o=e.length;for(r=0;r<o;r++)n.push(e[t[r]]);return n},concatWithoutRepetitions=function(){var e=arguments.length;if(0!==e){if(1==e)return arguments[0];var t,n,r,o,i=arguments[0].clone(),s=getBooleanDictionaryForList(i);for(t=1;t<e;t++)for(o=(r=arguments[t]).length,n=0;n<o;n++)s[r[n]]||i.push(r[n]);return i.downcast()}},slidingWindowOnList=function(e,t,n,r){r=r||0;var o,i,s,a=new T,l=e.length;switch(n=Math.max(1,n),r){case 0:for(i=0;i<l;i+=n)if(i+t<=l){for(o=new L,s=0;s<t;s++)o.push(e[i+s]);a.push(o.downcast())}break;case 1:for(i=0;i<l;i+=n){for(o=new L,s=0;s<Math.min(t,l-i);s++)o.push(e[i+s]);a.push(o.downcast())}break;case 2:for(i=0;i<l;i+=n){for(o=new L,s=0;s<t;s++)o.push(e[(i+s)%l]);a.push(o.downcast())}}return a.downcast()},getNewListForObjectType=function(e){var t=new L;return t[0]=e,instanceSameType(t.downcast())},union=function(e,t,n,r,o){if(null!=e&&null!=t){var i,s,a=new L,l=e.length,u=t.length,h=null==n?0:n.length,c=null==r?0:r.length,f=null==o?0:o.length;if("ndL"==e.type||"ndL"==t.type){for(a=new ndL,a=e.clone(),i=0;i<u;i++)null==e.get(t[i].id)&&a.addNode(t[i]);return n&&(a=a(a,n)),r&&(a=a(a,r)),o&&(a=a(a,o)),a}var p={};for(i=0;i<l;i++)p[e[i]]=e[i];for(i=0;i<u;i++)p[t[i]]=t[i];for(i=0;i<h;i++)p[n[i]]=n[i];for(i=0;i<c;i++)p[r[i]]=r[i];for(i=0;i<f;i++)p[o[i]]=o[i];for(s in p)a.push(p[s]);return a.downcast()}},intersection=function(e,t,n,r,o){if(null!=e&&null!=t){if(e.isTable&&t.isTable)return e.getColumns(t.getNames());var i,s=null;Array.isArray(n)||"object"!=typeof n||(s=n,n=null);var a,l,u=e.length,h=t.length;if("ndL"==e.type&&"ndL"==t.type){for(i=new ndL,a=0;a<u;a++)t.get(e[a].id)&&i.addNode(e[a]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var c=null==s?getBooleanDictionaryForList(e):s,f={},p=null==n?null:getBooleanDictionaryForList(n),g=null==r?null:getBooleanDictionaryForList(r),d=null==o?null:getBooleanDictionaryForList(o);for(i=new L,a=0;a<h;a++)null!=f[l=t[a]]||!c[l]||null!=p&&!p[l]||null!=g&&!g[l]||null!=d&&!d[l]||(f[l]=!0,i.push(l));return i.downcast()}},difference=function(e,t){if(null!=e&&null!=t){var n,r=getBooleanDictionaryForList(t),o={},i=new L,s=e.length;for(e.type,n=0;n<s;n++)r[e[n]]||o[e[n]]||(i.push(e[n]),o[e[n]]=!0);return i.downcast()}},symmetricDifference=function(e,t){if(null!=e&&null!=t){var n,r=getBooleanDictionaryForList(e),o=getBooleanDictionaryForList(t),i={},s=new L,a=e.length,l=t.length;for(e.type,n=0;n<a;n++)o[e[n]]||i[e[n]]||(s.push(e[n]),i[e[n]]=!0);for(n=0;n<l;n++)r[t[n]]||i[t[n]]||(s.push(t[n]),i[t[n]]=!0);return s.downcast()}},jaccardIndex=function(e,t,n,r){if(null!=e&&null!=t){if(0===e.length&&0===t.length)return 0;n=null==n?0:n;var o=intersection(e,t,r).length;return(o+n)/(e.getWithoutRepetitions().length+t.getWithoutRepetitions().length-o)}},jaccardDistance=function(e,t){return 1-jaccardIndex(e,t)},filterList=function(e,t="=c",n,r,o,i){if(null!=e){"="==t&&(t="=="),null==r&&(r=e),!0===i&&(i=1);var s,a=e.length;if(2==i){var l=new L;switch(t){case"==":for(s=0;s<a;s++)l.push(r[s]===n);break;case"<":for(s=0;s<a;s++)l.push(r[s]<n);break;case"<=":for(s=0;s<a;s++)l.push(r[s]<=n);break;case">":for(s=0;s<a;s++)l.push(r[s]>n);break;case">=":for(s=0;s<a;s++)l.push(r[s]>=n);break;case"!=":for(s=0;s<a;s++)l.push(r[s]!==n);break;case"contains":for(s=0;s<a;s++)l.push(r[s].includes(n));break;case"between":for(s=0;s<a;s++)l.push(r[s]>=n&&r[s]<=o);break;case"init":for(s=0;s<a;s++)l.push(0===r[s].indexOf(n));break;case"property value":for(s=0;s<a;s++)l.push(r[s][n]==o)}return l}var u=new L,h=1==i?createSortedNumberList(e.length):e;switch(t){case"==":for(s=0;s<a;s++)r[s]==n&&u.push(h[s]);break;case"<":for(s=0;s<a;s++)r[s]<n&&u.push(h[s]);break;case"<=":for(s=0;s<a;s++)r[s]<=n&&u.push(h[s]);break;case">":for(s=0;s<a;s++)r[s]>n&&u.push(h[s]);break;case">=":for(s=0;s<a;s++)r[s]>=n&&u.push(h[s]);break;case"!=":for(s=0;s<a;s++)r[s]!=n&&u.push(h[s]);break;case"contains":for(s=0;s<a;s++)r[s].includes(n)&&u.push(h[s]);break;case"between":for(s=0;s<a;s++)r[s]>=n&&r[s]<=o&&u.push(h[s]);break;case"init":for(s=0;s<a;s++)0===r[s].indexOf(n)&&u.push(h[s]);break;case"property value":for(s=0;s<a;s++)r[s][n]==o&&u.push(h[s])}return u.downcast()}},mapWithFunction=function(e,t,n,r,o,i,s,a,l,u){if(null!=e&&null!=t){null==u&&(u=!0),"string"==typeof t&&(u=!1,t=stringToFunction(t));var h,c=new L,f=e.length;if(u)for(h=0;h<f;h++)c[h]=t.call(this,e[h],h,n,r,i,s,a,l);else for(h=0;h<f;h++){var p=[e[h]];null!=n&&(p[1]=n),null!=r&&(p[2]=r),null!=i&&(p[3]=i),null!=s&&(p[4]=s),null!=a&&(p[5]=a),null!=l&&(p[6]=l),c[h]=t.apply(this,p)}return c.name=o,c.downcast()}},mapFunctionsOnList=function(e,t,n,r){if(null!=e&&null!=t){for(var o=new L,i=Math.min(e.length,t.length),s=0;s<i;s++){var a=t[s];"string"==typeof a&&(a=stringToFunction(a));var l=[e[s]];null!=n&&(l[1]=n),null!=r&&(l[2]=r),o[s]=a.apply(this,l)}return o.downcast()}},aggregateList=function(e,t,n,r,o,i){if(null==e||null==t)return null;var s,a,l=new T;if(null!=n&&"string"==_typeOf(n)&&(n=ListOperators._aggregationDictionary[n]),18==n&&null==o)throw Error("weightList must be defined to aggregate to a weighted average.");if(null==(r=e.indexesTable)&&(r=getIndexesTable(e),e.indexesTable=r),11==n)return r;if(l[0]=r[0],0===n&&e==t)return l[1]=r[0],l;n=null==n?0:n;var u,h,c,f,p,g=r[1].length;switch(n){case 0:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(t[u[0]]);return l[1]=l[1].downcast(),l;case 1:for(l[1]=new nL,f=0;f<g;f++)u=r[1][f],l[1].push(u.length);return l;case 2:case 3:case 18:case 19:var d,m,y;for(l[1]=new nL,f=0;f<g;f++){u=r[1][f],d=0,m=0,y=0;var v=new nL;for(p=0;p<u.length;p++)d+=t[h=u[p]],19==n&&v.push(t[h]),18==n&&(m+=t[h]*o[h],y+=o[h]);3==n?d/=u.length:18==n&&(d=0==y?0:m/y),19==n&&(d=v.getMedian()),2!=n||Number.isInteger(d)||(d=Number(parseFloat(d).toPrecision(12))),l[1].push(d)}return l;case 4:var x;for(l[1]=new nL,f=0;f<g;f++){for(u=r[1][f],x=99999999999,p=0;p<u.length;p++)h=u[p],x=Math.min(x,t[h]);l[1].push(x)}return l;case 5:var w;for(l[1]=new nL,f=0;f<g;f++){for(u=r[1][f],w=-99999999999,p=0;p<u.length;p++)h=u[p],w=Math.max(w,t[h]);l[1].push(w)}return l;case 6:var b;for(l=aggregateList(e,t,3,r),f=0;f<g;f++){for(u=r[1][f],d=0,b=l[1][f],p=0;p<u.length;p++)h=u[p],d+=Math.pow(t[h]-b,2);l[1][f]=Math.sqrt(d/u.length)}return l;case 16:case 7:for(l[1]=new T,f=0;f<g;f++){for(u=r[1][f],s=new L,p=0;p<u.length;p++)null!=t[h=u[p]]&&s.push(t[h]);s=s.downcast(),16==n&&(s=s.getFrequenciesTable(!0)),l[1].push(s)}return 16==n?l:l.downcast();case 8:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(t[u[u.length-1]]);return l[1]=l[1].downcast(),l;case 9:for(l[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getMode());return l[1]=l[1].downcast(),l;case 10:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(t[u[Math.floor(Math.random()*u.length)]]);return l[1]=l[1].downcast(),l;case 11:case 16:break;case 12:for(l[1]=new nL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions().length);return l;case 13:for(l[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions());return l[1]=l[1].downcast(),l;case 14:case 17:var _=14==n?", ":"";for(l[1]=new sL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.join(_));return l;case 15:for(l[1]=new sL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions().join(", "));return l;case 20:for(l[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(i(c));return l[1]=l[1].downcast(),l}return null},subCategoricalAnalysis=function(e,t){if(null!=e&&null!=t){var n,r,o,i={},s=!0;for(o=0;null!=e[o];o++)if(null==(r=i[n=e[o]]))i[n]=t[o];else if(r!=t[o]){s=!1;break}i={};var a=!0;for(o=0;null!=t[o];o++)if(null==(r=i[n=t[o]]))i[n]=e[o];else if(r!=e[o]){a=!1;break}return a&&s?1:s?2:a?3:0}},getListEntropy=function(e,t,n,r){if(null!=e){if(e.length<2)return 1==e.length?(e._mostRepresentedValue=e[0],e._biggestProbability=1,null!=t&&(e._P_valueFollowing=e[0]==t?1:0)):null!=t&&(e._P_valueFollowing=0),0;null!=e.infoObject&&(n=e.infoObject.frequenciesTable),null==n&&(n=e.getFrequenciesTable(!0)),e._mostRepresentedValue=n[0][0];var o=e.length;if(e._biggestProbability=n[1][0]/o,1==n[0].length)return e._P_valueFollowing=e[0]==t?1:0,0;var i,s,a=0,l=Math.log(n[0].length),u=n[1].length;for(i=0;i<u;i++)a-=(s=n[1][i])/o*Math.log(s/o);if(r>0&&(a*=1/l),2==r){var h=function(e,t){if(1==e)return 0;if(e==t)return 1;var n=t-(e-1);return(1/t*-(e-1)*Math.log(1/t)-n/t*1*Math.log(n/t))/Math.log(e)}(u,e.length);h<1&&(a=(a-h)/(1-h))}if(null!=t){var c=n[0].indexOf(t);e._P_valueFollowing=-1==c?0:n[1][c]/o}return a}},getListDiversity=function(e,t,n){if(!((t=null==t?0:t)<0||t>2||null==e)){if(e.length<2)return 0;if(!e.isList){if(!Array.isArray(e))return;e=L.toL(e)}switch(null!=e.infoObject&&(n=e.infoObject.frequenciesTable),null==n&&(n=e.getFrequenciesTable()),t){case 0:for(var r=0,o=e.length*(e.length-1),i=0;i<n[1].length;i++)r+=n[1][i]*(n[1][i]-1);return 1-r/o;case 1:return n[0].length/e.length;case 2:return getListEntropy(e,null,null,1)*n[0].length/e.length}}},getInformationGain=function(e,t,n){if(null==e||null==t||e.length!=t.length)return null;var r,o,i=null==t.infoObject?getListEntropy(t):t.infoObject.entropy,s=i,a={},l=new T,u=e.length;for(r=0;r<u;r++)null==a[o=e[r]]&&(a[o]=new L,l.push(a[o])),a[o].push(t[r]);u=l.length;var h,c=t.length,f=0;for(r=0;r<u;r++)h=null==l[r].infoObject?getListEntropy(l[r]):l[r].infoObject.entropy,f+=l[r].length/c*h;s=i-f;return n&&(s/=i),s},groupElementsByPropertyValue=function(e,t,n,r,o){if(e){null==r&&(r=0);var i,s,a,l,u,h={},c=new T;for(u=0;u<e.length;u++)s=e[u],void 0===h[i=null==t?s:s[t]]&&(h[i]=new L,h[i].name=i,h[i].valProperty=i,c.push(h[i])),0===r?h[i].push(s):1==r&&h[i].push(u),(void 0===a||i<a)&&(a=i),(void 0===l||i>l)&&(l=i);if(o){for(u=a;u<l;u++)void 0===h[u]&&(h[u]=new L,h[u].name=u,h[u].valProperty=u,c.push(h[u]))}return n&&(c=c.getSortedByProperty("name")),c}},repeatElements=function(e,t){if(e&&t){var n=instanceSameType(e);n.name=e.name;for(var r=0;r<e.length;r++)for(var o=0;o<t[r%t.length];o++)n.push(e[r]);return n}},_isCategorical=function(e,t){return t>1&&t<e.length&&(e.length<=20||t/e.length<.8)},buildInformationObjectForList=function(e,t){if(null!=e){if(1==(t=null==t||t)&&null!=e.infoObject)return e.infoObject;var n,r,o=e.length,i={isInfoObject:!0,type:e.type,name:e.name,length:o};if(i.frequenciesTable=e.getFrequenciesTable(!0,!0,!0),i.numberDifferentElements=i.frequenciesTable[0].length,i.mostFrequentElement=i.frequenciesTable[0][0],i.isNumeric="nL"==e.type,i.isCategorical=_isCategorical(e,i.numberDifferentElements),i.isLongTexts=!1,i.isDefault=!1,i.isNumericCategorical=i.isNumeric&&i.isCategorical,i.isUnique=i.numberDifferentElements==e.length,i.containsNulls=i.frequenciesTable[0].includes(null)||i.frequenciesTable[0].includes(void 0),i.containsNullsOrEqual=i.containsNulls||i.frequenciesTable[0].includes("")||i.frequenciesTable[0].includes("null"),i.isLongitude=!1,i.isLatitude=!1,i.isSmall=e.length<=100,"nL"==e.type){var s=999999999999,a=-999999999999,l=0,u=0,h=new nL,c=0,f=0,p=-999999999999,g=Math.max(Math.floor(e.length/50),1),d=!0;for(n=0;n<o;n++)r=e[n],s=Math.min(s,r),a=Math.max(a,r),l+=r,f+=r,r%1!=0&&(d=!1),++c==g&&(f/=c,p=Math.max(p,f),h.push(f),f=0,c=0);0!==c&&(f/=c,p=Math.max(p,f),h.push(f)),h=h.factor(1/p);var m=l;for(l/=e.length,n=0;n<o;n++)u+=Math.pow(e[n]-l,2);if(i.min=s,i.max=a,i.average=l,i.sum=m,i.standardDeviation=Math.sqrt(u/o),i.allIntegers=d,i.kind=d?"integer numbers":"numbers",i.allPositive=i.min>=0,i.allNegative=i.min<0,i.histogram=rangeCounts(e,50),e.name){var y=e.name.toLowerCase().trim();i.min>=-90&&i.max<=90&&("lat"==y||"lat."==y||y.match(/latitud.*/i))&&(i.isLatitude=!0),i.min>=-180&&i.max<=180&&("lon"==y||"lon."==y||"long"==y||y.match(/longitud.*/i)||"long."==y||"lng"==y)&&(i.isLongitude=!0)}}if("nL"!=e.type||i.allIntegers){if(i.categoricalColors=i.frequenciesTable[3],"sL"==e.type){var v=e.getLengths();for(i.averageTextLengths=0,i.minTextLength=999999999999999,i.maxTextLength=0,n=0;n<o;n++)i.averageTextLengths+=v[n],v[n]>i.maxTextLength&&(i.maxTextLength=v[n]),v[n]<i.minTextLength&&(i.minTextLength=v[n]);i.averageTextLengths=Number(numberToString(i.averageTextLengths/o,i.averageTextLengths/o<10?1:0)),i.averageTextLengths>40&&(i.isLongTexts=!0)}if(i.isLatitude||i.isLongitude)i.kind="geo coordinate";else if("sL"!=e.type||i.isCategorical)if("sL"!=e.type||i.isCategorical)if("L"==e.type){var x=0;for(n=0;n<i.frequenciesTable[0].length;n++)r=i.frequenciesTable[0][n],(isNaN(parseFloat(r))||!isFinite(r)||Math.floor(r)==r&&r<1e3)&&x++;i.isCategorical&&x/i.numberDifferentElements>.8?i.kind="categories":i.kind="strings"}else"nL"!=e.type?i.kind="categories":"nL"==e.type&&(i.kind="integer numbers",i.numberDifferentElements/e.length<=.2&&i.numberDifferentElements<=30&&(i.kind="categories"));else i.kind="strings";else i.kind="strings"}return i.entropy=i.numberDifferentElements==e.length?1:1==i.numberDifferentElements?0:getListEntropy(e,null,i.frequenciesTable),i.isLabel="sL"!=e.type&&i.isUnique&&i.maxTextLength<100,i.isDefault=!i.isNumeric&&!i.isCategorical&&!i.isLongTexts,e.infoObject=i,i}},kCombinations=function(e,t){if(null!=e&&null!=t){var n,r,o,i,s=new T;if(t>e.length||t<=0)return s;if(t==e.length)return s.push(e.clone()),s;if(1==t){for(n=0;n<e.length;n++)s.push(new L(e[n]).downcast());return s}for(n=0;n<e.length-t+1;n++)for(o=e.slice(n,n+1),i=s(L.toL(e.slice(n+1)).downcast(),t-1),r=0;r<i.length;r++)s.push(L.toL(o.concat(i[r])).downcast());return s.downcast()}},allSubLists=function(e,t){if(null==e)return null;var n,r=new T;for(t&&r.push(new L),n=1;n<=e.length;n++)r=T.toL(r.concat(kCombinations(e,n)));return r.downcast()},crossCombineLists=function(e,t,n){if(null==e||null==t)return null;var r,o;n=null==n?" ":n;var i=new sL;for(r=0;r<e.length;r++)for(o=0;o<t.length;o++)i.push(e[r]+n+t[o]);return i},characterizeList=function(e,t,n){if(null==e)return null;if(!e.isList)throw new Error("first inlet must be a list");if(e.isTable){var r=new sL;for(let o=0;o<e.length;o++)r.push(characterizeList(e[o],t,n));return r}if(0==e.length)return"";if(null==e.infoObject&&buildInformationObjectForList(e),t=null==t?0:t,n=null!=n&&n,isNaN(t)||t%1!=0||t<0||t>14)throw new Error("Mode must be an integer between 0 and 14");if([1,2,3,4,9,10].includes(t)&&"nL"!=e.type)throw new Error("This mode only applicable for nL input");var o,i,s,a,l;switch(t){case 0:o=e[0]+(n?"(first)":"");break;case 1:o=e.getSum()+(n?"(sum)":"");break;case 2:var u=getDecimalsInterval(e);o=numberToString(e.infoObject.average,u.y+1)+(n?"(avg)":"");break;case 3:o=e.infoObject.min+(n?"(min)":"");break;case 4:o=e.infoObject.max+(n?"(max)":"");break;case 5:o="sL"!=e.type?e.toStringList().join(", ")+(n?"(all)":""):e.join(", ")+(n?"(all)":"");break;case 6:o=e.infoObject.mostFrequentElement+(n?"(common)":"");break;case 7:o=e.infoObject.numberDifferentElements+(n?"(unique count)":"");break;case 8:o="sL"!=(s=e.infoObject.frequenciesTable[0]).type?s.toStringList().join(",")+(n?"(unique)":""):s.join(", ")+(n?"(unique)":"");break;case 9:o=e.infoObject.min+"-"+e.infoObject.max+(n?"(range)":"");break;case 10:o=e.getMedian()+(n?"(median)":"");break;case 11:for(o="",i=0;i<3&&i<e.length;i++)""!=o&&(o+=", "),o+=String(e[i]);e.length>3&&(o+=", + "+(e.length-3)+" more"),n&&(o+="(short list)");break;case 12:a=e.infoObject.frequenciesTable;var h=0;for(o="",i=0;i<a[0].length;i++)i<5?(""!=o&&(o+=", "),o+=String(a[0][i])+":"+a[1][i]):h+=a[1][i];h>0&&(o+=", Other:"+h),o+=n?"(frequency)":"";break;case 13:for(s="sL"==e.type?e:e.toStringList(),a=(s=getWords(s.join(" "),!1,!0,null,null,null,2)).getFrequenciesTable(!0,!0),o="",i=0;i<5&&i<a[0].length;i++)""!=o&&(o+=", "),l=(l=(100*a[2][i]).toPrecision(2)).includes("e")?parseFloat(l):l,o+=String(a[0][i])+":"+l;o+=n?"(word rate)":"";case 14:o=e.name&&""!=e.name?e.name+": ":"","sL"!=e.type?o+=e.toStringList().getSubList(0,5).join(", ")+(n?"(name:5)":""):o+=e.getSubList(0,5).join(", ")+(n?"(name:5)":"")}return o=o.replace(/\n/g," ")},createDefaultCategoricalColorList=function(e,t,n,r=!1){var o=createCategoricalColors(2,e,null,null,null,null,null,r);return null!=t&&t<=1&&(o=o.addAlpha(t)),n&&(o=o.getInverted()),o},colorsForCategoricalList=function(e,t,n){if(null!=e){if(n){var r=new cL;r.name=e.name+" colors";for(var o=0;o<e.length;o++)r[o]=stringToColor(String(e[o]));return r}return createCategoricalColorListForList(e,t)[0].value}},createCategoricalColorListForList=function(e,t,n,r,o,i,s){if(null==e)return null;o=null==o?0:o;var a,l=e.getWithoutRepetitions();a=t&&o>0?t.getInterpolated(r,o):createCategoricalColors(2,l.length,null,n,r,o,t,s),null!=n&&n<=1&&(a=a.addAlpha(n)),i&&(a=a.getInverted());var u=T.toL([l,a]),h=buildDictionaryObjectForDictionary(u),c=mapWithTable(e,u,"black");return[{value:c=cL.toL(c),type:"cL"},{value:l,type:l.type},{value:a,type:"cL"},{value:u,type:"T"},{value:h,type:"Object"}]},createColorListFromColorScale=function(e,t,n){if(null!=e){var r;n=null==n?0:n,t=null==t?grayToOrange:t;var o=new cL;switch(n){case 0:for(r=0;r<e;r++)o[r]=t(r/(e-1));break;case 1:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),2));break;case 2:for(r=0;r<e;r++)o[r]=t(Math.sqrt(r/(e-1)));break;case 3:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),4));break;case 4:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),.25))}return o}},createColorListFromNumberList=function(e,t,n){if(null==e)return null;n=null==n?0:n,t=null==t?grayToOrange:t;var r,o,i=new cL,s=e.length;switch(n){case 0:r=normalizeToMax(e);break;case 1:break;case 2:r=e}for(o=0;o<s;o++)i[o]=t(r[o]);return i},createSymmetricalColorListFromNumberList=function(e,t,n,r,o,i){if(null!=e){var s=null==i?e.getInterval():i,a=Math.max(Math.abs(s.x),Math.abs(s.y));n=null==n?"gray":n,r=null==r?"blue":r;for(var l,u=colorStringToRGB(t=null==t?"red":t),h=colorStringToRGB(n),c=colorStringToRGB(r),f=new cL,p=0;p<e.length;p++)l=Math.abs(e[p])/a,o>0&&(l=Math.sqrt(l)),o>1&&(l=Math.sqrt(l)),null!=i&&e[p]<i.x?f[p]=t:null!=i&&e[p]>i.y?f[p]=r:f[p]=RGBArrayToString(e[p]<0?interpolateColorsRGB(h,u,l):interpolateColorsRGB(h,c,l));return f}},createColorListWithSingleColor=function(e,t){for(var n=new cL,r=0;r<e;r++)n.push(t);return n},createColorListBetweenTwoColors=function(e,t,n){if(e=null==e?8:e,null!=t&&null!=n){for(var r=new cL,o=0;o<e;o++){var i=1==e?t:interpolateColors(t,n,o/(e-1),!0);r.push(i)}return r}},createColorListSpectrum=function(e,t,n){e=null==e?8:e,t=null==t?1:t,n=null==n?1:n;for(var r,o=new cL,i=0;i<e;i++)r=360*i/e,o.push(HSVtoHEX(r,t,n));return o},stringsToColors=function(e,t){if(null!=e){null!=t&&t.isTable&&(t=buildDictionaryObjectForDictionary(t));for(var n=new cL,r=0;r<e.length;r++)n[r]=t?t[String(e[r])]:null,null==n[r]&&(n[r]=stringToColor(String(e[r])));return n}},createCategoricalColors=function(e,t,n,r,o,i=.5,s,a){var l,u;n=null==n?temperature:n;var h=new cL;switch(e){case 0:for(l=0;l<t;l++)h[l]=n(l/(t-1));break;case 1:var c=createRandomNumbers(t,null,0);for(l=0;l<t;l++)h[l]=n(c[l]);break;case 2:var f;for(s=null==s?_HARDCODED_CATEGORICAL_COLORS:s,l=0;l<t;l++)if(h[l]=s[l%s.length],a&&l>=s.length)for(f=Math.floor(l/s.length),u=0;u<f;u++)h[l]=interpolateColors(h[l],"black",.2);break;case 3:h=createColorListSpectrum(t);break;case 4:case 5:var p,g,d=createRandomNumbers(1001,null,0),m=createSortedNumberList(t),y=createRandomNumbers(t,null,0),v=sortListByNumberList(m,y),x=Math.floor(2*t)+100,w=Math.floor(.6*t)+5,L=4==e,b=4==e,T=_evaluationFunction(v,L,b),_=v,M=0;for(l=0;l<x;l++){for(u=0;u<w;u++)p=_sortingVariation(v,d[M],d[M+1]),M=(M+2)%1001,(g=_evaluationFunction(p,L,b))>T&&(_=p,T=g);v=_}if(4==e){var S=createColorListSpectrum(t);for(l=0;l<t;l++)h.push(S[v[l]])}else for(l=0;l<t;l++)h.push(n(1/t+v[l]/(t+1)))}return i>0&&null!=o&&(h=h.getInterpolated(o,i)),null!=r&&(h=h.addAlpha(r)),h},_sortingVariation=function(e,t,n){var r=e.clone(),o=Math.floor(t*r.length),i=Math.floor(n*r.length),s=r[i];return r[i]=r[o],r[o]=s,r},_evaluationFunction=function(e,t,n){for(var r,o,i,s=0,a=e.length,l=Math.floor(a/2),u=n?4:1,h=1;h<=u;h++)for(i=h*h,r=0;null!=e[r+h];r++)o=Math.abs(e[r+h]-e[r]),t&&o>l&&(o=a-o),s+=Math.sqrt(o/i);return s},createCategoricalColorListDictionaryObject=function(e,t,n,r,o,i){if(null!=e){if(e.isTable){var s,a,l,u,h,c=e,f=null==t?_HARDCODED_CATEGORICAL_COLORS:t;for(s=f.clone(),l={},d=0;d<c.length;d++)(h=buildInformationObjectForList(c[d])).isCategorical&&((u=h.numberDifferentElements)>=f.length?a=createCategoricalColorListDictionaryObject(c[d],f,n,r,o,i):(u>s.length&&(s=f.clone()),a=createCategoricalColorListDictionaryObject(c[d],s,n,r,o,i),s=s.getSubList(u,s.length-1)),l=Object.assign(l,a));return l}var p=e.getWithoutRepetitions(),g=createCategoricalColors(2,p.length,null,n,r,o,t);i&&(g=g.getInverted());var d,m={},y=g.length;for(d=0;d<y;d++)m[p[d]]=g[d];return m}},stringToDate=function(e,t,n){if(null==e)return null;if(n=null==n?"-":n,t=null==t?1:t,t=Number(t),"sL"==e.type||"Array"==_typeOf(e)){var r,o=new dL;for(o.name=e.name,r=0;r<e.length;r++)o.push(stringToDate(e[r],t,n));return o}if(e=String(e),1==t)return"-"!=n&&(e=e.replace(new RegExp(n,"g"),"-")),-1==e.indexOf(".")?parseDate(e):new Date(e);var i,s=e.split(n);switch(t){case 0:return new Date(Number(s[2]),Number(s[0])-1,Number(s[1]));case 1:return new Date(e);case 2:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[0])-1,Number(s[1]));case 3:return i=(i=Number(s[0]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[2]));case 4:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[0]));case 5:return i=Number(s[2]),new Date(i,Number(s[1])-1,Number(s[0]));case 6:i=Number(e.substr(0,4));var a=Number(e.substr(4,2)),l=Number(e.substr(6,2));return new Date(i,a-1,l)}},dateToString=function(e,t,n){if(null==e)return null;if("dL"==e.type||"Array"==_typeOf(e)){var r,o=new sL;for(o.name=e.name,r=0;r<e.length;r++)o.push(dateToString(e[r],t,n));return o}n=null==n?"-":n,t=null==t?0:t,"string"==typeof e&&(e=new Date(e));var i=e.getFullYear(),s=String(i).substr(2),a=e.getMonth()+1,l=e.getDate();switch(t){case 0:return a+n+l+n+i;case 1:return i+n+a+n+l;case 2:return a+n+l+n+s;case 3:return s+n+a+n+l;case 4:return i+n+a+n+l+" "+(h=e.getHours())+":"+(c=(c=e.getMinutes())<10?"0"+c:c)+":"+(f=(f=e.getSeconds())<10?"0"+f:f);case 5:return l+" "+DateOperators_MONTH_NAMES[a-1]+" "+i;case 6:return u=0==(u=e.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u]+", "+l+" "+DateOperators_MONTH_NAMES[a-1]+" "+i;case 7:return DateOperators_MONTH_NAMES[a-1];case 8:var u;return u=0==(u=e.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u];case 9:return i+n+(a<10?"0"+a:a)+n+(l<10?"0"+l:l);case 10:var h,c,f;return(h=(h=e.getHours())<10?"0"+h:h)+":"+(c=(c=e.getMinutes())<10?"0"+c:c)+":"+(f=(f=e.getSeconds())<10?"0"+f:f);case 11:return(l<10?"0"+l:l)+n+(a<10?"0"+a:a)+n+i}},clearHoursMinutesSeconds=function(e){if(null==e)return null;var t=dateToString(e,1);return stringToDate(t,1)},currentDate=function(e){return new Date},addDaysToDate=function(e,t){if(null==e)return null;t=null==t?0:t,"string"==typeof e&&(e=parseDate(e));var n=new Date(e);return n.setDate(n.getDate()+t),n},addMillisecondsToDate=function(e,t){return new Date(e.getTime()+t)},parseDate=function(e){var t=(e=String(e)).match(/^(\d{4})[\-\.](\d{1,2})[\-\.](\d{1,2})$/);return t&&4==t.length?new Date(t[1],t[2]-1,t[3]):new Date(Date.parse(e))},parseDates=function(e){var t,n=new dL;for(t=0;null!=e[t];t++)n.push(this.parseDate(e[t]));return n},hoursBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToHours},daysBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToDays},weeksBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToWeeks},yearsBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToYears},nDayInYear=function(e){return Math.floor((e.getTime()-new Date(e.getFullYear(),0,1).getTime())*DateOperators_millisecondsToDays)},getDateDaysAgo=function(e){return addDaysToDate(new Date,-e)},getWeekInYear=function(e){if(null==e)return null;var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},getNDaysInMonth=function(e,t){return new Date(t,e,0).getDate()},getDecimalDate=function(e){var t;if(null==e)return null;if("string"==typeof e){if(t=new Date(e),isNaN(t))throw new Error("Invalid format for date:"+e)}else t=e;var n=t.getFullYear(),r=(e=new Date(n,0,1),new Date(n+1,0,1));return n+(t.getTime()-e.getTime())/(r.getTime()-e.getTime())},convertFromDecimalDate=function(e){if(null==e)return null;if("nL"==e.type){var t=new t;t.name=e.name;for(var n=0;n<e.length;n++)t.push(convertFromDecimalDate(e[n]));return t}var r=Math.floor(e),o=new Date(r,0,1),i=new Date(r+1,0,1),s=o.getTime()+(i.getTime()-o.getTime())*(e-r),a=new Date(Math.round(s));if(isNaN(a))throw new Error("Invalid decimal date value:"+e);return a},extractPropertiesFromDate=function(e,t){if(null==e)return null;if(t=null==t?0:t,isNaN(t)||t%1!=0||t<0||t>15)throw new Error("Invalid output type.");var n,r,o,i;switch(t){case 0:n=e.getFullYear();break;case 1:n=e.getMonth()+1;break;case 2:n=e.getDate();break;case 3:n=e.getDay();break;case 4:n=e.getHours();break;case 5:n=e.getMinutes();break;case 6:n=e.getSeconds();break;case 7:n=getDecimalDate(e);break;case 8:n=nDayInYear(e);break;case 9:r=getDecimalDate(e),n=Math.floor(4*(r-Math.floor(r)))+1;break;case 10:o=e.getHours()+(60*e.getMinutes()+e.getSeconds())/3600,n=Number(o.toFixed(5));break;case 11:for(n=[],i=0;i<7;i++)e.getDay()==i?n.push(1):n.push(0);break;case 12:for(n=[],i=0;i<12;i++)e.getMonth()==i?n.push(1):n.push(0);break;case 13:n=dateToString(e,8);break;case 14:n=dateToString(e,7);break;case 15:n=e.getHours()>=12?"pm":"am"}return n},StringListToNumberList=function(e){var t,n=new nL;for(n.name=e.name,t=0;null!=e[t];t++)n[t]=Number(e[t]);return n},toDateList=function(e,t,n){if(null!=e){var r,o=new dL;o.name=e.name;var i=e.length;for(r=0;r<i;r++)o.push(stringToDate(e[r],t,n));return o}},_y=function(e){return e.getFullYear()},_m=function(e){return e.getMonth()},_d=function(e){return e.getDate()-1},_h=function(e){return e.getHours()},_mn=function(e){return e.getMinutes()},_s=function(e){return e.getSeconds()},_ms=function(e){return e.getMilliseconds()},getDateLists=function(e){for(var t=new T,n=0;n<e.length;n++)"dL"==e[n].type&&t.push(e[n]);return t},buildSummaryTableFromDates=function(e,t,n,r){if(null==e||"dL"!=e.type)return null;var o="Weekday by Hour Summary",i="Hour";1==(t=null==t?0:t)?(o="Month by Day Summary",i="Day"):2==t&&(o="Sequence",i="Date");var s=new T;null!=e.name?s.name=e.name+" "+o:s.name=o,s.push(new sL),s[0].name=i;var a,l,u,h,c,f,p=window&&window.navigator&&window.navigator.language?window.navigator.language:"en-US",g=new Date(2016,0,17,10,0,0,0);if(2==t){null!=r&&"dI"==r.type||(r=new dI(e.getMin(),e.getMax())),s.push(new u),s[1].name="Value";var d=daysBetweenDates(r.date0,r.date1);for(a=0;a<=d;a++)l=addDaysToDate(r.date0,a),s[0][a]=dateToString(l,1),s[1][a]=0;for(a=0;a<e.length;a++)(h=Math.floor(daysBetweenDates(r.date0,e[a])))<0||h>=s[1].length||(m?s[1][h]+=n[a]:s[1][h]++);return s}var m=n&&n.length==e.length,y=0==t?7:12,v=0==t?1:30;for(a=0;a<y;a++)if(l=0==a?g:addDaysToDate(g,a*v),(u=new u).name=l.toLocaleString(p,0==t?{weekday:"long"}:{month:"long"}),s.push(u),0==a)if(0==t)for(h=0;h<24;h++)s[0][h]=0==h?"Midnight":12==h?"Noon":String(h>12?h-12:h);else for(h=0;h<31;h++)s[0][h]=String(h+1);for(c=1;c<=y;c++)for(f=0;f<s[0].length;f++)s[c][f]=0;for(a=0;a<e.length;a++)0==t?(c=e[a].getDay(),f=e[a].getHours()):(c=e[a].getMonth(),f=e[a].getDate()-1),m?s[c+1][f]+=n[a]:s[c+1][f]++;return s},transformDateList=function(e,t,n,r){if(null==e)return null;if("sL"==e.type&&(e=toDateList(e)),null==t&&(t=nL.toL([0,1,2])),"nL"!=t.type&&!(t instanceof Array))throw new Error("Invalid input. Second argument must be a nL.");n=null==n?"":n;var o,i,s,a,l=["year","month","day of month","day of week","hour","minute","second","decimal date","day number of year","quarter","decimal hour","day","month","day name","month name","week number in year","day number"],u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];if("dL"==(r=null==r?"2000-01-01":r).type)r=r.getMin();else if("sL"==r.type)r=(r=toDateList(r)).getMin();else if("string"==typeof r)if("earliest"==r)r=e.getMin();else if(r=parseDate(r),isNaN(r))throw new Error("Invalid format for date:"+r);r=clearHoursMinutesSeconds(r),o=t.includes(13)||t.includes(14)?new T:new nT;for(var c=0;c<t.length;c++){var f=t[c];if(a=o.length,isNaN(f)||f%1!=0||f<0||f>16)throw new Error("Invalid output type.");if(11==f)for(i=0;i<7;i++)o.push(new nL),s=""==n?l[f]:n+" "+l[f],o[a+i].name=s+":"+u[i];else if(12==f)for(i=0;i<12;i++)o.push(new nL),s=""==n?l[f]:n+" "+l[f],o[a+i].name=s+":"+h[i];else 13==f||14==f?o.push(new sL):o.push(new nL),o[a].name=""==n?l[f]:n+" "+l[f];for(var p=0;p<e.length;p++){var g=e[p];switch(f){case 0:o[a].push(g.getFullYear());break;case 1:o[a].push(g.getMonth()+1);break;case 2:o[a].push(g.getDate());break;case 3:o[a].push(g.getDay());break;case 4:o[a].push(g.getHours());break;case 5:o[a].push(g.getMinutes());break;case 6:o[a].push(g.getSeconds());break;case 7:o[a].push(getDecimalDate(g));break;case 8:o[a].push(nDayInYear(g));break;case 9:var d=getDecimalDate(g);d=Math.floor(4*(d-Math.floor(d)))+1,o[a].push(d);break;case 10:var m=g.getHours()+(60*g.getMinutes()+g.getSeconds())/3600;m=Number(m.toFixed(5)),o[a].push(m);break;case 11:for(i=0;i<7;i++)g.getDay()==i?o[a+i].push(1):o[a+i].push(0);break;case 12:for(i=0;i<12;i++)g.getMonth()==i?o[a+i].push(1):o[a+i].push(0);break;case 13:o[a].push(dateToString(g,8));break;case 14:o[a].push(dateToString(g,7));break;case 15:o[a].push(getWeekInYear(g));break;case 16:o[a].push(Math.round(daysBetweenDates(r,clearHoursMinutesSeconds(g))))}}}return o},changeTimeResolution=function(e,t,n,r,o){if(null!=e){if(n=null==n?100:n,r=null!=r&&r,o=null==o?0:o,(t=null==t?0:t)!=Math.floor(t)||t<0||t>9)throw new Error("Invalid mode value provided in changeTimeResolution");var i=e.type;if("sL"==e.type?e=toDateList(e):"nL"==e.type&&(e=convertFromDecimalDate(e)),"dL"!=e.type)throw new Error("changeTimeResolution input must be a dL, sL containing dates, or a nL of decimal dates");var s,a,l,u,h=encodeDatesAsNumericFeatures(e,[0,1,2,3,4,5,6,7]),c=h[7].getInterval(),f=convertFromDecimalDate(c.x),p=(convertFromDecimalDate(c.y).getTime()-f.getTime())/1e3,g=[315532800,31536e3,7862400,2678400,604800,86400,3600,60,1];if(0==t)for(t=9,t=9;t>=1;t--){if(r)a=changeTimeResolution(e,t).toNumberList().getWithoutRepetitions().length;else a=p/g[t-1];if(a<=n)break}t<1&&(t=1);var d=new dL;d.name=e.name;var m,y,v,x,w,L,b,_=new sL;_.name=null==e.name?"label":e.name+" label";var M=function(e){return e<10?"0"+e:""+e};for(s=0;s<e.length;s++){switch(m=h[0][s],y=h[1][s]-1,v=h[2][s],x=h[4][s],w=h[5][s],L=h[6][s],t){case 1:m=10*Math.floor(m/10),b=String(m),l=new Date(m,0);break;case 2:l=new Date(m,0),b=String(m);break;case 3:var S=" Q"+(Math.floor(y/3)+1);y=3*Math.floor(y/3),l=new Date(m,y),b=String(m)+S;break;case 4:l=new Date(m,y),b=String(m)+"-"+M(y+1)+"-01";break;case 5:m=(u=new Date(m,y,v-h[3][s])).getFullYear(),y=u.getMonth(),v=u.getDate(),l=new Date(m,y,v),b=String(m)+"-"+M(y+1)+"-"+M(v);break;case 6:l=new Date(m,y,v),b=String(m)+"-"+M(y+1)+"-"+M(v);break;case 7:l=new Date(m,y,v,x),b=String(m)+"-"+M(y+1)+"-"+M(v)+" "+M(x)+":00:00";break;case 8:l=new Date(m,y,v,x,w),b=String(m)+"-"+M(y+1)+"-"+M(v)+" "+M(x)+":"+M(w)+":00";break;case 9:l=new Date(m,y,v,x,w,L),b=String(m)+"-"+M(y+1)+"-"+M(v)+" "+M(x)+":"+M(w)+":"+M(L)}d.push(l),_.push(b)}if("nL"==i?d=d.toNumberList():"sL"==i&&(d=dateToString(d,1)),0==o)return d;var N=new T;if(N.push(d),N.push(_),1==o)return N;a=p/g[t-1];var R={table:N,extra:{numPeriods:a=Number.isInteger(a)?a+1:Math.ceil(a),modeUsed:t,intervalDates:c}};return R.name=e.name+"("+t+")",R}},getElementFromTable=function(e,t,n){return null==e[t]?null:e[t][n]},getSubTable=function(e,t,n,r,o){if(null==e)return e;var i=e.length;if(0===i)return null;var s=new T;r<=0&&(r=i-t+r),t=Math.min(t,i-1),r=Math.min(r,i-t);var a,l,u,h,c,f=e[0].length;if(0===f)return null;for(o<=0&&(o=f-n+o),n=Math.min(n,f-1),o=Math.min(o,f-n),u=t;u<t+r;u++){for(a=e[u],(l=new L).name=e[u].name,h=n;h<n+o;h++)c=a[h],l.push(c);s.push(l.downcast())}return s.downcast()},sliceColumns=function(e,t,n){return"string"==typeof t&&(t=e.getNames().indexOf(t)),null!=n&&"string"==typeof n&&(n=e.getNames().indexOf(n)),e.getSubList(t,n)},filterTable=function(e,t,n,r,o,i,s,a,l){if(null!=e&&0!==e.length&&null!=e[0]){if(e.isList&&!e.isTable){var u=new T;u.push(e),e=u}if(l)return e.getElements(filterList(e.getNames(),t,n,r,o,!0));if(void 0===t&&void 0===n)return s?createSortedNumberList(e[0].length):e;if("!contains"===t&&(void 0===n||""===n))return s?createSortedNumberList(e[0].length):e;null==t&&(t="=c"),"="==t&&(t="=="),t=t.toLowerCase();var h,c,f,p,g,d,m=new nL,y=e.getLengths().getMax(),v=0,x=e.length,w=_typeOf(n),L=null!=r&&!0===r.isList;if(null!=n&&1==n.isList&&n.length>0){var b;a=null==a?0:a,m=filterTable(e,t,n[0],r,o,i,!0);for(var _=1;_<n.length;_++)f=n[_],b=filterTable(e,t,f,r,o,i,!0),m=1==a?intersection(m,b):union(m,b);return s?m:e.getRows(m)}if(L&&r.length!=y)throw new Error("selected L (in listToCheck position) must have same length as table");if(null!=r&&("string"==typeof r&&(r=e.getNames().indexOf(r)),-1==r))throw new Error("do not find any list with such name");null==n?(w="Null",n=""):"string"==w&&String(n)==String(Number(n))&&""!==n.trim()?(w="number",n=Number(n)):"boolean"==w&&(w="string",n=String(n)),"=c"==t&&(t="string"==w?"contains":"=="),"number"!=w||"between"!=t&&"!between"!=t||(isNaN(o)?t="noop":o=Number(o)),"between"!=t&&"!between"!=t||null!=o||(t="noop"),"fuzzy"!=t&&"fuzzywords"!=t||null!=o||(o=50),null!=r&&(v=r,x=r+1),L&&(v=0,x=1),(null==i||!0!==i&&!1!==i)&&(i=!0),"string"==w&&i&&(n=n.toLowerCase(),o=o?String(o).toLowerCase():o),"=="==t&&i&&(t="==i"),"!="==t&&i&&(t="!=i");var M,S=String(n),N=(null==o||String(o),"string"==w),R="number"==w;switch(t){case"==":for(h=0;h<y;h++)for(c=v;c<x;c++)if(!("nL"==(M=L?r:e[c]).type&&N||"sL"==M.type&&R)&&(null==(p=M[h])&&(p=""),p==n)){m.push(h);break}break;case"==i":for(h=0;h<y;h++)for(c=v;c<x;c++)if(("nL"!=(M=L?r:e[c]).type||!N)&&(f=null==M[h]?"":M[h],f="sL"==M.type?f:String(f),(f=i?f.toLowerCase():f)==n)){m.push(h);break}break;case"!=":for(h=0;h<y;h++){for(g=!0,c=v;c<x;c++)if(null==(p=L?r[h]:e[c][h])&&(p=""),p==n){g=!1;break}g&&m.push(h)}break;case"!=i":for(h=0;h<y;h++){for(g=!0,c=v;c<x;c++)if((f=null==(p=L?r[h]:e[c][h])?"":String(p).toLowerCase())==n){g=!1;break}g&&m.push(h)}break;case"contains":for(h=0;h<y;h++)for(c=v;c<x;c++)if(("nL"!=(M=L?r:e[c]).type||!N)&&(f="sL"==M.type?M[h]:String(M[h]),(f=i?f.toLowerCase():f).includes(S))){m.push(h);break}break;case"!contains":for(h=0;h<y;h++){for(g=!0,c=v;c<x;c++)if(p=L?r[h]:e[c][h],(f=i?String(p).toLowerCase():String(p)).includes(S)){g=!1;break}g&&m.push(h)}break;case"init":for(h=0;h<y;h++)for(c=v;c<x;c++)if(p=L?r[h]:e[c][h],0===(f=i?String(p).toLowerCase():String(p)).indexOf(S)){m.push(h);break}break;case"<":case"<=":for(h=0;h<y;h++)for(c=v;c<x;c++)if(p=L?r[h]:e[c][h],w==_typeOf(p)){if((f="string"==w?i?String(p).toLowerCase():String(p):Number(p))<n){m.push(h);break}if(f==n&&"<="==t){m.push(h);break}}break;case">":case">=":for(h=0;h<y;h++)for(c=v;c<x;c++)if(p=L?r[h]:e[c][h],w==_typeOf(p)){if((f="string"==w?i?String(p).toLowerCase():String(p):Number(p))>n){m.push(h);break}if(f==n&&">="==t){m.push(h);break}}break;case"between":for(h=0;h<y;h++)for(c=v;c<x;c++)if(p=L?r[h]:e[c][h],f="string"==w?i?String(p).toLowerCase():String(p):Number(p),"number"==w&&(f=Number(f)),n<=f&&f<=o){m.push(h);break}break;case"!between":for(h=0;h<y;h++)for(c=v;c<x;c++)if(p=L?r[h]:e[c][h],f="string"==w?i?String(p).toLowerCase():String(p):Number(p),"number"==w&&(f=Number(f)),n>f||f>o){m.push(h);break}break;case"unique":var E={};for(h=0;h<y;h++){var O="";for(c=v;c<x;c++)p=L?r[h]:e[c][h],O=O+"|"+(f=i?String(p).toLowerCase():String(p));null==E[O]&&(E[O]=!0,m.push(h))}break;case"fuzzy":case"fuzzywords":if(""==(n=String(n).trim()))break;o=Number(o);var C,D,P,I=new nT(2);for(h=0;h<y;h++)for(c=v;c<x;c++){for(p=L?r[h]:e[c][h],f=i?String(p).toLowerCase():String(p),C="fuzzywords"==t?f.split(" "):[f],D=0,P=0;P<C.length&&D<o;P++)d=100*(1-getLevenshteinDistance(C[P],n,!0)),D=Math.max(D,d);if(D>=o){I[0].push(h),I[1].push(D);break}}m=(I=I.sortRowsByList(1,!1,!0))[0];break;default:if("function"==typeof t)for(h=0;h<y;h++)for(c=v;c<x;c++)if(t.call(this,e[c][h],n,o,r,e,c,h,i)){m.push(h);break}}if(s)return m;var k=new T;k.name=e.name;var F=e.length;for(c=0;c<F;c++)k.push(e[c].getElements(m,!0));return k.downcast()}},filterColumns=function(e,t,n,r,o,i){if(null!=e){for(var s,a,l=new T,u=0;u<e.length;u++)if(s=e[u],a=buildInformationObjectForList(s,!0),!(null!=t&&a.numberDifferentElements<t||null!=n&&a.numberDifferentElements/s.length>n||null!=r&&a.entropy<r||null!=o&&a.entropy>o)){switch(i){case 0:if(!a.isNumeric)continue;break;case 1:if("sL"!=s.type)continue;break;case 2:if(!a.isCategorical)continue;break;case 3:if("integer numbers"!=a.kind)continue;break;case 4:if(a.containsNulls)continue;break;case 5:if(s.includes("")||s.includes(" ")||s.includes("  "))continue;break;case 6:if("nL"!=s.type&&!a.isCategorical)continue}l.push(s)}return l.downcast()}},getSubTableByElementOnList=function(e,t,n){if(null!=e&&null!=t&&null!=n){var r,o,i=e.length;t<0&&(t=i+t),t%=i;var s=instanceSameType(e);for(s.name=e.name,r=0;r<i;r++){var a=new L;a.name=e[r].name,s.push(a)}var l,u=e[t],h=u.length;for(r=0;r<h;r++)if(n==u[r])for(l=s.length,o=0;o<l;o++)s[o].push(e[o][r]);for(i=s.length,r=0;r<i;r++)s[r]=s[r].downcast();return s.downcast()}},getSubTableByElementsOnList=function(e,t,n){if(null!=e&&null!=t&&null!=n){var r,o;t<0&&(t=e.length+t),t%=e.length;var i=instanceSameType(e);i.name=e.name,e.forEach((function(e){var t=new L;t.name=e.name,i.push(t)}));var s=e[t],a=getBooleanDictionaryForList(n);for(r=0;null!=s[r];r++)if(a[s[r]])for(o=0;null!=i[o];o++)i[o].push(e[o][r]);return i.forEach((function(e,t){i[t]=e.downcast()})),i.downcast()}},getRandomRows=function(e,t,n,r,o){if(null==e||null==e[0])return null;if(n=null==n||n,null==t&&(t=.5),t<0)return null;var i,s=e[0].length;i=t<=1?Math.round(t*s):Math.round(t);var a=createSortedNumberList(s,0,1);return a=a.getRandomElements(i,n,o),r||(a=a.getSorted()),e.getRows(a)},transpose=function(e,t,n){return null!=e&&e.isTable?e.transpose(t,n):null},replaceElementInTable=function(e,t,n){if(null!=e){var r,o,i,s,a,l=e.length,u=new T;for(o=0;o<l;o++){for(r=(s=e[o]).length,a=new L,u[o]=a,i=0;i<r;i++)a[i]=s[i]==t?n:s[i];(a=a.downcast()).name=s.name}return u.downcast()}},replaceSectionInTable=function(e,t,n,r,o,i){if(null!=e){var s,a,l,u=null!=n&&n==r,h=null!=o&&o==i;if(null==n&&(n=0),null==r&&(r=e.length-1),null==o&&(o=0),null==i&&(i=e[0].length-1),"string"!=typeof n&&"string"!=typeof r||(s=e.getNames()),"string"==typeof n&&(n=s.indexOf(n)),"string"==typeof r&&(r=s.indexOf(r)),u&&h)return t.isList&&(t=t[0]),t.isList&&(t=t[0]),replaceCellInTable(e,t,n,o);if(u){var c=new T;for(t.isTable&&(t=t[0]),a=0;a<e.length;a++)if(a==n){for(c[a]=new L,c[a].name=e[a].name,l=0;l<e[a].length;l++)c[a][l]=l<o||l>i?e[a][l]:t[l-o];c[a]=c[a].downcast()}else c[a]=e[a];return c.downcast()}if(h){for(c=new T,t.isTable&&(t=t.getRow(0)),a=0;a<e.length;a++)a<n||a>r?c[a]=e[a]:(c[a]=e[a].clone(),c[a][o]=t[a-n],c[a]=c[a].downcast());return c.downcast()}for(c=new T,r=Math.min(r,n+t.length),i=Math.min(i,o+t[0].length),a=0;a<e.length;a++)if(a<n||a>r)c[a]=e[a];else{for(c[a]=new L,c[a].name=e[a].name,l=0;l<e[a].length;l++)c[a][l]=l<o||l>i?e[a][l]:t[a-n][l-o];c[a]=c[a].downcast()}return c.downcast()}},replaceNullsInTable=function(e,t,n,r,o,i){if(null!=e){null!=r&&(t=null==t?0:t),null!=o&&(n=null==n?0:n),r=null==r&&null!=t?0:r,o=null==o&&null!=n?"-":o;var s,a,l,u,h,c,f,p=e.length,g=null!=t&&t.length&&t.isList?t:null,d=null!=o&&o.length&&o.isList?o:null,m=new T;if(g){p=Math.min(p,g.length);var y={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,element:0,previous:1,next:2,average:3,"local average":4,interpolate:5,common:6,median:7}}for(a=0;a<p;a++){for(s=(u=e[a]).length,c=!1,f=!1,l=0;l<s;l++)if(u[l]==i)f=!0;else if("number"!=typeof u[l]&&(c=!0,f))break;f?(h=g?replaceNullsInList(u,y[g[a]],d?d[a%p]:o,i):c?replaceNullsInList(u,3==n?6:n,o,i):replaceNullsInList(u,t,r,i),m[a]=h):m[a]=u}return m.downcast()}},testClassificationModel=function(e,t,n,r){if(null==e||null==t||null==n)return null;r=r||0;var o=0;return t.forEach((function(t,r){n(e[0][r],e[1][r])!=t&&o++})),o/t.length},getRows=function(e,t){var n,r,o=new T;o.name=e.name;for(var i=0;null!=e[i];i++){(r=instanceSameType(n=e[i])).name=n.name;for(var s=0;null!=t[s];s++)r[s]=n[t[s]];o[i]=r.downcast()}return o},sortListsByNumberList=function(e,t,n){null==n&&(n=!0);var r=instantiate(_typeOf(e));r.name=e.name;var o,i=e.length,s=t.clone();for(o=0;o<s.length;o++)s[o]=o;for(s=sortListByNumberList(s,t,n),o=0;o<i;o++){r[o]=e[o].clone();for(var a=0;a<s.length;a++)r[o][a]=e[o][s[a]]}return r},aggregateTable=function(e,t,n,r,o,i,s,a){if(t=t||0,null!=e&&(null==n&&(n=createSortedNumberList(e.length)),null==r&&(r=createListWithSameElement(e.length,9)),"sL"==n.type&&(n=e.getNames().indexesOfElements(n)),"nL"!=n.type&&Array.isArray(n)&&(n=nL.toL(n)),"string"==typeof t&&(t=e.getNames().indexOf(t)),e.length&&!(e.length<t)&&null!=n&&n.length&&null!=r)){if(null!=s&&3==s.length){var l;n=n.clone(),r=r.clone();for(var u=0;u<e.length;u++)n.includes(u)||(n.push(u),(l=buildInformationObjectForList(e[u])).isNumericCategorical?r.push(s[0]):l.isNumeric?r.push(s[1]):r.push(s[2]))}if(null!=t.length)if(t.length==e[0].length)x=t;else{if(0!=t.length){var h,c,f=e.getColumns(t),p=(f.getTypes(),new sL);for(b=f[0].length,u=0;u<b;u++){for(h=f[0][u],c=1;c<f.length;c++)h+="*__*"+f[c][u];p[u]=h}L=new T.toL([p].concat(e.getElements(n)));var g=new nL,d=new nL;g[0]=0,d[0]=0,null!=o&&(o=o.clone()).unshift("_");for(u=0;u<n.length;u++)g.push(n[u]+1),d.push(r[u]);var m=createSortedNumberList(L.length-1,1);return L=aggregateTable(L,0,m,d,o)}t=t[0]}var y,v,x=null==x?e[t]:x,w=getIndexesTable(x),L=new T,b=n.length;for(u=0;u<b;u++)v=e[n[u]],y=aggregateList(x,v,u<r.length?r[u]:1,w,i,a)[1],o&&u<o.length?y.name=o[u]:y.name=v.name,L.push(y);return L.downcast()}},disAggregateTable=function(e,t,n,r=","){if(null!=e&&null!=n){"number"==typeof t&&(t=[t]);var o=null==t?e:e.getColumns(t),i=e.get(n),s=new L;s.name=i.name;for(var a,l=new T,u=0;u<o.length;u++)l[u]=instanceSameType(o[u]),l[u].name=o[u].name;for(l.push(s),u=0;u<o[0].length;u++){a=sL.toL(String(i[u]).split(r)).trim();for(var h=0;h<a.length;h++){for(var c=0;c<o.length;c++)l[c].push(o[c][u]);s.push(String(Number(a[h]))==a[h]?Number(a[h]):a[h])}}return s=s.downcast(),l}},deSegmentTable=function(e,t,n){for(var r=normalizeToSum(t,(n=null==n?10:n)*t.length),o=new T,i=0;i<e.length;i++)o[i]=instanceSameType(e[i]),o[i].name=e[i].name;var s=new nL;o.push(s),s.name="weight per item";var a,l,u=new nL;o.push(u),u.name="count repetitions segment";for(var h=0;h<r.length;h++){a=Math.round(r[h]),l=t[h];for(var c=0;c<a;c++){for(i=0;i<e.length;i++)o[i].push(e[i][h]);s.push(l/a),u.push(a)}}return o},pivotTable=function(e,t,n,r,o,i,s,a,l){if(null!=e&&e.length&&null!=t&&null!=n&&null!=r){var u,h,c,f=t.isList?t:e.get(t),p=n.isList?n:e.get(n);switch(r=r.isList?r:e.get(r),o=null==o?1:o,s=s||0,i){case 0:case 3:l=null;break;case 1:l=0}var g,d,m=new T;if(1==s){var y={},v={};switch(f.forEach((function(e,t){u=p[t],h=String(e)+""+String(u),null==y[h]&&(y[h]=new nL,v[h]=new L),y[h].push(t),v[h].push(r[t])})),m[0]=new L,m[1]=new L,o){case 0:m[2]=new L;break;case 1:case 2:case 3:m[2]=new nL}for(h in y)switch(c=y[h],m[0].push(f[c[0]]),m[1].push(p[c[0]]),o){case 0:m[2].push(r[c[0]]);break;case 1:m[2].push(c.length);break;case 2:case 3:g=0,c.forEach((function(e){g+=r[e]})),3==o&&(g/=c.length),m[2].push(g)}if(m[0]=m[0].downcast(),m[1]=m[1].downcast(),0===o)m[2]=m[2].downcast();return m[0].name=f.name,m}m[0]=new L;var x,w,b,_,M={},S={};f.forEach((function(e,t){if(u=p[t],b=r[t],null==(w=M[String(e)])&&(m[0].push(e),w=m[0].length-1,M[String(e)]=w),null==(x=S[String(u)])){switch(o){case 0:case 1:case 2:case 3:case 4:case 5:_=new L}m.push(_),_.name=String(u),x=m.length-1,S[String(u)]=x}switch(o){case 0:null==m[x][w]&&(m[x][w]=b);break;case 1:null==m[x][w]&&(m[x][w]=0),m[x][w]++;break;case 2:null==m[x][w]&&(m[x][w]=0),m[x][w]+=b;break;case 3:null==m[x][w]&&(m[x][w]=[0,0]),m[x][w][0]+=b,m[x][w][1]++;break;case 4:null==m[x][w]&&(m[x][w]=b),m[x][w]=Math.min(b,m[x][w]);break;case 5:null==m[x][w]&&(m[x][w]=b),m[x][w]=Math.max(b,m[x][w])}}));var N=!1;switch(o){case 0:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(e,t){null==m[d][t]&&(m[d][t]=l)})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0);break;case 1:case 2:case 4:case 5:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(e,t){null==m[d][t]&&(m[d][t]=l)})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0);break;case 3:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(e,t){null==m[d][t]?m[d][t]=l:m[d][t]=m[d][t][0]/m[d][t][1]})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0)}if(i&&N&&(m=replaceNullsInTable(m,5)),1==a){var R=m.slice(1),E=m.getNames().getSubList(1);"nL"==p.type&&(E=E.toNumberList()),R=L.toL(R).getSortedByList(E);var O=new T;return O[0]=m[0],m=O.concat(R)}return m[0]=m[0].downcast(),m.downcast()}},unpivotTable=function(e,t,n){var r,o=e.get(t),i=e.getColumns(n),s=new T;s[0]=new L,s[0].name=o.name,s[1]=new sL,s[1].name="variables",s[2]=new L,s[2].name="value";for(var a=0;a<o.length;a++){r=o[a];for(var l=0;l<i.length;l++)s[0].push(r),s[1].push(i[l].name),s[2].push(i[l][a])}return s[0]=s[0].downcast(),s[2]=s[2].downcast(),s.downcast()},getCountPairsMatrix=function(e,t,n,r,o){if(null==e||e.length<2||null==e[0]||null==e[0][0])return null;var i,s;if(t=null!=t&&t,n=null==n?0:n,0==(r=null==r?0:r))i=e[0].getWithoutRepetitions(),s=e[1].getWithoutRepetitions(),t&&(i=(i=i.concat(s)).getWithoutRepetitions(),s=i);else if(1==r)if(t){var a=(i=e[0].concat(e[1])).getFrequenciesTable(!0);s=i=a[0]}else{a=e[0].getFrequenciesTable(!0);i=a[0],a=e[1].getFrequenciesTable(!0),s=a[0]}else if(2==r){if(t)a=(a=(i=e[0].concat(e[1])).getFrequenciesTable(!0)).sortRowsByList(0,!0),s=i=a[0];else a=(a=e[0].getFrequenciesTable(!0)).sortRowsByList(0,!0),i=a[0],a=(a=e[1].getFrequenciesTable(!0)).sortRowsByList(0,!0),s=a[0]}if(null!=o&&!isNaN(o)&&o>0){var l=createSortedNumberList(o);i.length>o&&(i=i.getElements(l)),s.length>o&&(s=s.getElements(l))}var u,h,c=new nT(s.length);if(s.forEach((function(e,t){c[t].name=String(e),i.forEach((function(e,n){c[t][n]=0}))})),e[0].forEach((function(t,n){var r=e[1][n];h=s.indexOf(r),-1!=(u=i.indexOf(t))&&-1!=h&&c[h][u]++})),0!=n){for(var f=0,p=0;p<c.length;p++)c[p]._max=c[p].getMax(),f=Math.max(f,c[p]._max);if(1==n&&0!=f)for(p=0;p<c.length;p++)for(var g=0;g<c[p].length;g++)d=(f-c[p][g])/f,c[p][g]=Number(d.toFixed(5));else if(2==n&&0!=f){var d;for(p=0;p<c.length;p++)for(g=0;c[p]._max>0&&g<c[p].length;g++)d=(c[p]._max-c[p][g])/c[p]._max,c[p][g]=Number(d.toFixed(5))}else if(3==n){var m;for(g=0;g<c[0].length;g++){m=0;for(p=0;p<c.length;p++)m+=c[p][g];for(p=0;0!=m&&p<c.length;p++)d=c[p][g]/m,c[p][g]=Number(d.toFixed(5))}}}var y=new T;return i.name=e[0].name,y.push(i),c=y.concat(c)},getPairsFrequencyTable=function(e){if(null==e||e.length<2||null==e[0]||null==e[0][0]||e[0].length!=e[1].length)return null;for(var t={},n=0;n<e[0].length;n++){var r=t[e[0][n]];null==r&&(r={sL:new L,c:0,s:e[0][n]},t[e[0][n]]=r),r.sL.push(e[1][n]),r.c++}var o=[];for(r in t)o.push(t[r]);o=o.sort((function(e,t){var n=t.c-e.c;return 0!=n?n:e.s<t.s?1:-1}));var i,s=new T;for(s[0]=instanceSameType(e[0]),s[0].name=""==e[0].name?"L 1":e[0].name,s[1]=instanceSameType(e[1]),s[1].name=""==e[1].name?"L 2":e[1].name,s[2]=new nL,s[2].name="Combination Frequency",n=0;n<o.length;n++){i=(r=o[n]).sL.getFrequenciesTable(!0);for(var a=0;a<i[0].length;a++)s[0].push(r.s),s[1].push(i[0][a]),s[2].push(i[1][a])}return s},concatenateRowElements=function(e,t){if(null==e||!e.isTable)return null;t=null==t?" ":t;var n,r,o,i=new i,s=e.getLengths().getMax(),a=!0;for(r=0;r<s;r++){for(n="",o=0;o<e.length;o++)o>0&&(n+=t),void 0!==e[o][r]&&(n+=String(e[o][r]),0==r&&(o>0&&(i.name+=t),i.name+=String(e[o].name),a=a&&0==String(e[o].name).length));i.push(n)}return a&&(i.name=""),i},filterTableByElementInList=function(e,t,n,r){if(!(null==e||e.length<=0||null==t)){if(null==n)return e;if(r=null==r||r,"string"==typeof t){var o=e.getNames().indexOf(t);if(-1==o)throw new Error("The table doesn't contain a list with name "+t);t=o}var i,s,a=new T,l=e.length,u=e[0].length;for(a.name=e.name,s=0;s<l;s++)a[s]=instanceSameType(e[s]),a[s].name=e[s].name;if(r){for(i=0;i<u;i++)if(e[t][i]==n)for(s=0;s<l;s++)a[s].push(e[s][i])}else for(i=0;i<u;i++)if(e[t][i]!=n)for(s=0;s<l;s++)a[s].push(e[s][i]);for(s=0;s<l;s++)"nL"!=a[s].type&&(a[s]=a[s].downcast());return a}},filterTableByElementsInList=function(e,t,n,r){if(!(null==e||e.length<=0||null==t)){if(null==n||0===n.length)return e;if(r=null==r||r,"string"==typeof t){var o=e.getNames().indexOf(t);if(-1==o)throw new Error("The table doesn't contain a list with name "+t);t=o}var i,s,a=getBooleanDictionaryForList(n),l=new T,u=e.length,h=e[0].length;for(l.name=e.name,s=0;s<u;s++)l[s]=new L,l[s].name=e[s].name;if(r){for(i=0;i<h;i++)if(a[e[t][i]])for(s=0;s<u;s++)l[s].push(e[s][i])}else for(i=0;i<h;i++)if(!a[e[t][i]])for(s=0;s<u;s++)l[s].push(e[s][i]);for(s=0;s<u;s++)l[s]=l[s].downcast();return l}},selectRows=function(e,t,n,r,o){if(!(null==e||e.length<=0)){if(r=null==r||r,o=null!=o&&o,null==t||null==n||null==t.length)return r?e:null;if(Array.isArray(n)||(n=[n]),t.length==n.length||1==t.length){var i=new nL,s=e[0].length,a=1==t.length&&n.length>1,l={};a&&(l=getBooleanDictionaryForList(n));for(var u=0;u<s;u++){for(var h=!0,c=0;c<t.length&&h;c++){if(isNaN(t[c])||t[c]<0||t[c]>=e.length)return;e[t[c]][u]!=n[c]&&(h=!1,a&&l[e[t[c]][u]]&&(h=!0))}h&&i.push(u)}if(o){if(r)return i;var f=createSortedNumberList(e[0].length);return difference(f,i)}return r?e.getRows(i):e.getWithoutRows(i)}}},joinTables=function(e,t,n,r,o){if(null!=e&&null!=t){var i,s,a=new T;if(n=null==n?0:n,r=null==r?0:r,2==(o=null==o?0:o)){var l=joinTables(t,e,r,n,1),u=[0];for(let e=t.length;e<l.length;e++)u.push(e);for(let e=1;e<t.length;e++)u.push(e);return l.getColumns(u).downcast()}if("string"==typeof n){if(null==(i=e.get(n)))throw Error("the table doesn't contain a list with name "+n);n=e.indexOf(i)}else n<0&&(n+=e.length),i=e[n%=e.length];if("string"==typeof r){if(null==(s=t.get(r)))throw Error("the table doesn't contain a list with name "+r);r=t.indexOf(s)}else r<0&&(r+=t.length),s=t[r%=t.length];var h,c,f,p,g,d,m=getIndexesDictionary(s),y=e.length,v=t.length,x=i.length,w=new L;for(w.name=i.name,a[0]=w,g=0;g<y;g++)g!=n&&((d=new L).name=e[g].name,d._list0=!0,d._listOnTable=e[g],a.push(d));for(g=0;g<v;g++)g!=r&&((d=new L).name=t[g].name,d._list0=!1,d._listOnTable=t[g],a.push(d));for(f=0;f<x;f++)if(null!=(c=m[h=i[f]]))for(p=0;p<c.length;p++)for(w.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?a[g]._listOnTable[f]:a[g]._listOnTable[c[p]]);else if(1==o||3==o)for(w.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?a[g]._listOnTable[f]:null);if(3==o){var b=getBooleanDictionaryForList(i);for(f=0;f<s.length;f++)if(!b[h=s[f]])for(w.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?null:a[g]._listOnTable[f])}for(f=0;f<a.length;f++)delete a[f]._list0,delete a[f]._listOnTable,a[f]=a[f].downcast();return a.downcast()}},joinMultipleTables=function(e,t,n){if(null!=e&&null!=t){if(e.length<2)throw new Error("listOfTables must have at least two tables");if(t.length!=e.length)throw new Error("listOfIndexes must have same length as listOfTables");if(null==e[0])throw new Error("listOfTables[0] is null");if(null==e[1])throw new Error("listOfTables[1] is null");var r,o=joinTables(e[0],e[1],t[0],t[1],n),i=e.length;for(r=2;r<i;r++)o=joinTables(o,e[r],0,t[r],n);return o}},combineLists=function(e,t){if(null==e)return null;t=null==t||t;for(var n=new T,r=new T,o=new nL,i=new nL,s=1,a=0;a<e.length;a++)r[a]=new L,n[a]=e[a].getWithoutRepetitions(),o[a]=0,i[a]=n[a].length,s*=i[a];if(t||s>1e5)return s;for(a=0;a<s;a++){for(var l=0;l<e.length;l++)r[l].push(n[l][o[l]]);var u=!0;for(o[l=0]++,u=o[l]>=i[l];u&&l<e.length;)o[l]=0,o[l+1]++,u=o[++l]>=i[l]}for(l=0;l<e.length;l++)r[l]=r[l].downcast();return r.downcast()},completeTable=function(e,t,n){n=void 0===n?0:n;var r,o,i,s=new T;s.name=e.name;for(var a=0;a<e.length;a++){for((o=null==(r=e[a])?getNewListForObjectType(n):instanceSameType(r)).name=null==r?"":r.name,i=0;i<t;i++)o[i]=null==r||null==r[i]?n:r[i];s[a]=o}return s},getNumberTableFromTable=function(e){if(null==e||e.length<=0)return null;var t,n=new nT;for(n.name=e.name,t=0;null!=e[t];t++)"nL"==e[t].type&&n.push(e[t]);return n},getVariablesInformationGain=function(e,t){if(null==e)return null;var n=new nL;return e.forEach((function(e){n.push(getInformationGain(e,t))})),n},splitTableByCategoricList=function(e,t,n){if(null==e||null==t)return null;var r,o=t.isList?t:e.get(t),i=new L,s={};return o.forEach((function(t,n){null==(r=s[t])&&((r=new T).name=String(t),s[t]=r,i.push(r),e.forEach((function(e,t){r[t]=instanceSameType(e),r[t].name=e.name})),r._element=t),e.forEach((function(t,o){r[o].push(e[o][n])}))})),n?s:i},buildCorrelationsNetwork=function(e,t,n,r,o,i,s,a,l){if(null==e)return null;var u,h;t=null==t||Boolean(t),o=null==o?.9:o,i=Boolean(i),s=null==s?0:s,l=null==l?3:l;var c,f,p,g,d,m,y,v,x,w,b,T=e.length,_=e[0].length,M=!1,S=!1,N=new Net,R=new sL,E=t?_:T,O=0,C=0;for(u=0;u<T;u++)"nL"==(w=e[u].type)?(R[u]="numbers",O++):"sL"==w&&e[u].getWithoutRepetitions().length/e[u].length>.8?(R[u]="texts"):(R[u]="categories",C++);if(null!=r&&null!=(v=r.isList?r:e.get(r))&&(x="cL"===v.type?v:"nL"===v.type?createColorListFromNumberList(v,blueToRed,0):createCategoricalColorListForList(v)[0].value),null!=a&&(b=new nL,"number"==_typeOf(a)?a<=T&&"nL"!=(b=e[a]).type&&(b=null):a.isList&&"nL"==a.type&&a.length>=E&&(b=a)),null==n||n.isList||(n=e.get(n)),t){for(u=0;u<_;u++){for((c=new Nd(g="_"+u,null==n?g:n[u])).i=u,c.row=e.getRow(u),c.numbers=new nL,c.categories=new L,c.texts=new sL,null!=x&&(c.color=x[u]),null!=b&&(c.weight=b[u]),h=0;h<T;h++)switch(R[h]){case"numbers":c.numbers.push(c.row[h]),S=!0;break;case"categories":c.categories.push(c.row[h]),M=!0;break;case"texts":c.texts.push(c.row[h]),!0}0===s?c.numbers.sd=c.numbers.getStandardDeviation():c.numbers.norm=c.numbers.getNorm(),N.addNode(c)}var D;for(u=0;u<_;u++){for(c=N.nodes[u],D=new nL,h=0;h<_;h++)2!=s&&h<u+1||(f=N.nodes[h],d=S?0===s?numericCorrelation(c.numbers,f.numbers,c.numbers.sd,f.numbers.sd):cosineSimilarity(c.numbers,f.numbers,c.numbers.norm,f.numbers.norm):0,m=M?2*Math.pow(jaccardIndex(c.categories,f.categories),.2)-1:0,y=S&&M?(d*O+m*C)/(O+C):S?d:m,2==s?D.push(u==h?0:y):(i&&Math.abs(y)>o||!i&&y>o)&&((p=new Rel(g=u+"_"+h,null==n?g:c.name+"_"+f.name,c,f,Math.abs(y)-.9*o)).color=y>0?"blue":"red",p.pearson=d,p.jaccard=m,N.addRelation(p)));if(2==s){var P=N.nodes.getSortedByList(D,!1);for(D=D.getSorted(!1),h=0;h<l;h++)p=new Rel(g=u+"_"+(f=P[h]).id,null==n?g:c.name+"_"+f.name,c,f,D[h]),N.addRelation(p)}}}else if("nT"==e.type){for(u=0;u<T;u++)c=new Nd("list_"+u,null==e[u].name||""==e[u].name?"list_"+u:e[u].name),N.addNode(c),c.i=u,c.numbers=e[u],null!=x&&(c.color=x[u]),null!=b&&(c.weight=b[u]);for(u=0;u<T;u++)for(c=N.nodes[u],h=u+1;h<T;h++)f=N.nodes[h],y=d=numericCorrelation(c.numbers,f.numbers),(i&&Math.abs(y)>o||!i&&y>o)&&((p=new Rel(g=u+"_"+h,c.name+"_"+f.name,c,f,Math.abs(y)-.9*o)).color=y>0?"blue":"red",p.pearson=d,N.addRelation(p))}return N},buildSimpleDecisionTree=function(e,t,n,r,o,i,s,a){if(null!=e&&null!=t){for(var l,u,h=new T,c=t.isList?t:e.get(t),f=0;f<e.length;f++)e[f]!=c&&((l=buildInformationObjectForList(e[f],!0)).isCategorical?h.push(e[f]):l.isNumeric&&(u=e[f].getQuantiles(3,3),h.push(u)));return l=buildInformationObjectForList(c,!0),buildDecisionTree(h,c,n,r,o,i,s,a)}},buildDecisionTree=function(e,t,n,r,o,i,s,a){if(null!=e&&null!=t){if(null==a&&(a=blueWhiteRed),"number"==_typeOf(t)){var l=e.getWithoutElementAtIndex(t);t=e.get(t),e=l}r=null==r?.1:r,o=o||10,i=i||.002;var u=createSortedNumberList(t.length),h=new Tr;return h.supervisedValue=n,null==n&&(h._colorDic=createCategoricalColorListForList(t)[4].value),_buildDecisionTreeNode(h,e,t,0,r,o,i,null,null,n,u,s,a),h.leavesWeights=h.getLeaves().getPropertyValues("weight"),h.sumWeightsLeaves=h.leavesWeights.getSum(),h.supervised=t,h}},_buildDecisionTreeNode=function(e,t,n,r,o,i,s,a,l,u,h,c,f){var p=null==u;if(p){var g=n.getFrequenciesTable(!0);u=g[0][0]}var d=getListEntropy(n,u),m=0,y=0,v=0;d>=o&&(v=getVariablesInformationGain(t,n)).forEach((function(e,t){e>m&&(m=e,y=t)}));var x=d>=o&&m>s&&n.length>=i&&r<9&&n._P_valueFollowing>0&&n._P_valueFollowing<1,w=new Nd(e.nodes.getNewId(),(null==l?"":l+":")+(x?t[y].name:"P="+n._biggestProbability+"("+n._mostRepresentedValue+")"));if(e.addNodeToTree(w,a),null==a&&(e.informationGainTable=new T,e.informationGainTable[0]=t.getNames(),v&&(e.informationGainTable[1]=v.clone(),e.informationGainTable=e.informationGainTable.sortRowsByList(v,!1))),w.entropy=d,w.weight=n.length,w.supervised=n,w.supervisedValue=u,w.indexes=w.indexesOnTable=h,w.value=l,w.fromList=null==a?"":a.bestFeatureName,w.mostRepresentedValue=n._mostRepresentedValue,w.biggestProbability=n._biggestProbability,w.valueFollowingProbability=n._P_valueFollowing,w.lift=w.valueFollowingProbability/e.nodes[0].valueFollowingProbability,w.i=e.nodes.length-1,""==w.fromList)w.filter={};else{if(w.filter={column:w.fromList},w.value&&w.value.includes&&w.value.includes("-")){var L=w.value.split("-");String(Number(L[0]))==L[0]&&String(Number(L[1]))==L[1]&&(w.filter.type="range",w.filter.value=[!0,Number(L[0]),!0,Number(L[1])])}null==w.filter.type&&(w.filter.type="in_array",w.filter.value=[w.value])}w.filters=[];var b=function(e){e.parent&&b(e.parent),e.filter.column&&w.filters.push(e.filter)};if(b(w),p){for(var _=new cL,M=0;M<g[0].length;M++)_[M]=e._colorDic[g[0][M]];w._color=w.color=interpolateColors("white",colorsLinearCombination(_,g[1]),w.valueFollowingProbability)}else w._color=w.color=f(1-w.valueFollowingProbability);if(c){var S=document.createElement("canvas");S.width=150,S.height=100;var N=S.getContext("2d");N.clearRect(0,0,150,100),_decisionTreeGenerateColorsMixture(N,150,100,["blue","red"],w.mostRepresentedValue==u?[Math.floor(w.biggestProbability*w.weight),Math.floor((1-w.biggestProbability)*w.weight)]:[Math.floor((1-w.biggestProbability)*w.weight),Math.floor(w.biggestProbability*w.weight)]);var R=new Image;R.src=S.toDataURL(),w.pattern=N.createPattern(R,"repeat")}if(!x)return w.isLeaf=!0,w.label=Math.floor(100*w.valueFollowingProbability)/100,w;w.isLeaf=!1,w.bestFeatureName=t[y].name,w.bestFeatureName=""===w.bestFeatureName?"list "+y:w.bestFeatureName,w.iBestFeature=y,w.informationGain=m,w.label=w.bestFeatureName;var E,O,C,D=t.concat([n,h]);return splitTableByCategoricList(D,t[y]).forEach((function(t){E=t.getSubList(0,t.length-3),O=t[t.length-2],C=t[t.length-1],_buildDecisionTreeNode(e,E,O,r+1,o,i,s,w,t._element,p?null:u,C,c,f)})),w.to=w.to.getSortedByProperty("valueFollowingProbability",!1),w},_decisionTreeGenerateColorsMixture=function(e,t,n,r,o){var i,s,a,l=createListWithSameElement(o[0],r[0]);for(a=1;null!=r[a];a++)l=l.concat(createListWithSameElement(o[a],r[a]));for(i=0;i<t;i++)for(s=0;s<n;s++)a=4*(i+s*t),e.fillStyle=l.getRandomElement(),e.fillRect(i,s,1,1)},allListsSameLength=function(e){if(null==e)return null;var t,n=e.length,r=e[0].length;for(t=1;t<n;t++)if(e[t].length!=r)return!1;return!0},getListsWithoutRepetition=function(e){if(null!=e){var t,n=e.length,r=new T;for(t=0;t<n;t++)r[t]=e[t].getWithoutRepetitions();return r.downcast()}},getNumberOfDifferentElementsOfLists=function(e,t){if(null!=e){var n,r=e.length,o=new nL;for(o.name="(proportion)",n=0;n<r;n++)o[n]=e[n].countDifferentElements(),t&&(o[n]/=e[n].length);return o}},buildInformationObjectForTable=function(e,t){if(null!=e){if(1==(t=null==t||t)&&null!=e.infoObject)return e.infoObject;var n,r,o=e.length,i=999999999999,s=-999999999999,a=0,l=!0,u={type:e.type,name:e.name,length:o,kind:"mixed",allListsSameLength:!0,allListsSameSize:!0,allListsSameType:!0,allListsSameKind:!0,listsInfoObjects:new L,names:new sL,lengths:new nL,types:new sL,kinds:new sL};for(n=0;n<o;n++)r=buildInformationObjectForList(e[n],t),u.listsInfoObjects[n]=r,r.containsNulls&&(u.containsNulls=!0),u.names[n]=r.name,u.types[n]=r.type,u.kinds[n]=r.kind,u.lengths[n]=r.length,"categories"!=r.kind&&"integer numbers"!=r.kind&&(l=!1),n>0&&(u.lengths[n]!=u.lengths[n-1]&&(u.allListsSameLength=!1),u.types[n]!=u.types[n-1]&&(u.allListsSameType=!1),u.kinds[n]!=u.kinds[n-1]&&(u.allListsSameKind=!1),u.lengths[n]!=u.lengths[n-1]&&(u.allListsSameType=!1)),"nL"==r.type&&(i=Math.min(i,r.min),s=Math.min(s,r.max),a+=r.average);if(0!==a&&(a/=u.length),u.allListsSameLength)u.minLength=u.lengths[0],u.maxLength=u.lengths[0],u.averageLength=u.lengths[0];else{var h=u.lengths.getInterval();u.minLength=h.x,u.maxLength=h.y,u.averageLength=.5*(h.x+h.y)}if(u.allListsSameKind)switch(u.kinds[0]){case"numbers":u.kind="numbers";break;case"integer numbers":u.kind="integer numbers";break;case"texts":u.kind="texts";break;case"categories":u.kind="categories"}else l?u.kind="integers and categories":u.allListsSameType&&"nL"==u.types[0]&&(u.kind="numbers");return e.infoObject=u,u}},getCategoricalLists=function(e){buildInformationObjectForTable(e);for(var t=new T,n=0;n<e.length;n++)e[n].infoObject.isCategorical&&t.push(e[n]);return t.downcast()},getTableSimplified=function(e,t,n,r){if(null==e||!(e.length>0))return null;var o;t=t||20;var i=e.length,s=new T;for(s.name=e.name,o=0;o<i;o++)s.push("nL"===e[o].type?e[o].getNumbersSimplified(1==r?6:2,t):e[o].getSimplified(t,n));return s.downcast()},concatTables=function(e,t){if(null!=e&&null!=t&&e.length==t.length){for(var n=new T,r=0;r<e.length;r++)n[r]=e[r].concat(t[r]),n[r].name=e[r].name;return n.downcast()}},concatRows=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var e,t,n,r,o,i=0;for(e=0;e<arguments.length;e++)if(null!=arguments[e]&&(i=Math.max(i,arguments[e].length),!arguments[e].isTable))return null;for(e=0;e<arguments.length;e++)if(null!=arguments[e]){var s=(n=arguments[e]).getLengths(),a=s.getMax(),l=s.getMin();for(a!=l&&(n=completeTable(n,a,null));n.length<i;)n.push(createListWithSameElement(a,null,""));if(0==e)r=n.clone();else for(t=0;t<r.length;t++)o=r[t].name,r[t]=r[t].concat(n[t]),r[t].name=""!=o?o:n[t].name}return r},concatLists=function(e){if(null!=e){for(var t=e[0],n=1;n<e.length;n++)t=t.concat(e[n]);return t}},unionListsFromTables=function(e){if(null!=e){var t,n,r,o=e[0].getWithoutRepetitions(),i=e.length;for(t=1;t<i;t++)for(r=e[t].length,n=0;n<r;n++)o.includes(e[t][n])||o.push(e[t][n]);return o}},intersectListsFromTables=function(e){if(null!=e){var t,n=e[0].getWithoutRepetitions(),r=e.length;for(t=1;t<r;t++)n=intersection(n,e[t]);return n}},encodeStringLists=function(e,t,n,r){if(null!=e){t=null==t?0:t,n=null==n?20:n,r=null==r||r;var o,i,s,a,l,u=new T;for(buildInformationObjectForTable(e,!0),o=0;o<e.length;o++)if(a=!1,"nL"!=(l=e[o]).type){if("sL"!=l.type&&(l=l.toStringList(),buildInformationObjectForList(l)),l.infoObject.numberDifferentElements<2||l.infoObject.numberDifferentElements>n)a=!0;else{for(s=encodeStringsAsNumericFeatures(l,t),i=0;i<s.length;i++)s[i].name=l.name+":"+s[i].name;u=concat(u,s)}a&&!r&&u.push(l.clone())}else u.push(l.clone());return u}},translateListsWithDictionary=function(e,t,n,r){if(null!=e&&null!=t){for(var o=new T,i=0;i<e.length;i++)o[i]=mapWithTable(e[i],t,n,r);return o.downcast()}},getModes=function(e,t=!0){if(null==e)return;t||(e=e.transpose());let n=toL(e.map((e=>e.getMode()))).downcast();return n.name="mode",n},getSubTables=function(e,t){if(null!=e){var n=new L;n.name="subtables";for(var r=0;r<t.length;r++)n.push(e.getColumns(t[r]));return n}},mapFunctionOnLists=function(e,t,n,r,o,i,s,a,l){if(null!=e){for(var u=new L,h=e.length,c=0;c<h;c++)u.push(mapWithFunction(e[c],t,n,r,null,o,i,s,a,l));return u.downcast()}},mapFunctionsOnLists=function(e,t,n,r,o,i,s,a,l){if(null!=e){for(var u=new L,h=Math.min(e.length,t.length),c=0;c<h;c++)u.push(mapWithFunction(e[c],t[c],n,r,null,o,i,s,a,l));return u.downcast()}},useVariablesDictionary=function(e,t){if(null!=e&&null!=t){for(var n=t.get("name",null,null,!0)||t[0],r=t.get("label",null,null,!0)||t[1],o=t.get("description",null,null,!0)||t[2],i=t.get("category",null,null,!0)||t[3],s=t.get("relevance",null,null,!0)||t[4],a=e.getNames(),l=(getFirstOccurrenceDictionaryForList(a),getFirstOccurrenceDictionaryForList(n)),u=(a.length,0);u<e.length;u++){var h=l[e[u].name];null!=h&&(e[u].label=r[h],e[u].description=o[h],e[u].category=i[h],e[u].relevance=s[h])}return e}},matrixToTwoColumns=function(e){var t=new T;t[0]=new sL,t[0].name=e[0].name,t[1]=new sL,t[1].name="related with";for(var n=1;n<e.length;n++)for(var r=0;r<e[0].length;r++)for(var o=0;o<e[n][r];o++)t[0].push(String(e[0][r])),t[1].push(e[n].name);return t},_preserveOrder=function(e,t){var n=t.getNames(),r=e.getNames().getWithoutElements(n);return e.getColumns(n.concat(r))},concatStrings=function(e,t){return null==t&&(t=""),sL.toL(e.join(t))},join=function(e,t="",n="",r="",o){if(null!=e)return o&&(t="\n"),n+e.join(t)+r},cleanTexts=function(e,t,n,r,o,i,s,a,l){if(null==e)return null;var u=new sL;u.name=e.name;for(var h=0;h<e.length;h++)u[h]=cleanText(e[h],t,n,r,o,i,s,a,l);return u},filterStringListByString=function(e,t,n,r){if(null==e||null==t)return null;var o,i,s=r?new nL:new sL,a=e.length;for(n&&(i=new RegExp("\\b"+t+"\\b")),o=0;o<a;o++)n?e[o].match(i).length>0&&s.push(r?o:e[o]):-1!=e[o].indexOf(t)&&s.push(r?o:e[o]);return s},replaceStringsInTexts=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;var o,i,s=e.length,a=t.length;for(o=0;o<s;o++)if(r[o]=e[o],null!=r[o])for(i=0;i<a;i++)r[o]=replaceStringInText(r[o],t[i],n);return r},replaceStringInTexts=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;var o,i=e.length;for(o=0;o<i;o++)r[o]=null==e[o]?null:replaceStringInText(e[o],t,n);return r},replaceStringsInTextsByStrings=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;var o,i,s=e.length,a=t.length;for(o=0;o<s;o++)if(r[o]=e[o],null!=r[o])for(i=0;i<a;i++)r[o]=replaceStringInText(r[o],t[i],n[i]);return r},countStringsOccurrencesOnTexts=function(e,t,n){if(null==e||null==t)return null;var r,o,i,s,a,l=new nT,u=e.length,h=t.length;for(r=0;r<u;r++){for(i=e[r],a=new RegExp("\\b"+i+"\\b"),(s=new nL).name=i,o=0;o<h;o++)s[o]=n?countRegexOccurrences(t[o],a):countOccurrences(t[o],i);l[r]=s}return l},getWordsInTextsOccurrencesTable=function(e,t,n=1,r,o=500,i=1e3,s,a=3,l,u=0,h){if(null!=e){var c,f,p,g=e.length;1==n&&(n=StringOperators_STOP_WORDS);var d,m=1==t,y=2==t||3==t||4==t;s=s||!0;var v,x={};for(c=0;c<g;c++)for(d=getWordsOccurrencesTable(e[c],n,r,o,a,h),f=0;f<d[0].length;f++)null==(v=x[d[0][f]])&&((v=new nT).push(new nL),v.push(new nL),x[d[0][f]]=v),v[0].push(c),v[1].push(d[1][f]);var w=new sL;for(var L in x)x.hasOwnProperty(L)&&(x[L][0].length<u*g?delete x[L]:w.push(L));for(p=createUniformTable(g+1,w.length,0),c=0;c<p.length;c++)0==c?p[c]=createListWithSameElement(w.length,"","words"):p[c].name="text "+(c-1);var b=0;for(var L in x)if(x.hasOwnProperty(L)){for(p[0][b]=L,v=x[L],c=0;c<v[0].length;c++)p[v[0][c]+1][b]+=v[1][c];b++}if(p[0].length>i&&(s=!0),p[0].name="words",y||s||l){var T,_=new nL;_=p[1].clone();var M=createListWithSameElement(p[0].length,0,"idf");for(c=1;c<p.length;c++)for((T=p[c]).name="text "+(c-1),f=0;f<T.length;f++)T[f]>0&&(c>1&&(_[f]+=T[f]),M[f]++);if(y)if(_=createListWithSameElement(p[0].length,0,"total tf-idf"),2==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]/=M[f],_[f]+=T[f];else if(3==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=Math.log(g/M[f]),_[f]+=T[f];else if(4==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=M[f],_[f]+=T[f];l&&(p.push(_),_.name="totals"),s&&(p=p.sortRowsByList(_,!1))}else for(c=1;c<p.length;c++)p[c].name="text "+(c-1);return m&&p.forEach((function(e,t){0!==t&&(p[t]=normalizeToSum(p[t]))})),i>0&&i<p[0].length&&(p=p.sliceRows(0,i-1)),p}},createShortTextsNetwork=function(e,t,n,r,o,i,s,a){if(null!=e&&null!=e.length&&0!==e.length){(new Date).getTime();var l,u,h,c,f,p,g,d,m,y=new Net,v=e.join(" *** ").toLowerCase().split(" *** "),x=e.length,w=0;if(null==a||a.isColorList||(a=a.toColorList()),n=n||.2,r=r||0,i){i[0]=i[0].toLowerCase();var L,b=i[1][0]}switch(r){case 0:d=function(e){return 1-Math.pow(2*e/(x-1)-1,2)};break;case 1:d=function(e){return 1/(e+1)};break;case 2:d=function(e){return 1-Math.pow(2*Math.pow(e/(x-1),.2)-1,2)};break;default:d=function(e){return 0===e?0:1/e}}for((new Date).getTime(),e.forEach((function(e,n){m=null==s||null==s[n]?"_"+n:s[n],_=new Nd("_"+n,m),y.addNode(_),_.content=e,null!=a&&(_.color=a[n]);var r=getWords(e,!0,t,!1,!1,0,3);for(f=r.length,p=new nL,u=0;null!=r[u];u++){h=r[u];var l=0;v.forEach((function(e,t){n!=t&&(l+=Number(-1!=e.indexOf(h)))})),0!==l?(p[u]=d(l),o&&(p[u]*=1-1/(countOccurrences(v[n],h)+1)),i&&(L=i[0].indexOf(h),p[u]*=-1==L?1:1-Math.pow(i[1][L]/b,.2)),w=Math.max(w,p[u])):(r.splice(u,1),u--)}c=Math.floor(3*Math.log(f+1)),(r=r.getSortedByList(p,!1).slice(0,c)).position={},r.forEach((function(e,t){r.position[e]=t})),p=p.getSorted(!1).slice(0,c),_.wordsTable=new T,_.wordsTable[0]=r,_.wordsTable[1]=p})),(new Date).getTime(),l=0;null!=y.nodes[l+1];l++){var _=y.nodes[l];for(u=l+1;null!=y.nodes[u];u++){var M=y.nodes[u];if(g=0,_.wordsTable[0].forEach((function(e,t){null!=(L=M.wordsTable[0].position[e])&&(g+=_.wordsTable[1][t]*M.wordsTable[1][L])})),(g=Math.sqrt(g/w/Math.max(_.wordsTable[0].length,M.wordsTable[0].length)))>n){var S=new Rel(_.id+"_"+M.id,_.id+"_"+M.id,_,M,g);y.addRelation(S)}}}return y}},splitStrings=function(e,t,n,r,o){if(null==e)return null;null==t&&(t=","),null==n&&(n=4),r=null==r||r,o=null==o?"":o;var i,s,a,l=new T;for(i=0;i<n;i++)l.push(new sL),l[i].name="Level "+(i+1);var u=new nL;for(i=0;i<e.length;i++){var h=splitString(e[i],t);if(null!=h){for(h=h.trim(),s=0;s<n;s++)if(s<h.length?(l[s][i]=h[s],s>=u.length&&u.push(s)):l[s][i]=null,r&&s==n-1&&h.length>n)for(a=s+1;a<h.length;a++)l[s][i]+=t+h[a]}else for(s=0;s<n;s++)l[s][i]=0==s?o:null}return 0==u.length?l=new T:u.length<l.length&&(l=l.getColumns(u)),l},encodeStringsAsNumericFeatures=function(e,t,n,r,o,i){if(null==e)return null;t=null==t?0:t,r=null!=r&&r,o=null!=o&&o,null==i&&(i=3!=t);var s,a,l,u={};"sL"!=e.type&&(e=e.toStringList()),r&&(e=e.toLowerCase()),s=null==n?e.getWithoutRepetitions().getSorted():(s=r?n.toLowerCase():n).getWithoutRepetitions().getSorted();for(var h=[],c=0;c<s.length;c++)u[s[c]]=c,h.push(s[c]);var f="";if(o&&(f=""==e.name?"":e.name+":"),a=new nT,0==t||3==t)for(c=0;c<s.length;c++)a.push(new nL),a[c].name=f+s[c];else if(1==t)a.push(new nL),a[0].name=""==e.name?"Code":e.name+" Code";else{var p=(s.length-1>>>0).toString(2).length;for(c=0;c<p;c++)a.push(new nL),a[c].name=f+"Bit "+c}if(0==t||3==t)for(c=0;c<e.length;c++)if(null!=(l=u[e[c]]))for(var g=0;g<a.length;g++)a[g].push(g==l?1:0);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}else if(1==t)for(c=0;c<e.length;c++)if(null!=(l=u[e[c]]))a[0].push(l);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}else for(c=0;c<e.length;c++)if(null!=(l=u[e[c]])){var d=(l>>>0).toString(2),m=a.length-d.length;for(g=0;g<a.length;g++){var y=g-m<0?"0":d.substr(g-m,1);a[g].push(Number(y))}}else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}return 0==t&&a.length>1&&(a=a.getWithoutElementAtIndex(a.length-1)),a},correlationRatio=function(e,t,n){if(null==t||null==e)return null;if("L"==e.type&&(e=e.toStringList()),"nL"!=t.type)throw new Error("The first list must be a nL");if("sL"!=e.type)throw new Error("The second list must be a sL");if(t.length!=e.length)throw new Error("The two lists must have the same length");0!=(n=null==n?0:n)&&(t=normalizeByZScore(t));var r=new T;r.push(e),r.push(t),r=aggregateTable(r,0,[0,1],[0,7]);var o=t.getVariance()*t.length,i=t.getMean();if(0==o)return 0;for(var s,a=0,l=new t,u=0;u<r[1].length;u++)s=r[1][u].getMean(),l.push(s),a+=Math.pow(s-i,2)*r[1][u].length;var h=1;if(0!=n){var c=t.getInterval();l=normalizeToInterval(l,c);var f,p=0,g=1/0,d=-1/0;for(u=0;u<l.length;u++)for(var m=u+1;m<l.length;m++)p+=f=Math.abs(l[u]-l[m]),g=Math.min(g,f),d=Math.max(d,f);var y=l.length*(l.length-1)/2;1==n?h=10*g:2==n?h=10*p/y:3==n&&(h=10*d)}return Number((Math.abs(h)*Math.sqrt(a/o)).toFixed(5))},splitByEnter=function(e,t){if(null==e)return null;var n=splitString(e,"\n",null,t);return n.length>1||(n=splitString(e,ENTER2,null,t)).length>1||(n=splitString(e,ENTER3,null,t)).length>1?n:new sL(e)},replaceStringInText=function(e,t,n){if(null==e||null==t||null==n)return null;if("object"==typeof e)return e;if("[object RegExp]"!=Object.prototype.toString.call(t)){var r=(t=String(t)).match(/\/(.+)\/(.*)/);if(null==r)t=new RegExp(t,"g");else try{t=new RegExp(r[1],r[2])}catch(e){throw e}}return String(e).replace(t,n)},replaceStringsInText=function(e,t,n,r){if(null==e||null==t||null==n)return null;var o,i,s=e,a=t.length;for(o=0;o<a;o++)i=t[o],r&&"[object RegExp]"!=Object.prototype.toString.call(i)&&(i=new RegExp("\\b"+escapeForRegExp(i)+"\\b","g")),s=replaceStringInText(s,i,Array.isArray(n)?String(n[o]):n);return s},removeTextsBetweenStrings=function(e,t,n,r,o,i){if(null==e||null==t||null==n)return null;var s=function(e){var i=e.indexOf(t),s=e.indexOf(n,i);return-1==i||-1==s?null:e.substr(0,i-(r?t.length:0))+e.substr(s+(o?0:n.length))},a=s(e);a&&(e=a);var l=1;for(i=i>0?i:Number.MAX_SAFE_INTEGER;a&&l<i;)a=s(e=a),l++;return e},getWords=function(e,t=!0,n=!0,r=!0,o=!0,i=0,s=3,a=" "){if(null==e)return null;var l;a=""==a?" ":a;var u,h,c,f=StringOperators_LINK_REGEX;if("string"!=typeof e&&(e=String(e)),o&&(l=e.match(f)),e=e.toLowerCase().replace(f,""),null==(h=" "==a?e.match(/[A-Za-z_0-9---]+/g):splitString(e,a,null,!0)))return new sL;if(h=(h=sL.toL(h)).getFilteredByFunction((function(e){return""!=e})),o&&null!=l&&(h=h.concat(l))," "==a&&(h=sL.toL(h).replace(/ /g,"")),null!=n){var p=!0;if(!0===n)n=StringOperators_STOP_WORDS,p=!1;else for(p=!1,y=0;y<n.length;y++)if("object"==typeof n[y]){p=!0;break}if(p){c=h.length;var g=n.length;for(u=0;u<c;u++)for(y=0;y<g;y++)if("string"==typeof n[y]){if(n[y]==h[u]){h.splice(u,1),u--,c=h.length;break}}else if(n[y].test(h[u])){h.splice(u,1),u--,c=h.length;break}}else c=(h=h.getWithoutElements(n)).length}if(s>1)for(c=h.length,u=0;u<c;u++)h[u].length<s&&(h.splice(u,1),u--,c=h.length);if(r){if(t)h=h.getFrequenciesTable(!0)[0];else{var d=h.getFrequenciesTable(),m=new sL;for(u=0;u<d[0].length;u++)for(var y=0;y<d[1][u];y++)m.push(d[0][u]);h=m}return i>0&&(h=h.splice(0,i)),h}return t&&(h=h.getWithoutRepetitions()),i>0&&(h=h.splice(0,i)),h},getBigrams=function(e,t=!0,n=!0,r=!0,o=3){!0===n&&(n=StringOperators_STOP_WORDS);let i=(e=cleanText(e,!0,!0," ",!0,!0,n,!0,!0)).split(" "),s=new sL,a=i.length-1;for(let e=0;e<a;e++)i[e].length>=o&&i[e+1].length>=o&&s.push(i[e]+" "+i[e+1]);return t&&(s=s.getWithoutRepetitions()),s},substr=function(e,t,n){return null==e?null:(t=t||0,e.substr(t,n))},splitString=function(e,t,n,r){if(null==e)return null;if(null!=n&&!isNaN(n)&&0!=n){var o=e.match(/\w+/g);null==o&&(o=[e]);var i=!0,s=e.length/o.length/2;n>o.length&&(i=!1,s=0);for(var a,l,u,h=new h,c=e;c.length>0;){if(u=Math.max(1,Math.floor(c.length/(n-h.length)-s)),h.length==n-1){h.push(c);break}-1==(l=i?c.substring(u-1).search(/\s/):0)?l=u:l+=u,a=c.substring(0,l),h.push(a),c=c.substring(l)}return r?h.trim():h}return null==t&&(t=","),"string"==typeof t&&(t=t.replace("\\n","\n")),-1==e.indexOf(t)?new h(e):(h=h.toL(e.split(t)),r?h.trim():h)},getFirstTextBetweenStrings=function(e,t,n){if(null==e)return null;var r=e.indexOf(t);if(-1==r)return null;if(""===n||null==n)return e.substr(r+t.length);var o=e.indexOf(n,r+t.length+1);return-1==o?e.substring(r+t.length):e.substr(r+t.length,o-(r+t.length))},getAllTextsBetweenStrings=function(e,t,n){if(-1==e.indexOf(t))return new sL;var r,o,i,s=e.split(t),a=s.length,l=new sL;for(i=1;i<a;i++)r=s[i],n==t?l.push(r):(o=r.indexOf(n))>=0&&l.push(r.substr(0,o));return l},textContainsString=function(e,t,n,r){return e=r?t:e.toLowerCase(),t=r?t:t.toLowerCase(),n?e.match(new RegExp("\\b"+t+"\\b")).length>0:-1!=e.indexOf(t)},getParenthesisContents=function(e,t){for(var n=new sL,r=e,o=getFirstParenthesisContentWithIndexes(e,t),i=0;""!==o.content&&o.index1<r.length-1&&i<e.length;)n.push(o.content),r=r.substr(o.index1+2),o=getFirstParenthesisContentWithIndexes(r,t),i++;return n},getFirstParenthesisContent=function(e,t){return getFirstParenthesisContentWithIndexes(e,t).content},getFirstParenthesisContentWithIndexes=function(e,t){var n=t?"[":"(",r=t?"]":")",o=t?/\[/g:/\(/g,i=t?/\]/g:/\)/g,s=e.indexOf(n);if(-1==s)return{content:"",index0:0,index1:0};for(var a=e.indexOf(r),l=e.substring(s+1,a),u=l.match(o),h=l.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f=0;(c>0||-1==a)&&f<e.length;)a=e.indexOf(r,a),l=e.substring(s+1,a+1),a++,u=l.match(o),h=l.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f++;return{content:-1==(a=e.indexOf(r,a))?e.substring(s+1):e.substring(s+1,a),index0:s+1,index1:-1==a?e.length-1:a-1}},placeString=function(e,t,n){return e.substr(0,n)+t+e.substr(n+t.length)},insertString=function(e,t,n){return e.substr(0,n)+t+e.substr(n)},cleanText=function(e,t,n,r,o,i,s,a,l){return null==e?null:e.isList?cleanTexts(e,t,n,r,o,i,s,a,l):(t&&(e=removeEnters(e,r)),n&&(e=removeTabs(e,r)),o&&(e=removePunctuation(e)),i&&(e=e.toLowerCase()),null!=s&&(!0===s&&(s=StringOperators_STOP_WORDS),e=replaceStringsInText(e,s,"",!0)),a&&(e=removeDoubleSpaces(e)),l&&(e=removeAccentsAndDiacritics(e)),e)},removeEnters=function(e,t){return null==e?null:(t=null==t?"":t,e.replace(/(\r|\n)/g,t))},removeTabs=function(e,t){return null==e?null:(t=t||"",e.replace(/\t/g,t))},removePunctuation=function(e,t){return null==e?null:(t=t||"",e.replace(/[:,.;?!\(\)\"\']/gi,t))},removeDoubleSpaces=function(e){if(null==e)return null;for(var t=e,n=RegExp(/\s\s/g);n.test(t);)t=t.replace(n," ");return t},removeHtmlTags=function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText},escapeForRegExp=function(e){return null==e?null:e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},removeLinks=function(e){return(e+=" ").replace(/https*:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g," ").substr(0,e.length-2)},removeQuotes=function(e){return'"'==e.charAt(0)&&(e=e.substr(1)),'"'==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e},removeAccentsAndDiacritics=function(e){var t=e.replace(new RegExp(/[]/g),"a");return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp(//g),"ae")).replace(new RegExp(//g),"c")).replace(new RegExp(/[]/g),"o")).replace(new RegExp(//g),"oe")).replace(new RegExp(/[]/g),"u")).replace(new RegExp(/[]/g),"y")).replace(new RegExp(/[]/g),"A")).replace(new RegExp(//g),"AE")).replace(new RegExp(//g),"c")).replace(new RegExp(/[]/g),"E")).replace(new RegExp(/[]/g),"I")).replace(new RegExp(/[]/g),"e")).replace(new RegExp(/[]/g),"i")).replace(new RegExp(//g),"n")).replace(new RegExp(//g),"N")).replace(new RegExp(/[]/g),"O")).replace(new RegExp(//g),"OE")).replace(new RegExp(/[]/g),"U")).replace(new RegExp(/[]/g),"Y")},getWordsOccurrencesTable=function(e,t,n,r,o,i){if(null!=e){if(0===e.length)return new T(new sL,new nL);1==t&&(t=StringOperators_STOP_WORDS);var s,a=getWords(e,!1,t,!1,n,null,o,i);return(s=null!=r?a.getFrequenciesTable(!0).sliceRows(0,r-1):a.getFrequenciesTable(!0))[0].name="Word",s[1].name="Frequency",s}},indexesOf=function(e,t,n){var r,o;if(n){var i;for(r=new nL,t=new RegExp("\\b"+t+"\\b"),-1!=(o=e.search(t))&&(e=e.substr(o));-1!=o;)r.push(o),i=o,o=e.search(t),e=e.substr(o+1),o>=0&&(o+=i);return r}if(-1==(o=e.indexOf(t)))return new nL;for(r=new nL(o),o=e.indexOf(t,o+1);-1!=o;)r.push(o),o=e.indexOf(t,o+1);return r},indexesOfString=function(e,t,n){return indexesOf(e,t,n)},repeatString=function(e,t){var n,r="";for(n=0;n<t;n++)r+=e;return r},countStringOccurrences=function(e,t,n){return countOccurrences(e,t,n)},countOccurrences=function(e,t,n){if(n)return countWordOccurrences(e,t);for(var r=0,o=e.indexOf(t);-1!=o;)r++,o=e.indexOf(t,o+t.length);return r},countWordOccurrences=function(e,t){var n=new RegExp("\\b"+t+"\\b");return countRegexOccurrences(e,n)},countRegexOccurrences=function(e,t){var n=e.match(t);return null==n?0:n.length},countStringsOccurrences=function(e,t,n){if(null!=e&&null!=t){var r,o=new nL,i=t.length;for(r=0;r<i;r++)o[r]=n?countRegexOccurrences(e,new RegExp("\\b"+t[r]+"\\b")):countOccurrences(e,t[r]);return o}},validateEmail=function(e){return StringOperators_MAIL_REGEX.test(e)},validateUrl=function(e){return StringOperators_LINK_REGEX.test(e)},getClosestLevenshtein=function(e,t,n=0){let r=t[0],o=99999;return t.forEach((t=>{let n=getLevenshteinDistance(e,t);n<o&&(o=n,r=t)})),0==n?r:{closest:r,distance:o}},getLevenshteinDistance=function(e,t,n){if(t=null==t?"":t,0===(e=null==e?"":e).length&&0===t.length)return 0;if(0===e.length)return n?1:t.length;if(0===t.length)return n?1:e.length;var r,o,i=[];for(r=0;r<=t.length;r++)i[r]=[r];for(o=0;o<=e.length;o++)i[0][o]=o;for(r=1;r<=t.length;r++)for(o=1;o<=e.length;o++)t.charAt(r-1)==e.charAt(o-1)?i[r][o]=i[r-1][o-1]:i[r][o]=Math.min(i[r-1][o-1]+1,Math.min(i[r][o-1]+1,i[r-1][o]+1));if(n){var s=i[t.length][e.length]/Math.max(e.length,t.length);return Number(s.toFixed(5))}return i[t.length][e.length]},getNgrams=function(e,t=2,n=2,r,o=0,i=0,s){var a,l,u;n<t&&(n=t),!0===r&&(r=StringOperators_STOP_WORDS),1!=(s=null==s?null==r?1:0:s)&&null==r&&(r=StringOperators_STOP_WORDS),1==s&&(r=null);var h=new sL;if(null==e||"string"!=typeof e)return h;var c=StringOperators_LINK_REGEX,f=(e=e.toLowerCase().replace(c,"")).match(/\w+|[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/g);if(null==f)return h;f=sL.toL(f);var p=/[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/;for(a=0;a<f.length;a++)if(u=f[a],!(r&&-1!=r.indexOf(f[a])||i&&f[a].length<i||1==f[a].length&&f[a].match(p))){for(1==t&&h.push(u),l=a+1;l<f.length&&l<a+n&&(!r||-1==r.indexOf(f[l])||0!=s)&&!(i&&f[l].length<i)&&(1!=f[l].length||!f[l].match(p));l++)if(l>=a+t-1){if(u=u+" "+f[l],2==s&&-1!=r.indexOf(f[l]))continue;if(h.push(u),0!==o&&h.length==o)break}else u=u+" "+f[l];if(0!==o&&h.length==o)break}return h},stringToFunction=function(string){if(null!=string){var realCode,myTempraryFunction,func;if(-1!=string.search(/function\(/))return realCode="myTempraryFunction = "+string,eval(realCode),myTempraryFunction;for(var i=0;i<methods.length;i++)if(methods[i].methodName==string){if(methods[i].isPrototype){var funcName=string;func=function(e,t,n,r,o,i,s){return null==e[funcName]?null:e[funcName](t,n,r,o,i,s)}}else func=methods[i].func;break}return null!=func?func:(realCode="myTempraryFunction = function(x){return "+string+"}",eval(realCode),myTempraryFunction)}},stringFormat=function(e,t,n,r){if(null==e||null==t||null==n)return null;var o,i;if(r=null==r?0:r,"sL"==e.type||"Array"==_typeOf(e)){var s=new sL;for(s.name=e.name,o=0;o<e.length;o++)s.push(stringFormat(e[o],t,n,r));return s}if(e="string"!=typeof e?String(e):e,t="string"!=typeof t?String(t):t,n="string"!=typeof n?String(n):n,e.length!=t.length){if(0==r)return e;if(1==r)return null;throw new Error("Input string must be same length as the input pattern")}if(new Set(t).size!=t.length)throw new Error("All characters in the input pattern must be unique");var a=n;for(o=0;o<n.length;o++)-1!=(i=t.indexOf(n[o]))&&(a=a.substring(0,o)+e[i]+a.substring(o+1));return a},createListWithSameElement=function(e,t,n){if(null==e)return null;var r,o;switch(Array.isArray(e)&&(e=e.length),_typeOf(t)){case"number":r=new nL;break;case"L":r=new T;break;case"nL":r=new nT;break;case"Rec":r=new recL;break;case"string":r=new sL;break;default:r=new L}for(o=0;o<e;o++)r[o]=t;return null!=n&&(r.name=n),r},createIterationSequence=function(e,t,n){for(var r=createListWithSameElement(1,t),o=1;o<e;o++)r[o]=n(r[o-1]);return r},createListWithUniqueElements=function(e,t=0,n,r,o=5){var i,s,a;if(i=""==(n=null==n?"":n)&&1==t?new nL:new sL,null!=r&&(i.name=r),0==t){for(var l=1,u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=u.length;e>Math.pow(h,l);)l++;var c,f=createListWithSameElement(l,0);for(s=0;s<e;s++){for(c="",a=0;a<f.length;a++)c=u[f[a]]+c;for(i.push(n+c),a=0;a<f.length&&(f[a]++,f[a]==h);a++)f[a]=0}}else if(1==t)for(s=0;s<e;s++)""==n?i.push(s+1):i.push(n+(s+1));else if(2==t)for(s=0;s<e;s++)c=StringOperators_WORDLISTS.lorem.getRandomElements(o).join(" "),i.push(c);return i},replaceChomasInTextLine=function(e,t){var n,r,o=e.split('"');if(o.length<2)return e;for(t=null==t?",":t,r=new RegExp("\\"+t,"g"),n=0;null!=o[n];n++).5*n!=Math.floor(.5*n)&&(o[n]=o[n].replace(r,"*CHOMA*"));return e=sL.toL(o).getConcatenated("")},_replaceSpacesInLine=function(e){var t,n=e.split('"');if(n.length<2)return e;for(t=0;null!=n[t];t++).5*t!=Math.floor(.5*t)&&(n[t]=n[t].replace(/ /g,"*SPACE*"));return e=sL.toL(n).getConcatenated('"')},decodeTextNet=function(e){if(null==e)return;if(""===e)return new Net;var t,n,r,o,i,s,a,l,u,h,c,f,p,g;console.log("\n\n*************////////// decodeTextNet //////////*************");var d,m,y,v,x,w=[],L=[],b=[],T=new Net,_=new sL;T.nodesPropertiesNames=new sL,T.relationsPropertiesNames=new sL,(h=e.split(/\n/g)).forEach((function(e,t){h[t]=e.trim()})),e=h.join("\n");for(var M=0;"\n"==e.charAt(0);)e=e.substr(1),M++;var S,N=e;for(l=N.search(/\n\n./g);-1!=l;)_.push(N.substr(0,l)),N=N.substr(l+2),l=N.search(/\n\n./g);_.push(N),_.forEach((function(e){if(-1==e.indexOf("\n")?(r=e,h=null):(h=e.split(/\n/g),r=h[0]),h&&(h=h.filter((e=>""!=e.trim()))),S=r,"\n"==r||""===r||" "==r||"  "==r);else if(0===r.indexOf("//"))null==b[M]&&(b[M]=[]),b[M].push({type:"comment",iStart:0,iEnd:r.length});else if("relations colors:"==r||"groups colors:"==r||"categories colors:"==r)h&&h.slice(1).forEach((function(e,t){l=e.indexOf(":"),"relations colors:"==S&&-1!=l&&null!=colorStringToRGB(e.split(":")[1])&&(w.push(e),null==b[M+t]&&(b[M+t]=[]),b[M+t].push({type:"relation_color",iStart:0,iEnd:e.length})),"groups colors:"!=S&&"categories colors:"!=S||-1==l||null==colorStringToRGB(e.split(":")[1])||(L.push(e),null==b[M+t]&&(b[M+t]=[]),b[M+t].push({type:"relation_color",iStart:0,iEnd:e.length}))}));else{for(u=99999999,-1!=(l=r.indexOf(NetworkEncodings_nodeNameSeparators[0]))&&(u=l,g=NetworkEncodings_nodeNameSeparators[0]),n=1;n<NetworkEncodings_nodeNameSeparators.length;)-1!=(l=r.indexOf(NetworkEncodings_nodeNameSeparators[n]))&&(u=Math.min(l,u),g=NetworkEncodings_nodeNameSeparators[n]),n++;""!==(a=(a=-1==(l=99999999==u?-1:u)?r:r.substr(0,l)).trim())&&"---"!=a&&(i=_simplifyForTextNet(a),c=T.nodes.get(i),m=-1==l?r.length:l,null==c?((c=new Nd(i,a))._nLine=M,T.addNode(c),c.content=-1!=l?r.substr(l+g.length).trim():"",c._lines=h?h.slice(1):new sL,c.position=T.nodes.length-1,c.impact=1,null==b[M]&&(b[M]=[]),b[M].push({type:"node_name",iStart:0,iEnd:m})):(null!=h&&(c._lines=c._lines.concat(h.slice(1))),c.content+=-1!=l?" |"+r.substr(l+g.length).trim():"",null==b[M]&&(b[M]=[]),b[M].push({type:"node_name_repeated",iStart:0,iEnd:m})))}c.content=c._lines.join(" / "),M+=(h?h.length:1)+1}));for(var R=!0;R;){R=!1;e:for(t=0;null!=T.nodes[t];t++)for(c=T.nodes[t],n=0;null!=c._lines[n];n++)if(0===(r=c._lines[n]).indexOf("=")){if(s=_simplifyForTextNet(r.substr(1)),(f=T.nodes.get(s))&&c!=f){R=!0,c._lines=f._lines.concat(f._lines),T.nodes.removeNode(f),T.nodes.ids[f.id]=c;break e}T.nodes.ids[s]=f,c._otherIds||(c._otherIds=[]),c._otherIds.push(s)}}let E=new sL;if(T.nodes.forEach((function(e){M=e._nLine,e._lines.forEach((function(t,r){-1!=t.indexOf("=")||(t.indexOf(":")>0?(o=t.trim(),y=removeAccentsAndDiacritics(o.split(":")[0]).replace(/\s/g,"_"),(v=t.split(":")[1].trim())==String(Number(v))&&(v=Number(v)),null!=v&&("x"==y&&(y="_x"),"y"==y&&(y="_y"),e[y]=v,"category"==y&&E.pushIfUnique(String(v)),T.nodesPropertiesNames.includes(y)||T.nodesPropertiesNames.push(y))):(o=t,T.nodes.forEach((function(s){if(d=_regexWordForTextNet(s.id),-1==(l=o.search(d))&&s._otherIds)for(n=0;null!=s._otherIds[n]&&(d=_regexWordForTextNet(s._otherIds[n]),-1==(l=o.search(d)));n++);if(-1!=l)if(m=l+o.substr(l).match(d)[0].length,null!=(p=T.relations.getFirstRelationBetweenNodes(e,s,!0)))x=p.node0.name+" "+t,p.content+=" | "+x,null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_repeated_relation",iStart:l,iEnd:m});else{p=T.relations.getFirstRelationBetweenNodes(s,e,!0);var a=t;d=_regexWordForTextNet(e.id),-1!=(l=a.search(d))&&(a=(a=a.substr(l)).replace(d,"").trim()),d=_regexWordForTextNet(s.id),l=a.search(d),a=" "+a.substr(0,l).trim()+" ",i=t,p=new Rel(t,a,e,s),x=p.node0.name+" "+t,0==t.indexOf("- ")?(p.color="red",p.influence=-1):0==t.indexOf("+ ")?(p.color="blue",p.influence=1):p.influence=0,p.content=x,T.addRelation(p),null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_relation",iStart:l,iEnd:m})}}))))})),e.positionWeight=Math.pow(T.nodes.length-e.position-1/T.nodes.length,2),e.combinedWeight=e.positionWeight+.1*e.nodes.length})),E.length>0){console.log("categories:",E);let e=createDefaultCategoricalColorList(E.length),t={};E.forEach(((n,r)=>t[n]=interpolateColors(e[r],"white",.8))),T.nodes.forEach((e=>e.color=t[e.category]))}return w.forEach((function(e){l=e.indexOf(":"),e.substr(0,l).split(",").forEach((function(t){var n=e.substr(l+1);T.relations.forEach((function(e){-1!=e.name.indexOf(t)&&(e.color=n)}))}))})),L.forEach((function(e){l=e.indexOf(":"),e.substr(0,l).split(",").forEach((function(t){var n=e.substr(l+1);T.nodes.forEach((function(e){e.group==t&&(e.color=n),e.category==t&&(e.color=n)}))}))})),T.colorSegments=b,T},_simplifyForTextNet=function(e){return("es"==(e=e.toLowerCase()).substr(e.length-2)||"s"==e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e.trim()},_regexWordForTextNet=function(e,t){t=null==t||t;try{return new RegExp("(\\b)("+e+"|"+e+"s|"+e+"es)(\\b)",t?"gi":"i")}catch(e){return null}},encodeTextNet=function(e,t,n,r){if(null!=e){var o,i,s,a="";return t=t||", ",n=n||[],r=r||[],e.nodes.forEach((function(e){a+=e.name,e.content&&""!==e.content&&(a+=t+e.content),a+="\n",n.forEach((function(t){null!=e[t]&&(a+=t+":"+String(e[t])+"\n")})),s=new sL,e.toRelations.forEach((function(e){var t=null!=e.content&&""!==e.content||!e.description?e.content:e.description;t&&""!==t?(o=_regexWordForTextNet(e.node1.name),i=t+(null!=o&&-1==t.search(o)?" "+e.node1.name:"")):i="connected with "+e.node1.name,-1==s.indexOf(i)&&(a+=i,a+="\n",s.push(i))})),a+="\n"})),a}},modelInfluence=function(e,t,n=1,r=1){if(null==t)return;"string"==typeof t&&(t=e.get(t)),e.nodes.forEach((e=>e.impact=1)),e.relations.forEach((e=>e._impact_hits=0)),t.impact=n;!function(t,n){if(n>15)return;let o,i,s;for(var a=0;a<1e4;a++){let t=e.relations.getRandomElement();if(0==t.influence)continue;let n=t.node0,a=t.node1;i=r*(n.impact-1)**2*(1/(1+.9*t._impact_hits)),o=1+i,s=a.impact,t._impact_hits++,t.influence>0?(n.impact>1?a.impact*=o**2:a.impact/=o,"gras"==n.id&&"otter"==a.id&&console.log("1 grass otter | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",a.impact)):t.influence<0&&(n.impact>1?a.impact/=o:a.impact*=o**2,"gras"==a.id&&"deer"==n.id&&console.log("-1 deer grass | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",a.impact)),a.impact=0*a.impact+2/(1+Math.pow(Math.E,-2*(a.impact-1)))*1}}(0,0),e.nodes.forEach((e=>console.log(e.name,e.impact)))},NetworkToTable=function(e,t,n,r){if(null!=e){t=null==t||t,r=null==r?0:r;var o,i=n?new T:new nT,s=t?e.nodes.getIds():e.nodes.getNames();s.name="node names",n&&(i[0]=s);var a,l,u=e.nodes.length,h=e.relations.length,c={},f=n?1:0;for(a=0;a<u;a++)(o=createListWithSameElement(u,0)).name=s[a],i.push(o),c[e.nodes[a].id]=a;for(a=0;a<h;a++)l=e.relations[a],0===r?i[c[l.node0.id]+f][c[l.node1.id]]++:i[c[l.node0.id]+f][c[l.node1.id]]+=l.weight;return i}},TableToNetworkPairs=function(e,t,n=0,r=!1,o=0,i,s=","){if(null==e||null==e[0]||null==e[1])return;var a,l,u,h,c,f,p,g,d,m=new Net;if("nT"==e.type&&e.length>2&&e.length==e[0].length){for(a=e.length,p=0;p<a;p++)(h=null==i?null==e[p].name||""==e[p].name?"node_"+p:e[p].name:i[p])&&(l=new Nd(h,h),m.addNode(l));for(p=0;p<a;p++)for(d=e[p],l=m.nodes[p],g=0;g<a;g++)u=m.nodes[g],d[g]>n&&(f=new Rel(p+"_"+g,p+"_"+g,l,u,d[g]),m.addRelation(f));return m}let y=createSortedNumberList(e[0]);if(y.name="indexes",e[0].join("").includes(s)){let t=toT(e);e.push(y);var v=disAggregateTable(t,t.getWithoutElementAtIndex(0).getNames(),0);v.setNames(t.getNames()),y=v.get("indexes"),e=v=(v=v.getWithoutElement(y)).getColumns(3==v.length?[2,0,1]:[1,0])}if(e[1].join("").includes(s)){let t=toT(e);t.push(y),(v=disAggregateTable(t,t.getWithoutElementAtIndex(1).getNames(),1)).setNames(e.getNames()),y=v.get("indexes"),e=v=(v=v.getWithoutElement(y)).getColumns(3==v.length?[2,0,1]:[1,0])}if(e.length<2)return null;a=null==t?Math.min(e[0].length,e[1].length):Math.min(e[0].length,e[1].length,t.length),null==t&&e.length>2&&"nL"==_typeOf(e[2])&&e[2].length>=a&&(t=e[2]),_typeOf(e[0])==ndL&&(_typeOf(e[1]),NodeList);var x,w=new ndL;for(p=0;p<a;p++)h=(""+e[0][p]).trim(),c=(""+e[1][p]).trim(),h&&c&&"undefined"!=h&&"undefined"!=c&&(null==(l=m.nodes.get(h))?(l=new Nd(h,h),m.addNode(l),l.color="rgb(255,140,80)",l.kind=e[0].name,l.indexes=new nL):l.weight++,l.indexes.push(y[p]),null==(u=m.nodes.get(c))?(u=new Nd(c,c),m.addNode(u),u.color="rgb(60,180,255)",u.kind=e[1].name,u.indexes=new nL):(u.weight++,"rgb(200,100,0)"==u.color&&(u.color="rgb(100,100,100)")),u.indexes.push(y[p]),null==t?r?(f=new Rel(x=h+"_"+c+"_"+p,h+"_"+c,l,u,1),m.addRelation(f)):(x=h+"_"+c+"_",null==(f=w.get(x))||r?(f=new Rel(x,x,l,u,1),w.addNode(f)):f.weight++):t[p]>n&&(f=new Rel(h+"_"+c,h+"_"+c,l,u,t[p]),m.addRelation(f)),i&&(f.content=i[p]));var L=0;if(m.nodes.forEach((e=>{e.indexes=e.indexes.getWithoutRepetitions(),L=Math.max(L,e.weight)})),null==t)if(r)for(p=0;p<w.length;p++)m.addRelation(w[p]);else for(p=0;p<w.length;p++)w[p].weight>n&&m.addRelation(w[p]);if(0)for(p=0;null!=m.nodes[p];p++)m.nodes[p].relations.length<0&&(m.removeNode(m.nodes[p]),p--);return m.nodes.forEach((e=>e.weight/=L)),L=0,m.relations.forEach((e=>{L=Math.max(L,e.weight)})),m.relations.forEach((e=>e.weight/=L)),m},matrixToNetwork=function(e){for(var t,n,r,o,i=new Net,s=1;s<e.length;s++){null==(t=i.get(e[s].name))&&(t=new Nd(e[s].name,e[s].name),i.addNode(t));for(var a=0;a<e[0].length;a++)e[s][a]>0&&(o=String(e[0][a]),null==(n=i.get(o))&&(n=new Nd(o,o),i.addNode(n)),r=new Rel(o=s-1+"_"+a,t.name+"_"+n.name,t,n,e[s][a]),i.addRelation(r))}return i},CSVToTable=function(e,t=!0,n,r,o,i){if(null==e)return null;if(o=null!=o&&o,-1==e.indexOf("\n")&&-1==e.indexOf(",")&&-1==e.indexOf(";"))throw 0===e.indexOf("http:/")||0===e.indexOf("https:/")||0===e.indexOf("fttp:/")||0===e.indexOf("fttps:/")?new Error("The provided string seems to be a url, not a csv<br><br>Use <b>CSVLoader</b> to upload and decode csv files"):new Error("the provided string doesn't seem to be a csv, it contains no enters or chomas");var s,a=2==t;if(a&&(t=!0),null==e)return null;if(""===e)return new T;var l=(e=e.replace(/\$/g,"")).split('"');for(C=1;null!=l[C];C+=2)l[C]=l[C].replace(/\n|\r/g,"*ENTER*");var u=(e=l.join('"')).split(/\n|\r/g);if(1==u.length&&t)throw new Error("CSV contains only one line and firstRowIsHeader is true, a T can't be build");if("auto"==n){var h,c,f=[",",";",":","|","\t","+","-","_"],p=u.slice(0,11).join("\n"),g=0,d=",";for(C=0;C<f.length;C++){try{h=CSVToTable(p,t,f[C])}catch(e){h=null}if(null!=h&&0!=h.length){if(buildInformationObjectForTable(h),c=h.length,t)c-=h.getNames().getElementNumberOfOccurrences("");var m=h.reduce((function(e,t){return e+t.getElementNumberOfOccurrences(null)}),0),y=h.reduce((function(e,t){return e+t.length}),0);c-=0==y?0:m/y,h.infoObject.allListsSameLength||c--,c>g&&(g=c,d=f[C])}}n=d}"\\t"!=(n=null==n||""===n?",":n)&&"tab"!=n||(n="\t");var v=new T,x=n;if(null==e||""===e||" "==e||0===u.length)return null;var w,b,_,M,S,N,R=0;if(t)if(R=1,a)for(w=replaceChomasInTextLine(u[0],n).split(","),C=0;C<w.length;C++)w[C]=w[C].replace("*CHOMA*",n);else w=u[0].split(x);for(C=0,N=R;N<u.length;N++)if(!(u[N].length<2)){for(S=replaceChomasInTextLine(u[N],n).split(x),s=0;s<S.length;s++)v[s]=null==v[s]?new L:v[s],t&&0===C&&(v[s].name=(null==w[s]?"":_removeQuotes(w[s])).trim()),null!=(_=""===(_=S[s].replace(/\*CHOMA\*/g,n).replace(/\*ENTER\*/g,"\n"))?r:_)?(_=String(_),"string"==typeof(b=(M=Number(_.replace(",",".")))||0===M&&""!==_?M:_)&&(b=_removeQuotes(b))):b=null,v[s][C]=b;C++}for(C=0;null!=v[C];C++)v[C]=v[C].downcast(),o&&"L"==v[C].type&&(v[C]=toStringList(v[C]));if((v=v.downcast()).name=i,a){for(var E=!0,O=0,C=0;C<v.length;C++)if("nL"==v[C].type&&(O++,String(Number(v[C].name))!=Number(v[C].name))){E=!1;break}if(!E)return v;var D=0,P=0;for(C=0;C<v.length;C++){if("nL"!=v[C].type)if(P++,v[C].includes(v[C].name))D++;else v[C].getWithoutRepetitions().length==v[C].length&&D++}if(P>0&&(D+O)/v.length>.3)for(C=0;C<v.length;C++)v[C].unshift(v[C].name),v[C].name="col "+C}return v},_removeQuotes=function(e){return 0===e.length||'"'!=e.charAt(0)&&"'"!=e.charAt(0)||'"'!=e.charAt(e.length-1)&&"'"!=e.charAt(e.length-1)||(e=e.substr(1,e.length-2)),e},TableToCSV=function(e,t=",",n=!0,r,o){if(null==e)return;var i,s,a,l,u,h=createListWithSameElement(e[0].length,"");for(i=0;null!=e[i];i++)for(l=(a=e[i]).type,u=i!=e.length-1,s=0;s<a.length;s++){if(null!==a[s])if("nL"===l)h[s]+=a[s];else h[s]+=null!=r?String(a[s]).replace(/,/g,r):'"'+a[s]+'"';u&&(h[s]+=t)}var c="";if(n){for(i=0;null!=e[i];i++)a=e[i],c+=null!=r?a.name.replace(/,/g,r):'"'+a.name+'"',i!=e.length-1&&(c+=t);c+="\n"}return(o?e.getTypes().join(t)+"\n":"")+c+h.getConcatenated("\n")},TableToJSONString=function(e,t){if(null==e)return"";for(var n=e.slice(0),r=e.getNames(),o=e.getTypes(),i=[],s=0;s<e.length;s++)void 0===e[s].containsNulls?i.push(null):i.push(e[s].containsNulls);var a={data:n,name:e.name,type:e.type,handle:e.handle,names:r,types:o,nulls:i};if(void 0!==e.containsNulls&&(a.containsNulls=e.containsNulls),t)return a;try{return JSON.stringify(a)}catch(e){return JSON.stringify({error:"cannot convert."})}},JSONStringToTable=function(e){if(null==e||0==e.length)return new T;var t,n,r;if("object"==typeof e)t=e;else try{t=JSON.parse(e)}catch(e){return null}if((r="nT"==t.type?nT.toL(t.data):T.toL(t.data)).name=null==t.name?t.name:String(t.name),r.type=t.type,null!=t.handle&&(r.handle=t.handle),null!=t.containsNulls&&(r.containsNulls=t.containsNulls),t.types&&t.types.length>0){for(n=0;n<t.types.length;n++)if(r[n])switch(t.types[n]){case"sL":r[n]=sL.toL(r[n],!1);break;case"nL":r[n]=nL.toL(r[n],!1);break;case"dL":r[n]=dL.toL(r[n],!0);break;case"iL":r[n]=iL.toL(r[n],!1)}}else for(n=0;n<r.length;n++)if(r[n]=r[n].downcast(),"sL"==r[n].type){for(var o=!0,i=0;o&&i<r[n].length;i++)o=!isNaN(r[n][i])&&""!==r[n][i].trim();o&&(r[n]=toNumberList(r[n]))}if(t.names)for(n=0;n<t.names.length;n++)r[n]&&(r[n].name=String(t.names[n]));if(t.nulls)for(n=0;n<t.nulls.length;n++)r[n]&&null!=t.nulls[n]&&(r[n].containsNulls=t.nulls[n]);return r},NumberListToPolygon=function(e){if(0===e.length)return null;for(var t=new Pol,n=0;null!=e[n+1];n+=2)t.push(new P(e[n],e[n+1]));return t},NumberListToStringList=function(e){var t,n=new sL;for(t=0;null!=e[t];t++)n[t]=String(e[t]);return n.name=e.name,n},ObjectToTable=function(e,t){if(null==e)return null;var n,r,o,i,s,a;if(Array.isArray(e)){if(n=1,!t)for(r in t=[],e[0])e[0].hasOwnProperty(r)&&t.push(r)}else{var l=[];for(r in e)l.push(r);if(1==l.length&&Array.isArray(e[l[0]])){if(n=1,e=e[l[0]],!t)for(r in t=[],e[0])t.push(r)}else n=3,t||(t=l)}var u=new T;for(i=0;i<t.length;i++){var h=t[i];o=new L,u[i]=o,o.name=h}if(1==n)for(i=0;i<e.length;i++){var c=e[i];for(s=0;s<t.length;s++)u[s].push(c[t[s]])}else for(s=0;s<t.length;s++)for(o=e[t[s]],i=0;i<o.length;i++)u[s].push(o[i]);for(i=0;i<u.length;i++){var f=u[i].getTypeOfElements();if(""==f||"Object"==f){var p=!0,g="";for(a=0;a<u[i].length&&p;a++)if(null!==u[i][a]){if("Object"!=_typeOf(u[i][a])){p=!1;break}""==g?g=getObjectStructure(u[i][a]):g!=getObjectStructure(u[i][a])&&(p=!1)}p||(f="")}if("Object"==f){var d=ObjectToTable(u[i]),m=u[i].name;for(a=0;a<d.length;a++)d[a].name=m+"_"+d[a].name;u=T.toL(u.slice(0,i).concat(d).concat(u.slice(i+1))),i--}}for(i=0;i<u.length;i++)u[i]=u[i].downcast();return u=u.downcast()},ObjectToList=function(e,t){var n=ObjectToTable(e,t);if(1==n.getLengths.getMax())return n.getRow(0)},objectToString=function(e){try{return JSON.stringify(e)}catch(e){return JSON.stringify({error:"cannot convert."})}},conversor=function(e,t){if(null!=e&&null!=t){var n,r;switch(_typeOf(e)+"_"+t){case"Array_List":return ArrayToList(e);case"NumberTablePolygon":var o=new Pol,i=e.length>1;for(n=0;null!=e[0][n];n++)o[n]=new P(e[0][n],i?e[1][n]:0);return o;case"date_string":return dateToString(e);case"string_date":return stringToDate(e);case"date_number":return e.getTime();case"number_date":return new Date(e);case"List_StringList":case"NumberList_StringList":return NumberListToStringList(e);case"DateList_StringList":return DateListToStringList(e);case"StringList_NumberList":return StringListToNumberList(e);case"Object_string":return JSON.stringify(e,null,"\t");case"string_Object":return JSON.parse(e);case"string_ColorScale":return ColorScales[e];case"string_Table":return CSVToTable(e);case"StringList_DateList":return r=new dL,e.forEach((function(e){r.push(stringToDate(e))})),r.name=e.name,r;case"DateList_NumberList":return e.getTimes();case"Table_Network":return TableToNetworkPairs(e,null,0,!1)}switch(t){case"string":return e.toString();case"number":return Number(e)}return null}},ArrayToList=function(e){if(null!=e)return L.toL(e).downcast()},angleFromTwoPoints=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},dot=function(e,t){return e.x*t.x+e.y*t.y},twoPointsInterpolation=function(e,t,n){return new P((1-n)*e.x+n*t.x,(1-n)*e.y+n*t.y)},pointMultiplication=function(e,t){return new P(e.x*t.x-e.y*t.y,e.y*t.x+e.x*t.y)},normalizeTableToMax=function(e,t){if(null!=e){t=null==t?1:t;var n,r=new nT,o=t/e.getMax();for(n=0;null!=e[n];n++)r[n]=e[n].factor(o);return r.name=e.name,r}},normalizeLists=function(e,t,n){if(null!=e&&e.length&&e[0].length){n=null==n?"min-max":n;var r,o=instanceSameType(e);for(o.name=e.name,r=0;null!=e[r];r++)if("nL"==e[r].type)switch(n){case"max":o[r]=normalizeToMax(e[r],t);break;case"sum":o[r]=normalizeToSum(e[r],t);break;case"z-score":o[r]=normalizeByZScore(e[r]);break;default:o[r]=e[r].getNormalized()}else o[r]=e[r].clone();return o}},normalizeListsToMax=function(e,t){if(null!=e&&e[0].length){var n,r,o=new nT,i=e.length;for(r=0;r<i;r++)n=e[r],o[r]=normalizeToMax(n,t);return o.name=e.name,o}},normalizeListsToSum=function(e,t){if(null!=e&&e[0].length){var n,r,o=new nT,i=e.length;for(r=0;r<i;r++)n=e[r],o[r]=normalizeToSum(n,t);return o.name=e.name,o}},normalizeListsToInterval=function(e,t,n){if(null!=e&&e[0].length){var r,o,i=new nT,s=e.length;for(o=0;o<s;o++)r=e[o],i[o]=normalizeToInterval(r,t,n);return i.name=e.name,i}},averageSmootherOnLists=function(e,t,n){if(null!=e&&e[0].length){t=t||.5,n=n||1;var r=new nT;return r.name=e.name,e.forEach((function(o,i){r[i]=averageSmoother(e[i],t,n)})),r}},kMeans=function(e,t,n,r,o){if(null==e||null==e[0]||null==t||t<=0||0!==e.getLengths().getInterval().getAmplitude())return null;n=null==n?0:n,r=null==r||r<=0?1e3:r;var i,s,a,l,u,h,c,f,p=new nT;p.name="k-means clusters";var g,d,m,y,v=new nT,x=e.length,w=e[0].length,b=e.transpose(),T=p.clone();if(t>=b.length)return b;var _,M,S,N,R=function(e,t){var n=t.length;for(i=0;i<n;i++)if(containSameElements(e,t[i]))return!0;return!1};for(s=0;s<t;s++)if(o&&s<o.length)v[s]=b[o[s]].clone();else{for(u=b.getRandomElement(),y=0;R(u,v)&&y<100;)u=b.getRandomElement(),y++;if(100==y){t=s;break}v[s]=u.clone()}for(f=0;f<r;f++){for(s=0;s<t;s++)p[s]=new nL,p[s].name="-means cluster "+s;for(i=0;i<w;i++){for(u=b[i],c=99999999,l=0,s=0;s<t;s++)(h=distance(u,v[s]))<c&&(c=h,l=s);p[l].push(i)}for(i=0;i<p.length;i++)if(0==p[i].length)for(s=0;s<p.length;s++)if(!(s==i||p[s].length<2)){var E=p[s].length-1;p[i].push(p[s][E]),p[s]=p[s].getWithoutElementAtIndex(E);break}if(p.isEqual(T))break;for(T=p.clone(),s=0;s<t;s++){for(g=(d=p[s]).length,v[s]=new nL,v[s].name="k-means mean "+s,m=v[s],u=b[d[0]],a=0;a<x;a++)m[a]=u[a]/g;for(i=1;i<g;i++)for(u=b[d[i]],a=0;a<x;a++)m[a]+=u[a]/g}}if(1==n||5==n)for((_=new nL).name="mean index",i=0;i<t;i++)for(S=(M=p[i]).length,s=0;s<S;s++)_[M[s]]=i;if(2==n||5==n){(N=new cL).name="mean color";var O=createDefaultCategoricalColorList(t);for(i=0;i<t;i++)for(S=(M=p[i]).length,s=0;s<S;s++)N[M[s]]=O[i]}var C=new L;if(4==n||5==n)for(i=0;i<t;i++){for(C[i]=new nT,C[i].name="k-means subtable_"+i,S=(M=p[i]).length,s=0;s<S;s++)C[i].push(b[M[s]]);C[i]=C[i].transpose()}switch(n){case 0:return p;case 1:return _;case 2:return N;case 3:return v;case 4:return C;case 5:return{indexes:p,means:v,meanNumber:_,colors:N,subtables:C}}return null},product=function(e,t){if(null!=e&&null!=t){var n=e.length,r=e[0].length;if(0!==n&&0!==r&&n==t[0].length&&r==t.length){var o,i,s,a,l=new nT;for(o=0;o<n;o++)for(l[o]=new nL,i=0;i<n;i++){for(a=0,s=0;s<r;s++)a+=e[o][s]*t[s][i];l[o][i]=a}return l}}},getCovarianceMatrix=function(e){if(null!=e)return product(e,e.transpose()).factor(1/e.length)},generateNumberTable=function(e,t,n,r){e=null==e?0:e,n=null==n?t:n,r=null==r?1:r;var o,i=new i;switch(e){case 0:o=function(e,t){return e==t?r:0};break;case 1:o=function(e,t){return r};break;case 2:o=function(e,t){return Math.random()*r};break;case 3:o=function(e,t){return e==t?Math.random()*r:0}}for(var s=0;s<t;s++){i[s]=new nL,i[s].name="col_"+s;for(var a=0;a<n;a++)i[s][a]=o(s,a)}return i},identity=function(e){return e},mergeObjects=function(e,t){if(null==e)return null;if(null==t)return e;var n=Object.assign(cloneObject(e),t);return isEqual(e,n)?e:n},cloneObject=function(e){if(null==e)return null;var t;if(e.clone&&"function"==typeof e.clone)return e.clone();try{t=JSON.stringify(e)}catch(n){t=JSON.stringify(serliazeObject(e))}return JSON.parse(t)},serliazeObject=function(e){if(null==e)return null;var t,n,r;if(e.isTable){for(t=e.toArray(),n=e.length,r=0;r<n;r++)t[r]=serliazeObject(e[r]);return t}return e.isList?e.toArray():e},getInterval=function(e){if(null!=e)return null!=e.getInterval?e.getInterval():void 0},getFrame=function(e,t){var n;if(e.getFrame)return n=e.getFrame(),null!=t&&(n=n.expand(t)),n},getInfo=function(e,t){return null==e?null:(e.isTable?n=buildInformationObjectForTable(e,t):e.isList?n=buildInformationObjectForList(e,t):e.getInfo&&(n=e.getInfo()),null==n?null:(n.objectType=n.type,n.type=null,n));var n},getObjectStructure=function(e){var t=replaceValuesByNull(e);return objectToString(t)},replaceValuesByNull=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){if("object"==typeof e[n]&&null!=e[n]){t[n]=replaceValuesByNull(e[n]);continue}t[n]=null}return t},getLength=function(e,t){if(null!=e&&null!=e.length){if((t=null!=t&&t)&&null!=e.length){for(var n=0,r=0;r<e.length;r++)r in e&&n++;return n}return e.length}},includes=function(e,t){if(null!=e)return e.includes(t)},getPropertyValue=function(e,t){if(null!=e){for(var n="string"==typeof t?t.split("."):t,r=e[n[0]],o=1;null!=n[o];){if(null==r)return null;r=r[n[o]],o++}return r}},getPropertyValues=function(e,t,n){if(null!=e&&null!=e.length){if(e.isList)return e.getPropertyValues(t,n);var r,o=new L;o.name=t;for(var i=e.length,s=0;s<i;s++)r=getPropertyValue(e[s],t),o[s]=null==r?n:r;return o.downcast()}},getPropertyValuesInterval=function(e,t){if(null==e)return;let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;return e.forEach((e=>{null!=e[t]&&(n=Math.min(n,e[t]),r=Math.max(r,e[t]))})),new I(n,r)},getMultiplePropertyValues=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;for(var e=arguments[0],t=[],n=1;n<arguments.length;n++){var r={name:"value"+(n-1),description:arguments[n]?"The value of property "+arguments[n]:""};r.value=arguments[n]?getPropertyValue(e,arguments[n]):null,r.type=null==r.value?"Object":_typeOf(r.value),t.push(arguments[n]?r:null)}return t.isOutput=!0,t},getName=function(e){if(null!=e)return e.name},isPropertyValue=function(e,t){if(null==e)return!1;for(var n in e)if(e[n]===t)return!0;return!1},getPropertiesNames=function(e){if(null!=e){var t=sL.toL(Object.getOwnPropertyNames(e));return t.removeElement("__ob__"),t}},getPropertiesNamesAndValues=function(e){if(null!=e){var t=new T;return t[0]=getPropertiesNames(e),t[1]=new L,t[0].forEach((function(n,r){t[1][r]=e[n]})),t[1]=t[1].downcast(),t}},setPropertyValue=function(e,t,n,r,o){if(null!=e&&null!=t){var i=r?e:cloneObject(e);if(o&&null==n)return i;for(var s="string"==typeof t?t.split("."):t,a=i,l=0;l<s.length-1;l++)a=a[s[l]]=a[s[l]]||{};return a[s[l]]=n,i}},interpolateObjects=function(e,t,n,r){var o,i,s=_typeOf(e),a=1-(n=null==n?.5:n);if(s!=_typeOf(t))return n<.5?e:t;switch(s){case"number":return r&&Math.abs(e-t)<=r?t:a*e+n*t;case"I":return r&&Math.abs(e.x-t.x)+Math.abs(e.y-t.y)<=r?t:new I(a*e.x+n*t.x,a*e.y+n*t.y);case"nL":var l=Math.min(e.length,t.length),u=new nL;for(i=0,o=0;o<l;o++)u[o]=a*e[o]+n*t[o],i+=Math.pow(t[o]-u[o],2);return r&&i<r*r?t:u;case"Pol":l=Math.min(e.length,t.length);var h=new Pol;for(o=0;o<l;o++)h[o]=twoPointsInterpolation(e[o],t[o],n);return h;case"T":case"nT":var c=instanceSameType(t),f=(l=Math.min(e.length,t.length),!0);for(o=0;o<l;o++)c[o]=interpolateObjects(e[o],t[o],n,r),f=f&&c[o]==t[o];return f?t:c}return n<.5?e:t},replaceObject=function(e,t,n){return e==t?n:e},toList=function(e){return L.toL(e).downcast()},floor=function(e){return"number"==typeof e?Math.floor(e):e.floor?e.floor():null},addition=function(){var e,t;if(arguments.length<2){if(1==arguments.length&&null!=arguments[0]&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=addition(e,arguments[0][t]);return e}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnObjectWithList(arguments[0],arguments[1],ObjectOperators.addition);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=!1;i<o&&"string"!=i&&"string"!=o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r),s=!0);var a=o+"_"+i;switch(a){case"boolean_boolean":return n&&r;case"date_string":return s?r+dateToString(n):dateToString(n)+r;case"number_string":case"string_string":case"string_number":case"boolean_number":case"number_number":return n+r;case"PointPoint":return new P(n.x+r.x,n.y+r.y);case"Point3DPoint3D":return new P3D(n.x+r.x,n.y+r.y,n.z+r.z);case"numberPoint":return new P(n.x+r,n.y+r);case"numberPoint3D":return new P3D(n.x+r,n.y+r,n.z+r);case"Interval_number":return new I(n.x+r,n.y+r);case"IntervalPoint":return new P(n.getMin()+r.x,n.getMax()+r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x+r.x,n.y+r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()+r.x,n.getMax()+r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x+r.x,n.y+r.y,n.width+r.width,n.height+r.height);case"date_number":return new Date(n.getTime()+r/DateOperators_millisecondsToDays);case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(addition(n,r.date0),addition(n,r.date1));case"DateInterval_number":return new dI(addition(n.date0,r),addition(n.date1,r));case"DateInterval_Interval":return new dI(addition(n.date0,r.min),addition(n.date1,r.max));case"DateInterval_DateInterval":return new dI(addition(n.date0,r.date0),addition(n.date1,r.date1));case"string_StringList":return r.append(n,!1);case"StringList_string":return r.append(n,!0);default:return null}return n+r}for(e=arguments[0],t=1;t<arguments.length;t++)e=addition(e,arguments[t]);return e},multiplication=function(){var e,t;if(arguments.length<2){if(1==arguments.length&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=multiplication(e,arguments[0][t]);return e}return null}var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=o+"_"+i;if(2==arguments.length){if(null==arguments[0])return null;if("NumberTable_NumberTable"==s)return product(n,r);if(arguments[0].isList&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.multiplication);switch(i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r)),s=o+"_"+i){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n*r;case"PointPoint":return pointMultiplication(n,r);case"Point3DPoint3D":return new P3D(n.x*r.x,n.y*r.y,n.z*r.z);case"numberPoint":return new P(n.x*r,n.y*r);case"numberPoint3D":return new P3D(n.x*r,n.y*r,n.z*r);case"Interval_number":return new I(n.getMin()*r,n.getMax()*r);case"IntervalPoint":return new P(n.getMin()*r.x,n.getMax()*r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x*r.x,n.y*r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()*r.x,n.getMax()*r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x*r.x,n.y*r.y,n.width*r.width,n.height*r.height);case"date_number":return new Date(n.getTime()*(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(multiplication(n,r.date0),multiplication(n,r.date1));case"DateInterval_number":return new dI(multiplication(n.date0,r),multiplication(n.date1,r));case"DateInterval_Interval":return new dI(multiplication(n.date0,r.min),multiplication(n.date1,r.max));case"DateInterval_DateInterval":return new dI(multiplication(n.date0,r.date0),multiplication(n.date1,r.date1));default:return null}return n*r}for(e=arguments[0],t=1;t<arguments.length;t++)e=multiplication(e,arguments[t]);return e},division=function(){var e,t;if(arguments.length<2){if(1==arguments.length&&arguments[0]&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=division(e,arguments[0][t]);return e}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.division);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r);i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r));var s=o+"_"+i;switch(s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n/r;case"PointPoint":return new P(n.x/r.x,n.y/r.y);case"Point3DPoint3D":return new P3D(n.x/r.x,n.y/r.y,n.z/r.z);case"numberPoint":return new P(n.x/r,n.y/r);case"numberPoint3D":return new P3D(n.x/r,n.y/r,n.z/r);case"Interval_number":return new I(n.getMin()/r,n.getMax()/r);case"IntervalPoint":return new P(n.getMin()/r.x,n.getMax()/r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x/r.x,n.y/r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()/r.x,n.getMax()/r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x/r.x,n.y/r.y,n.width/r.width,n.height/r.height);case"date_number":return new Date(n.getTime()/(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(division(n,r.date0),division(n,r.date1));case"DateInterval_number":return new dI(division(n.date0,r),division(n.date1,r));case"DateInterval_Interval":return new dI(division(n.date0,r.min),division(n.date1,r.max));case"DateInterval_DateInterval":return new dI(division(n.date0,r.date0),division(n.date1,r.date1));default:return null}return n/r}for(e=arguments[0],t=1;t<arguments.length;t++)e=division(e,arguments[t]);return e},applyFunctionOnInput=function(e,t,n,r,o,i,s){if(null!=e&&null!=t)return"string"==typeof t&&(t=stringToFunction(t)),t.apply(this,[e,n,r,o,i,s])},isEqual=function(e,t){return _recursiveEqual(e,t)},_recursiveEqual=function(e,t){if(e==t)return!0;var n=_typeOf(e);if("string"==n||"number"==n||"boolean"==n||"null"==n)return!1;if(null==e||null==t)return!1;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var r in e)if(!_recursiveEqual(e[r],t[r]))return!1;return 0!=Object.keys(e).length||null==e.toString||null==t.toString||e.toString()==t.toString()},arrayOfArraysToTable=function(e,t,n){if(null==e)return null;t=null==t||t,n=null==n||n;for(var r=new T,o=t?1:0,i=0;i<e.length;i++){r[i]=new L,t&&e[i].length>0?r[i].name=String(e[i][0]):r[i].name="_";for(var s=o;s<e[i].length;s++)if(r[i][s-o]=e[i][s],n&&null!==r[i][s-o]){var a=String(r[i][s-o]),l=Number(a.replace(",",".")),u=l||0===l&&""!==a?l:a;"string"==typeof u&&(u=_removeQuotes(u)),r[i][s-o]=u}r[i]=r[i].downcast()}return r.downcast()},operate=function(operation,x,y,factor,mapFunction,name,numIterations){if(numIterations>1){var accumulated=x.isList?new T:new L;accumulated.push(x);for(var i=0;i<numIterations;i++)x=operate(operation,x,y,factor,mapFunction,name),accumulated.push(x);return accumulated.downcast()}if(numIterations<=-1)return operate(operation,operate(operation,x,y,factor,mapFunction,name,numIterations+1),y,factor,mapFunction,name);var f=null!=mapFunction?mapFunction:[_sum,_multiplication,_pow2,_pow3,Math.pow,Math.sqrt,Math.log,_logSum,Math.log2,_log2Sum,_log_y,Math.cos,_cosSum,Math.sin,_sinSum,Math.tan,_tanSum,Math.atan2,Math.floor,Math.round,Math.ceil,Math.abs,_modulo,_subtract,_divide][operation];factor=null==factor?1:factor;var type_x=null==x?"object":x.isTable?"table":x.isList?"list":"object",type_y=null==y?"object":y.isTable?"table":y.isList?"list":"object",combinedType=type_x+"_"+type_y,i,nL,nT,l;switch("string"==_typeOf(f)&&eval("f = function(x,y){ return "+f+"}"),combinedType){case"object_list":for(nL=new L,nL.name=null==name?y.name:name,i=0;i<y.length;i++)nL[i]=1==factor?f(x,y[i]):factor*f(x,y[i]);return nL.downcast();case"list_object":for(nL=new L,nL.name=null==name?x.name:name,i=0;i<x.length;i++)nL[i]=1==factor?f(x[i],y):factor*f(x[i],y);return nL.downcast();case"list_list":for(nL=new L,nL.name=null==name?y.name:name,l=Math.min(x.length,y.length),i=0;i<l;i++)nL[i]=1==factor?f(x[i],y[i]):factor*f(x[i],y[i]);return nL.downcast();case"object_table":for(nT=new T,nT.name=name,i=0;i<y.length;i++)nT[i]=operate(operation,x,y[i],factor,mapFunction);return nT.downcast();case"table_object":for(nT=new T,nT.name=name,i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y,factor,mapFunction);return nT.downcast();case"list_table":case"table_list":case"table_table":for(nT=new T,nT.name=name,l=Math.min(x.length,y.length),i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y[i],factor,mapFunction);return nT.downcast();default:return 1==factor?f(x,y):factor*f(x,y)}},_sum=function(e,t){return e+t},_multiplication=function(e,t){return e*t},_pow2=function(e){return Math.pow(e,2)},_pow3=function(e){return Math.pow(e,2)},_logSum=function(e,t){return Math.log(e+t)},_log2Sum=function(e,t){return Math.log2(e+t)},_log_y=function(e,t){return Math.log(e)/Math.log(t)},_cosSum=function(e,t){return Math.cos(e+t)},_sinSum=function(e,t){return Math.sin(e+t)},_tanSum=function(e,t){return Math.tan(e+t)},_modulo=function(e,t){return e%t},_subtract=function(e,t){return e-t},_divide=function(e,t){return e/t},numberToString=function(e,t){var n=e.toFixed(t);if(0==t)return n;for(;"0"==n.charAt(n.length-1);)n=n.substring(0,n.length-1);return"."==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},getRandomWithSeed=function(e){return(e=(9301*(e=null==e?1:e)+49297)%233280)/233280},numberFromBinaryPositions=function(e){var t,n=0;for(t=0;null!=e[t];t++)n+=Math.pow(2,e[t]);return n},numberFromBinaryValues=function(e){for(var t=0,n=e.length,r=0;r<n;r++)t+=1==e[r]?Math.pow(2,n-(r+1)):0;return t},powersOfTwoDecomposition=function(e,t){for(var n,r=new nL;0<e;)r[n=Math.floor(Math.log(e)/Math.LN2)]=1,e-=Math.pow(2,n);t=Math.max(r.length,null==t?0:t);for(var o=0;o<r.length;o++)r[o]=r[o]?1:0;for(;r.length<t;)r.unshift(0);return r},toBinary=function(e,t,n=!0){var r=powersOfTwoDecomposition(e,t);return n||(r=r.getReversed()),r},binaryToNumber=function(e,t=!0){if(null!=e){for(var n=t?e.getReversed():e,r=0,o=n.length,i=0;i<o;i++)r+=0==Number(n[i])?0:Math.pow(2,o-(i+1));return r}},positionsFromBinaryValues=function(e){var t,n=new nL;for(t=0;null!=e[t];t++)1==e[t]&&n.push(t);return n},_Alea=function(){return function(e){var t=0,n=0,r=0,o=1;0===e.length&&(e=[+new Date]);var i=_Mash();t=i(" "),n=i(" "),r=i(" ");for(var s=0;s<e.length;s++)(t-=i(e[s]))<0&&(t+=1),(n-=i(e[s]))<0&&(n+=1),(r-=i(e[s]))<0&&(r+=1);i=null;var a=function(){var e=2091639*t+2.3283064365386963e-10*o;return t=n,n=r,r=e-(o=0|e)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.version="Alea 0.9",a.args=e,a}(Array.prototype.slice.call(arguments))},_Mash=function(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t},random=function(){return new _Alea},randomSeed=function(e){NumberOperators_stackRandom.push(NumberOperators_random),NumberOperators_stackRandom.length>100&&NumberOperators_stackRandom.shift(),NumberOperators_random=new _Alea("my",e,"seeds"),NumberOperators_lastNormal=NaN},randomSeedPop=function(){NumberOperators_stackRandom.length>0&&(NumberOperators_random=NumberOperators_stackRandom.pop())},decimalPlaces=function(e){var t=String(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},logistic=function(e,t,n,r){return null==e||isNaN(e)?null:(n=null==n?0:n,r=null==r?1:r,(t=null==t?1:t)/(1+Math.exp(-r*(e-n))))},formatShort=function(e,t){if(null!=e){if(0==e||e==1/0)return String(e);if(isNaN(e))return e;if(t=null==t||t<1?2:t,String(e).length<=t)return String(e);var n=parseFloat(e.toPrecision(t)),r=Math.floor(Math.log10(n)),o="";return r>=15?(n=parseFloat((n/Math.pow(10,r)).toPrecision(t)),o="e"+r):r>=12?(n/=Math.pow(10,12),o="t"):r>=9?(n/=Math.pow(10,9),o="b"):r>=6?(n/=Math.pow(10,6),o="m"):r>=3?(n/=Math.pow(10,3),o="k"):r<-3&&(n=parseFloat((n/Math.pow(10,r)).toPrecision(t)),o="e"+r),(n=parseFloat(n.toPrecision(12)))+o}},numberToPosition=function(e){var t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"},getSoftenControlPoints=function(e,t,n,r){r=r||10;var o=angleFromTwoPoints(e,n);return[new P(t.x-r*Math.cos(o),t.y-r*Math.sin(o)),new P(t.x+r*Math.cos(o),t.y+r*Math.sin(o))]},bezierCurvePoints=function(e,t,n,r,o,i,s,a,l){let u=1-l,h=u*n+l*o,c=u*r+l*i;return new P(l*(u*h+l*(u*o+l*s))+u*(u*(u*e+l*n)+l*h),l*(u*c+l*(u*i+l*a))+u*(u*(u*t+l*r)+l*c))},triangleContainsPoint=function(e,t,n,r){var o=(e.x-r.x)*(t.y-r.y)-(t.x-r.x)*(e.y-r.y),i=(t.x-r.x)*(n.y-r.y)-(n.x-r.x)*(t.y-r.y),s=(n.x-r.x)*(e.y-r.y)-(e.x-r.x)*(n.y-r.y);return o>0&&i>0&&s>0||o>=0&&i>=0&&s>=0},triangleArea=function(e){return Math.abs(e.a.x*(e.b.y-e.c.y)+e.b.x*(e.c.y-e.a.y)+e.c.x*(e.a.y-e.b.y))/2},lineFromTwoPoints=function(e,t){if(e.x==t.x)return new P(1/0,e.x);var n=(t.y-e.y)/(t.x-e.x);return new P(n,e.y-n*e.x)},distancePointToLine=function(e,t){var n,r;0===t.x?(n=1/0,r=e.x):(n=-1/t.x,r=e.y-n*e.x);var o=intersectionLines(t,new P(n,r));return Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2))},distancePointToSegment=function(e,t,n){var r,o,i=t.x==n.x?1/0:(n.y-t.y)/(n.x-t.x),s=i==1/0?new P(1/0,t.x):new P(i,t.y-i*t.x);0===s.x?(r=1/0,o=e.x):(r=-1/s.x,o=e.y-r*e.x);var a=intersectionLines(s,new P(r,o));return a.x>=Math.min(t.x,n.x)&&a.x<=Math.max(t.x,n.x)?e.distanceToPoint(a):Math.min(e.distanceToPoint(t),e.distanceToPoint(n))},intersectionLines=function(e,t){if(e.x==t.x)return e.y==t.y?e.x==1/0?new P(e.y,0):new P(0,e.y):null;if(e.x==1/0)return new P(e.y,t.x*e.y+t.y);if(t.x==1/0)return new P(t.y,e.x*t.y+e.y);var n=(t.y-e.y)/(e.x-t.x);return new P(n,e.x*n+e.y)},intersectionLineRectangle=function(e,t,n,r){r=null!=r&&r;var o,i=lineFromTwoPoints(e,t),s=lineFromTwoPoints(n.getTopLeft(),n.getTopRight()),a=lineFromTwoPoints(n.getTopRight(),n.getBottomRight()),l=lineFromTwoPoints(n.getBottomLeft(),n.getBottomRight()),u=lineFromTwoPoints(n.getTopLeft(),n.getBottomLeft()),h=new Pol;if(null!=(o=intersectionLines(i,s))&&n.pointIsOnBorder(o)&&h.push(o),null!=(o=intersectionLines(i,a))&&n.pointIsOnBorder(o)&&h.push(o),null!=(o=intersectionLines(i,l))&&n.pointIsOnBorder(o)&&h.push(o),null!=(o=intersectionLines(i,u))&&n.pointIsOnBorder(o)&&h.push(o),!r){for(var c=new Pol,f=0;f<h.length;f++)(o=h[f]).x>=Math.min(e.x,t.x)&&o.x<=Math.max(e.x,t.x)&&o.y>=Math.min(e.y,t.y)&&o.y<=Math.max(e.y,t.y)&&c.push(o);h=c}return h},numberTableToPolygon=function(e){if(null==e||e.length<2)return null;var t,n=Math.min(e[0].length,e[1].length),r=new Pol;for(t=0;t<n;t++)r[t]=new P(e[0][t],e[1][t]);return r},numberTableToColorList=function(e,t){if(null!=e){if(t=null==t||t,"T"!=e.type&&"nT"!=e.type)throw new Error("Input must be a table");if(e.length<3)throw new Error("T must have at least 3 lists");for(var n,r,o,i=new i,s=0;s<e[0].length;s++){if(t)n=Math.max(0,Math.min(255,Math.round(e[0][s]))),r=Math.max(0,Math.min(255,Math.round(e[1][s]))),o=Math.max(0,Math.min(255,Math.round(e[2][s])));else{var a=HSVtoRGB(e[0][s],e[1][s],e[2][s]);n=Math.max(0,Math.min(255,Math.round(a[0]))),r=Math.max(0,Math.min(255,Math.round(a[1]))),o=Math.max(0,Math.min(255,Math.round(a[2])))}if(isNaN(n)||isNaN(r)||isNaN(o))throw new Error("Invalid format. T cells must be numbers in range [0,255]");i.push("rgb("+n+","+r+","+o+")")}return i}},numberTableToNetwork=function(e,t,n){n=null==n?0:n;var r,o,i,s,a,l,u,h,c=new Net;if(0===t)for(i=0;null!=e[i+1];i++)for(r=e[i],0===i?(a=new Nd(r.name,r.name),c.addNode(a)):a=c.nodes[i],s=i+1;null!=e[s];s++)o=e[s],0===i?(l=new Nd(o.name,o.name),c.addNode(l)):l=c.nodes[s],o=e[s],(h=1/(1+standardDeviationTwoNumberLists(r,o)))>=n&&(u=new Rel(i+"_"+s,a.name+"_"+l.name,a,l,h),c.addRelation(u));return c},buildDendrogramFromPolygon=function(e){var t,n,r,o=new Tr,i=new ndL,s=new Pol;e.forEach((function(e,n){(t=new Nd("point_"+n,"point_"+n)).weight=1,t.barycenter=e,t.point=e,t.polygon=new Pol(e),o.addNode(t),s.push(t),i.push(t)})),o.nodes=o.nodes.getReversed();for(var a,l=function(e,t){var r=new Nd("("+e.id+","+t.id+")","("+e.id+","+t.id+")");return r.polygon=e.polygon.concat(t.polygon),r.weight=r.polygon.length,n=e.weight+t.weight,r.barycenter=new P((e.weight*e.barycenter.x+t.weight*t.barycenter.x)/n,(e.weight*e.barycenter.y+t.weight*t.barycenter.y)/n),o.addNode(r),o._newCreateRelation(r,e),o._newCreateRelation(r,t),r};s.length>1;)a=_findClosestNodes(s),(r=l(s[a[0]],s[a[1]])).distance=a.distance,s.splice(a[0],1),s.splice(a[1]-1,1),s.push(r);o.nodes=o.nodes.getReversed();var u=function(e,t){e.level=t+1,e.to.forEach((function(t){u(t,e.level)}))};return u(o.nodes[0],-1),o.leaves=i,o},_findClosestNodes=function(e){var t,n,r,o,i=9999999999;for(t=0;null!=e[t+1];t++)for(n=t+1;null!=e[n];n++)(r=Math.pow(e[t].barycenter.x-e[n].barycenter.x,2)+Math.pow(e[t].barycenter.y-e[n].barycenter.y,2))<i&&(i=r,o=[t,n]);return o.distance=i,o},sortOnXY=function(e){return e.sort((function(e,t){return e.x<t.x||e.x==t.x&&e.y<t.y?-1:1}))},expandFromBarycenter=function(e,t){for(var n=new Pol,r=e.getBarycenter(),o=0;null!=e[o];o++)n[o]=e[o].expandFromPoint(r,t);return n},simplifyPolygon=function(e,t){t=null==t||0===t||void 0===t?1:t;var n,r,o,i,s,a=e.clone(),l=e.length;for(s=0;s<l;s++)n=a[s],r=a[(s+1)%l],o=a[(s+2)%l],i=lineFromTwoPoints(n,o),distancePointToLine(r,i)<t&&(a=a.getWithoutElementAtIndex((s+1)%l),s--),l=a.length;return a},bezierPolygonContainsPoint=function(e,t,n,r){var o=e.getFrame();r.clearContext(),r.context.fillStyle="black",r.context.fillRect(0,0,o.width,o.height),null!=n&&(r.context.strokeStyle="black",r.context.lineWidth=n),r.context.fillStyle="white",r.context.beginPath(),r.drawBezierPolygon(e,-o.x,-o.y),r.context.fill(),null!=n&&r.context.stroke();var i=r.context.getImageData(t.x-o.x,t.y-o.y,1,1).data;return r.clearContext(),i[0]>0},placePointsInsidePolygon=function(e,t,n){var r=new Pol,o=e.getFrame();if(0===(n=n||0)){for(var i;r.length<t;)i=new P(o.x+Math.random()*o.width,o.y+Math.random()*o.height),polygonContainsPoint(e,i)&&r.push(i);return r}},placePointsInsideBezierPolygon=function(e,t,n,r){var o=new Pol,i=e.getFrame();if(0===(n=n||0)){for(var s,a=0;o.length<t&&a<1e3;)s=new P(i.x+Math.random()*i.width,i.y+Math.random()*i.height),a++,bezierPolygonContainsPoint(e,s,r)&&(o.push(s),a=0);return o}},geoCoordinateToDecimal=function(e){return Math.floor(e)+1.66667*(e-Math.floor(e))},geoDistance=function(e,t){var n=Math.pow(Math.sin(.5*(t.y-e.y)*gradToRad),2)+Math.cos(e.y*gradToRad)*Math.cos(t.y*gradToRad)*Math.pow(Math.sin(.5*(t.x-e.x)*gradToRad),2);return GeoOperators_EARTH_DIAMETER*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))},polygonLength=function(e){if(e.length<2)return 0;for(var t=geoDistance(e[0],e[1]),n=2;null!=e[n];n++)t+=geoDistance(e[n-1],e[n]);return t},minRect=function(){if(null==arguments||arguments.length<1)return null;var e,t=arguments[0].clone();for(t.width=t.getRight(),t.height=t.getBottom(),e=1;null!=arguments[e];e++)t.x=Math.min(t.x,arguments[e].x),t.y=Math.min(t.y,arguments[e].y),t.width=Math.max(arguments[e].getRight(),t.width),t.height=Math.max(arguments[e].getBottom(),t.height);return t.width-=t.x,t.height-=t.y,t},packingRectangles=function(e,t,n=2){let r=function(e,t,n,r,o,i){for(var s,a=0;null!=e[a];a++)if(t+r>(s=e[a]).x-i&&t<s.x+s.width+i&&n+o>s.y-i&&n<s.y+s.height+i)return!0;return!1},o=t.getCenter(),i=t.width/t.height,s=new L;var a=new L;let l,u,h,c,f,p,g,d=0;for(let t=0;t<e.length;t++){if(h=e[t].width,c=e[t].height,0===t)l=o.x-.5*h,u=o.y-.5*c;else{for(f=.1*t,p=0;r(s,l,u,h,c,n);)p+=1,f+=.005*p,l=o.x+i*p*Math.cos(f)-.5*h,u=o.y+p*Math.sin(f)-.5*c;d=Math.max(d,i*p+.5*h)}a[t]=new Rec(l,u,h,c),s.push(a[t])}i=.5*t.width/d;for(let e=0;e<a.length;e++)g=a[e],g.x=o.x+(g.x-o.x)*i,g.y=o.y+(g.y-o.y)*i,g.width*=i,g.height*=i;return a},packingCircles=function(e,t,n){if(null==e||0===e.length)return null;var r=function(e,t,n,r,o){for(var i,s=0;null!=e[s];s++)if(i=e[s],Math.pow(i.x-t,2)+Math.pow(i.y-n,2)<Math.pow(i.z+r+o,2))return!0;return!1};n=null==n?0:n;for(var o,i,s,a=_.normalizeToMax(e).sqrt(),l=new Pol3D,u=0,h=0,c=0,f=0,p=t.getCenter(),g=100*a[0],d=t.width/t.height,m=0;m<a.length;m++){if(o=100*a[m],0===m)c=p.x,f=p.y,i=o;else{for(u=0,h=i+o+n+.1;r(l,c,f,o,n);)u+=.003*(h+=.06),c=p.x+d*h*Math.cos(u),f=p.y+h*Math.sin(u);g=Math.max(g,d*h+100*a[m])}l[m]=new _.P3D(c,f,o)}for(d=.5*t.width/(g+.001),m=0;null!=l[m];m++)(s=l[m]).x=p.x+(s.x-p.x)*d,s.y=p.y+(s.y-p.y)*d,s.z*=d;return l},fillWithRectangles=function(e,t,n,r){switch(null==n&&(n=new Rec(0,0,1,1)),t=t||0){case 0:return squarify(n,e);case 1:var o=e.getInterval();o.min<0&&(e=e.add(-o.min),o=new I(0,o.max-o.min));var i,s,a=e.getSum(),l=new L,u=n.y,h=n.height/a;for(s=0;null!=e[s];s++)i=h*e[s],l.push(new Rec(n.x,u,n.width,i)),u+=i;return l;case 2:(o=e.getInterval()).min<0&&(e=e.add(-o.min),o=new I(0,o.max-o.min)),a=e.getSum(),l=new L;var c,f=n.x,p=n.width/a;for(s=0;null!=e[s];s++)c=p*e[s],l.push(new Rec(f,n.y,c,n.height)),f+=c;return l;case 3:if(e.length<6);else if(6==e.length){var g=new Rec(.44,.36,.16,.45),d=new Rec(.6,.15,.3,.3),m=new Rec(.72,.45,.28,.32),y=new Rec(.38,.04,.22,.32),v=new P(.6,.36);g=expandRectangle(g,Math.sqrt(e[0]),v),d=expandRectangle(d,Math.sqrt(e[1]),v),y=expandRectangle(y,Math.sqrt(e[3]),v),m.x=d.x+.5*d.width,m.y=d.bottom;var x=new P(m.x+.3*m.width,d.bottom);(m=expandRectangle(m,Math.sqrt(e[2]),x)).y+=.2*m.height;var w=new P(.26,.36+Math.max(.3*g.height,.2*y.height)),b=new Rec(.1,w.y-.4,.2,.4),T=new Rec(.22,w.y,.16,.5);b=expandRectangle(b,Math.sqrt(e[4]),w),T=expandRectangle(T,Math.sqrt(e[5]),w);var _=.2*Math.max(y.width,g.width,T.right-w.x,b.right-w.x),M=Math.min(y.x,g.x)-Math.max(b.right,T.right)-_;return T.x+=M,b.x+=M,new L(g,d,m,y,b,T)}case 4:case 5:var S;S=0===(r=r||0)?Math.round(Math.sqrt(e.length)):Math.round(e.length/r);var N=Math.ceil(e.length/S),R=S*N-e.length,E=e.getMean(),O=concat(e,createListWithSameElement(R,E)),C=slidingWindowOnList(O,N,N,0),D=C.getSums(),k=this.fillWithRectangles(D,2,n);for(l=L(),s=0;s<S;s++)l=concat(l,this.fillWithRectangles(C[s],1,k[s]));return l}return null},squarify=function(e,t,n,r){if(null!=t){if(0===t.length)return new recL;if(1===t.length)return new recL(e);var o,i;r=r||!1,o=(n=n||!1)?t:normalizeToSum(t),r||(i=null==t.positions?o.getSortIndexes():t.positions,o=null==o.sortedWeights?o.getSorted(!1):o.sortedWeights);var s,a,l,u,h,c,f,p,g,d,m=e.width*e.height,y=new recL,v=e.clone(),x=new L,w=0,b=new Rec,T=t.length;if(T>2)for(p=w;p<T;p++)if(l=Number.MAX_VALUE,0===o[p])y.push(new Rec(b.x,b.y,0,0));else{for(g=1;g<T&&(s=nL.toL(o.slice(p,p+g)),a=x.slice(),h=(d=s.getSum())*m,b.x=v.x,b.y=v.y,v.width>v.height?(b.width=h/v.height,b.height=v.height):(b.width=v.width,b.height=h/v.width),!(l<=(u=(x=partitionRectangle(b,s,d)).highestRatio)));g++)l=u;if(0===a.length){if(y.push(new Rec(v.x,v.y,v.width,v.height)),y.length==T){if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}w++}else{if((y=y.concat(a)).length==T){if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}w+=a.length,c=a[a.length-1],v.width>v.height?(v.x=c.width+c.x,v.width-=c.width):(v.y=c.height+c.y,v.height-=c.height)}p=w-1}else 2==T?(s=o.clone(),b=e.clone(),y=partitionRectangle(b,s,s.getSum())):y[0]=new Rec(e.x,e.y,e.width,e.height);if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}},partitionRectangle=function(e,t,n){var r,o,i,s=e.width*e.height,a=new L,l=new Rec(e.x,e.y,e.width,e.height),u=1,h=t.length;for(o=0;o<h;o++)r=t[o]*s/n,e.width>e.height?(i=new Rec(l.x,l.y,r/l.height,l.height),a.push(i),l.x+=r/l.height):(i=new Rec(l.x,l.y,l.width,r/l.width),a.push(i),l.y+=r/l.width),i.ratio=Math.max(i.width,i.height)/Math.min(i.width,i.height),u=Math.max(u,i.ratio);return a.highestRatio=u,a},_getHighestRatio=function(e){var t,n,r=1;for(n=0;n<e.length;n++)t=e[n],r=Math.max(r,t.getRatio());return r},simplifyPolygons=function(e,t,n){for(var r,o=new polL,i=0;null!=e[i];i++)((r=simplifyPolygon(e[i],t)).length>0||!n)&&o.push(r);return o},createPolygon=function(e,t,n){var r=new Pol;if(0===t)for(var o=0;o<e;o++)r.push(new P(n.x+n.width*Math.random(),n.y+n.height*Math.random()));return r},twoNumberListsToPolygon=function(e,t){for(var n=Math.min(e.length,t.length),r=new Pol,o=0;o<n;o++)r[o]=new P(e[o],t[o]);return r},colorListFromColorScale=function(e,t){return e.getColorList.apply(e,[t])},colorListFromColorScaleFunction=function(e,t){var n,r=new cL;for(n=0;n<t;n++)r[n]=e(n/(t-1));return r},colorsLinearCombination=function(e,t){if(null!=e&&0!=e.length){if(1==e.length)return e[0];null==t&&(t=createListWithSameElement(e.length,1)),t=normalizeToSum(t);for(var n,r=colorStringToRGB(e[0],t[0]),o=1;o<e.length;o++)n=colorStringToRGB(e[o],t[o]),r[0]+=n[0],r[1]+=n[1],r[2]+=n[2];return"rgb("+Math.floor(r[0])+","+Math.floor(r[1])+","+Math.floor(r[2])+")"}},polygon3DToColorList=function(e){var t,n=e.length,r=new cL;for(t=0;t<n;t++)r.push(point3DToColor(e[t]));return r},colorListToPolygon3D=function(e){var t,n=e.length,r=new Pol3D;for(t=0;t<n;t++)r.push(colorToPoint3D(e[t]));return r},randomColor=function(e){return e=null==e?1:e,"rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+e+")"},getFlowTable=function(e,t,n){if(null!=e){t=t||!1;var r,o,i,s,a,l,u=e.length,h=e[0].length,c=new nL,f=new nL,p=new nL,g=-9999999,d=9999999,m=-9999999;for(a=0;a<h;a++){for(o=9999999,i=-9999999,s=0,l=0;l<u;l++){if((r=e[l]).length!=h)return;i=Math.max(i,r[a]),o=Math.min(o,r[a]),s+=r[a]}c.push(o),f.push(i),p.push(s),d=Math.min(d,o),g=Math.max(g,i),m=Math.max(m,s)}var y,v,x,w=m-d,L=new nT,b=n?1:0;if(t&&n)return L=new nT(e.length+1),e[0].forEach((function(){L[0].push(0)})),e.forEach((function(e,t){e.forEach((function(e,n){var r=p[n];L[t+1][n]=e/(0===r?1e-5:r)+L[t][n]}))})),L;for(L=new nT,t?v=Math.max(d,0):(v=d,x=w),a=0;a<u;a++)y=new nL,L.push(y);for(n&&L.push(new nL),a=0;a<h;a++)for(r=e[0],t&&(x=p[a]-v),n&&(L[0][a]=0),0===x&&(x=1e-5),L[b][a]=(r[a]-v)/x,l=1;l<u;l++)r=e[l],L[l+b][a]=(r[a]-v)/x+L[l-1+b][a];return L}},getFlowTableIntervals=function(e,t,n,r){if(null==e)return null;var o,i,s,a,l,u,h=getFlowTable(e,t,!0),c=new T,f=h.length,p=h[0].length,g=new nL;for(o=1;o<f;o++)for(h[o],s=new L,c[o-1]=s,i=0;i<p;i++)s.push(new I(h[o-1][i],h[o][i])),o==f-1&&(g[i]=h[o][i]);if(n)for(i=0;i<p;i++){for(l=new nL,s=c[o],o=0;o<f-1;o++)l.push(c[o][i].getAmplitude());var d=l.getSortIndexes();for(u=t||r?0:.5*(1-g[i]),o=0;o<f-1;o++)(a=c[d[o]][i]).y=u+a.getAmplitude(),a.x=u,u=a.y}else if(!t)for(i=0;i<p;i++)for(o=0;o<f-1;o++)a=c[o][i],r?(c[o][i].x=1-c[o][i].x,c[o][i].y=1-c[o][i].y):c[o][i]=a.add(.5*(1-g[i]));return c},scaleIntervals=function(e,t){if(null!=e){t=null==t?1:t;var n,r=new L,o=e.length;for(r.name=e.name,n=0;n<o;n++)r[n]=e[n].getScaled(t);return r}},nlsToIntervalList=function(e,t,n){if(null!=e&&null!=t){n=null!=n&&n;var r,o=Math.min(e.length,t.length),i=new iL;for(n&&(t=addition(e,t)),r=0;r<o;r++)i.push(new I(e[r],t[r]));return i}},fillTextRectangle=function(e,t,n,r,o,i,s,a,l,u,h){u=null!=u&&u,h=null!=h&&h;var c=textWordWrapReturnLines(e,r,o,i,a,l);h&&(n+=((null==o?600:o)-(null==i?16:i)*c.length)/2);var f=l.context.textAlign;u&&(l.context.textAlign="center",t+=(null==r?100:r)/2);var p=fillTextRectangleWithTextLines(c,t,n,o,i,s,l);return l.context.textAlign=f,p},fillTextRectangleWithTextLines=function(e,t,n,r,o,i,s){r=0===r||null==r?99999:r;for(var a=0;null!=e[a]&&(s.context.fillText(e[a],t,n+a*o),!((a+2)*o>r));a++);return i?e.length*o:e.length},textWordWrapReturnLines=function(e,t,n,r,o,i){t=t||100,n=n||600;var s=0===(r=r||16)?-1:Math.floor(n/r),a=new sL;if(t<=0)return a.push(e),a;var l,u,h,c,f,p,g=e.split(/\\n|\n/);for(l=0;l<g.length;l++)if(""!==g[l])if(i.context.measureText(g[l]).width<t&&a.length<s)a.push(g[l]);else{for(u=g[l].split(" "),h=1;u.length>0&&h<=u.length;)if(c=u.slice(0,h).join(" "),(f=i.context.measureText(c).width)>t){if(1==h&&(h=2),""!==(p=u.slice(0,h-1).join(" "))&&a.push(p),a.length==s){if(o){var d=a[a.length-1];i.context.measureText(d+"").width<=t?a[a.length-1]+="":(p=(u=d.split(" ")).slice(0,u.length-1).join(" ")+"",a.push(p))}return a}u=u.splice(h-1),h=1}else h++;h>0&&""!==(p=u.join(" "))&&a.push(p)}else a.push("");return a.width=1==a.length?f:t,a},getMaxTextWidth=function(e,t){for(var n=t.getTextW(e[0]),r=1;null!=e[r];r++)n=Math.max(n,t.getTextW(e[r]));return n},stringToObject=function(e){try{return JSON.parse(e)}catch(e){}if(null==e)return null;for(var t,n=e.split(/\r?\n/),r="[",o=!1,i=0;i<n.length;i++)if(0!=n[i].trim().length){if("{"==n[i]){for(t="";"}"!=n[i]&&i<n.length;)t+=" "+n[i],i++;t+="}"}else t=n[i];t=(o?",\r\n":"\r\n")+t,o=!0,r+=t}r+="\r\n]";try{return JSON.parse(r)}catch(e){return null}},stringToHash=function(e,t,n){if(null==e)return null;t=null==t?4294967295:t,n=null==n?1:n;var r,o,i,s,a,l=2166136261;for(o=0,a=e.length;o<a;++o)(s=65280&(i=e.charCodeAt(o)))&&(l=_fnv_multiply(l^s>>8)),l=_fnv_multiply(l^255&i);r=(l=_fnv_mix(l))%t;var u=1==n?0:_fnv_mix(_fnv_multiply(l)),h=new h;for(o=0;o<n;o++)h.push(r<0?r+t:r),r=(r+u)%t;return 1==n?h[0]:h},_fnv_multiply=function(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)},_fnv_mix=function(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,4294967295&(e+=e<<5)},decodeIdentedTree=function(e,t,n){t=null==t?"":t,n=null==n?"\t":n;var r,o,i,s,a,l,u,h,c,f=new Tr,p=splitByEnter(e),g=p.length;if(0===g||1==g&&(null==p[0]||""===p[0]))return null;for(""!==t&&null!=t&&(c=new Nd(t,t),f.addNodeToTree(c,null)),r=0;r<g;r++){for(s=(i=p[r]).length,o=0;o<s;o++)if(i.charAt(o)!=n){a=i.substr(o);break}u=new Nd(i,a),0===o?null!=c?f.addNodeToTree(u,c):f.addNodeToTree(u,null):(l=o+1-Number(null==c),h=null!=f.getLevel(l-1)&&f.getLevel(l-1).length>0?f.getLevel(l-1)[f.getLevel(l-1).length-1]:null,f.addNodeToTree(u,h))}return f.assignDescentWeightsToNodes(),f},TableToTree=function(e,t,n,r,o,i,s,a){if(null!=e){if(0===e.length)throw new Error("T has no Lists");if(null===e[0])throw new Error("table[0] is null");if(null!=i&&i.length!=e[0].length)throw new Error("weightsList must have a value for each row in the table");if(null!=s&&s.length!=e[0].length)throw new Error("colors list must have a value for each row in the table");t=null==t?e[0].name:t,r=null==r?0:r,o=null==o||""==o?"rgb(255,255,255)":o,a=null==a?0:a,null!=i&&i.getMin()<0&&(i=normalizeToInterval(i,new I(0,1)));var l,u,h,c=new Tr,f=new Nd(t,t);c.addNodeToTree(f,null);var p,g,d,m,y,v,x=e.length;if(n)if(y=0==r?x-1:0,s){var w=T.toL([e[y],s]);v=buildDictionaryObjectForDictionary(w)}else v=createCategoricalColorListForList(e[y])[4].value;if(1==a){if(2!=e.length)throw new Error("T must have 2 Lists for parent-child mode");var L,b,_,M=difference(e[0].getWithoutRepetitions(),e[1].getWithoutRepetitions());if(0==M.length)throw new Error("Invalid data for a tree. Likely has loops in the relationships.");for(p=0;p<M.length;p++)l=new Nd(String(M[p]),String(M[p])),c.addNodeToTree(l,f);for(;M.length>0;){for(L=new sL,p=0;p<e[0].length;p++)if(-1!=M.indexOfElement(e[0][p])){if(null==(_=c.nodes.get(String(e[0][p])))&&new Error("Invalid data for a tree. Nd "+String(e[0][p])+" not found as parent"),null!=(b=c.nodes.get(String(e[1][p]))))throw new Error("Invalid data for a tree. Nd "+String(e[1][p])+" has multiple parents.");b=new Nd(String(e[1][p]),String(e[1][p])),n&&0==r?b.color=v[String(e[1][p])]:!n||1!=r&&2!=r||(b.color=v[String(e[1][p])]),L.push(String(e[1][p])),c.addNodeToTree(b,_),null!=i&&(b.weight=i[p])}M=L.clone()}}else for(p=0;p<x;p++)if(null!=e[p])for(d=e[p],g=0;g<d.length;g++)null!=(m=d[g])&&(h=_getId(e,p,g),null==(l=c.nodes.get(h))?(l=new Nd(h,String(m)),n&&p==x-1&&0==r?l.color=v[m]:!n||1!=r&&2!=r||(l.color=v[e[0][g]]),0===p?c.addNodeToTree(l,f):(u=c.nodes.get(_getId(e,p-1,g)),c.addNodeToTree(l,u)),l.firstIndexInTable=g,l.indexesInTable=new nL(g),null!=i&&(l.weight=i[g])):(null!=i?l.weight+=i[g]:l.weight++,l.indexesInTable.push(g)));if(n&&2==r)for(p=0;p<c.nodes.length;p++)0==(l=c.nodes[p]).level?l.color=o:l.color=interpolateColors(l.color,o,(l.level-1)/(c.nLevels-1));c.assignDescentWeightsToNodes();var S=function(e){var t;if(0===e.to.length)return e.indexesInTable;for(e.indexesInTable=new nL,t=0;null!=e.to[t];t++)e.indexesInTable=e.indexesInTable.concat(S(e.to[t]));return e.indexesInTable};return S(c.nodes[0]),c}},_getId=function(e,t,n){for(var r=1,o="_"+String(e[0][n]);r<=t;)o+="_"+String(e[r][n]),r++;return o},TreeToTable=function(e,t,n){if(null!=e){t=null==t||t,n=null!=n&&n;var r,o,i=new T,s=e.getLeaves(),a=function(e,t,n){if(0==e)return!1;for(var r=0;r<i[e].length;r++)if(i[e][r]==t&&i[e-1][r]!=n)return!0;return!1};n||(a=function(){return!1});for(var l=0;l<s.length;l++){(r=e.getAncestorsOf(s[l]).reverse()).addNode(s[l]),t||(r=r.slice(1));for(var u=r.length-1;u>=0;u--){for(null==i[u]&&(i[u]=new sL),o=r[u].name;a(u,o,u>0?r[u-1].name:"");)o+="";i[u][l]=o}}return i}},treeToObject=function(e,t){if(null==e||"Tr"!=e.type)return null;var n,r={},o=[r],i=["name","id","level","weight","color"];e.traverse(null,null,(function(e){for(var s in 0==e.level?n=r:(n={},o[e.level].push(n)),e)"type"==s&&0==e.level||(t||i.includes(s))&&"object"!=typeof e[s]&&null!=e[s]&&(n[s]=e[s]);return e.to.length>0&&(n.children=[],o[e.level+1]=n.children),!0}));return r},objectToTree=function(e){if(null==e)return null;var t=new Tr,n=function(e,t,r){var o=null!=r.name?r.name:"",i=null!=r.id?r.id:"_"+o;null!=e.nodes.get(i)&&(i=e.nodes.getNewId());var s=new Nd(i,o);e.addNodeToTree(s,t);var a=!0;for(var l in r)if("id"!=l&&"name"!=l)if("[object Array]"!=Object.prototype.toString.call(r[l]))s[l]=r[l];else if(a){for(var u=0;u<r[l].length;u++)n(e,s,r[l][u]);a=!1}else s[l]=JSON.parse(JSON.stringify(r[l]))};return n(t,null,e),t},filterNetworkByRelationsWeight=function(e,t=0,n,r,o){let i,s=new _.Net;switch(t){case 0:i=e.relations.getSortedByProperty("weight",!1).slice(0,n);break;case 1:i=e.relations.filter((e=>e.weight>n))}return i.forEach((e=>{let t=s.createNode(e.node0.name),n=s.createNode(e.node1.name);r&&r.forEach((r=>{t[r]=e.node0[r],n[r]=e.node1[r]}));let i=s.createRelation(t,n);o&&o.forEach((t=>{i[t]=e[t]})),i.weight=e.weight,i.color=e.color})),s},filterNodesByMinDegree=function(e,t){var n;for(n=0;null!=e.nodes[n];n++)e.nodes[n].nodes.length<t&&(e.removeNode(e.nodes[n]),n--);return null},degreeBetweenNodes=function(e,t,n){if(null==e||null==t||null==n)return null;if(t==n)return 0;for(var r,o,i,s=t.nodes,a=1;null==s.get(n.id);){for(r=s.clone(),i=s.length,o=0;o<i;o++)r=concat(r,s[o].nodes);if(r=r.getWithoutRepetitions(),s.length==r.length)return-1;s=r,a++}return a},getNodesBetweenTwoNodes=function(e,t,n){var r,o,i=new ndL,s=e.nodes.length;for(r=0;r<s;r++)(o=e.nodes[r]).id!=t.id&&o.id!=n.id&&null!=t.nodes.get(o.id)&&null!=n.nodes.get(o.id)&&i.addNode(o);return i},getSubNetwork=function(e,t,n,r){for(var o,i,s,a=new Net,l=0;l<t.length;l++)if(o=new Nd(t[l].id,t[l].name),a.addNode(o),n)for(var u=0;u<n.length;u++)o[n[u]]=t[l][n[u]];for(l=0;l<e.relations.length;l++)if(o=a.nodes.get(e.relations[l].node0.id),i=a.nodes.get(e.relations[l].node1.id),null!=o&&null!=i&&(s=new Rel(e.relations[l].id,e.relations[l].name,o,i,e.relations[l].weight),a.addRelation(s),r))for(u=0;u<r.length;u++)s[r[u]]=e.relations[l][r[u]];return a},shortestPath=function(e,t,n,r){if(null==e||null==t||null==n)return null;var o=spanningTree(e,t,n),i=new ndL;r&&i.addNode(n);var s=o.nodes.get(n.id);if(null==s)return null;for(;s.parent.id!=t.id;)if(i.addNode(s.parent.node),null==(s=s.parent))return null;return r&&i.addNode(t),i.getReversed()},shortestPaths=function(e,t,n,r,o){if(null==e||null==t||null==n)return null;var i,s=new T;if(null!=t.nodes.get(n.id))return s.push(new ndL(t,n)),s;null==o&&(o=spanningTree(e,t,n));var a,l,u=o.nLevels,h=new ndL(n),c=adjacentNodeList(e,h,!1),f=intersection(c,o.getLevel(u-2)),p=new T;for(p.push(getRelationsBetweenNodeLists(e,f,h,!1));u>2;)u--,f=intersection(adjacentNodeList(e,h=f,!1),o.getLevel(u-2)),a=getRelationsBetweenNodeLists(e,f,h,!1),p.push(a);for(p=p.getReversed(),i=0;null!=p[0][i];i++)s.push(new ndL(t,p[0][i].getOther(t)));for(var g,d,m,y=function(e,t){var n,r=new T,o=e[e.length-1];return t.forEach((function(t){o.relations.get(t.id)&&((n=e.clone()).addNode(t.getOther(o)),r.push(n))})),r};s[0].length<o.nLevels;){for(l=new T,d=s.length,i=0;i<d;i++)g=y(m=s[i],p[m.length-1]),l=l.concat(g);s=l}return s},getRelationsBetweenNodeLists=function(e,t,n,r=!0){if(null==t||null==n)return null;var o,i,s=new relL,a=e.relations.length;for(i=0;i<a;i++)o=e.relations[i],(null!=t.get(o.node0.id)&&null!=n.get(o.node1.id)||!r&&null!=t.get(o.node1.id)&&null!=n.get(o.node0.id))&&s.addRelation(o);return s},_extendPaths=function(e,t,n){if(e[0].length>=n)return e;var r,o,i,s,a,l,u=new T,h=e.length;for(r=0;r<h;r++)for(l=(i=(s=e[r])[s.length-1].nodes.getWithoutRepetitions()).length,o=0;o<l;o++)null==s.get(i[o].id)&&((a=s.clone()).addNode(i[o]),u.push(a));return _extendPaths(e=u,t,n)},loops=function(e,t=3){if(null==e)return null;let n=function(e,t){if(e.length!=t.length)return!1;if(null==t.get(e[0].id))return!1;for(var n=t.indexOf(e[0]),r=e.length,o=1;null!=e[o];o++)if(e[o]!=t[(o+n)%r])return!1;return!0};var r,o,i,s,a=new T;for(r=0;null!=e.nodes[r];r++){for(s=_getLoopsOnNode(e.nodes[r]),i=0;null!=a[i];i++)for(o=0;null!=s[o];o++)n(s[o],a[i])&&(s.splice(o,1),o--);a=a.concat(s)}return t&&(a=a.getFilteredByPropertyValue("length",t,"greater")),a.sort((function(e,t){return e.length>t.length?-1:1})),a},_getLoopsOnNode=function(e){if(0===e.to.length||0===e.from.length)return[];var t,n,r,o,i=new T,s=new ndL;for(s.addNode(e),i.push(s),_loopsColumns(e.to,1,i,1),t=1;i[t];t++)for(n=1;null!=i[n];n++)for(r=0;null!=i[n][r];r++)delete(o=i[n][r]).onColumn,0===o.to.length&&(i[n].removeNodeAtIndex(r),r--);var a,l=new T;for(n=1;null!=i[n];n++)for(r=0;null!=i[n][r];r++)null!=(o=i[n][r]).to.get(e.id)&&(a=new ndL(o),l.push(a),_pathsToCentral(i,n,a,l));return l.sort((function(e,t){return e.length>t.length?-1:1})),l},_pathsToCentral=function(e,t,n,r){if(!n.finished)if(0!==t){var o,i,s,a,l=n[0],u=!0,h=e[t-1].clone();h.addNodes(e[t]);var c=e[t-1].length;for(o=0;null!=h[o];o++)l==(i=h[o])||null!=n.get(i.id)||null!=s&&null!=s.get(i.id)||null!=i.to.get(l.id)&&(u?(s=n.clone(),n.unshift(i),n.ids[i.id]=i,_pathsToCentral(e,o<c?t-1:t,n,r),u=!1):(a=s.clone(),r.push(a),a.unshift(i),a.ids[i.id]=i,_pathsToCentral(e,o<c?t-1:t,a,r)))}else n.finished=!0},_loopsColumns=function(e,t,n){var r;null==n[t]&&(n[t]=new ndL);for(var o=new ndL,i=0;null!=e[i];i++)(r=e[i]).onColumn||(r.onColumn=!0,n[t].addNode(r),o.addNodes(r.to));for(o=o.getWithoutRepetitions(),i=0;i<o.length;i++)o[i].onColumn&&(o.removeNodeAtIndex(i),i--);o.length>0&&_loopsColumns(o,t+1,n)},spanningTree=function(e,t,n,r){if(null!=e){if(r>0)return _spanningTree2(t,r,n);t=null==t?e.nodes[0]:t,r=null==r?0:r;var o,i,s,a,l,u=new Tr,h=new Nd(t.id,t.name);h.node=t,u.addNodeToTree(h);var c=(o=t.nodes).length,f=!1;for(a=0;a<c;a++)(s=new Nd(o[a].id,o[a].name)).id!=h.id&&(s.node=o[a],u.addNodeToTree(s,h),null!=n&&s.id==n.id&&(f=!0));if(f)return u;var p=o.clone();p.addNode(t);for(var g=0;;){for(i=0==r?new ndL:o.clone(),a=0;null!=o[a];a++)i.addNodes(o[a].nodes);if((i=i.getWithoutRepetitions()).removeElements(p),0===i.length)return u;for(a=0;a<i.length;a++){(s=new Nd(i[a].id,i[a].name)).node=i[a];var d=i[a].nodes;if(null!=d&&0!=d.length){for(var m=0;null!=d[m];m++)if(l=d[m].id,null!=o.get(l)&&s.id!=l){u.addNodeToTree(s,u.nodes.get(l));break}null!=n&&s.id==n.id&&(f=!0)}}if(f&&(f=!0),f)return u;if(o=i,p=p.concat(i),++g>e.nodes)return null}return u}},_spanningTree2=function(e,t,n){t=null==t?0:t;var r=new Tr,o=function(e,i){if(!n||e.id!=n.id){var s=r.nodes.get(e.id);if(null==s){var a;switch(s=new Nd(e.id,e.name),r.addNodeToTree(s,i),t){case 0:a=e.nodes;break;case 1:a=e.to;break;case 2:a=e.from}for(var l=0;l<a.length;l++)o(a[l],s)}}};if(Array.isArray(e)){var i=new Nd("root","root");r.addNodeToTree(i),e.forEach((e=>o(e,i)))}else o(e,null);return r},influenceLevels=function(e,t,n=!0){let r,o=new T,i=new T,s=new relL,a=null!=t.length,l=a?t:new ndL;a||l.addNode(t);let u=Math.random();l.forEach((e=>{e.__mark=u,e.__level=-1}));let h=function(e,t,o=0){r.push(e);let i=function(e,t,r){if(0==e.length)return null;let o,i,a=new ndL,l=t==n;return e.forEach((e=>{e.__level=r,o=t?e.toRelations:e.fromRelations,o?.forEach((e=>{i=t?e.node1:e.node0,e._onImpactTo=!0,i.__mark!=u&&(i.__mark=u,l&&s.addRelation(e),a.addNode(i))}))})),a}(e,t,o);if(0!=i.length)return h(i,t,o+1),i};n?(r=o,h(l,!0),r=i,h(l,!1)):(r=o,h(l,!1),r=i,h(l,!0));let c=[];for(let t=0;t<e.nodes.length;t++)e.nodes[t].__mark!=u&&(c.push(e.nodes[t]),e.nodes[t].__level=-1);let f=new relL;for(let t=0;t<e.relations.length;t++)e.relations[t].node1?.__level-e.relations[t].node0?.__level==1&&f.addRelation(e.relations[t]);return{levelsTableMain:o,levelsTableSecondary:i,notImpacted:c,influenceRelations:s,extendedInfluenceRelations:f}},adjacentNodeList=function(e,t,n,r){if(null==e||null==t)return null;var o,i,s,a,l=n?t.clone():new ndL;if(r){for(o=0;o<t.length;o++)for(i=0;i<t[o].to.length;i++)a=t[o].to[i].id,null==t.get(a)&&null==l.get(a)&&l.addNode(a);return l}for(o=0;o<t.length;o++)for(i=0;null!=t[o].relations[i];i++)s=t[o].relations[i].node0,a=t[o].relations[i].node1,null==t.get(s.id)&&null==l.get(s.id)&&l.addNode(s),null==t.get(a.id)&&null==l.get(a.id)&&l.addNode(a);return l},degreesPartition=function(e,t){var n,r,o,i,s=new ndL(t),a=t.nodes,l=new T(s),u=a.length>0;u&&l.push(a);var h=a.clone();for(h.push(t);u;){for(r=new ndL,o=0;null!=a[o];o++)for(n=a[o].nodes,i=0;i<n.length;i++)h.includes(n[i])||(r.push(n[i]),h.push(n[i]));(u=r.length>0)&&(a=r,l.push(a))}return l},getNodes=function(e){return null==e?null:null!=e.nodes?e.nodes:"Rel"==typeOf(e)?new ndL(e.node0,e.node1):null},buildDendrogram=function(e){if(null==e)return null;var t,n,r,o,i,s,a=new Tr,l=new ndL,u=e.nodes.length,h=2*e.relations.length/(u*(u-1));for(s=0;s<u;s++)(o=new Nd("["+e.nodes[s].id+"]","["+e.nodes[s].id+"]")).nodes=new ndL(e.nodes[s]),a.addNode(o),l[s]=o;for(;l.length>1;){for(n=l[(t=_getClosestPair(l,!0,h))[0]],r=l[t[1]],(o=new Nd(i="["+n.id+"-"+r.id+"]",i)).weight=t.strength,a.addNode(o),a.createRelation(o,n,i+"-"+n.id),a.createRelation(o,r,i+"-"+r.id),o.node=new Nd(i,i),o.nodes=n.nodes.concat(r.nodes),s=0;s<n.nodes.length;s++)o.node.nodes.addNode(n.nodes[s]),o.node.relations.addRelation(n.relations[s]);for(s=0;s<r.nodes.length;s++)o.node.nodes.addNode(r.nodes[s]),o.node.relations.addRelation(r.relations[s]);l.removeElement(n),l.removeElement(r),l.addNode(o)}for(s=0;s<a.nodes.length;s++)(n=a.nodes[s]).nodes.length>1&&(n.level=Math.max(n.nodes[0].level,n.nodes[1].level)+1);return a},_getClosestPair=function(e,t,n){var r,o,i,s,a;if(2==e.length){var l=e[0].nodes.indexOf(e[1]);return t?((r=[0,1]).strength=-1==l?0:e[0].relations[l].weight,r):((e=new ndL(e[0],e[1])).strength=-1==l?0:e[0].relations[l].weight,e)}var u=-1;for(o=0;o<e.length-1;o++)for(s=e[o].nodes,i=o+1;i<e.length;i++)(a=_strengthBetweenSets(s,e[i].nodes,n))>u&&(r=[o,i],u=a);return r.strength=u,t?r:((e=new ndL(e[r[0]],e[r[1]])).strength=u,e)},_strengthBetweenSets=function(e,t,n){var r,o,i,s=0;for(r=0;r<e.length;r++)for(i=e[r],o=0;o<i.nodes.length;o++)t.includes(i.nodes[o])&&(s+=i.relations[o].weight);return s/(e.length*t.length*n)},buildNetworkClusters=function(e,t,n,r,o,i){if(null!=e){var s,a,l,u,h,c;if(null==t||0===t?s=_buildNetworkClustersLvn(e):(null!=e._dendrogramTree&&(n=e._dendrogramTree),null==n&&(n=buildDendrogram(e)),e._dendrogramTree=n,r=r||.5,s=new T,_iterativeBuildClusters(n.nodes[n.nodes.length-1],s,r)),o)for(a=createDefaultCategoricalColorList(s.length),h=s.length,l=0;l<h;l++)for(c=s[l].length,u=0;u<c;u++)s[l][u].color=a[l];if(1==i){var f=new sL;for(f.name="clusters names",l=0;l<e.nodes.length;l++)e.nodes[l]._index=l;for(l=0;l<s.length;l++)for(c=s[l].length,u=0;u<c;u++)f[s[l][u]._index]="cluster_"+l;return f}return s}},_iterativeBuildClusters=function(e,t,n){1!=e.nodes.length?(1==e.nodes[0].nodes.length||e.nodes[0].weight>n?t.push(e.nodes[0].nodes):_iterativeBuildClusters(e.nodes[0],t,n),1==e.nodes[1].nodes.length||e.nodes[1].weight>n?t.push(e.nodes[1].nodes):_iterativeBuildClusters(e.nodes[1],t,n)):t.push(new ndL(e.node))},_buildNetworkClustersLvn=function(e){if(null==e)return e;var t,n=[];for(t=0;t<e.nodes.length;t++)n.push("n"+e.nodes[t].id);var r=[];for(t=0;t<e.relations.length;t++){var o={source:"n"+e.relations[t].node0.id,target:"n"+e.relations[t].node1.id,weight:e.relations[t].weight};r.push(o)}var i=_jLvn().nodes(n).edges(r)(),s=new T;if(i)for(t=0;t<e.nodes.length;t++){var a=i["n"+e.nodes[t].id];null==s[a]&&(s[a]=new ndL),s[a].addNode(e.nodes[t])}else for(t=0;t<e.nodes.length;t++)s.push(new ndL(e.nodes[t]));return s},getNodesPageRanks=function(e,t,n){return addPageRankToNodes(e,t,n)},addPageRankToNodes=function(e,t=2,n){var r,o,i,s,a,l,u,h=e.nodes.length,c=(1-.85)/h,f=["toPageRank","fromPageRank","allPageRank"][t=0==t?0:1==t?1:t],p=1;for(e.minFromPageRank=e.minToPageRank=99999999,e.maxFromPageRank=e.maxToPageRank=-99999999,o=0;null!=e.nodes[o];o++)(s=e.nodes[o])[f]=1/h;let g;for(r=0;r<300;r++)for(o=0;null!=e.nodes[o];o++){switch(s=e.nodes[o],t){case 0:l=s.to;break;case 1:l=s.from;break;case 2:l=s.nodes}for(s[f]=c,n&&(u=t?s.fromRelations:s.toRelations),i=0;null!=l[i];i++)a=l[i],n&&(p=u[i].weight),s[f]+=.85*p*a[f]/(t?a.to.length:a.from.length);299==r&&(n&&(s[f]=Math.pow(s[f],4)),t?(e.minFromPageRank=Math.min(e.minFromPageRank,s[f]),g=e.maxFromPageRank=Math.max(e.maxFromPageRank,s[f])):(e.minToPageRank=Math.min(e.minToPageRank,s[f]),g=e.maxToPageRank=Math.max(e.maxToPageRank,s[f])))}return e.nodes.forEach((e=>{e[f]/=g,console.log(e[f])})),e.nodes.getPropertyValues(f)},fusionNetworks=function(e,t,n,r){t=null==t?1:t,n=null==n?1:n;var o,i,s,a,l,u=new Net,h=new T,c=createDefaultCategoricalColorList(e.length).getInterpolated("black",.17).getInterpolated("white",.55);for(e.forEach((function(e,t){h[t]=new ndL,e.nodes.forEach((function(e){null==(o=u.nodes.get(e.id))?((o=new Nd(e.id,e.name)).basicId=e.basicId,o.mapId="map_"+t,o.mapsIds=[o.mapId],o.color=null==e.color?e.color:c[t],o.nMaps=1,o.weight=e.weight,o.kind=e.kind,r&&r.forEach((t=>o[t]=e[t])),u.addNode(o),h[t].addNode(o)):(o.nMaps+=1,o.mapsIds.push("map_"+t),o.color=null==o.color?"rgb(200,200,200)":o.color,e.weight&&null==o.weight&&(o.weight=e.weight),e.kind&&null==o.kind&&(o.kind=e.kind),r&&r.forEach((t=>{e[t]&&null==o[t]&&(o[t]=e[t])})))}))})),e.forEach((function(e){e.relations.forEach((function(e){(i=new Rel(e.id,e.name,u.nodes.get(e.node0.id),u.nodes.get(e.node1.id))).color=e.color,i.content=e.content,i.description=e.description,i.weight=e.weight,u.addRelation(i)}))})),s=0;null!=u.nodes[s];s++)for(l=u.nodes[s],a=s+1;null!=u.nodes[a];a++)l.name==u.nodes[a].name&&((i=new Rel(l.id+"_"+u.nodes[a].id,"same variable",l,u.nodes[a])).color="black",i.distanceFactor=t,i.forceWeight=n,u.addRelation(i),(i=new Rel(u.nodes[a].id+"_"+l.id,"same variable",u.nodes[a],l)).color="black",i.distanceFactor=t,i.forceWeight=n,u.addRelation(i),i.node0.nMaps+=1,i.node1.nMaps+=1);for(s=0;null!=u.nodes[s];s++)u.nodes[s].hubWeight=Math.sqrt(u.nodes[s].nMaps-1);return u.mapsCluster=h,u},_jLvn=function(){var e,t,n,r={};function o(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t)}function i(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function s(e,t){var n=e._assoc_mat[t]?Object.keys(e._assoc_mat[t]):[],r=0;return n.forEach((function(n){var o=e._assoc_mat[t][n]||1;t==n&&(o*=2),r+=o})),r}function a(e,t){return void 0===e._assoc_mat[t]?[]:Object.keys(e._assoc_mat[t])}function l(e,t,n){return e._assoc_mat[t]?e._assoc_mat[t][n]:void 0}function u(e){var t={};return e.forEach((function(e){t[e.source]=t[e.source]||{},t[e.source][e.target]=e.weight,t[e.target]=t[e.target]||{},t[e.target][e.source]=e.weight})),t}function h(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=h(e[n]);return t}function c(e,t,n){t.nodes_to_com={},t.total_weight=0,t.internals={},t.degrees={},t.gdegrees={},t.loops={},t.total_weight=function(e){var t=0;return e.edges.forEach((function(e){t+=e.weight})),t}(e),void 0===n?e.nodes.forEach((function(n,r){t.nodes_to_com[n]=r;var o=s(e,n);o<0||(t.degrees[r]=o,t.gdegrees[n]=o,t.loops[n]=l(e,n,n)||0,t.internals[r]=t.loops[n])})):e.nodes.forEach((function(r){var o=n[r];t.nodes_to_com[r]=o;var i=s(e,r);t.degrees[o]=(t.degrees[o]||0)+i,t.gdegrees[r]=i;var l=0;a(e,r).forEach((function(t){var i=e._assoc_mat[r][t];if(i<=0)throw"Bad graph type, use positive weights";n[t]==o&&(l+=t==r?i:i/2)})),t.internals[o]=(t.internals[o]||0)+l}))}function f(e){var t=e.total_weight,n=0;return o(i(e.nodes_to_com)).forEach((function(r){var o=e.internals[r]||0,i=e.degrees[r]||0;t>0&&(n=n+o/t-Math.pow(i/(2*t),2))})),n}function p(e,t,n){var r={};return a(t,e).forEach((function(o){if(o!=e){var i=t._assoc_mat[e][o]||1,s=n.nodes_to_com[o];r[s]=(r[s]||0)+i}})),r}function g(e,t,n,r){r.nodes_to_com[e]=+t,r.degrees[t]=(r.degrees[t]||0)+(r.gdegrees[e]||0),r.internals[t]=(r.internals[t]||0)+n+(r.loops[e]||0)}function d(e,t,n,r){r.degrees[t]=(r.degrees[t]||0)-(r.gdegrees[e]||0),r.internals[t]=(r.internals[t]||0)-n-(r.loops[e]||0),r.nodes_to_com[e]=-1}function m(e){var t=0,n=h(e),r={};return Object.keys(e).forEach((function(o){var i=e[o],s=void 0===r[i]?-1:r[i];-1==s&&(r[i]=t,s=t,t+=1),n[o]=s})),n}function y(e,t){for(var n=!0,r=0,o=f(t),i=o;n&&-1!=r&&(o=i,n=!1,r+=1,e.nodes.forEach((function(r){var o=t.nodes_to_com[r],i=(t.gdegrees[r]||0)/(2*t.total_weight),s=p(r,e,t);d(r,o,s[o]||0,t);var a=o,l=0;Object.keys(s).forEach((function(e){var n=s[e]-(t.degrees[e]||0)*i;n>l&&(l=n,a=e)})),g(r,a,s[a]||0,t),a!=o&&(n=!0)})),!((i=f(t))-o<1e-7)););}function v(e,t){var n,r,s={nodes:[],edges:[],_assoc_mat:{}},a=i(e);return s.nodes=s.nodes.concat(o(a)),t.edges.forEach((function(t){r=t.weight||1;var o=e[t.source],i=e[t.target];n=l(s,o,i)||0,function(e,t){!function(e,t){e._assoc_mat[t.source]=e._assoc_mat[t.source]||{},e._assoc_mat[t.source][t.target]=t.weight,e._assoc_mat[t.target]=e._assoc_mat[t.target]||{},e._assoc_mat[t.target][t.source]=t.weight}(e,t);var n=e.edges.map((function(e){return e.source+"_"+e.target})).indexOf(t.source+"_"+t.target);-1!=n?e.edges[n].weight=t.weight:e.edges.push(t)}(s,{source:o,target:i,weight:n+r})})),s}var x=function(){var e=function(e,t){if(0===e.edges.length){var n={};return e.nodes.forEach((function(e){n[e]=e})),n}var o={};c(r,o,t);var i=f(o),s=[];y(r,o);var a=f(o),l=m(o.nodes_to_com);s.push(l),i=a;var u=v(l,r);for(c(u,o);y(u,o),!((a=f(o))-i<1e-7);)l=m(o.nodes_to_com),s.push(l),i=a,c(u=v(l,u),o);return s}(r,n);return function(e,t){for(var n=h(e[0]),r=1;r<t+1;r++)Object.keys(n).forEach((function(t){var o=t,i=n[t];n[o]=e[r][i]}));return n}(e,e.length-1)};return x.nodes=function(t){return arguments.length>0&&(e=t),x},x.edges=function(n){if(void 0===e)throw"Please provide the graph nodes first!";if(arguments.length>0){t=n;var o=u(n);r={nodes:e,edges:t,_assoc_mat:o}}return x},x.partition_init=function(e){return arguments.length>0&&(n=e),x},x},getNodesCentralities=function(e,t,n,r){if(null!=e){var o=new nL;0===(t=null==t?0:t)&&addEigenvectorCentralityToNodes(e,n,r),1===t&&addBetweennessCentralityToNodes(e,n,r);for(var i=0;i<e.nodes.length;i++)o[i]=0==t?e.nodes[i].eigenvectorCentrality:e.nodes[i].betweennessCentrality;return o}},addCentralitiesToNodes=function(e,t,n,r){if(null!=e)return 0===(t=null==t?0:t)&&addEigenvectorCentralityToNodes(e,n,r),1===t&&addBetweennessCentralityToNodes(e,n,r),2===t&&addReachToNodes(e,!1),3===t&&addReachToNodes(e,!0),e},_getAdjacencyMap=function(e,t,n,r){if(null==e)return null;t=null!=t&&t,n=null!=n&&n,r=null!=r&&r;for(var o={},i=0;i<e.nodes.length;i++)o[e.nodes[i].id]={};for(i=0;i<e.relations.length;i++){var s=e.relations[i],a=s[n?"node1":"node0"].id,l=s[n?"node0":"node1"].id;o[a][l]=1-.5*s.weight,t||(o[l][a]=o[a][l])}if(r)for(var a in o){var u=[];for(var h in o[a])u.push(o[a][h]);var c=0;for(i=0;i<u.length;i++)c+=u[i];for(var l in o[a])o[a][l]/=c}return o},addEigenvectorCentralityToNodes=function(e,t,n){if(null==e)return e;void 0===t&&(t=!0),void 0===n&&(n=!0);var r={};function o(e){var t=[];for(var n in e)t.push(e[n]);for(var r=0,o=0;o<t.length;o++)r+=t[o];var i=1/(r||1);for(var s in e)e[s]*=i}var i=_getAdjacencyMap(e,null,n);randomSeed(1);for(var s={},a=0;a<e.nodes.length;a++)s[e.nodes[a].id]=random();o(s),randomSeedPop();for(a=0;a<100;a++){var l=s;s={};for(var u in l)s[u]=0;for(var h in s)for(var c in i[h])s[h]+=.01+l[c]*i[h][c]*(r[p]?r[p]:1);o(s);var f=0;for(var p in s)f+=Math.abs(s[p]-l[p]);if(f<1e-4*e.nodes.length){if(t){var g=[];for(var u in s)g.push(s[u]);var d=Math.max.apply(Math,g)||1;for(var m in s)s[m]/=d}for(var m in s){e.nodes.get(m).eigenvectorCentrality=s[m]}return e}}for(a=0;a<e.nodes.length;a++)e.nodes[a].eigenvectorCentrality=0;return e},addBetweennessCentralityToNodes=function(e,t,n){if(null==e)return e;void 0===t&&(t=!0),void 0===n&&(n=!1);for(var r,o,i,s=function(){this.init=function(){this.k=[],this.w=[],this.length=0},this.init(),this.push=function(e,t){for(var n=0;n<=this.w.length&&t<(this.w[n]||1/0);)n++;return this.k.splice(n,0,e),this.w.splice(n,0,t),this.length+=1,!0},this.pop=function(){return this.length-=1,this.w.pop(),this.k.pop()}},a=_getAdjacencyMap(e,null,!0),l={},u=0;u<e.nodes.length;u++)l[e.nodes[u].id]=0;for(u=0;u<e.nodes.length;u++){for(var h=e.nodes[u].id,c=new s,f={},p={},g=0;g<e.nodes.length;g++)p[e.nodes[g].id]=[];var d={id:0};c.push([0,h,h],0);var m=[],y={};for(g=0;g<e.nodes.length;g++)y[e.nodes[g].id]=0;for(y[h]=1;c.length;){var v=c.pop();if(r=v[0],o=v[1],!((i=v[2])in f))for(var x in f[i]=r,m.push(i),y[i]+=y[o],a[i]){var w=f[i]+a[i][x];x in f||x in d&&!(w<d[x])?w==d[x]&&(p[x].push(i),y[x]=y[x]+y[i]):(d[x]=w,c.push([w,i,x],w),p[x]=[i],y[x]=0)}}var L={};for(g=0;g<e.nodes.length;g++)L[e.nodes[g].id]=0;for(;m.length;){for(x=m.pop(),g=0;g<p[x].length;g++)L[i=p[x][g]]+=(1+L[x])*y[i]/y[x];x!=h&&(l[x]+=L[x])}}if(t){var b=[];for(var T in l)b.push(l[T]);var _=Math.max.apply(Math,b)||1;for(var h in l)l[h]/=_}for(var h in l){var M=e.nodes.get(h);M.betweennessCentrality=l[h],M.betweennessCentralityDegreeRatio=M.betweennessCentrality/(M.nodes.length+.001)}return e},addReachToNodes=function(e,t=!1){let n=function(e){return e.reach||(e.reach=new L,e.to.forEach((r=>{e.reach=e.reach.concat(n(r,t)),e.reach.push(r),t||(e.reach=e.reach.getWithoutRepetitions())}))),e.reach};e.nodes.forEach((e=>e.reach=null)),e.nodes.forEach((e=>{e.reach||n(e)})),e.nodes.forEach((e=>{console.log(e.name,e.reach.getPropertyValues("name").join(", ")),e.reach=e.reach.length}))},getLeaves=function(e){if(null!=e)return null!=e.getLeaves?e.getLeaves():null},createNetworkFromListAndFunction=function(e,t,n,r,o,i){if(null!=e&&null!=t){var s,a,l,u,h,c=new Net,f=e.length;for(r=null==r?.3:r,s=0;s<f;s++)(u=new Nd("n_"+s,null==n?"n_"+s:n[s])).element=e[s],u.i=s,c.addNode(u);if(i)for(s=0;s<f;s++)for(u=c.nodes[s],a=s+1;a<f;a++)h=c.nodes[a],(l=t(e[s],e[a]))>r&&(o>0&&(l-=r),2==o&&(l/=1-r),c.addRelation(new Rel(s+"_"+a,s+"_"+a,u,h,l)));else for(s=0;s<f;s++)for(u=c.nodes[s],a=0;a<f;a++)s!=a&&(h=c.nodes[a],(l=t(e[s],e[a]))>r&&(o>0&&(l-=r),2==o&&(l/=1-r),c.addRelation(new Rel(s+"_"+a,s+"_"+a,u,h,l))));return c}},createRandomNetwork=function(e,t,n,r,o){if(null==e||null==t)return null;var i,s,a;i=null!=o?function(){return o++,getRandomWithSeed(o)}:Math.random,n=null==n?0:n;var l,u=new Net;for(s=0;s<e;s++)u.addNode(new Nd("n"+s,"n"+s));switch(n){case 0:if(t<1)for(s=0;s<e-1;s++)for(l=u.nodes[s],a=s+1;a<e;a++)i()<t&&u.addRelation(new Rel(s+"_"+a,s+"_"+a,l,u.nodes[a],r?i():1));else for(t=Math.min(t,e*(e-1)*.5);u.relations.length<t;)(s=Math.floor(i()*e))!=(a=Math.floor(i()*e))&&null==u.relations.get(s+"_"+a)&&u.addRelation(new Rel(s+"_"+a,s+"_"+a,u.nodes[s],u.nodes[a],r?i():1));return u;case 1:var h,c,f,p=e*(e-1)*.5;for(s=0;s<p;s++)if(i()<t)for(h=!0;h;)if(l=u.nodes[Math.floor(u.nodes.length*i())],i()<(l.nodes.length+1)/1)for(;h;)c=u.nodes[Math.floor(u.nodes.length*i())],f=l.id+"_"+c.id,null==u.relations.get(f)&&null==u.relations.get(c.id+"_"+l.id)&&i()<(c.nodes.length+1)/1&&(u.addRelation(new Rel(f,f,l,c,r?i():1)),h=!1);return u}},textsToNet=function(e,t,n,r=.8,o=1){let i=transpose(getWordsInTextsOccurrencesTable(e,0,o),!0);return buildCorrelationsNetwork(i,!0,t||e,n,r)},parseNet=function(e,t=.2){let n=new _.Net;if(Array.isArray(e)&&2==e.length){let r=e[0],o=e[1];try{r=JSON.parse(r)}catch(e){}if(!Array.isArray(null==r)){r=[],e[0].split("\n").forEach((e=>{r.push(JSON.parse(e))}))}r.forEach((e=>{let t=e.node.labels[0],r=new _.Nd(String(e.node?.id),e.node?.properties?.fullName||e.node?.properties?.title);r.category=t,r.color=interpolateColors(stringToColor(t),"white",.7),r.urlImage=e.node?.properties?.savedImg,r.properties=e.node?.properties,n.addNode(r)}));try{o=JSON.parse(o)}catch(e){}if(!Array.isArray(o)){o=[],e[1].split("\n").forEach((e=>{o.push(JSON.parse(e))}))}o.forEach((e=>{let r=e.rel?.properties?.weight;r<t||null!=n.get(String(e.rel.start.id))&&null!=n.get(String(e.rel.end.id))&&(n.createRelation(e.rel.start.id,e.rel.end.id).weight=r)}))}return n},textToNet=function(e,t="\n\n",n,r,o,i,s,a=!1){if(null==e)return;let l;Array.isArray(e)?(l=e,e=e.join(/\n\n/)):l=null!=o?e.split(o):[e],l=l.filter((e=>""!=e));let u,h={},c=0;l.forEach(((e,n)=>{u=e.split(t),u.forEach(((e,t)=>{let r=getWords(e);s&&(r=r.concat(getBigrams(e))),r.forEach((e=>{let t=h[e];null==t&&(t={word:e,count:0,contexts:[],groups:[],locations:[]},h[e]=t),t.count++,t.groups.push(n),t.locations.push(c)})),c++}))}));let f=new L,p=0;for(let e in h){let t=h[e];f.push(t)}f=f.getSortedByProperty("count",!1).slice(0,n).filter((e=>e.count>1)),f.forEach((e=>{p=Math.max(p,e.count),e.vector=createListWithSameElement(c,0),e.locations.forEach((t=>e.vector[t]++)),e.vector.mean=e.vector.getMean(),e.vector.standardDeviation=e.vector.getStandardDeviation()}));let g=new L,d=r<=1;for(let e=0;e<f.length;e++)for(let t=e+1;t<f.length;t++){let n=f[e],o=f[t],i={pair_id:n.word+"_"+o.word,wordObject0:n,wordObject1:o,weight:numericCorrelation(n.vector,o.vector)};(!d||i.weight>=r)&&g.push(i)}d||(g=g.getSortedByProperty("weight",!1).slice(0,r));let m=new Net;g.forEach((e=>{let t=m.createRelation(e.wordObject0.word,e.wordObject1.word);null==t.node0.count&&(t.node0.count=e.wordObject0.count,t.node0.weight=Math.log(e.wordObject0.count),t.node0.groups=e.wordObject0.groups),null==t.node1.count&&(t.node1.count=e.wordObject1.count,t.node1.weight=Math.log(e.wordObject1.count),t.node1.groups=e.wordObject1.groups),t.content=t.node0.name+"|"+t.node1.name+" "+e.weight,t.weight=e.weight}));let y=l.length,v=createDefaultCategoricalColorList(y,"0.9").getInterpolated("white",.6);m.colorsTable=new T,m.colorsTable[0]=new sL,m.colorsTable[1]=new cL;for(let e=0;e<y;e++)m.colorsTable[0][e]=e,m.colorsTable[1][e]=v[e];return m.nodes.forEach((e=>{e.colorsTable=toL(e.groups).getFrequenciesTable(!0,!0).getColumns([0,2]),2==y&&(e.groupsProportion=(e.groups.filter((e=>0==e)).length-e.groups.filter((e=>1==e)).length)/e.groups.length),e.colorsTable[0]=e.colorsTable[0].map((e=>v[e]))})),a&&(u=e.toLowerCase().split(t),m.relations.forEach((e=>{e.content="",u.forEach((n=>{n.includes(e.node0.name)&&n.includes(e.node1.name)&&(""!=e.content&&(e.content+=t+" /// "),e.content+=n)}))}))),m},textToTree=function(e,t,n="text"){let r=new _.Tr,o=function(e,n,i){if(!e||""==e.trim())return;let s=null==i?"text":e.includes("\n")?e.split("\n")[0]:e.includes(".")?e.split(".")[0]:e.includes(" ")?e.split(" ")[0]:e.substr(0,100),a=new _.Nd(s,s);a.text=e,a.level=n,r.addNodeToTree(a,i),a.weight=e.length;let l=e.split(t[n]);if(console.log(n,s,l.length),l.length<2)return;let u=t[n].toString().includes("(");if(n<3&&(console.log("level:",n),console.log("div:",t[n]),console.log("blocks:",l),console.log("divisors[level]:",t[n]),console.log("captureDivisor:",u)),u){let e,r,i="";for(var h=0;h<l.length;h+=2)console.log("+++",h),e=l[h],e&&""!=e.trim()?(i=h>0?e[h-1]:"",r=e[h],console.log("   ++++++++ level, detectedDivisor:",n,i),n<t.length&&o(h>0?(i+r).trim():e.trim(),n+1,a)):h++}else l.forEach((e=>{e&&""!=e.trim()&&(e=e.trim(),n<t.length&&o(e,n+1,a))}))};return o(e,0),r.nodes[0].name=n,r},imageToTableOfRGBA=function(e,t){if(null==e||e.width<=0)return null;t=null!=t&&t;var n,r,o,i=_getPixelData(e);if(null==i)return null;if(t){n=new T;for(var s=0;s<e.width;s++){n.push(new cL);for(var a=0;a<e.height;a++)n[s].push("")}}else n=createUniformTable(e.width,e.height,[]);for(var l=0;l<i.length;l+=4)r=l/4%e.width,o=Math.floor(l/4/e.width),n[r][o]=t?"rgba("+i[l]+","+i[l+1]+","+i[l+2]+","+i[l+3]/255+")":[i[l],i[l+1],i[l+2],i[l+3]/255];return n},invertImageColors=function(e){if(null==e||e.width<=0)return null;var t=_getPixelData(e);if(null==t)return null;for(var n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2];var r=new ImageData(t,e.width,e.height);return _makeImageFromData(r)},grayscaleImage=function(e){if(null==e||e.width<=0)return null;var t=_getPixelData(e);if(null==t)return null;for(var n=0;n<t.length;n+=4){var r=.2126*t[n]+.7152*t[n+1]+.0722*t[n+2];t[n]=t[n+1]=t[n+2]=r}var o=new ImageData(t,e.width,e.height);return _makeImageFromData(o)},cropImage=function(e,t,n,r,o){if(null==e||e.width<=0)return null;if(e.isList){for(var i=new L,s=0;s<e.length;s++){var a=cropImage(e[s],t,n,r,o);i=i.concat(a)}return i}t=null==t?0:t,n=null==n?0:n,r=null==r?e.width:r,o=null==o?e.height:o;var l=document.createElement("canvas"),u=l.getContext("2d");l.width=e.width,l.height=e.height,u.drawImage(e,0,0);var h=u.getImageData(t,n,r,o);return _makeImageFromData(h)},resizeImage=function(e,t,n,r,o){if(null==e||e.width<=0)return null;r=null==r||0!=r&&1!=r?0:r,o=null==o?"topleft":o;var i,s=new MetaCanvas({container:null,dimensions:{width:t=null==t||Math.round(t)<=0?200:Math.round(t),height:n=null==n||Math.round(n)<=0?Math.round(t/e.width*e.height):Math.round(n)},noLoop:!0,noStart:!0});if(0==r){var a,l,u,h,c=o;if("topleft"==c.toLowerCase()){var f=_getPixelData(e);c="rgba("+f[0]+","+f[1]+","+f[2]+","+(f[3]/255).toFixed(2)+")"}s.fill(c),s.fRect(0,0,t,n),a=(t-(u=(h=Math.min(n,t*e.height/e.width))*e.width/e.height))/2,l=(n-h)/2,s.drawImage(e,0,0,e.width,e.height,a,l,u,h),i=s.captureCanvas()}else 1==r&&(s.drawImage(e,0,0,e.width,e.height,0,0,t,n),i=s.captureCanvas());return i},getDataURL=function(e,t){if(null==e||e.width<=0)return null;var n=new MetaCanvas({container:null,dimensions:{width:e.width,height:e.height},noLoop:!0,noStart:!0});n.drawImage(e,0,0);var r=n.captureCanvas();return t?'<img src="'+r.src+'">':r.src},_getPixelData=function(e){if(null==e||e.width<=0)return null;var t;try{var n=document.createElement("canvas"),r=n.getContext("2d");n.width=e.width,n.height=e.height,r.drawImage(e,0,0),t=r.getImageData(0,0,e.width,e.height).data}catch(e){throw e}return t},_makeImageFromData=function(e){if(null==e||null==e.width||e.width<=0||e.height<=0)return null;try{var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.putImageData(e,0,0);var r=document.createElement("img");r.src=t.toDataURL("image/png")}catch(e){throw e}return r},expandSimpleHtml=function(e,t){if(null==e||""===e)return"";var n;if(e.split("<").length!=e.split(">").length)return e;var r,o,i,s=e;if(-1!=s.indexOf("<fs"))for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fs",">"))&&(s=s.replace("<fs"+n+">",'<font style="font-size:'+Number(n)+'px">')),-1==s.indexOf(">")&&(n=null);for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<ff",">"))&&(s=s.replace("<ff"+n+">",'<font face="'+n+'">'));for(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(//,"<br/>")).replace(/<fcBlack>/g,'<font color="#000000">')).replace(/<.White>/g,'<font color="#FFFFFF">')).replace(/<fcRed>/g,'<font color="#FF0000">')).replace(/<fcGreen>/g,'<font color="#00FF00">')).replace(/<fcBlue>/g,'<font color="#0000FF">')).replace(/<fcOrange>/g,'<font color="#FFAA00">')).replace(/<fcCyan>/g,'<font color="#00FFFF">')).replace(/<fcYellow>/g,'<font color="#FFFF00">')).replace(/<fcMagenta>/g,'<font color="#FF00FF">'),n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fcuint",">"))&&(s=s.replace("<fcuint"+n+">",'<font color="'+uinttoHEX(n)+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fccolor",">"))&&(s=s.replace("<fccolor"+n+">",'<font color="'+colorStringToHEX(n)+'">'));for(n="";null!=n;)if(null!=(n=getFirstTextBetweenStrings(s,"<frgb",">"))){var a=n.split(".");s=s.replace("<frgb"+n+">",'<font color="'+RGBtoHEX(Number(a[0]),Number(a[1]),Number(a[2]))+'">')}if(-1!=s.indexOf("<fc"))for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fc",">"))&&(s=s.replace("<fc"+n+">",'<font color="'+("#"==n[0]?"":"#")+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<tl",">"))&&(s=s.replace("<tl"+n+">",'<textformat leftmargin="'+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<tv",">"))&&(s=s.replace("<tv"+n+">",'<textformat leading="'+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<e",">"))&&(r=n.split("*")[0],o=n.split("*")[1],i=n.split("*").length>2&&"s"==n.split("*")[2]?"_self":"_blank",s="http://"==r.substr(0,7)||"https://"==r.substr(0,8)?s.replace("<e"+n+">","<u><a href='"+r+"' target='"+i+"'>"+o+"</a></u>"):s.replace("<e"+n+">","<u><a href='javascript:clickLink(\""+r+'","'+t+"\")' FastHtml.onclick='event.preventDefault(); clickLink(\""+r+'","'+t+"\"); return false; '>"+o+"</a></u>"));return s=(s=(s=(s=(s=(s=s.replace(/<pl>/g,'<p align="left">')).replace(/<pc>/g,'<p align="center">')).replace(/<pr>/g,'<p align="right">')).replace(/<pj>/g,'<p align="justify">')).replace(/<\/f>/g,"</font>")).replace(/<\/t>/g,"</textformat>")},clickLink=function(e,t){for(var n=0;n<FastHtml_clickLinkFunctionsToCall.length;n++)FastHtml_clickLinkFunctionsToCall[n].call(FastHtml_clickLinkTargetsToCall[n],e,t)},_typeDict={L:L,iL:iL,cL:cL,P:P,P3D:P3D,Pol:Pol,Pol3D:Pol3D,Rec:Rec,T:T,nT:nT,polL:polL,Nd:Nd,sL:sL,ndL:ndL,relL:relL,recL:recL,Rel:Rel,Net:Net,Tr:Tr,dI:dI,dL:dL,nL:nL,I:I,pol3DL:pol3DL,cScale:cScale,MetaCanvas:MetaCanvas,Engine3D:Engine3D,Forces:Forces},TwoPi=6.28318530718;function ifDef(e,t){return null!=e?e:t}function typeOf(e){if(null==e)return null;var t=typeof e;return"object"!==t?t:null!=e.type?e.type:"[object Array]"==Object.prototype.toString.call(e)?"Array":null!=e.getDate?"date":"Object"}var _typeOf=function(e){if(null==e)return null;var t=typeof e;return"object"!==t?t:null!=e.type?e.type:"[object Array]"==Object.prototype.toString.call(e)?"Array":null!=e.getDate?"date":"Object"},noOperation=function(){};function resizeThrottler(e,t){var n;return function(r){n||(n=setTimeout((function(){n=null,e(r)}),t))}}function instantiate(e,t){switch(e){case"number":case"string":return window[e](t);case"date":if(!t||0===t.length)return new Date;if(1==t.length){if(t[0].match(/d*.-d*.-d*Dd*.:d*.:d*/)){var n=t[0].split(" ");return n[0]=n[0].split("-"),n[1]?n[1]=n[1].split(":"):n[1]=new Array(0,0,0),new Date(Date.UTC(n[0][0],Number(n[0][1])-1,n[0][2],n[1][0],n[1][1],n[1][2]))}return"NaN"!=Number(t[0])?new Date(Number(t[0])):new Date(t[0])}return new Date(Date.UTC.apply(null,t));case"boolean":return window[e]("false"!=t&&"0"!=t);case"L":case"T":case"sL":case"nL":case"nT":case"ndL":case"relL":case"Pol":case"Pol3D":case"polL":case"dL":case"cL":case"iL":return _typeDict[e].apply(new _typeDict[e],t);case null:case void 0:case"undefined":return null}var r,o,i;return i=window[e],(o=function(){}).prototype=i.prototype,r=new o,i.apply(r,t),r}function instanceSameType(e,t){return instantiate(typeOf(e),t)}var plasma=createColorScaleFromColors(cL.toL(["rgb(13,8,135)","rgb(125,3,168)","rgb(203,70,121)","rgb(248,148,65)","rgb(240,249,33)"]),[.25,.5,.75]),viridis=createColorScaleFromColors(cL.toL(["rgb(68,1,84)","rgb(59,81,139)","rgb(33,144,141)","rgb(92,200,99)","rgb(253,231,37)"]),[.25,.5,.75]),_HARDCODED_CATEGORICAL_COLORS=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f"],DateOperators_millisecondsToHours=1/36e5,DateOperators_millisecondsToDays=1/864e5,DateOperators_millisecondsToWeeks=1/6048e5,DateOperators_millisecondsToYears=3169e-14,DateOperators_MONTH_NAMES=["january","february","march","april","may","june","july","august","september","october","november","december"],DateOperators_MONTH_NAMES_SHORT=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],DateOperators_MONTH_NDAYS=[31,28,31,30,31,30,31,31,30,31,30,31],DateOperators_WEEK_NAMES=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],StringOperators_ENTER=String.fromCharCode(13),StringOperators_ENTER2=String.fromCharCode(10),StringOperators_ENTER3=String.fromCharCode(8232),StringOperators_SPACE=String.fromCharCode(32),StringOperators_SPACE2=String.fromCharCode(160),StringOperators_TAB=" ",StringOperators_TAB2=String.fromCharCode(9),StringOperators_LINK_REGEX=/(^|\s+)(https*\:\/\/\S+[^\.\s+])/,StringOperators_MAIL_REGEX=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,StringOperators_STOP_WORDS="t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","),StringOperators_WORDLISTS={},NetworkEncodings_nodeNameSeparators=["|",":"," is "," are ",".",","],NumberOperators_stackRandom=[],NumberOperators_lastNormal=NaN,NumberOperators_random=Math.random,NumberOperators_lastNormal=NaN,NumberOperators_lastNormal=1,NumberOperators_SG_MAGICCONST=1+Math.log(4.5),NumberOperators_LOG4=Math.log(4),TableEncodings_ENTER=String.fromCharCode(13),TableEncodings_ENTER2=String.fromCharCode(10),TableEncodings_ENTER3=String.fromCharCode(8232),TableEncodings_SPACE=String.fromCharCode(32),TableEncodings_SPACE2=String.fromCharCode(160),TableEncodings_TAB="  ",TableEncodings_TAB2=String.fromCharCode(9),GeoOperators_EARTH_RADIUS=6371009,GeoOperators_EARTH_DIAMETER=2*GeoOperators_EARTH_RADIUS,DrawTexts_POINT_TO_PIXEL=1.3333,DrawTexts_PIXEL_TO_POINT=.75,FastHtml_clickLinkFunctionsToCall=[],FastHtml_clickLinkTargetsToCall=[],FastHtml_target=null,FastHtml_linkFunction=null,_parseData=function(e,t,n){switch(t){case"csv":return toT(e,n);case"json":return JSON.parse(e);default:return e}};exports._parseData=_parseData,exports.loadData=function(e,t,n,r){var o=_parseData;fetch(e).then((e=>e.text())).then((i=>t({result:o(i,n,r),path:e})))},exports.loadDatas=function(e,t,n,r,o){var i=0,s=e[i],a=new L,l=_parseData,u=function(){fetch(s).then((e=>e.text())).then((h=>{let c={result:l(h,r,o),path:s,nFile:i};a.push(c),t?.(c,a),i<e.length-1?(s=e[++i],u()):n?.(a.downcast())}))};u()};var loadImage=function(e,t){if(null!=e){var n=document.createElement("img");n.onload=function(){let r={path:e,result:n};t.call(this,r)},n.onerror=function(){let n={path:e,result:null};t.call(this,n)},n.src=e}},loadImages=function(e,t,n){var r=0,o=e[r],i=new L,s=new iL,a=function(){loadImage(o,(l=>{i.push(l),s.push(l.result),t?.(l,{paths:e.slice(0,s.length),results:s}),r<e.length-1?(o=e[++r],a()):n?.({paths:e,results:s})}))};a()},downloadData=function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),document.body.appendChild(n),n.click()},downloadTable=function(e,t){let n=TableToCSV(e,",",!0);downloadData(n,t)};exports.LOG=function(...e){if(null!=e&&null!=e[0])if(e[0].isTable){var t={};e[0].forEach((e=>{t[e.name]=e.serial()}))}else if(!e[0].isList)return"Net"==e[0].type?(e[0].nodes.forEach((e=>{e.nodes.forEach((e=>e.color?console.log("%c  "+e.name,"color:"+e.color):console.log("  "+e.name)))})),void console.groupEnd()):void("-"!=e[0]?console.log.apply(null,e):console.table("----------------------------------------------"))},exports.passPropertiesObjects=function(e,t,n,r){n.forEach((n=>e.forEach(((e,o)=>{r&&null!=e[n]||(e[n]=t[o][n])}))))},exports.passPropertiesToNodes=function(e,t,n,r=!1){n.forEach((n=>t.nodes.forEach((t=>{let o=e.get(t.id);o&&(r&&null!=o[n]||(o[n]=t[n]))}))))};let toL=function(e){return L.toL(e).downcast()},tosL=function(e){return sL.toL(e)},tonL=function(e){return nL.toL(e)},toT=function(e){if("string"==typeof e)return CSVToTable.apply(null,arguments);e=e[0].isList?e:e.map((e=>e.toL()));return T.toL(e).downcast()},tonT=function(e){return nT.toL(e)},serial=function(e){return e.isTable?e.map((e=>e.slice())):e.isList?e.slice():void 0};Array.prototype.toL=function(){return toL(this)},Array.prototype.tosL=function(){return tosL(this)},Array.prototype.tonL=function(){return tonL(this)},Array.prototype.toT=function(){return toT(this)},Array.prototype.tonT=function(){return tonT(this)},Array.prototype.serial=function(){return serial(this)},exports.toL=toL,exports.tosL=tosL,exports.tonL=tonL,exports.toT=toT,exports.tonT=tonT,exports.serial=serial,L.prototype._filter=Array.prototype.filter,L.prototype.filter=function(...e){return LOG(""),this._filter(e).toL()},L.prototype.pushNew=function(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||this.push(arguments[e])},L.prototype.concatNew=function(e){let t=[];return e.forEach((e=>{this.includes(e)||t.push(e)})),this.concat(t)},exports.deepAssign=function(e,t,n=0){for(var r in n++,e)if(null!=t[r])if(t[r]instanceof Array)e[r]=t[r];else{var o=typeof t[r];!("number"==o||"string"==o||"boolean"==o)?exports.deepAssign(e[r],t[r],n):e[r]=t[r]}},exports.expandTags=function(e,t){return t=t??",",e.join(t).getWithoutElement().split(t).tosL().trim()};var TableToNetwork=function(e,t,n,r=!0){let o,i,s=new Net;if(Array.isArray(t)||(t=e.get(t)),t.forEach(((t,n)=>{o=s.createNode(t,t),e.forEach((e=>{"name"!=e.name&&"id"!=e.name&&(i=e.name.replace(" ","_").toLowerCase(),o[i]=e[n])}))})),n){let e;s.nodes.forEach(((t,o)=>{s.nodes.forEach(((i,a)=>{if(o!=a&&(r||!(a<o))&&(e=n(t,i),e)){let n=s.createRelation(t,i,t.name+"_"+i.name);for(let t in e)n[t]=e[t]}}))}))}return s};Net.prototype.createNode=function(e,t){var n=this.nodes.get(e);return n||(n=new Nd(e,t||e),this.addNode(n),n)},Net.prototype.filter=function(e){for(var t=this.nodes.filter((t=>e(t))),n=0;n<this.nodes.length;n++)t.includes(this.nodes[n])||(this.removeNode(this.nodes[n]),n--)},MetaCanvas.prototype.fTexts=function(e,t,n,r=null,o=null){e.forEach(((e,i)=>{r&&(this.fontSize=r[i]),o&&(this.fontColor=o[i]),this.fText(e,t[i],n[i])}))},MetaCanvas.prototype.fCircles=function(e,t,n,r=null){e.forEach(((e,o)=>{r&&this.fill(r[o]),this.fCircle(e,t[o],n[o])}))},MetaCanvas.prototype._setDragZoomTransformation=function(e){this.applyTransformationFunctions((e=>e*this.ZOOM+this.x0),(e=>e*this.ZOOM+this.y0))},MetaCanvas.prototype.setDRAGGABLE=function(e){this.DRAGGABLE!=e&&(this.DRAGGABLE=e,e?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.ZOOMABLE?this.x0=this.y0=0:this.resetTransformation())},MetaCanvas.prototype.setZOOMABLE=function(e,t=50,n=.1){this.ZOOMABLE!=e&&(this.ZOOMABLE=e,this.MAX_ZOOM=t,this.MIN_ZOOM=n,e?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.DRAGGABLE?this.ZOOM=1:this.resetTransformation())},exports.buildTagsNetwork=function(e,t=",",n=1){if(null!=e){var r=new Net;if(1==e.length||!e.isTable&&e.isList){var o=e.isTable?e[0]:e,i={};let s,a;o.forEach(((e,n)=>{if(null==e)return;let r=e.split(t);for(let e=0;e<r.length;e++)for(let t=e+1;t<r.length;t++){r[e]<r[t]?(s=r[e],a=r[t]):(s=r[t],a=r[e]);let o=i[s+"_"+a];null==o&&(o=i[s+"_"+a]={count:0,indexes:[],indexesDic:{}}),o.count++,o.indexesDic["_"+n]||(o.indexes.push(n),o.indexesDic["_"+n]=!0)}}));new nL;let l,u,h,c=1,f=1;for(let e in i){let t=i[e].count;if(t>=n){let o=e.split("_");l=r.createNode(o[0]),u=r.createNode(o[1]),null==l.indexes&&(l.indexes=[]),null==u.indexes&&(u.indexes=[]),l.indexes=l.indexes.concat(i[e].indexes),u.indexes=u.indexes.concat(i[e].indexes),l.weight++,u.weight++,c=Math.max(c,l.weight,u.weight),h=r.createRelation(l,u),h.weight=1+t-n,h.count=t,f=Math.max(f,h.weight)}}return r.nodes.forEach((e=>{e.weight=.5+.5*e.weight/c,e.indexes=_.tonL(e.indexes).getWithoutRepetitions()})),r.relations.forEach((e=>e.weight=.2+.8*e.weight/f)),r}var s=e[0];o=e[1];return s.forEach((e=>{var t=new Nd(e,e);r.addNode(t),t.kind=nameActor??"actor",t.color="blue"})),o.forEach(((e,t)=>{if(null!=e){var n=r.nodes[t];e.split(",").toL().trim().forEach((e=>{var t=r.createNode(e,e);t.kind=nameTags??"tag",t.color="red",r.createRelation(n,t)}))}})),r}},exports.expandForBarycenters=function(e,t){if(e){var n=new PolL;return n.name=e.name,e.forEach((e=>n.push(expandForBarycenter(e,t)))),n}},exports.closestPointToLine=function(e,t,n,r,o,i){let s=o-n,a=i-r,l=((e-n)*s+(t-r)*a)/(s**2+a**2);return new _.P(n+s*l,r+a*l)},exports.distanceToLine2=function(e,t,n,r,o,i){let s=this.closestPointToLine(e,t,n,r,o,i);return(s.x-e)**2+(s.y-t)**2},exports.distanceToLine=function(e,t,n,r,o,i){let s=this.closestPointToLine(e,t,n,r,o,i);return Math.sqrt((s.x-e)**2+(s.y-t)**2)},exports.dataDropper=function(e,t,n){if(!e)return;if(!t)return;let r;n?n?.startsWith("DATA")&&(r="https://moebio.protozoo.com/data/"+n.substr(5),n="../data/"+n.substr(5)):r="https://moebio.protozoo.com/dataDropper/"+(n="data/"),""==n||n.endsWith("/")||(n+="/",r+="/"),n+=t,r+=t;var o=new XMLHttpRequest;o.onreadystatechange=function(){console.log("dataDropper | this.readyState: "+this.readyState),4==this.readyState&&console.log("sent")},o.open("POST","https://moebio.protozoo.com/dataDropper/storeData.php",!0);o.send(n+"<***>"+e);return r},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*Math.random())]},random=Math.random,NumberOperators_random=Math.random,exports.L=L,exports.iL=iL,exports.cL=cL,exports.P=P,exports.P3D=P3D,exports.Pol=Pol,exports.Pol3D=Pol3D,exports.Rec=Rec,exports.T=T,exports.nT=nT,exports.polL=polL,exports.Nd=Nd,exports.sL=sL,exports.ndL=ndL,exports.relL=relL,exports.recL=recL,exports.Rel=Rel,exports.Net=Net,exports.Tr=Tr,exports.dI=dI,exports.dL=dL,exports.nL=nL,exports.I=I,exports.pol3DL=pol3DL,exports.cScale=cScale,exports.MetaCanvas=MetaCanvas,exports.Engine3D=Engine3D,exports.Forces=Forces,exports.interpolateColors=interpolateColors,exports.interpolateColorsRGB=interpolateColorsRGB,exports.distanceColorsRGB=distanceColorsRGB,exports.addAlpha=addAlpha,exports.invertColor=invertColor,exports.stringToColor=stringToColor,exports.HEXtoRGB=HEXtoRGB,exports.RGBtoHEX=RGBtoHEX,exports.RGBArrayToString=RGBArrayToString,exports.colorStringToHEX=colorStringToHEX,exports.numberToHex=numberToHex,exports.uinttoRGB=uinttoRGB,exports.uinttoHEX=uinttoHEX,exports.RGBtouint=RGBtouint,exports.HEXtouint=HEXtouint,exports.grayByLevel=grayByLevel,exports.HEXtoHSV=HEXtoHSV,exports.HSVtoHEX=HSVtoHEX,exports.HSLtoHEX=HSLtoHEX,exports.RGBtoHSV=RGBtoHSV,exports.HSVtoRGB=HSVtoRGB,exports.HSLtoRGB=HSLtoRGB,exports.invertColorRGB=invertColorRGB,exports.toHex=toHex,exports.getRandomColor=getRandomColor,exports.colorStringToRGB=colorStringToRGB,exports.createSortedNumberList=createSortedNumberList,exports.createNumberListWithinInterval=createNumberListWithinInterval,exports.createRandomNormalDistribution=createRandomNormalDistribution,exports.createRandomBetaPERTDistribution=createRandomBetaPERTDistribution,exports.createRandomBimodalDistribution=createRandomBimodalDistribution,exports.createRandomNumbers=createRandomNumbers,exports.createUniformTable=createUniformTable,exports.dotProduct=dotProduct,exports.linearRegression=linearRegression,exports.distance=distance,exports.cosineSimilarity=cosineSimilarity,exports.covariance=covariance,exports.standardDeviationTwoNumberLists=standardDeviationTwoNumberLists,exports.numericCorrelation=numericCorrelation,exports.slidingWindowCorrelation=slidingWindowCorrelation,exports.normalizeToSum=normalizeToSum,exports.normalizeByZScore=normalizeByZScore,exports.normalizeToMax=normalizeToMax,exports.normalizeToInterval=normalizeToInterval,exports.trimNumberList=trimNumberList,exports.getAccumulativeSum=getAccumulativeSum,exports.shorten=shorten,exports.simplify=simplify,exports.segmentNumberList=segmentNumberList,exports.averageSmoother=averageSmoother,exports.closestValue=closestValue,exports.filterNumberListByInterval=filterNumberListByInterval,exports.filterNumberListByNumber=filterNumberListByNumber,exports.frameFromTwoNumberLists=frameFromTwoNumberLists,exports.rangeCounts=rangeCounts,exports.simpleCompression=simpleCompression,exports.regression=regression,exports.getDecimalsInterval=getDecimalsInterval,exports.setDecimals=setDecimals,exports.getDistributionHeights=getDistributionHeights,exports.kNearestNeighbours=kNearestNeighbours,exports.skewness=skewness,exports.TableToObject=TableToObject,exports.ArrayOfArraysToTable=ArrayOfArraysToTable,exports.tableToHtml=tableToHtml,exports.tableToList=tableToList,exports.createColorScaleFromColors=createColorScaleFromColors,exports.blackScale=blackScale,exports.grayscale=grayscale,exports.antiGrayscale=antiGrayscale,exports.antiTemperature=antiTemperature,exports.temperature=temperature,exports.lightTemperature=lightTemperature,exports.sqrtTemperature=sqrtTemperature,exports.sqrt4Temperature=sqrt4Temperature,exports.quadraticTemperature=quadraticTemperature,exports.cubicTemperature=cubicTemperature,exports.greenToRed=greenToRed,exports.greenToBlue=greenToBlue,exports.grayToOrange=grayToOrange,exports.sqrt4GrayToOrange=sqrt4GrayToOrange,exports.blueToRed=blueToRed,exports.whiteToRed=whiteToRed,exports.redToBlue=redToBlue,exports.greenWhiteRed=greenWhiteRed,exports.blueWhiteRed=blueWhiteRed,exports.blueBlackRed=blueBlackRed,exports.grayBlackOrange=grayBlackOrange,exports.grayWhiteOrange=grayWhiteOrange,exports.solar=solar,exports.antiSolar=antiSolar,exports.get=get,exports.getFirstElements=getFirstElements,exports.containSameElements=containSameElements,exports.fractionOfSameElements=fractionOfSameElements,exports.getCorrespondenceBetweenLists=getCorrespondenceBetweenLists,exports.getConfusionMatrix=getConfusionMatrix,exports.indexOf=indexOf,exports.replaceElement=replaceElement,exports.replaceElementAtIndex=replaceElementAtIndex,exports.replaceNullsInList=replaceNullsInList,exports.concat=concat,exports.reverse=reverse,exports.getBooleanDictionaryForList=getBooleanDictionaryForList,exports.getFirstOccurrenceDictionaryForList=getFirstOccurrenceDictionaryForList,exports.getIndexesDictionary=getIndexesDictionary,exports.getIndexesTable=getIndexesTable,exports.buildDictionaryObjectForDictionary=buildDictionaryObjectForDictionary,exports.mapWithTable=mapWithTable,exports.mapWithObject=mapWithObject,exports.sortListByNumberList=sortListByNumberList,exports.getRankingsList=getRankingsList,exports.sortListByIndexes=sortListByIndexes,exports.concatWithoutRepetitions=concatWithoutRepetitions,exports.slidingWindowOnList=slidingWindowOnList,exports.getNewListForObjectType=getNewListForObjectType,exports.union=union,exports.intersection=intersection,exports.difference=difference,exports.symmetricDifference=symmetricDifference,exports.jaccardIndex=jaccardIndex,exports.jaccardDistance=jaccardDistance,exports.filterList=filterList,exports.mapWithFunction=mapWithFunction,exports.mapFunctionsOnList=mapFunctionsOnList,exports.aggregateList=aggregateList,exports.subCategoricalAnalysis=subCategoricalAnalysis,exports.getListEntropy=getListEntropy,exports.getListDiversity=getListDiversity,exports.getInformationGain=getInformationGain,exports.groupElementsByPropertyValue=groupElementsByPropertyValue,exports.repeatElements=repeatElements,exports._isCategorical=_isCategorical,exports.buildInformationObjectForList=buildInformationObjectForList,exports.kCombinations=kCombinations,exports.allSubLists=allSubLists,exports.crossCombineLists=crossCombineLists,exports.characterizeList=characterizeList,exports.createDefaultCategoricalColorList=createDefaultCategoricalColorList,exports.colorsForCategoricalList=colorsForCategoricalList,exports.createCategoricalColorListForList=createCategoricalColorListForList,exports.createColorListFromColorScale=createColorListFromColorScale,exports.createColorListFromNumberList=createColorListFromNumberList,exports.createSymmetricalColorListFromNumberList=createSymmetricalColorListFromNumberList,exports.createColorListWithSingleColor=createColorListWithSingleColor,exports.createColorListBetweenTwoColors=createColorListBetweenTwoColors,exports.createColorListSpectrum=createColorListSpectrum,exports.stringsToColors=stringsToColors,exports.createCategoricalColors=createCategoricalColors,exports._sortingVariation=_sortingVariation,exports._evaluationFunction=_evaluationFunction,exports.createCategoricalColorListDictionaryObject=createCategoricalColorListDictionaryObject,exports.stringToDate=stringToDate,exports.dateToString=dateToString,exports.clearHoursMinutesSeconds=clearHoursMinutesSeconds,exports.currentDate=currentDate,exports.addDaysToDate=addDaysToDate,exports.addMillisecondsToDate=addMillisecondsToDate,exports.parseDate=parseDate,exports.parseDates=parseDates,exports.hoursBetweenDates=hoursBetweenDates,exports.daysBetweenDates=daysBetweenDates,exports.weeksBetweenDates=weeksBetweenDates,exports.yearsBetweenDates=yearsBetweenDates,exports.nDayInYear=nDayInYear,exports.getDateDaysAgo=getDateDaysAgo,exports.getWeekInYear=getWeekInYear,exports.getNDaysInMonth=getNDaysInMonth,exports.getDecimalDate=getDecimalDate,exports.convertFromDecimalDate=convertFromDecimalDate,exports.extractPropertiesFromDate=extractPropertiesFromDate,exports.StringListToNumberList=StringListToNumberList,exports.toDateList=toDateList,exports._y=_y,exports._m=_m,exports._d=_d,exports._h=_h,exports._mn=_mn,exports._s=_s,exports._ms=_ms,exports.getDateLists=getDateLists,exports.buildSummaryTableFromDates=buildSummaryTableFromDates,exports.transformDateList=transformDateList,exports.changeTimeResolution=changeTimeResolution,exports.getElementFromTable=getElementFromTable,exports.getSubTable=getSubTable,exports.sliceColumns=sliceColumns,exports.filterTable=filterTable,exports.filterColumns=filterColumns,exports.getSubTableByElementOnList=getSubTableByElementOnList,exports.getSubTableByElementsOnList=getSubTableByElementsOnList,exports.getRandomRows=getRandomRows,exports.transpose=transpose,exports.replaceElementInTable=replaceElementInTable,exports.replaceSectionInTable=replaceSectionInTable,exports.replaceNullsInTable=replaceNullsInTable,exports.testClassificationModel=testClassificationModel,exports.getRows=getRows,exports.sortListsByNumberList=sortListsByNumberList,exports.aggregateTable=aggregateTable,exports.disAggregateTable=disAggregateTable,exports.deSegmentTable=deSegmentTable,exports.pivotTable=pivotTable,exports.unpivotTable=unpivotTable,exports.getCountPairsMatrix=getCountPairsMatrix,exports.getPairsFrequencyTable=getPairsFrequencyTable,exports.concatenateRowElements=concatenateRowElements,exports.filterTableByElementInList=filterTableByElementInList,exports.filterTableByElementsInList=filterTableByElementsInList,exports.selectRows=selectRows,exports.joinTables=joinTables,exports.joinMultipleTables=joinMultipleTables,exports.combineLists=combineLists,exports.completeTable=completeTable,exports.getNumberTableFromTable=getNumberTableFromTable,exports.getVariablesInformationGain=getVariablesInformationGain,exports.splitTableByCategoricList=splitTableByCategoricList,exports.buildCorrelationsNetwork=buildCorrelationsNetwork,exports.buildSimpleDecisionTree=buildSimpleDecisionTree,exports.buildDecisionTree=buildDecisionTree,exports._buildDecisionTreeNode=_buildDecisionTreeNode,exports._decisionTreeGenerateColorsMixture=_decisionTreeGenerateColorsMixture,exports.allListsSameLength=allListsSameLength,exports.getListsWithoutRepetition=getListsWithoutRepetition,exports.getNumberOfDifferentElementsOfLists=getNumberOfDifferentElementsOfLists,exports.buildInformationObjectForTable=buildInformationObjectForTable,exports.getCategoricalLists=getCategoricalLists,exports.getTableSimplified=getTableSimplified,exports.concatTables=concatTables,exports.concatRows=concatRows,exports.concatLists=concatLists,exports.unionListsFromTables=unionListsFromTables,exports.intersectListsFromTables=intersectListsFromTables,exports.encodeStringLists=encodeStringLists,exports.translateListsWithDictionary=translateListsWithDictionary,exports.getModes=getModes,exports.getSubTables=getSubTables,exports.mapFunctionOnLists=mapFunctionOnLists,exports.mapFunctionsOnLists=mapFunctionsOnLists,exports.useVariablesDictionary=useVariablesDictionary,exports.matrixToTwoColumns=matrixToTwoColumns,exports._preserveOrder=_preserveOrder,exports.concatStrings=concatStrings,exports.join=join,exports.cleanTexts=cleanTexts,exports.filterStringListByString=filterStringListByString,exports.replaceStringsInTexts=replaceStringsInTexts,exports.replaceStringInTexts=replaceStringInTexts,exports.replaceStringsInTextsByStrings=replaceStringsInTextsByStrings,exports.countStringsOccurrencesOnTexts=countStringsOccurrencesOnTexts,exports.getWordsInTextsOccurrencesTable=getWordsInTextsOccurrencesTable,exports.createShortTextsNetwork=createShortTextsNetwork,exports.splitStrings=splitStrings,exports.encodeStringsAsNumericFeatures=encodeStringsAsNumericFeatures,exports.correlationRatio=correlationRatio,exports.splitByEnter=splitByEnter,exports.replaceStringInText=replaceStringInText,exports.replaceStringsInText=replaceStringsInText,exports.removeTextsBetweenStrings=removeTextsBetweenStrings,exports.getWords=getWords,exports.getBigrams=getBigrams,exports.substr=substr,exports.splitString=splitString,exports.getFirstTextBetweenStrings=getFirstTextBetweenStrings,exports.getAllTextsBetweenStrings=getAllTextsBetweenStrings,exports.textContainsString=textContainsString,exports.getParenthesisContents=getParenthesisContents,exports.getFirstParenthesisContent=getFirstParenthesisContent,exports.getFirstParenthesisContentWithIndexes=getFirstParenthesisContentWithIndexes,exports.placeString=placeString,exports.insertString=insertString,exports.cleanText=cleanText,exports.removeEnters=removeEnters,exports.removeTabs=removeTabs,exports.removePunctuation=removePunctuation,exports.removeDoubleSpaces=removeDoubleSpaces,exports.removeHtmlTags=removeHtmlTags,exports.escapeForRegExp=escapeForRegExp,exports.removeLinks=removeLinks,exports.removeQuotes=removeQuotes,exports.removeAccentsAndDiacritics=removeAccentsAndDiacritics,exports.getWordsOccurrencesTable=getWordsOccurrencesTable,exports.indexesOf=indexesOf,exports.indexesOfString=indexesOfString,exports.repeatString=repeatString,exports.countStringOccurrences=countStringOccurrences,exports.countOccurrences=countOccurrences,exports.countWordOccurrences=countWordOccurrences,exports.countRegexOccurrences=countRegexOccurrences,exports.countStringsOccurrences=countStringsOccurrences,exports.validateEmail=validateEmail,exports.validateUrl=validateUrl,exports.getLevenshteinDistance=getLevenshteinDistance,exports.getClosestLevenshtein=getClosestLevenshtein,exports.getNgrams=getNgrams,exports.stringToFunction=stringToFunction,exports.stringFormat=stringFormat,exports.createListWithSameElement=createListWithSameElement,exports.createIterationSequence=createIterationSequence,exports.createListWithUniqueElements=createListWithUniqueElements,exports.replaceChomasInTextLine=replaceChomasInTextLine,exports._replaceSpacesInLine=_replaceSpacesInLine,exports.decodeTextNet=decodeTextNet,exports._simplifyForTextNet=_simplifyForTextNet,exports._regexWordForTextNet=_regexWordForTextNet,exports.encodeTextNet=encodeTextNet,exports.modelInfluence=modelInfluence,exports.NetworkToTable=NetworkToTable,exports.TableToNetwork=TableToNetwork,exports.TableToNetworkPairs=TableToNetworkPairs,exports.matrixToNetwork=matrixToNetwork,exports.CSVToTable=CSVToTable,exports._removeQuotes=_removeQuotes,exports.TableToCSV=TableToCSV,exports.TableToJSONString=TableToJSONString,exports.JSONStringToTable=JSONStringToTable,exports.NumberListToPolygon=NumberListToPolygon,exports.NumberListToStringList=NumberListToStringList,exports.ObjectToTable=ObjectToTable,exports.ObjectToList=ObjectToList,exports.objectToString=objectToString,exports.conversor=conversor,exports.ArrayToList=ArrayToList,exports.angleFromTwoPoints=angleFromTwoPoints,exports.dot=dot,exports.twoPointsInterpolation=twoPointsInterpolation,exports.pointMultiplication=pointMultiplication,exports.normalizeTableToMax=normalizeTableToMax,exports.normalizeLists=normalizeLists,exports.normalizeListsToMax=normalizeListsToMax,exports.normalizeListsToSum=normalizeListsToSum,exports.normalizeListsToInterval=normalizeListsToInterval,exports.averageSmootherOnLists=averageSmootherOnLists,exports.kMeans=kMeans,exports.product=product,exports.getCovarianceMatrix=getCovarianceMatrix,exports.generateNumberTable=generateNumberTable,exports.identity=identity,exports.mergeObjects=mergeObjects,exports.cloneObject=cloneObject,exports.serliazeObject=serliazeObject,exports.getInterval=getInterval,exports.getFrame=getFrame,exports.getInfo=getInfo,exports.getObjectStructure=getObjectStructure,exports.replaceValuesByNull=replaceValuesByNull,exports.getLength=getLength,exports.includes=includes,exports.getPropertyValue=getPropertyValue,exports.getPropertyValues=getPropertyValues,exports.getPropertyValuesInterval=getPropertyValuesInterval,exports.getMultiplePropertyValues=getMultiplePropertyValues,exports.getName=getName,exports.isPropertyValue=isPropertyValue,exports.getPropertiesNames=getPropertiesNames,exports.getPropertiesNamesAndValues=getPropertiesNamesAndValues,exports.setPropertyValue=setPropertyValue,exports.interpolateObjects=interpolateObjects,exports.replaceObject=replaceObject,exports.toList=toList,exports.floor=floor,exports.addition=addition,exports.multiplication=multiplication,exports.division=division,exports.applyFunctionOnInput=applyFunctionOnInput,exports.isEqual=isEqual,exports._recursiveEqual=_recursiveEqual,exports.arrayOfArraysToTable=arrayOfArraysToTable,exports.operate=operate,exports._sum=_sum,exports._multiplication=_multiplication,exports._pow2=_pow2,exports._pow3=_pow3,exports._logSum=_logSum,exports._log2Sum=_log2Sum,exports._log_y=_log_y,exports._cosSum=_cosSum,exports._sinSum=_sinSum,exports._tanSum=_tanSum,exports._modulo=_modulo,exports._subtract=_subtract,exports._divide=_divide,exports.numberToString=numberToString,exports.getRandomWithSeed=getRandomWithSeed,exports.numberFromBinaryPositions=numberFromBinaryPositions,exports.numberFromBinaryValues=numberFromBinaryValues,exports.powersOfTwoDecomposition=powersOfTwoDecomposition,exports.toBinary=toBinary,exports.binaryToNumber=binaryToNumber,exports.positionsFromBinaryValues=positionsFromBinaryValues,exports._Alea=_Alea,exports._Mash=_Mash,exports.random=random,exports.randomSeed=randomSeed,exports.randomSeedPop=randomSeedPop,exports.decimalPlaces=decimalPlaces,exports.logistic=logistic,exports.formatShort=formatShort,exports.numberToPosition=numberToPosition,exports.getSoftenControlPoints=getSoftenControlPoints,exports.bezierCurvePoints=bezierCurvePoints,exports.triangleContainsPoint=triangleContainsPoint,exports.triangleArea=triangleArea,exports.lineFromTwoPoints=lineFromTwoPoints,exports.distancePointToLine=distancePointToLine,exports.distancePointToSegment=distancePointToSegment,exports.intersectionLines=intersectionLines,exports.intersectionLineRectangle=intersectionLineRectangle,exports.numberTableToPolygon=numberTableToPolygon,exports.numberTableToColorList=numberTableToColorList,exports.numberTableToNetwork=numberTableToNetwork,exports.buildDendrogramFromPolygon=buildDendrogramFromPolygon,exports._findClosestNodes=_findClosestNodes,exports.sortOnXY=sortOnXY,exports.expandFromBarycenter=expandFromBarycenter,exports.simplifyPolygon=simplifyPolygon,exports.bezierPolygonContainsPoint=bezierPolygonContainsPoint,exports.placePointsInsidePolygon=placePointsInsidePolygon,exports.placePointsInsideBezierPolygon=placePointsInsideBezierPolygon,exports.geoCoordinateToDecimal=geoCoordinateToDecimal,exports.geoDistance=geoDistance,exports.polygonLength=polygonLength,exports.minRect=minRect,exports.packingCircles=packingCircles,exports.packingRectangles=packingRectangles,exports.fillWithRectangles=fillWithRectangles,exports.squarify=squarify,exports.partitionRectangle=partitionRectangle,exports._getHighestRatio=_getHighestRatio,exports.simplifyPolygons=simplifyPolygons,exports.createPolygon=createPolygon,exports.twoNumberListsToPolygon=twoNumberListsToPolygon,exports.colorListFromColorScale=colorListFromColorScale,exports.colorListFromColorScaleFunction=colorListFromColorScaleFunction,exports.colorsLinearCombination=colorsLinearCombination,exports.polygon3DToColorList=polygon3DToColorList,exports.colorListToPolygon3D=colorListToPolygon3D,exports.randomColor=randomColor,exports.getFlowTable=getFlowTable,exports.getFlowTableIntervals=getFlowTableIntervals,exports.scaleIntervals=scaleIntervals,exports.nlsToIntervalList=nlsToIntervalList,exports.fillTextRectangle=fillTextRectangle,exports.fillTextRectangleWithTextLines=fillTextRectangleWithTextLines,exports.textWordWrapReturnLines=textWordWrapReturnLines,exports.getMaxTextWidth=getMaxTextWidth,exports.stringToObject=stringToObject,exports.stringToHash=stringToHash,exports._fnv_multiply=_fnv_multiply,exports._fnv_mix=_fnv_mix,exports.decodeIdentedTree=decodeIdentedTree,exports.TableToTree=TableToTree,exports._getId=_getId,exports.TreeToTable=TreeToTable,exports.treeToObject=treeToObject,exports.filterNetworkByRelationsWeight=filterNetworkByRelationsWeight,exports.objectToTree=objectToTree,exports.filterNodesByMinDegree=filterNodesByMinDegree,exports.degreeBetweenNodes=degreeBetweenNodes,exports.getNodesBetweenTwoNodes=getNodesBetweenTwoNodes,exports.getSubNetwork=getSubNetwork,exports.shortestPath=shortestPath,exports.shortestPaths=shortestPaths,exports.getRelationsBetweenNodeLists=getRelationsBetweenNodeLists,exports._extendPaths=_extendPaths,exports.loops=loops,exports._getLoopsOnNode=_getLoopsOnNode,exports._pathsToCentral=_pathsToCentral,exports._loopsColumns=_loopsColumns,exports.spanningTree=spanningTree,exports.influenceLevels=influenceLevels,exports._spanningTree2=_spanningTree2,exports.adjacentNodeList=adjacentNodeList,exports.degreesPartition=degreesPartition,exports.getNodes=getNodes,exports.buildDendrogram=buildDendrogram,exports._getClosestPair=_getClosestPair,exports._strengthBetweenSets=_strengthBetweenSets,exports.buildNetworkClusters=buildNetworkClusters,exports._iterativeBuildClusters=_iterativeBuildClusters,exports._buildNetworkClustersLvn=_buildNetworkClustersLvn,exports.getNodesPageRanks=getNodesPageRanks,exports.addPageRankToNodes=addPageRankToNodes,exports.fusionNetworks=fusionNetworks,exports._jLvn=_jLvn,exports.getNodesCentralities=getNodesCentralities,exports.addCentralitiesToNodes=addCentralitiesToNodes,exports.addEigenvectorCentralityToNodes=addEigenvectorCentralityToNodes,exports.addBetweennessCentralityToNodes=addBetweennessCentralityToNodes,exports.addReachToNodes=addReachToNodes,exports.getLeaves=getLeaves,exports.createNetworkFromListAndFunction=createNetworkFromListAndFunction,exports.createRandomNetwork=createRandomNetwork,exports.textToNet=textToNet,exports.textToTree=textToTree,exports.textsToNet=textsToNet,exports.parseNet=parseNet,exports.imageToTableOfRGBA=imageToTableOfRGBA,exports.invertImageColors=invertImageColors,exports.grayscaleImage=grayscaleImage,exports.cropImage=cropImage,exports.resizeImage=resizeImage,exports.getDataURL=getDataURL,exports._getPixelData=_getPixelData,exports._makeImageFromData=_makeImageFromData,exports.expandSimpleHtml=expandSimpleHtml,exports.clickLink=clickLink,exports.downloadData=downloadData,exports.downloadTable=downloadTable,exports.loadImage=loadImage,exports.loadImages=loadImages,exports.StringOperators_STOP_WORDS=StringOperators_STOP_WORDS}));