!function(e,t){"function"==typeof define&&define.amd?define(["exports"],(function(n){t(e._=n)})):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e._={})}("undefined"!=typeof self?self:this,(function(exports){"use strict";function DataType(){Object.apply(this),this.type="DataType"}function L(){DataType.apply(this);var e,t=[],n=arguments.length;for(e=0;e<n;e++)t.push(arguments[e]);return t=L.toL(t)}function iL(){for(var e=[],t=arguments.length,n=0;n<t;n++)e[n]=arguments[n];var r=L.apply(this,e);return r=iL.toL(r)}function cL(){var e,t=[],n=arguments.length;for(e=0;e<n;e++)t[e]=arguments[e];var r=L.apply(this,t);return r=cL.toL(r)}function P(e,t){DataType.apply(this,arguments),this.type="P",this.x=Number(e)||0,this.y=Number(t)||0}function P3D(e,t,n){P.apply(this,arguments),this.type="P3D",this.z=n}function Pol(){var e=L.apply(this,arguments);return e=Pol.toL(e)}function Pol3D(){var e=L.apply(this,arguments);return e=Pol3D.toL(e)}function Rec(e,t,n,r){DataType.apply(this),this.type="Rec",this.x=Number(e)||0,this.y=Number(t)||0,this.width=Number(n)||0,this.height=Number(r)||0}function T(){var e,t=[],n=arguments.length;for(e=0;e<n;e++)t[e]=arguments[e].isList?arguments[e]:new L(arguments[e]);var r=L.apply(this,t);return r=T.toL(r)}function nT(){var e=arguments,t=[];if(1==arguments.length)if("number"==typeof e[0])for(var n=0;n<e[0];n++)t.push(new nL);else Array.isArray(e[0])&&(t=i(e[0],1));else if(arguments.length>1)if("number"==typeof e[0]){var r=new nL;for(n=0;n<e.length;n++)r.push(e[n]);t.push(r)}else{var o=Array.prototype.slice.call(e);t=i(o,1)}function i(e,t){var n;if(void 0!==e.type)return"nT"==(n=e.clone()).type?n:"nL"==n.type&&1==t?[n]:"nL"==n.type&&t>1?n:[];n=[];for(var r=0;r<e.length;r++)Array.isArray(e[r])&&(e[r]=i(e[r],++t)),n[r]=e[r];return 0==n.length?[]:"number"==typeof n[0]&&1==t?[n]:n}return t=nT.toL(t)}function polL(){var e=T.apply(this,arguments);return e=polL.toL(e)}function Nd(e,t){this.id=null==e?"":e,this.name=null!=t?t:e,this.type="Nd",this.nodeType=null,this.x=0,this.y=0,this.z=0,this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL,this.weight=1,this.descentWeight=1,this.level=0,this.parent=null,this.vx=0,this.vy=0,this.vz=0,this.ax=0,this.ay=0,this.az=0}function sL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=String(arguments[t]);var n=L.apply(this,e);return n=sL.toL(n)}function ndL(){var e=ndL.toL([]);if(arguments&&arguments.length>0){var t=Array.prototype.slice.call(arguments);t.forEach((function(t){e.addNode(t)}))}return e}function relL(){var e=ndL.apply(this,arguments);return e.name="",e=relL.toL(e)}function recL(){var e=L.apply(this,arguments);return e=recL.toL(e)}function Rel(e,t,n,r,o,i){Nd.call(this,e,t),this.type="Rel",this.node0=n,this.node1=r,this.weight=null==o?1:o,this.content=null==i?"":i}function Net(){this.type="Net",this.nodes=new ndL,this.relations=new relL}function Tr(){Net.apply(this),this.type="Tr",this.nLevels=0,this._createRelation=this.createRelation,this.createRelation=this._newCreateRelation}function dI(e,t){DataType.apply(this,arguments),this.date0=e,this.date1=t,this.type="dI"}function dL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=Number(arguments[t]);var n=L.apply(this,e);return n=dL.toL(n)}function nL(){for(var e=[],t=arguments.length,n=0;n<t;n++)e[n]=Number(arguments[n]);var r=L.apply(this,e);return r=nL.toL(r)}function I(e,t){DataType.apply(this,arguments),this.x=Number(e),this.y=Number(t),this.type="I"}function pol3DL(){var e=L.apply(this,arguments);return e=pol3DL.toL(e)}function cScale(e){DataType.apply(this,arguments),this.name="",this.type="cScale",this.colorScaleFunction=e||blackScale}function MetaCanvas(e){null==e&&(e={container:document.querySelector("#maindiv"),cycle:function(){},onResize:function(){}}),this.container=e.container,this.container=this.container||document.querySelector("#maindiv"),"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.dimensions=e.dimensions,this.init=e.init||noOperation,this.cycle=e.cycle||noOperation,this.onResize=e.onResize||e.resize||noOperation,this._cycleInterval=void 0===e.cycleInterval?30:e.cycleInterval,e.noLoop&&(this._cycleInterval=0),this._init(!e.noStart)}function Engine3D(e){e=null==e?{}:e,this.lens=null==e.lens?300:e.lens,this._freeRotation=!1,this.setBasis(new Pol3D(new P3D(1,0,0),new P3D(0,1,0),new P3D(0,0,1))),this._cuttingPlane=10,this._dx=0,null!=e.angles&&this.setAngles(e.angles)}function Forces(e){this.k=e&&e.k?e.k:.01,this.dEqSprings=e&&e.dEqSprings?e.dEqSprings:100,this.dEqRepulsors=e&&e.dEqRepulsors?e.dEqRepulsors:500,this.friction=e&&e.friction?e.friction:.8,this.nodes=new ndL,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this._i0=0}DataType.prototype={},DataType.prototype.constructor=DataType,DataType.prototype.setType=function(e){this.type=e},DataType.prototype.getType=function(){return this.type},DataType.prototype.toString=function(){},L.prototype=new DataType,L.prototype.constructor=L,L.toL=function(e,t){if(null!=e){if(t){switch(t){case"number":case"nL":return nL.toL(e,!1);case"string":case"sL":return sL.toL(e,!1);case"Date":case"dL":return dL.toL(e,!1)}e.pushNew=L.prototype.pushNew,e.concatNew=L.prototype.concatNew}return e.type="L",e.name=e.name||"",e.setType=L.prototype.setType,e.toArray=L.prototype.toArray,e._constructor=L,e.downcast=L.prototype.downcast,e.get=L.prototype.get,e.getElements=L.prototype.getElements,e.isEqual=L.prototype.isEqual,e.getTypeOfElements=L.prototype.getTypeOfElements,e.getTypes=L.prototype.getTypes,e.getType=L.prototype.getType,e.getLengths=L.prototype.getLengths,e.getWithoutRepetitions=L.prototype.getWithoutRepetitions,e.getSimplified=L.prototype.getSimplified,e.getFrequenciesTable=L.prototype.getFrequenciesTable,e.allElementsAreEqual=L.prototype.allElementsAreEqual,e.countElement=L.prototype.countElement,e.countOccurrences=L.prototype.countOccurrences,e.countDifferentElements=L.prototype.countDifferentElements,e.getMode=L.prototype.getMode,e.getMin=L.prototype.getMin,e.getMax=L.prototype.getMax,e.indexOfElement=L.prototype.indexOfElement,e.indexesOf=L.prototype.indexesOf,e.indexOfElements=L.prototype.indexOfElements,e.indexesOfElements=L.prototype.indexesOfElements,e.getElementByName=L.prototype.getElementByName,e.getElementsByNames=L.prototype.getElementsByNames,e.getFirstElementByPropertyValue=L.prototype.getFirstElementByPropertyValue,e.add=L.prototype.add,e.getElementNumberOfOccurrences=L.prototype.getElementNumberOfOccurrences,e.getPropertyValues=L.prototype.getPropertyValues,e.getRandomElement=L.prototype.getRandomElement,e.getRandomElements=L.prototype.getRandomElements,e.isSorted=L.prototype.isSorted,e.getSortedByIndexes=L.prototype.getSortedByIndexes,e.getReversed=L.prototype.getReversed,e.getSortedByProperty=L.prototype.getSortedByProperty,e.getSorted=L.prototype.getSorted,e.getSortedByList=L.prototype.getSortedByList,e.getSortedRandom=L.prototype.getSortedRandom,e.getSubList=L.prototype.getSubList,e.getSubListByType=L.prototype.getSubListByType,e.getFilteredByPropertyValue=L.prototype.getFilteredByPropertyValue,e.getFilteredByBooleanList=L.prototype.getFilteredByBooleanList,e.toStringList=L.prototype.toStringList,e.toNumberList=L.prototype.toNumberList,e.toColorList=L.prototype.toColorList,e.clone=L.prototype.clone,e.toString=L.prototype.toString,e.getNames=L.prototype.getNames,e.getLabels=L.prototype.getLabels,e.getDescriptions=L.prototype.getDescriptions,e.getCategories=L.prototype.getCategories,e.applyFunction=L.prototype.applyFunction,e.getWithoutElementAtIndex=L.prototype.getWithoutElementAtIndex,e.getWithoutElement=L.prototype.getWithoutElement,e.getWithoutElements=L.prototype.getWithoutElements,e.getWithoutElementsAtIndexes=L.prototype.getWithoutElementsAtIndexes,e.getFilteredByFunction=L.prototype.getFilteredByFunction,e.insert=L.prototype.insert,e.insertMany=L.prototype.insertMany,e._concat=Array.prototype.concat,e.concat=L.prototype.concat,e.removeElement=L.prototype.removeElement,e.removeElementAtIndex=L.prototype.removeElementAtIndex,e.removeElementsAtIndexes=L.prototype.removeElementsAtIndexes,e.removeElements=L.prototype.removeElements,e.pushIfUnique=L.prototype.pushIfUnique,e.replace=L.prototype.replace,e.setNames=L.prototype.setNames,e.setPropertyValues=L.prototype.setPropertyValues,e._splice=Array.prototype.splice,e.splice=L.prototype.splice,e.isList=!0,e}},iL.prototype=new L,iL.prototype.constructor=iL,iL.toL=function(e){let t=L.toL(e);return t.type="iL",t.getInterval=iL.prototype.getInterval,t.getAmplitudes=iL.prototype.getAmplitudes,t},cL.prototype=new L,cL.prototype.constructor=cL,cL.toL=function(e){let t=L.toL(e);return t.type="cL",t.name=e.name||"",t.getRgbArrays=cL.prototype.getRgbArrays,t.getInterpolated=cL.prototype.getInterpolated,t.getInverted=cL.prototype.getInverted,t.addAlpha=cL.prototype.addAlpha,t},P.prototype=new DataType,P.prototype.constructor=P,P3D.prototype=new P,P3D.prototype.constructor=P3D,Pol.prototype=new L,Pol.prototype.constructor=Pol,Pol.toL=function(e){let t=L.toL(e);return t.type="Pol",t.getFrame=Pol.prototype.getFrame,t.getBarycenter=Pol.prototype.getBarycenter,t.getCenter=Pol.prototype.getCenter,t.add=Pol.prototype.add,t.factor=Pol.prototype.factor,t.getRotated=Pol.prototype.getRotated,t.getClosestPoint=Pol.prototype.getClosestPoint,t.toNumberList=Pol.prototype.toNumberList,t.containsPoint=Pol.prototype.containsPoint,t.touchesPolygon=Pol.prototype.touchesPolygon,t.approach=Pol.prototype.approach,t.clone=Pol.prototype.clone,t},Pol3D.prototype=new L,Pol3D.prototype.constructor=Pol3D,Pol3D.toL=function(e){let t=L.toL(e);return t.type="Pol3D",t.getBarycenter=Pol3D.prototype.getBarycenter,t},Rec.prototype=new DataType,Rec.prototype.constructor=Rec,T.prototype=new L,T.prototype.constructor=T,T.toL=function(e){for(var t=0;t<e.length;t++)Array.isArray(e[t])&&!e[t].isList&&(e[t]=L.toL(e[t]));let n=L.toL(e);return n.type="T",n.applyFunction=T.prototype.applyFunction,n.getListsDowncasted=T.prototype.getListsDowncasted,n.get=T.prototype.get,n.getColumns=T.prototype.getColumns,n.getWithoutColumn=T.prototype.getWithoutColumn,n.getWithoutColumns=T.prototype.getWithoutColumns,n.getRow=T.prototype.getRow,n.getRows=T.prototype.getRows,n.getCell=T.prototype.getCell,n.getLengths=T.prototype.getLengths,n.getListLength=T.prototype.getListLength,n.sliceRows=T.prototype.sliceRows,n.getRows=T.prototype.getRows,n.getWithoutRow=T.prototype.getWithoutRow,n.getWithoutRows=T.prototype.getWithoutRows,n.transpose=T.prototype.transpose,n.sortRowsByList=T.prototype.sortRowsByList,n.sortRowsByLists=T.prototype.sortRowsByLists,n.clone=T.prototype.clone,n.cloneWithEmptyLists=T.prototype.cloneWithEmptyLists,n.appendRows=T.prototype.appendRows,n.insertRow=T.prototype.insertRow,n.trim=T.prototype.trim,n.removeRow=T.prototype.removeRow,n.pushRow=T.prototype.pushRow,n.isTable=!0,n},nT.prototype=new T,nT.prototype.constructor=nT,nT.toL=function(e){let t=T.toL(e);return t.type="nT",t.getSums=nT.prototype.getSums,t.getRowsSums=nT.prototype.getRowsSums,t.getAverages=nT.prototype.getAverages,t.getRowsAverages=nT.prototype.getRowsAverages,t.getIntervals=nT.prototype.getIntervals,t.factor=nT.prototype.factor,t.add=nT.prototype.add,t.getMax=nT.prototype.getMax,t.getMaxValues=nT.prototype.getMaxValues,t.getMaxCell=nT.prototype.getMaxCell,t.getMin=nT.prototype.getMin,t.getMinValues=nT.prototype.getMinValues,t.getMinCell=nT.prototype.getMinCell,t.getInterval=nT.prototype.getInterval,t.getFrame=nT.prototype.getFrame,t},polL.prototype=new T,polL.prototype.constructor=polL,polL.toL=function(e){let t=T.toL(e);return t.type="polL",t.getFrame=polL.prototype.getFrame,t.getBarycenter=polL.prototype.getBarycenter,t.getCenter=polL.prototype.getCenter,t.add=polL.prototype.add,t.factor=polL.prototype.factor,t.getRotated=polL.prototype.getRotated,t.clone=polL.prototype.clone,t},Nd.prototype=new DataType,Nd.prototype.constructor=Nd,sL.prototype=new L,sL.prototype.constructor=sL,sL.toL=function(e,t){t=null==t||t;var n=L.toL(e);if(t)for(var r=0;r<n.length;r++)n[r]=String(n[r]);return n.type="sL",n.getLengths=sL.prototype.getLengths,n.countTags=sL.prototype.countTags,n.includesSubString=sL.prototype.includesSubString,n.indexesOfSubString=sL.prototype.indexesOfSubString,n.toLowerCase=sL.prototype.toLowerCase,n.toUpperCase=sL.prototype.toUpperCase,n.append=sL.prototype.append,n.getSurrounded=sL.prototype.getSurrounded,n.replace=sL.prototype.replace,n.getConcatenated=sL.prototype.getConcatenated,n.trim=sL.prototype.trim,n.clone=sL.prototype.clone,n},ndL.prototype=new L,ndL.prototype.constructor=ndL,ndL.toL=function(e,t){t=null!=t&&t;var n=L.toL(e);if(t)for(var r=n.length,o=0;o<r;o++)n[o]="Nd"==_typeOf(n[o])?n[o]:new Nd(String(n[o]),String(n[o]));return n.type="ndL",n.ids={},Array(),n.addNode=ndL.prototype.addNode,n.addNodes=ndL.prototype.addNodes,n.removeNode=ndL.prototype.removeNode,n.removeNodes=ndL.prototype.removeNodes,n.removeNodeAtIndex=ndL.prototype.removeNodeAtIndex,n.getNodeByName=ndL.prototype.getNodeByName,n.get=ndL.prototype.get,n.getNodesByIds=ndL.prototype.getNodesByIds,n.normalizeWeights=ndL.prototype.normalizeWeights,n.getWeights=ndL.prototype.getWeights,n.getIds=ndL.prototype.getIds,n.getDegrees=ndL.prototype.getDegrees,n.getPolygon=ndL.prototype.getPolygon,n._push=Array.prototype.push,n.getWithoutRepetitions=ndL.prototype.getWithoutRepetitions,n.removeElements=ndL.prototype.removeElements,n.clone=ndL.prototype.clone,n},relL.prototype=new ndL,relL.prototype.constructor=relL,relL.toL=function(e){let t=ndL.toL(e);return t.type="relL",t.addRelation=relL.prototype.addRelation,t.removeRelation=relL.prototype.removeRelation,t.getRelationsWithNode=relL.prototype.getRelationsWithNode,t.getFirstRelationBetweenNodes=relL.prototype.getFirstRelationBetweenNodes,t.getFirstRelationByIds=relL.prototype.getFirstRelationByIds,t.getAllRelationsBetweenNodes=relL.prototype.getAllRelationsBetweenNodes,t.getRelatedNodesToNode=relL.prototype.getRelatedNodesToNode,t.nodesAreConnected=relL.prototype.nodesAreConnected,t.getChildrenOfNode=relL.prototype.getChildrenOfNode,t},recL.prototype=new L,recL.prototype.constructor=recL,recL.toL=function(e){let t=L.toL(e);return t.type="recL",t.getFrame=recL.prototype.getFrame,t.add=recL.prototype.add,t.clone=recL.prototype.clone,t.factor=recL.prototype.factor,t.getIntersectionArea=recL.prototype.getIntersectionArea,t.intersectsRectangle=recL.prototype.intersectsRectangle,t},Rel.prototype=new Nd,Rel.prototype.constructor=Rel,Net.prototype=new DataType,Net.prototype.constructor=Net,Tr.prototype=new Net,Tr.prototype.constructor=Tr,dI.prototype=new DataType,dI.prototype.constructor=dI,dL.prototype=new L,dL.prototype.constructor=dL,dL.toL=function(e,t){t=null==t||t;let n=L.toL(e);if(t)for(var r=0;r<n.length;r++)n[r]=new Date(n[r]);return n.type="dL",n.getTimes=dL.prototype.getTimes,n.getYears=dL.prototype.getYears,n.getFullYears=dL.prototype.getFullYears,n.getMin=dL.prototype.getMin,n.getMax=dL.prototype.getMax,n.getInterval=dL.prototype.getInterval,n},nL.prototype=new L,nL.prototype.constructor=nL,nL.toL=function(e,t){t=null==t||t;var n=L.toL(e);let r=n.length;if(t)for(var o=0;o<r;o++)n[o]=Number(n[o]);return n.type="nL",n.getMin=nL.prototype.getMin,n.getMax=nL.prototype.getMax,n.getAmplitude=nL.prototype.getAmplitude,n.getIndexOfMin=nL.prototype.getIndexOfMin,n.getIndexOfMax=nL.prototype.getIndexOfMax,n.getSum=nL.prototype.getSum,n.getProduct=nL.prototype.getProduct,n.getInterval=nL.prototype.getInterval,n.getIntervalWithAverage=nL.prototype.getIntervalWithAverage,n.getNumbersSimplified=nL.prototype.getNumbersSimplified,n.getMean=nL.prototype.getMean,n.getNorm=nL.prototype.getNorm,n.getStandardDeviation=nL.prototype.getStandardDeviation,n.getVariance=nL.prototype.getVariance,n.getMedian=nL.prototype.getMedian,n.getQuantiles=nL.prototype.getQuantiles,n.getSorted=nL.prototype.getSorted,n.getSortIndexes=nL.prototype.getSortIndexes,n.cleanNonFinites=nL.prototype.cleanNonFinites,n.getNormalized=nL.prototype.getNormalized,n.getNormalizedToMax=nL.prototype.getNormalizedToMax,n.getNormalizedToSum=nL.prototype.getNormalizedToSum,n.factor=nL.prototype.factor,n.add=nL.prototype.add,n.subtract=nL.prototype.subtract,n.divide=nL.prototype.divide,n.sqrt=nL.prototype.sqrt,n.pow=nL.prototype.pow,n.log=nL.prototype.log,n.floor=nL.prototype.floor,n.isEqual=nL.prototype.isEqual,n.addRandom=nL.prototype.addRandom,n.trim=nL.prototype.trim,n.getGeometricMean=nL.prototype.getGeometricMean,n.approach=nL.prototype.approach,n.clone=nL.prototype.clone,n},I.prototype=new P,I.prototype.constructor=I,pol3DL.prototype=new L,pol3DL.prototype.constructor=pol3DL,pol3DL.toL=function(e){let t=L.toL(e);return t.type="pol3DL",t.getBarycenter=pol3DL.prototype.getBarycenter,t},cScale.prototype=new DataType,cScale.prototype.constructor=cScale,MetaCanvas.prototype.constructor=MetaCanvas,Engine3D.prototype.constructor=Engine3D,Forces.prototype.constructor=Forces,P.prototype.getNorm=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},P.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},P.prototype.factor=function(e){return e>=0||e<0?new P(this.x*e,this.y*e):null!=e.type&&"P"==e.type?new P(this.x*e.x,this.y*e.y):void 0},P.prototype.normalize=function(){let e=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x/e,this.y/e)},P.prototype.normalizeToValue=function(e){let t=e/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x*t,this.y*t)},P.prototype.subtract=function(e){return new P(this.x-e.x,this.y-e.y)},P.prototype.add=function(e){return new P(e.x+this.x,e.y+this.y)},P.prototype.addCoordinates=function(e,t){return new P(e+this.x,t+this.y)},P.prototype.distanceToPoint=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},P.prototype.distanceToPointSquared=function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},P.prototype.angleToPoint=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},P.prototype.expandFromPoint=function(e,t){return new P(e.x+t*(this.x-e.x),e.y+t*(this.y-e.y))},P.prototype.interpolate=function(e,t){return new P((1-t)*this.x+t*e.x,(1-t)*this.y+t*e.y)},P.prototype.cross=function(e){return this.x*e.y-this.y*e.x},P.prototype.dot=function(e){return this.x*e.x+this.y*e.y},P.prototype.getRotated=function(e,t){return t=null==t?new P:t,new P(Math.cos(e)*(this.x-t.x)-Math.sin(e)*(this.y-t.y)+t.x,Math.sin(e)*(this.x-t.x)+Math.cos(e)*(this.y-t.y)+t.y)},P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},L.prototype.downcast=function(){if(0===this.length)return this;let e;switch(this.getTypeOfElements()){case"number":return e=nL.toL(this,!1),e.name=this.name,e;case"string":return e=sL.toL(this,!1),e.name=this.name,e;case"Rec":return this;case"date":return e=dL.toL(this,!1),e.name=this.name,e;case"L":case"dL":case"iL":case"sL":case"T":e=T.toL(this,!1);break;case"Array":e=T.toL(this,!1).getListsDowncasted();break;case"nL":return e=nT.toL(this,!1),e.name=this.name,e;case"P":e=Pol.toL(this,!1);break;case"Pol":e=polL.toL(this,!1);break;case"Nd":e=ndL.toL(this,!1);break;case"Rel":e=relL.toL(this,!1)}var t=this.length;let n,r=!1,o=!0;if(null==e||null==e.type&&""==e){for(n=0;n<t;n++)if(null==this[n]&&(r=!0),null==this[n]||!this[n].isList){o=!1;break}o&&(e=T.toL(this,!1))}if(null!=e?e.name=this.name:e=this,o){for(n=0;n<t;n++)if(null==e[n]||e[n].containsNulls){r=!0;break}}else if(!r)for(n=0;n<t;n++)if(null==e[n]){r=!0;break}return e.containsNulls=r,e},L.prototype.get=function(e){if(Array.isArray(e))return this.getElements(e);if("string"==typeof e){e=e.trim();for(var t=!1,n=0;n<this.length;n++)if(this[n].name==e){t=!0,e=n;break}if(!t)return null}else(e=null==e?0:e)<0&&(e+=this.length),e>=this.length&&(e=Math.floor(e)%this.length);return this[e]},L.prototype.getElements=function(e,t){if(null==e)return;var n=instanceSameType(this);n.name=this.name;let r,o,i=e.length,s=_typeOf(n);var l="sL"==_typeOf(e);for(r=0;r<i;r++)o=l?this.getElementByName(e[r]):this[e[r]<0?e[r]+this.length:e[r]],null==o?(t||!l&&null===this[e[r]])&&n.push(null):"ndL"==s?n.addNode(o):n.push(o);return"L"!=n.type?n:n.downcast()},L.prototype.toArray=function(){let e=this.slice(0);return e.name=this.name,e.type=this.type,e},L.prototype.isEqual=function(e){if(null==e||this.length!=e.length)return!1;var t;let n=this.length;if(this.isTable){for(t=0;t<n;t++)if(!this[t].isEqual(e[t]))return!1;return!0}for(t=0;t<n;t++)if(this[t]!=e[t])return!1;return!0},L.prototype.getLengths=function(){return tonL(this.map((e=>e.length)))},L.prototype.getTypeOfElements=function(){let e=_typeOf(this[0]),t=this.length;for(var n=1;n<t;n++)if(_typeOf(this[n])!=e)return"";return e},L.prototype.getTypes=function(){let e=new sL,t=this.length;for(var n=0;n<t;n++)e[n]=_typeOf(this[n]);return e},L.prototype.getNames=function(e,t,n){let r=new sL;r.name=n?"labels":"names";let o,i=this.length;e&&this.isTable&&buildInformationObjectForTable(this);for(var s=0;s<i;s++)o=n&&null!=this[s].label?this[s].label:this[s].name,e&&this[s].isList?this[s].infoObject.isCategorical&&this[s].infoObject.isNumeric?r[s]="[#c] "+o:this[s].infoObject.isCategorical?r[s]="[c] "+o:this[s].infoObject.isNumeric?r[s]="[#] "+o:r[s]=o:r[s]=o,t&&(r[s]+=" ("+this[s].countDifferentElements()+")");return r},L.prototype.getLabels=function(e,t){return this.getNames(e,t,!0)},L.prototype.getDescriptions=function(){let e=new sL,t=this.length;for(var n=0;n<t;n++)e[n]=this[n].description;return e},L.prototype.getCategories=function(){let e=new sL,t=this.length;for(var n=0;n<t;n++)e[n]=this[n].category;return e},L.prototype.getReversed=function(){let e=this.clone();return e.reverse(),e},L.prototype.getSubList=function(){var e;let t;if(null==arguments[0])return;if(arguments[0].isList)return this.getElements(arguments[0]);"number"==_typeOf(arguments[0])?e=null!=_typeOf(arguments[1])&&"number"==_typeOf(arguments[1])?new I(arguments[0],arguments[1]):new I(arguments[0],this.length-1):null!=arguments[0].x&&(e=arguments[0]),e.x<0&&(e.x=this.length+e.x),e.y<0&&(e.y=this.length+e.y);var n=new I(Math.max(Math.min(Math.floor(e.x),this.length),0),Math.max(Math.min(Math.floor(e.y),this.length-1),0));let r;if(arguments[2]&&(n.y+=arguments[2]),"nL"==this.type)return r=nL.toL(this.slice(n.x,n.y+1),!1),r.name=this.name,r;if("sL"==this.type)return r=sL.toL(this.slice(n.x,n.y+1),!1),r.name=this.name,r;var o=this.type;if(r="L"==o||"T"==o?new L:instantiate(o),"ndL"==o)for(t=n.x;t<=n.y;t++)r.addNode(this[t]);else for(t=n.x;t<=n.y;t++)r.push(this[t]);return r.name=this.name,"L"==o||"T"==o?r.downcast():r},L.prototype.getSubListByType=function(e){let t=new L;t.name=this.name;for(var n=0;n<this.length;n++)_typeOf(this[n])==e&&t.push(this[n]);return t.downcast()},L.prototype.getElementNumberOfOccurrences=function(e){let t=0,n=0,r=this.indexOf(e,n);for(;r>-1;)t++,n=r+1,r=this.indexOf(e,n);return t},L.prototype.clone=function(){let e,t=instanceSameType(this),n=this.length;for(e=0;e<n;e++)t.push(this[e]);return t.name=this.name,t.fnDerived=this.fnDerived,t},L.prototype.getWithoutRepetitions=function(e,t){return toL([...new Set(this)]).downcast()},L.prototype.getSimplified=function(e,t,n){if(!e)return;var r=this.getFrequenciesTable(!0,!1,!1,n);let o,i=getFirstOccurrenceDictionaryForList(r[0]),s=this.length;null==t&&(t="other");var l="sL"==this.type?new sL:new L;for(l.name=this.name,o=0;o<s;o++)l.push(i[this[o]]<e-1?this[o]:t);return l},L.prototype.countElement=function(e){let t=0,n=this.length;for(var r=0;r<n;r++)e==this[r]&&t++;return t},L.prototype.countOccurrences=function(){let e=new nL,t={},n=this.length;for(var r=0;r<n;r++)null==t[this[r]]&&(t[this[r]]=0),t[this[r]]++;for(r=0;r<n;r++)e[r]=t[this[r]];return e},L.prototype.countDifferentElements=function(){if(this.infoObject)return this.infoObject.numberDifferentElements;var e={};let t=0;for(var n=0;n<this.length;n++)null==e[this[n]]&&(e[this[n]]=1,t++);return t},L.prototype.getFrequenciesTable=function(e=!0,t,n,r){var o;let i,s;if(this.freqTable)l=(o=this.freqTable.getColumns([0,1]))[0],a=o[1];else{o=new T;var l=instanceSameType(this),a=new nL;o[0]=l,o[1]=a,o._indexesDictionary={};var u=this.length;for(i=0;i<u;i++)s=o._indexesDictionary[this[i]],null==s&&(s=l.length,l[s]=this[i],a[s]=0,o._indexesDictionary[this[i]]=s),r&&i<r.length?a[s]+=r[i]:a[s]++}var h=0;if(e){var c=[];for(i=0;i<a.length;i++)c[i]=[a[i],l[i]],h+=a[i];var f=c.sort((function(e,t){return t[0]-e[0]}));for(o[0]=instanceSameType(l),o[1]=new nL,i=0;i<a.length;i++)o[0][i]=f[i][1],o[1][i]=f[i][0];o._indexesDictionary=null}if(o[0].name=""==this.name?"Element":this.name,o[1].name="Frequency",t&&(0==h&&(h=o[1].getSum()),o[2]=normalizeToSum(o[1],1,h),o[2].name="Occurrences normalized to sum"),n){var p=stringsToColors(o[0]);p.name="Categorical colors",o.push(p)}return this.freqTable=o,o},L.prototype.allElementsAreEqual=function(){let e;if(this.length<2)return!0;var t=this[0];let n=this.length;for(e=1;e<n;e++)if(this[e]!=t)return!1;return!0},L.prototype.getMode=function(){let e={};var t=0;let n;for(var r=0;r<this.length&&(null==e[this[r]]&&(e[this[r]]=0),e[this[r]]++,!(e[this[r]]>t&&(t=e[this[r]],n=this[r],t>.5*this.length)));r++);return n},L.prototype.getMin=function(){if(0===this.length)return null;let e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.min(t,this[e]);return t},L.prototype.getMax=function(){if(0===this.length)return null;let e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.max(t,this[e]);return t},L.prototype.add=function(e){if(e.constructor==Number){var t,n=this.length,r=instanceSameType(this);for(t=0;t<n;t++)r.push(this[t]+e);return r}},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*random())]},L.prototype.getRandomElements=function(e,t,n,r){if(null==e)return;var o=null!=n?new _Alea("my",n,"seeds"):NumberOperators_random;t=null==t||t,e=Math.min(e,this.length);let i,s=instanceSameType(this);if(r){var l=this;if(t)l=u=this.getWithoutRepetitions();e=Math.min(e,l.length);var a=new T;a.push(createSortedNumberList(l.length,0,1)),a.push(createNumberListWithinInterval(l.length,new I(0,1),0,n)),a=(a=(a=a.sortRowsByList(1)).sliceRows(0,e-1)).sortRowsByList(0),s=l.getElements(a[0])}else if(t){var u=this.getWithoutRepetitions();e=Math.min(e,u.length);for(var h=createNumberListWithinInterval(u.length,new I(0,1),0,n),c=u.getSortedByList(h),f=0;f<e;f++)s.push(c[f])}else for(;s.length<e;)i=this[Math.floor(this.length*o())],s.push(i);return s.name=this.name,s},L.prototype.getPropertyValues=function(e,t){let n,r=new L;r.name=e;let o=this.length;for(var i=0;i<o;i++)n=getPropertyValue(this[i],e),r[i]=null==n?t:n;return r.downcast()},L.prototype.isSorted=function(e){e=null==e||Boolean(e);var t=this.length;let n;if(e){for(n=1;n<t;n++)if(this[n]<this[n-1])return!1}else for(n=1;n<t;n++)if(this[n]>this[n-1])return!1;return!0},L.prototype.getSortedByIndexes=function(e){if(null==e)return;var t=instanceSameType(this);let n;t.name=this.name;let r=this.length;for(n=0;n<r;n++)-1!=e[n]&&t.push(this[e[n]]);return t},L.prototype.getSortedByProperty=function(e,t,n){if(e.includes("."))return this.getSortedByList(this.getPropertyValues(e),t,null!=n?this.getPropertyValues(e):null);if(t=null==t||t,0==this.length)return this.clone();var r=_typeOf(this[0][e]);let o="number"!=r&&"date"!=r;var i;return i=n?t?o?function(t,r){return t[e]==r[e]?t[n]>r[n]?1:-1:t[e]>r[e]?1:-1}:function(t,r){return t[e]==r[e]?t[n]-r[n]:t[e]-r[e]}:o?function(t,r){return t[e]==r[e]?r[n]>t[n]?1:-1:r[e]>t[e]?1:-1}:function(t,r){return t[e]==r[e]?r[n]-t[n]:r[e]-t[e]}:t?o?function(t,n){return t[e]>n[e]?1:-1}:function(t,n){return t[e]-n[e]}:o?function(t,n){return n[e]>t[e]?1:-1}:function(t,n){return n[e]-t[e]},this.clone().sort(i)},L.prototype.getSorted=function(e){return this.getSortedByList(this,e)},L.prototype.getSortedByList=function(e,t,n,r){if(null==e)return null;t=null==t||t,r=null!=r&&r;var o=[];let i,s=this.length;if(n&&"nL"==e.type)for(i=0;i<s;i++)o[i]=[this[i],e[i]+1e4*Math.random()*Number.MIN_VALUE,i];else if("dL"==e.type)for(i=0;i<s;i++)o[i]=[this[i],e[i].getTime(),i];else for(i=0;i<s;i++)o[i]=[this[i],e[i],i];let l=("nL"==e.type||"dL"==e.type)&&!r;var a;a=t?l?function(e,t){return e[1]-t[1]}:r?function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[2]-t[2]}:function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:0}:l?function(e,t){return t[1]-e[1]}:r?function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:e[2]-t[2]}:function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:0},o=o.sort(a);var u=instanceSameType(this);for(u.name=this.name,i=0;i<s;i++)u[i]=o[i][0];return u},L.prototype.getSortedRandom=function(){let e=this.clone();return e.name=this.name,e.sort((function(){return random()-.5})),e},L.prototype.indexOfElement=function(e){let t,n=this.length;for(t=0;t<n;t++)if(this[t]==e)return t;return-1},L.prototype.indexesOf=function(e){var t=this.indexOf(e);let n=new nL;for(;-1!=t;)n.push(t),t=this.indexOf(e,t+1);return n},L.prototype.indexOfElements=function(e){if(null==e)return;var t=new nL;let n=e.length;for(var r=0;r<n;r++)t[r]=this.indexOf(e[r]);return t},L.prototype.indexesOfElements=function(e,t){if(null==e)return;var n,r=new nL;let o,i;this.length;if(n=getFirstOccurrenceDictionaryForList(this),t)for(o=0;o<e.length;o++)i=n[e[o]],r[o]=null==i?-1:i;else for(o=0;o<e.length;o++)i=n[e[o]],null!=i&&r.push(i);return r},L.prototype.getElementByName=function(e,t){if(null==e)return null;for(var n=this.length,r=0;r<n;r++)if(this[r].name==e)return t?r:this[r];return t?-1:null},L.prototype.getElementsByNames=function(e,t,n,r){if(null==e)return;var o=t?new nL:new L;let i,s,l,a,u=this.length;for(i=0;i<e.length;i++){for(l=e[i],a=!1,s=0;s<u;s++)if(this[s].name==l){o.push(t?s:this[s]),a=!0;break}n&&!a&&o.push(t?-1:r)}return t?o:o.downcast()},L.prototype.getFirstElementByPropertyValue=function(e,t){let n=this.length;for(var r=0;r<n;r++)if(this[r][e]==t)return this[r];return null},L.prototype.getFilteredByBooleanList=function(e){let t,n=new L;n.name=this.name;let r=this.length;for(t=0;t<r;t++)e[t]&&n.push(this[t]);return n.downcast()},L.prototype.getFilteredByPropertyValue=function(e,t,n){n=null==n?"equal":n;var r=new L;let o;r.name="filtered_"+this.name;let i=this.length;switch(n){case"equal":for(o=0;o<i;o++)this[o][e]==t&&r.push(this[o]);break;case"different":for(o=0;o<i;o++)this[o][e]!=t&&r.push(this[o]);break;case"greater":for(o=0;o<i;o++)this[o][e]>t&&r.push(this[o]);break;case"lower":for(o=0;o<i;o++)this[o][e]<t&&r.push(this[o])}return r.downcast()},L.prototype.getWithoutElementsAtIndexes=function(e){let t,n,r=this.length;for(n="L"==this.type?new L:instantiate(_typeOf(this)),e=nL.toL(e.slice(),!1),t=0;t<e.length;t++)e[t]<0&&(e[t]+=this.length);for(t=0;t<r;t++)e.includes(t)||n.push(this[t]);return"L"==this.type?n.downcast():(n.name=this.name,n)},L.prototype.getWithoutElementAtIndex=function(e){let t,n=this.length;e<0&&(e+=n),t="L"==this.type?new L:instanceSameType(this);for(var r=0;r<n;r++)r!=e&&t.push(this[r]);return t.name=this.name,"L"==this.type?t.downcast():t},L.prototype.getWithoutElement=function(e){if(null==e&&(e=null),null!=e&&!this.includes(e))return this;var t=new L;let n;t.name=this.name;let r=this.length;for(n=0;n<r;n++)this[n]!=e&&t.push(this[n]);return t.downcast()},L.prototype.getWithoutElements=function(e){let t,n,r=this.length;if(t="L"==this.type?new L:instanceSameType(this),this.isTable)for(n=0;n<r;n++)e.includes(this[n])||t.push(this[n]);else{var o=getBooleanDictionaryForList(e);for(n=0;n<r;n++)o[this[n]]||t.push(this[n])}return t.name=this.name,"L"==this.type?t.downcast():t},L.prototype.getFilteredByFunction=function(e,t){let n=instanceSameType(this),r=this.length;for(var o=0;o<r;o++)e(this[o],o,this)&&("ndL"==n.type?n.addNode(this[o]):n.push(this[o]));return n.name=t||this.name,"L"==this.type?n.downcast():n},L.prototype.insert=function(e,t,n){if(n=null==n||n,t=null==t?0:t,null!=e){if("string"==typeof t&&(t=this.getNames().indexOf(t)),-1==t)throw new Error("element with given name not found");var r;if(n)return(r=this.clone()).name=this.name,r[t]=e,r.downcast();(r=new L).name=this.name;for(var o=0;o<this.length+1;o++)r[o]=o<t?this[o]:o==t?e:this[o-1];return r.downcast()}},L.prototype.insertMany=function(e,t,n){if(null==e||null==t)return null;if(n=null==n||n,e.length!=t.length)throw new Error("indexes and elements need to be the same length");if("sL"==t.type&&(t=this.getNames().indexesOfElements(t)),null==t||t.length!=e.length)throw new Error("some elements with given names not found");let r;if(n){var o=Math.min(e.length,t.length);r=this.clone(),r.name=this.name;for(var i=0;i<o;i++)r[t[i]]=e[i];return r.downcast()}r=new L,r.name=this.name,e=e.getSortedByList(t),t=t.getSorted();for(i=0;i<e.length;i++)r[t[i]+i]=e[i];var s=0;for(i=0;i<this.length;i++){for(;null!=r[s];)s++;r[s]=this[i],s++}return r.downcast()},L.prototype.concat=function(){if(null==arguments[0])return this;if(arguments[0].type==this.type){if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nL"==this.type)return nL.toL(this._concat.apply(this,arguments),!1);if("sL"==this.type)return sL.toL(this._concat.apply(this,arguments),!1);if("dL"==this.type)return dL.toL(this._concat.apply(this,arguments),!1);if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nT"==this.type)return nT.toL(this._concat.apply(this,arguments),!1);if("ndL"==this.type){var e,t=this.clone(),n=arguments[0],r=n.length;for(e=0;e<r;e++)t.addNode(n[e]);return t}}return L.toL(this._concat.apply(this,arguments)).downcast()},L.prototype.toNumberList=function(e,t){if("nL"==this.type)return this;t=null==t?0:t;var n=new nL;let r,o=this.length,i=!1;if("dL"==this.type)for(""==n.name&&(n.name="decimal date"),r=0;r<o;r++)n[r]=getDecimalDate(this[r]);else for(r=0;r<o;r++)n[r]=0==t?parseFloat(this[r]):Number(this[r]),isNaN(n[r])&&(n[r]=e,null==e&&(i=!0));return i&&(n=L.toL(n)),n.name=this.name,n.downcast()},L.prototype.toStringList=function(){if("sL"==this.type)return this;var e=this.length;let t,n=new sL;for(n.name=this.name,t=0;t<e;t++)n[t]=String(this[t]);return n},L.prototype.toColorList=function(e,t){let n;if("cL"==this.type)return this;if("nL"==this.type){let e=this.getInterval();if(e.x<0&&e.y>0){let t=Math.max(e.x,e.y);n=new _.cL,this.forEach((e=>{let r=e?.5-.5*e/t:.5;n.push(_.interpolateColors(_.blueWhiteRed(r),"rgb(255,255,255)",.6))}))}else n=createColorListFromNumberList(this,t);return n.name="colors",n}if(e)return colorsForCategoricalList(this,null,!0);if("sL"==this.type){var r,o=new cL;o.name=this.name;for(var i=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,s=0;s<this.length&&null!=(r=colorStringToRGB(this[s]));s++)i.test(this[s])?o.push(this[s]):o.push("rgb("+r[0]+","+r[1]+","+r[2]+")");if(o.name="colors",null!=r)return o}return n=colorsForCategoricalList(this),n.name="colors",n},L.prototype.removeElements=function(e){let t,n={},r=this.length,o=e.length;for(t=0;t<o;t++)n[e[t]]=!0;for(t=0;t<r;t++)n[this[t]]&&(this.splice(t,1),t--)},L.prototype.removeElement=function(e){let t=this.indexOf(e);-1!=t&&this.splice(t,1)},L.prototype.pushIfUnique=function(e){let t=!this.includes(e);return t&&this.push(e),t},L.prototype.removeElementAtIndex=function(e){this.splice(e,1)},L.prototype.removeElementsAtIndexes=function(e){e=e.sort((function(e,t){return e-t}));for(var t=0;null!=e[t];t++)this.splice(e[t]-t,1)},L.prototype.setNames=function(e,t=!0,n){if(null==e)return this;var r,o;"string"==typeof e&&-1!=e.search(/\n|\r|\,/)&&(e=e.split(/\n|\r|\,/g)),"string"==typeof e&&(e=[e]);var i=null==n?createSortedNumberList(e.length):n;"sL"==i.type&&(i=this.getElementsByNames(i,!0,!0));let s=Math.min(i.length,e.length);var l=t?this:this.clone();for(r=0;r<s;r++){if(-1==(o=i[r])&&"sL"==n.type)throw new Error("No element found with name: "+n[r]);if(o<0||o>=this.length)throw new Error("Invalid index: "+o);l[o].name=e[r]}return l},L.prototype.setPropertyValues=function(e,t,n){if(null==e||null==t)return null;Array.isArray(t)||(t=[t]);var r=t.length;let o=this.length;for(var i=n?this:this.clone(),s=0;s<o;s++)i[s]=setPropertyValue(this[s],e,t[s%r],n);return i},L.prototype.splice=function(){switch(this.type){case"nL":return nL.toL(this._splice.apply(this,arguments));case"sL":return sL.toL(this._splice.apply(this,arguments));case"ndL":return ndL.toL(this._splice.apply(this,arguments));case"dL":return dL.toL(this._splice.apply(this,arguments))}return L.toL(this._splice.apply(this,arguments)).downcast()},iL.prototype.getInterval=function(){if(0===this.length)return null;var e=Math.max(this[0].x,this[0].y);let t,n=Math.min(this[0].x,this[0].y),r=this.length;for(t=1;t<r;t++)e=Math.max(e,this[t].x,this[t].y),n=Math.min(n,this[t].x,this[t].y);return new I(n,e)},iL.prototype.getAmplitudes=function(){if(0===this.length)return null;var e;let t=new nL;for(e=0;e<this.length;e++)t[e]=this[e].getAmplitude();return t},cL.prototype.getRgbArrays=function(){let e=new L,t=this.length;for(var n=0;n<t;n++)e[n]=colorStringToRGB(this[n]);return e},cL.prototype.getInterpolated=function(e,t){let n=new cL,r=this.length;for(var o=0;o<r;o++)n[o]=interpolateColors(this[o],e,t);return n.name=this.name,n},cL.prototype.getInverted=function(){let e=new cL,t=this.length;for(var n=0;n<t;n++)e[n]=invertColor(this[n]);return e.name=this.name,e},cL.prototype.addAlpha=function(e){let t=new cL,n=this.length;for(var r=0;r<n;r++)t[r]=addAlpha(this[r],e);return t.name=this.name,t},P3D.prototype.distanceToPoint3D=function(e){return Math.sqrt(Math.pow(Math.abs(this.x-e.x),2)+Math.pow(Math.abs(this.y-e.y),2)+Math.pow(Math.abs(this.z-e.z),2))},P3D.prototype.distanceToPointSquared=function(e){return Math.pow(Math.abs(this.x-e.x),2)+Math.pow(Math.abs(this.y-e.y),2)+Math.pow(Math.abs(this.z-e.z),2)},P3D.prototype.getNorm2=function(){return this.x*this.x+this.y*this.y+this.z*this.z},P3D.prototype.getNorm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},P3D.prototype.normalizeToValue=function(e){let t=e/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2));return new P3D(this.x*t,this.y*t,this.z*t)},P3D.prototype.cross=function(e){return new P3D(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},P3D.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},P3D.prototype.angleToPoint=function(e){let t=this.getNorm(),n=e.getNorm();return Math.acos(this.dot(e)/(t*n))},P3D.prototype.add=function(e){return new P3D(e.x+this.x,e.y+this.y,e.z+this.z)},P3D.prototype.subtract=function(e){return new P3D(this.x-e.x,this.y-e.y,this.z-e.z)},P3D.prototype.factor=function(e){return new P3D(this.x*e,this.y*e,this.z*e)},P3D.prototype.interpolate=function(e,t){return new P3D((1-t)*this.x+t*e.x,(1-t)*this.y+t*e.y,(1-t)*this.z+t*e.z)},P3D.prototype.getAngles=function(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),t=.5*Math.PI-Math.atan2(this.z/e,this.y/e),n=-Math.asin(this.x/e);return t<-Math.PI&&(t+=2*Math.PI),t>Math.PI&&(t-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(t,n,0)},P3D.prototype.getInverseAngles=function(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),t=-.5*Math.PI+Math.atan2(-this.z/e,-this.y/e),n=Math.asin(-this.x/e);return t<-Math.PI&&(t+=2*Math.PI),t>Math.PI&&(t-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(t,n,0)},P3D.prototype.clone=function(){return new P3D(this.x,this.y,this.z)},P3D.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"},Pol3D.prototype.getBarycenter=function(){let e=0,t=0,n=0;for(var r=0;r<this.length;r++)e+=this[r].x,t+=this[r].y,n+=this[r].z;return new P3D(e/this.length,t/this.length,n/this.length)},Rec.prototype.getRight=function(){return this.x+this.width},Rec.prototype.getBottom=function(){return this.y+this.height},Rec.prototype.setRight=function(e){this.width=e-this.x},Rec.prototype.setBottom=function(e){this.height=e-this.y},Rec.prototype.getTopLeft=function(){return new P(this.x,this.y)},Rec.prototype.getTopRight=function(){return new P(this.x+this.width,this.y)},Rec.prototype.getBottomRight=function(){return new P(this.x+this.width,this.y+this.height)},Rec.prototype.getBottomLeft=function(){return new P(this.x,this.y+this.height)},Rec.prototype.getCenter=function(){return new P(this.x+.5*this.width,this.y+.5*this.height)},Rec.prototype.getRandomPoint=function(){return new P(this.x+Math.random()*this.width,this.y+Math.random()*this.height)},Rec.prototype.getIntersection=function(e){if(e.x+e.width<this.x||e.x>this.x+this.width||e.y+e.height<this.y||e.y>this.y+this.height)return null;let t=Math.max(e.x,this.x),n=Math.max(e.y,this.y);return new Rec(t,n,Math.min(e.x+e.width,this.x+this.width)-t,Math.min(e.y+e.height,this.y+this.height)-n)},Rec.prototype.interpolate=function(e,t){let n=1-t;return new Rec(n*this.x+t*e.x,n*this.y+t*e.y,n*this.width+t*e.width,n*this.height+t*e.height)},Rec.prototype.getRatio=function(){return Math.max(this.width,this.height)/Math.min(this.width,this.height)},Rec.prototype.getArea=function(){return this.width*this.height},Rec.prototype.containsPoint=function(e){return this.x<=e.x&&this.x+this.width>=e.x&&this.y<=e.y&&this.y+this.height>=e.y},Rec.prototype.pointIsOnBorder=function(e,t){if(t=null==t?1:t,e.x>=this.x-t&&e.x<=this.x+this.width+t){if(e.y>=this.y-t&&e.y<=this.y+t)return!0;if(e.y>=this.y+this.height-t&&e.y<=this.y+this.height+t)return!0;if(e.y>=this.y-t&&e.y<=this.y+this.height+t&&(e.x<this.x+t||e.x>this.x+this.width-t))return!0}return!1},Rec.prototype.getNormalRectangle=function(){return new Rec(Math.min(this.x,this.x+this.width),Math.min(this.y,this.y+this.height),Math.abs(this.width),Math.abs(this.height))},Rec.prototype.intersectsRectangle=function(e){return this.x+this.width>=e.x&&this.y+this.height>=e.y&&e.x+e.width>=this.x&&e.y+e.height>=this.y},Rec.prototype.containsRectangle=function(e){return e.getRight()<=this.getRight()&&e.x>=this.x&&e.getBottom()<=this.getBottom()&&e.y>=this.y},Rec.prototype.expand=function(e,t){return t=t||new P(this.x+.5*this.width,this.y+.5*this.height),new Rec((this.x-t.x)*e+t.x,(this.y-t.y)*e+t.y,this.width*e,this.height*e)},Rec.prototype.expandHorizontal=function(e,t){return t=t||this.x+.5*this.width,new Rec((this.x-t)*e+t,this.y,this.width*e,this.height)},Rec.prototype.expandVertical=function(e,t){return t=t||this.y+.5*this.height,new Rec(this.x,(this.y-t)*e+t,this.width,this.height*e)},Rec.prototype.isEqual=function(e){return this.x==e.x&&this.y==e.y&&this.width==e.width&&this.height==e.height},Rec.prototype.clone=function(){return new Rec(this.x,this.y,this.width,this.height)},Rec.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"},T.prototype.applyFunction=function(e){let t,n=new T;for(n.name=this.name,t=0;null!=this[t];t++)n[t]=this[t].applyFunction(e);return n.downcast()},T.prototype.getListsDowncasted=function(){return T.toL(this.map((function(e){return e.downcast()})))},T.prototype.get=function(e,t,n,r){var o;let i;if(e&&Array.isArray(e))return this.getColumns(e);if("string"==typeof e){for(e=e.trim(),i=!1,o=0;o<this.length;o++)if(this[o].name==e){i=!0,e=o;break}if(!i)return null}else(e=null==e?0:e)<0&&(e+=this.length);var s=this[e];if(null==s){if("number"==typeof e){if(e>this.length)throw new Error("provided indexElementInColumn bigger than list in indexOrNameOfColumn");return null}if("string"!=typeof e)throw new Error("indexOrNameOfColumn should be a number or a string")}if(null==s)return null;if(r)return s.getWithoutRepetitions();if(null==t&&null==n)return s;var l=s.length;null==t&&(t=0),null==n&&(n=l-1),t<0&&(t+=s.length),n<0&&(n+=s.length),n=Math.min(n,l-1);var a=new L;for(a.name=s.name,o=t;o<=n;o++)a.push(s[o]);return a.downcast()},T.prototype.getColumns=function(e,t,n,r,o){if(null==e)return;var i;if("string"==_typeOf(e)&&e.includes(",")&&(e=e.split(",")),null!=e.length&&"string"!=_typeOf(e)||(e=[e]),o)return i=this.getWithoutColumns(e),null==t&&null==n||(i=i.sliceRows(t,n)),i.name=this.name,i.downcast();i=new T;let s,l,a=e.length;for(s=0;s<a;s++)l=this.get(e[s],t,n),null==l?r&&i.push(new L):i.push(l);return i.downcast()},T.prototype.getWithoutColumn=function(e){if(null==e)return;let t=this.get(e);return null==t?this:this.getWithoutElement(t)},T.prototype.getWithoutColumns=function(e){if(null==e)return;let t=this.getColumns(e);return null==t||0==t.length?this:this.getWithoutElements(t)},T.prototype.getRow=function(e){if((e=null==e?0:e)<0&&(e+=this.length>0?this[0].length:0),!Number.isInteger(Number(e)))return null;var t=new L;let n,r=this.length;for(n=0;n<r;n++)t[n]=this[n][e];return t.downcast()},T.prototype.getRows=function(e,t){if(null==e)return t?this:void 0;"I"==e.type&&(e.x<0&&this.length>0&&(e.x+=this[0].length),e.y<0&&this.length>0&&(e.y+=this[0].length),e=createSortedNumberList(Math.floor(e.y-e.x+1),e.x));let n,r,o,i,s=new T,l=this.length,a=e.length,u=!1;for(r=0;r<l;r++){for(n=instanceSameType(this[r]),o=0;o<a;o++)i=e[o],i<0&&(i+=this[0].length,u=!0),n[o]=this[r][i];"nL"!=n.type&&(n=n.downcast()),n.name=this[r].name,s[r]=n}return s.name=this.name,s.downcast()},T.prototype.getCell=function(e,t){return this.get(e).get(t)},T.prototype.getListLength=function(e){if(!((e=e||0)>=this.length))return this[e].length},T.prototype.getLengths=function(){let e=new nL,t=this.length;for(var n=0;n<t;n++)e[n]=null==this[n]?0:this[n].length;return e},T.prototype.sliceRows=function(e,t){if(null==e)return this;var n;e.x&&(t=e.y,e=e.x),e=null==e?0:e,t=null==t?this[0].length-1:t;let r,o=new T,i=this.length;for(o.name=this.name,n=0;n<i;n++)r=this[n].getSubList(e,t),r&&(r.name=this[n].name),o.push(r);return o.downcast()},T.prototype.getWithoutRow=function(e){let t=new T,n=this.length;if(t.name=this.name,e<0&&(e+=this.length>0?this[0].length:0),!Number.isInteger(Number(e)))return this;for(var r=0;r<n;r++)t[r]=L.toL(this[r].slice(0,e).concat(this[r].slice(e+1))).downcast(),t[r].name=this[r].name;return t.downcast()},T.prototype.getWithoutRows=function(e){let t,n=new T,r=this.length;n.name=this.name,e=nL.toL(e.slice(),!1);for(var o=0;o<e.length;o++)e[o]<0&&(e[o]+=this.length>0?this[0].length:0);let i=getBooleanDictionaryForList(e);for(o=0;o<r;o++){n[o]=instanceSameType(this[o]),t=this[o].length;for(var s=0;s<t;s++)null==i[s]&&n[o].push(this[o][s]);n[o].name=this[o].name}return n.downcast()},T.prototype.sortRowsByList=function(e,t,n){if(null==e)return;var r=e.isList?e.clone():this.get(e);if(null==r)return;t=null==t||t,n=null!=n&&n;var o=instanceSameType(this);let i=this.length;for(var s=[],l=0;l<r.length;l++)s[l]=[l,r[l]];var a=("nL"==r.type||"dL"==r.type)&&!n;let u;var h;for(u=t?a?function(e,t){return e[1]-t[1]}:n?function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[0]-t[0]}:function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:0}:a?function(e,t){return t[1]-e[1]}:n?function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:e[0]-t[0]}:function(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:0},s=s.sort(u),o.name=this.name,l=0;l<i;l++){(h=instanceSameType(this[l])).name=this[l].name,o[l]=h;for(var c=0;c<r.length;c++)h[c]=this[l][s[c][0]]}return o},T.prototype.sortRowsByLists=function(e,t){if(null==e)return;if("number"==typeof e)(r=new nL).push(e),e=r;else if("string"==typeof e){(r=new sL).push(e),e=r}if("sL"==e.type){for(var n=this.getNames(),r=new nL,o=0;o<e.length;o++){if(-1==(h=n.indexOf(e[o])))throw new Error("No list with name "+e[o]);r.push(h)}e=r}null==t&&(t=!0),null==t.isList&&(t=createListWithSameElement(e.length,t));let i=new nL;for(o=0;o<t.length;o++)1==t[o]||"true"==t[o]||1==t[o]?i.push(1):i.push(-1);var s=instanceSameType(this);let l=this.length;var a=[];for(o=0;o<this[0].length;o++)a[o]={i:o,t:this,lists:e,polarity:i};var u;for(a=a.sort((function(e,t){for(var n,r,o,i=0;i<e.lists.length;i++){if(n=e.t[e.lists[i]][e.i],r=t.t[t.lists[i]][t.i],o=i<e.polarity.length?e.polarity[i]:1,n<r)return-1*o;if(n>r)return 1*o;if(i==e.lists.length-1)return e.i-t.i}return 0})),s.name=this.name,o=0;o<l;o++){(u=instanceSameType(this[o])).name=this[o].name,s[o]=u;for(var h=0;h<this[o].length;h++)u[h]=this[o][a[h].i]}return s},T.prototype.transpose=function(e,t){var n=e?this.getSubList(1):this;let r,o=n.length;var i=instantiate(_typeOf(n));if(0===n.length)return i;let s,l,a;for(s=0;s<o;s++)for(a=n[s],r=a.length,l=0;l<r;l++)0===s&&(i[l]="nT"==this.type?new nL:new L),i[l][s]=n[s][l];if(r=n[0].length,"nT"!=this.type)for(l=0;l<r;l++)i[l]=i[l].downcast();if(e)for(r=this[0].length,l=0;l<r;l++)i[l].name=String(this[0][l]);if(t){var u=new sL,h=e?1:0;for(o=this.length,s=h;s<o;s++)u.push(this[s].name);i._splice(0,0,u),i=i.downcast(),e&&(u.name=this[0].name)}return i},T.prototype.removeRow=function(e){for(var t=0;null!=this[t];t++)this[t].splice(e,1)},T.prototype.pushRow=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;let e=arguments;1==e.length&&e[0].length==this.length&&(e=e[0]);for(var t=0;t<e.length&&t<this.length;t++)this[t].push(e[t])},T.prototype.clone=function(){let e,t=this.length,n=instanceSameType(this);for(n.name=this.name,e=0;e<t;e++)n.push(this[e].clone());return void 0!==this.containsNulls&&(n.containsNulls=this.containsNulls),n},T.prototype.cloneWithEmptyLists=function(){let e,t,n=this.length,r=instanceSameType(this);for(r.name=this.name,e=0;e<n;e++)t=instanceSameType(this[e]),t.name=this[e].name,r.push(t);return r},T.prototype.appendRows=function(e){if(null==e)return this;let t,n;for(e==this&&(e=e.clone()),t=0;t<e.length;t++)for(t>=this.length&&(this[t]=instanceSameType(e[t]),this[t].name=e[t].name),n=0;n<e[t].length;n++)this[t].push(e[t][n]);return this},T.prototype.insertRow=function(e,t,n,r){if(null==e)return null;n=null!=n&&n;var o,i,s=(r=null!=r&&r)?this:this.clone();for(o=0;o<s.length&&o<e.length;o++)i="nL"!=s[o].type||isNaN(e[o])?e[o]:Number(e[o]),s[o]=s[o].insert(i,null==t?s[o].length:t,n);return s},T.prototype.trim=function(){return this.reduce(((e,t)=>(e.push("sL"==t.type?t.trim():t),e)),new T).downcast()},polL.prototype.getFrame=function(){if(0===this.length)return null;let e=this[0].getFrame(),t=new Rec(e.x,e.y,e.getRight(),e.getBottom());for(var n=1;null!=this[n];n++)e=this[n].getFrame(),t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.width=Math.max(t.width,e.getRight()),t.height=Math.max(t.height,e.getBottom());return t.width-=t.x,t.height-=t.y,t},polL.prototype.getCenter=function(){let e=this.getFrame();return new P(e.x+.5*e.width,e.y+.5*e.height)},polL.prototype.getBarycenter=function(){let e;if(0===this.length)return null;let t=new P(this[0].x,this[0].y);for(e=1;null!=this[e];e++)t.x+=this[e].getBarycenter().x,t.y+=this[e].getBarycenter().y;return t.x/=this.length,t.y/=this.length,t},polL.prototype.add=function(e){let t;if("P"===_typeOf(e)){var n=new polL;for(t=0;null!=this[t];t++)n[t]=this[t].add(e);return n.name=this.name,n}},polL.prototype.factor=function(e){let t=new polL;for(var n=0;null!=this[n];n++)t[n]=this[n].factor(e);return t.name=this.name,t},polL.prototype.getRotated=function(e,t){let n=new polL;for(var r=0;null!=this[r];r++)n[r]=this[r].getRotated(e,t);return n.name=this.name,n},polL.prototype.clone=function(){let e=new polL;for(var t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},Pol.prototype.getFrame=function(){if(0===this.length)return null;let e,t=new Rec(this[0].x,this[0].y,this[0].x,this[0].y);for(var n=1;null!=this[n];n++)e=this[n],t.x=Math.min(t.x,e.x),t.y=Math.min(t.y,e.y),t.width=Math.max(t.width,e.x),t.height=Math.max(t.height,e.y);return t.width-=t.x,t.height-=t.y,t},Pol.prototype.getCenter=function(){let e=this.getFrame();return new P(e.x+.5*e.width,e.y+.5*e.height)},Pol.prototype.getBarycenter=function(e){let t;e=null==e||e;let n=1-Number(e);if(0===this.length)return null;let r=new P(this[0].x,this[0].y);for(t=1;null!=this[t+n];t++)r.x+=this[t].x,r.y+=this[t].y;return r.x/=this.length,r.y/=this.length,r},Pol.prototype.add=function(e){let t;if("P"===_typeOf(e)){var n=new Pol;for(t=0;null!=this[t];t++)n[t]=this[t].add(e);return n.name=this.name,n}},Pol.prototype.factor=function(e){let t,n=new Pol;if(n.name=this.name,e>=0||e<0){for(t=0;null!=this[t];t++)n[t]=new P(this[t].x*e,this[t].y*e);return n}if(null!=e.type&&"P"==e.type){for(t=0;null!=this[t];t++)n[t]=new P(this[t].x*e.x,this[t].y*e.y);return n}return null},Pol.prototype.getRotated=function(e,t){t=null==t?this.getCenter():t;for(var n=new Pol,r=0;null!=this[r];r++)n[r]=new P(Math.cos(e)*(this[r].x-t.x)-Math.sin(e)*(this[r].y-t.y)+t.x,Math.sin(e)*(this[r].x-t.x)+Math.cos(e)*(this[r].y-t.y)+t.y);return n.name=this.name,n},Pol.prototype.getClosestPoint=function(e){let t,n=this[0],r=Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2);for(var o=1;null!=this[o];o++)t=Math.pow(e.x-this[o].x,2)+Math.pow(e.y-this[o].y,2),t<r&&(r=t,n=this[o]);return n},Pol.prototype.toNumberList=function(){let e,t=new nL;for(e=0;null!=this[e];e++)t[2*e]=this[e].x,t[2*e+1]=this[e].y;return t},Pol.prototype.containsPoint=function(e){let t,n,r,o;for(o=!1,t=-1,r=this.length,n=r-1;++t<r;n=t)(this[t].y<=e.y&&e.y<this[n].y||this[n].y<=e.y&&e.y<this[t].y)&&e.x<(this[n].x-this[t].x)*(e.y-this[t].y)/(this[n].y-this[t].y)+this[t].x&&(o=!o);return o},Pol.prototype.touchesPolygon=function(e){let t=this.getFrame(),n=e.getFrame();if(t.x>n.x+n.width||t.x+t.width<n.x||t.y>n.y+n.height||t.y+t.height<n.y)return!1;for(var r=0;r<this.length;r++)if(e.containsPoint(this[r]))return!0;return!1},Pol.prototype.approach=function(e,t){let n=1-(t=t||.5);this.forEach((function(r,o){r.x=n*r.x+t*e[o].x,r.y=n*r.y+t*e[o].y}))},Pol.prototype.clone=function(){let e=new Pol;for(var t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},Nd.prototype.cleanRelations=function(){this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL},Nd.prototype.getDegree=function(){return this.relations.length},Nd.prototype.getParent=function(){return this.parent},Nd.prototype.getLeaves=function(){var e=new ndL,t=function(n){0!==n.to.length?n.to.forEach(t):e.addNode(n)};return t(this),e},Nd.prototype.loadImage=function(e){Loader.loadImage(e,(function(e){this.image=e.result}),this)},Nd.prototype.clone=function(e){let t=new Nd(this.id,this.name);return t.x=this.x,t.y=this.y,t.z=this.z,t.nodeType=this.nodeType,t.weight=this.weight,t.descentWeight=this.descentWeight,e?.forEach((e=>{t[e]=this[e]})),t},sL.prototype.getLengths=function(){let e=new nL;return this.forEach((function(t){e.push(null==t?0:t.length)})),e},sL.prototype.countTags=function(e=","){let t=new nL;return this.forEach((function(n){n.includes(e)?t.push(n.split(e).length):t.push(0)})),t},sL.prototype.includesSubString=function(e){for(var t=0;t<this.length;t++)if(this[t].includes(e))return!0;return!1},sL.prototype.indexesOfSubString=function(e){for(var t=new nL,n=0;n<this.length;n++)this[n].includes(e)&&t.push(n);return t},sL.prototype.append=function(e,t){t=null==t||t;let n=new sL;n.name=this.name;let r,o="sL"==_typeOf(e);if(t)for(r=0;null!=this[r];r++)n[r]=this[r]+(o?e[r]:e);else for(r=0;null!=this[r];r++)n[r]=(o?e[r]:e)+this[r];return n},sL.prototype.getSurrounded=function(e,t){t=null==t?"":t;let n,r=new sL;r.name=this.name;var o=Array.isArray(e);let i=Array.isArray(t);for(n=0;null!=this[n];n++)r[n]=(o?e[n]:e)+this[n]+(i?t[n]:t);return r},sL.prototype.replace=function(e,t){if(null==e)return this;var n=new sL;let r,o=this.length;for(n.name=this.name,r=0;r<o;r++)n[r]=this[r].replace(e,t);return n},sL.prototype.getConcatenated=function(e){let t;e=null==e?" ":e;let n="",r=this.length;for(t=0;t<r;t++)n+=this[t],t<this.length-1&&(n+=e);return n},sL.prototype.toLowerCase=function(){let e,t=new sL;t.name=this.name;let n=this.length;for(e=0;e<n;e++)t[e]=this[e].toLowerCase();return t},sL.prototype.toUpperCase=function(){let e,t=new sL;t.name=this.name;let n=this.length;for(e=0;e<n;e++)t[e]=this[e].toUpperCase();return t},sL.prototype.trim=function(e){if(this.isTable)return this.trim();if("sL"!=this.type)return null;let t,n=this.length,r=new sL;for(t=0;t<n;t++)r[t]=e?this[t].substring(0,e).trim():this[t].trim();return r.name=this.name,r},sL.prototype.clone=function(){let e=sL.toL(this.slice(),!1);return e.name=this.name,e.fnDerived=this.fnDerived,e},ndL.prototype.removeNodes=function(){let e,t=this.length;for(e=0;e<t;e++)this.ids[this[e].id]=null,this.removeElement(this[e])},ndL.prototype.addNode=function(e){this.ids[e.id]=e,this._push(e)},ndL.prototype.addNodes=function(e){let t;for(t=0;null!=e[t];t++)this.addNode(e[t])},ndL.prototype.removeNode=function(e){this.ids[e.id]=null,this.removeElement(e)},ndL.prototype.removeNodeAtIndex=function(e){this.ids[this[e].id]=null,this.splice(e,1)},ndL.prototype.normalizeWeights=function(){let e,t=-9999999,n=this.length;for(e=0;e<n;e++)t=Math.max(this[e].weight,t);for(e=0;e<n;e++)this[e].weight/=t},ndL.prototype.getNodeByName=function(e){let t,n=this.length;for(t=0;t<n;t++)if(this[t].name==e)return this[t];return null},ndL.prototype.get=function(e){return this.ids[e]},ndL.prototype.getNodesByIds=function(e){let t,n=new ndL,r=e.length;for(var o=0;o<r;o++)t=this.ids[e[o]],null!=t&&n.addNode(t);return n},ndL.prototype.getWeights=function(){let e,t=new nL;for(e=0;null!=this[e];e++)t[e]=this[e].weight;return t},ndL.prototype.getIds=function(){let e=new sL,t=this.length;for(var n=0;n<t;n++)e[n]=this[n].id;return e},ndL.prototype.getDegrees=function(){let e=new nL;for(var t=0;null!=this[t];t++)e[t]=this[t].nodes.length;return e},ndL.prototype.getPolygon=function(e){let t=new Pol;for(var n=0;null!=this[n];n++)t[n]=new P(this[n].x+e.cX,this[n].y+e.cY);return t},ndL.prototype.clone=function(){let e,t=new ndL,n=this.length;for(e=0;e<n;e++)t.addNode(this[e]);return t.name=this.name,t},ndL.prototype.getWithoutRepetitions=function(){let e,t=new ndL;for(t.name=this.name,e=0;null!=this[e];e++)null==t.get(this[e].id)&&t.addNode(this[e]);return t},ndL.prototype.removeElements=function(e){let t;for(t=0;null!=this[t];t++)null!=e.get(this[t].id)&&(this.ids[this[t].id]=null,this.splice(t,1),t--)},relL.prototype.addRelation=function(e){this.addNode(e)},relL.prototype.removeRelation=function(e){this.removeNode(e)},relL.prototype.getRelationsWithNode=function(e){let t,n=[];for(t=0;null!=this[t];t++){var r=this[t];r.node0!=e&&r.node1!=e||n.push(r)}return n},relL.prototype.getRelatedNodesToNode=function(e){let t,n=new ndL;for(t=0;t<this.length;t++){var r=this[t];r.node0.id==e.id&&n.push(r.node1),r.node1.id==e.id&&n.push(r.node0)}return n},relL.prototype.getChildrenOfNode=function(e){let t,n=new ndL;for(t=0;t<this.length;t++){var r=this[t];r.node0.id==e.id&&n.addNode(r.node1)}return n},relL.prototype.getAllRelationsBetweenNodes=function(e,t,n){let r;n=null!=n&&n;let o=[];for(r=0;null!=this[r];r++){var i=this[r];(i.node0==e&&i.node1==t||!n&&i.node0==t&&i.node1==e)&&o.push(i)}return o},relL.prototype.nodesAreConnected=function(e,t,n){return null!=e.to.get(t.id)||!n&&null!=t.to.get(e.id)},relL.prototype.getFirstRelationBetweenNodes=function(e,t,n){n=null!=n&&n;for(var r=0;null!=this[r];r++)if(this[r].node0.id==e.id&&this[r].node1.id==t.id||!n&&this[r].node1.id==e.id&&this[r].node0.id==t.id)return this[r];return null},relL.prototype.getFirstRelationByIds=function(e,t,n){let r,o,i=n||!1;for(r=0;null!=this[r];r++)if(o=this[r],o.node0.id==e&&o.node1.id==t)return o;if(i)return null;for(r=0;null!=this[r];r++)if(o=this[r],o.node0.id==t&&o.node1.id==e)return o;return null},recL.prototype.getFrame=function(){if(0===this.length)return null;var e=this[0].clone();e.width=e.getRight(),e.height=e.getBottom();for(var t=1;null!=this[t];t++)e.x=Math.min(e.x,this[t].x),e.y=Math.min(e.y,this[t].y),e.width=Math.max(this[t].getRight(),e.width),e.height=Math.max(this[t].getBottom(),e.height);return e.width-=e.x,e.height-=e.y,e},recL.prototype.clone=function(){let e=new recL;for(var t=0;null!=this[t];t++)e[t]=this[t].clone();return e.name=this.name,e},recL.prototype.add=function(){},recL.prototype.factor=function(){},recL.prototype.getIntersectionArea=function(){let e,t,n,r=0;for(var o=0;null!=this[o+1];o++){e=this[o];for(var i=o+1;null!=this[i];i++)t=this[i],n=e.getIntersection(t),r+=null==n?0:n.getArea()}return r},recL.prototype.intersectsRectangle=function(e){if(null==e)return!1;for(var t=0;t<this.length;t++)if(this[t].intersectsRectangle(e))return!0;return!1},Rel.prototype.getOther=function(e){return e==this.node0?this.node1:this.node0},Rel.prototype.clone=function(e,t){var n;return(n=t?new Rel(this.id,this.name,t.nodes.get(this.node0.id),t.nodes.get(this.node1.id)):new Rel(this.id,this.name,this.node0,this.node1)).x=this.x,n.y=this.y,n.z=this.z,n.nodeType=this.nodeType,n.weight=this.weight,n.descentWeight=this.descentWeight,e?.forEach((e=>{n[e]=this[e]})),n},Net.prototype.getNodes=function(){return this.nodes},Net.prototype.getRelations=function(){return this.relations},Net.prototype.getNodesIds=function(){return this.nodes.getIds()},Net.prototype.addNode=function(e){this.nodes.addNode(e)},Net.prototype.getNodeByName=function(e){return this.nodes.getNodeByName(e)},Net.prototype.get=function(e){return this.nodes.get(e)},Net.prototype.createRelation=function(e,t,n,r,o,i){null==e.type&&(e=this.createNode(e)),null==t.type&&(t=this.createNode(t)),null==n&&(n=e.id+"_"+t.id);var s=this.relations.get(n);return s||(null==i&&(i=e.name+"_"+t.name),s=new Rel(n,i,e,t,r,o),this.addRelation(s),s)},Net.prototype.addRelation=function(e){this.relations.addNode(e),e.node0.nodes.addNode(e.node1),e.node0.relations.addNode(e),e.node0.to.addNode(e.node1),e.node0.toRelations.addNode(e),e.node1.nodes.addNode(e.node0),e.node1.relations.addNode(e),e.node1.from.addNode(e.node0),e.node1.fromRelations.addNode(e)},Net.prototype.connect=function(e,t,n,r,o){let i=new Rel(n=n||e.id+"_"+t.id,n,e,t,r=r||1);return this.addRelation(i),i.content=o,i},Net.prototype.removeNode=function(e){this.removeNodeRelations(e),this.nodes.removeNode(e)},Net.prototype.removeNodeRelations=function(e){for(var t=0;null!=e.relations[t];t++)this.removeRelation(e.relations[t]),t--},Net.prototype.removeNodes=function(){this.nodes.deleteNodes(),this.relations.deleteNodes()},Net.prototype.removeRelation=function(e){this.relations.removeElement(e),e.node0.nodes.removeNode(e.node1),e.node0.relations.removeRelation(e),e.node0.to.removeNode(e.node1),e.node0.toRelations.removeRelation(e),e.node1.nodes.removeNode(e.node0),e.node1.relations.removeRelation(e),e.node1.from.removeNode(e.node0),e.node1.fromRelations.removeRelation(e)},Net.prototype.removeIsolatedNodes=function(e=1){let t,n=0;for(t=0;null!=this.nodes[t];t++)this.nodes[t].getDegree()<e&&(this.nodes[t]._toRemove=!0);for(t=0;null!=this.nodes[t];t++)this.nodes[t]._toRemove&&(this.removeNode(this.nodes[t]),n++,t--);return n},Net.prototype.lightClone=function(){let e=new Net;return e.nodes=this.nodes,e.relations=this.relations,e},Net.prototype.clone=function(e,t,n,r){let o,i,s=new Net;return null==e&&(e=[]),null==t&&(t=[]),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(t){o=new Nd(n+t.id,r+t.name),""!==n&&(o.basicId=t.id),""!==r&&(o.basicName=t.name),e&&(e.forEach((function(e){null!=t[e]&&(o[e]=t[e])})),o.weight=t.weight,o.color=t.color,o.kind=t.kind),s.addNode(o)})),this.relations.forEach((function(e){i=new Rel(n+e.id,r+e.name,s.nodes.get(n+e.node0.id),s.nodes.get(n+e.node1.id),e.weight),""!==n&&(i.basicId=e.id),""!==r&&(i.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(i[t]=e[t])})),s.addRelation(i)})),s},Tr.prototype.addNodeToTree=function(e,t){if(this.addNode(e),null==t)e.level=0,e.parent=null;else{var n=new Rel(t.id+"_"+e.id,t.id+"_"+e.id,t,e);this.addRelation(n),e.level=t.level+1,e.parent=t,t.weight++}e.weight=1,this.nLevels=Math.max(this.nLevels,e.level+1)},Net.prototype._newCreateRelation=function(e,t,n,r){null==n&&(n=this.relations.getNewId()),this._createRelation(e,t,n,r),t.level=e.level+1,t.parent=e,this.nLevels=Math.max(this.nLevels,t.level+1)},Tr.prototype.addFather=function(e,t){if(null!=t.parent||-1==this.nodes.indexOf(t))return!1;this.addNode(e),t.parent=e,t.level=1,this.nLevels=Math.max(this.nLevels,1),this.createRelation(e,t)},Tr.prototype.getLevel=function(e){e=0===e?0:e;var t=new ndL;t.name="level_"+e;let n,r=this.nodes.length;for(n=0;n<r;n++)this.nodes[n].level==e&&t.addNode(this.nodes[n]);return t},Tr.prototype.getLeaves=function(e){let t,n,r=new ndL;if(r.name="leaves",e){if(0===e.to.length)return r.addNode(e),r;var o=function(e){if(0===e.to.length)r.addNode(e);else for(n=e.to.length,t=0;t<n;t++)o(e.to[t])};for(n=e.to.length,t=0;t<n;t++)o(e.to[t])}else for(n=this.nodes.length,t=0;t<n;t++)0===this.nodes[t].to.length&&r.addNode(this.nodes[t]);return r},Tr.prototype.assignDescentWeightsToNodes=function(){this._assignDescentWeightsToNode(this.nodes[0])},Tr.prototype._assignDescentWeightsToNode=function(e){let t;if(0===e.to.length)return e.descentWeight=e.weight,e.descentWeight;for(e.descentWeight=0,t=0;null!=e.to[t];t++)e.descentWeight+=this._assignDescentWeightsToNode(e.to[t]);return e.weight=e.descentWeight,e.descentWeight},Tr.prototype.getReport=function(){return"Tr contains "+this.nodes.length+" nodes and "+this.relations.length+" relations"},Tr.prototype.traverse=function(e,t,n){if(null==this||"Tr"!=this.type)return;if(null==e&&null==(e=this.getLevel(0)[0]))return;t=null==t?0:t;var r=[e];let o,i,s,l,a=0,u=new ndL;for(;r.length>0;)if(i=0==t?r.pop():r.shift(),l=!0,n&&(l=n(i,a++,this)),u.addNode(i),l&&(s=this.relations.getChildrenOfNode(i),0!=s.length))if(0==t)for(o=s.length-1;o>=0;o--)r.push(s[o]);else for(o=0;o<s.length;o++)r.push(s[o]);return u},Tr.prototype.getAncestorsOf=function(e){if(null!=this&&"Tr"==this.type){var t,n,r;if("Nd"==e.type)(r=new ndL).addNode(e);else{if("ndL"!=e.type)return;r=e}var o=new ndL;for(n=0;n<r.length;n++)for(t=r[n];null!=t.parent;)o.addNode(t.parent),t=t.parent;return o=o.getWithoutRepetitions()}},Tr.prototype.buildFilteredTree=function(e){if(null==this||"Tr"!=this.type)return;if("ndL"!=e.type)throw new Error("Invalid input type for buildFilteredTree");var t=this.clone();let n,r,o=this.getAncestorsOf(e),i=new ndL;for(r=0;r<t.nodes.length;r++)n=t.nodes[r],null==o.get(n.id)&&null==e.get(n.id)&&i.addNode(n);for(r=0;r<i.length;r++)t.removeNode(i[r]);return t},Tr.prototype.clone=function(e,t,n,r){let o,i,s=new Tr;return s.nLevels=this.nLevels,null==e&&(e=[]),null==t&&(t=[]),e.push("parent"),e.push("level"),e.push("bOpen"),e.push("color"),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(t){o=new Nd(n+t.id,r+t.name),""!==n&&(o.basicId=t.id),""!==r&&(o.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(o[e]=t[e])})),s.addNode(o)})),this.relations.forEach((function(e){i=new Rel(n+e.id,r+e.name,s.nodes.get(n+e.node0.id),s.nodes.get(n+e.node1.id),e.weight),""!==n&&(i.basicId=e.id),""!==r&&(i.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(i[t]=e[t])})),s.addRelation(i)})),s},dI.prototype.toString=function(){return"DateInterval["+this.date0+", "+this.date1+"]"},dI.prototype.getMax=function(){return this.date1>this.date0?this.date1:this.date0},dI.prototype.getMin=function(){return this.date0<this.date1?this.date0:this.date1},dI.prototype.getTimesInterval=function(){return new I(this.date0.getTime(),this.date1.getTime())},dI.prototype.getProduct=function(e){if(null!=e){if("I"==e.type){var t=this.date0.getTime(),n=this.date1.getTime()-t;return new dI(new Date(t+e.x*n),new Date(t+e.y*n))}return null}},nT.prototype.getMax=function(){if(0===this.length)return null;var e=this[0].getMax();let t;for(t=1;null!=this[t];t++)e=Math.max(this[t].getMax(),e);return e},nT.prototype.getMaxValues=function(){if(0===this.length)return null;var e=new nL;let t;for(t=0;null!=this[t];t++)e[t]=this[t].getMax();return e},nT.prototype.getMaxCell=function(){if(0===this.length)return null;var e=createListWithSameElement(2,0);let t,n,r;for(r=this[0][0],t=0;t<this.length;t++)for(n=0;n<this[t].length;n++)this[t][n]>r&&(r=this[t][n],e[0]=t,e[1]=n);return e},nT.prototype.getMin=function(){if(0===this.length)return null;var e=this[0].getMin();let t;for(t=1;null!=this[t];t++)e=Math.min(this[t].getMin(),e);return e},nT.prototype.getMinValues=function(){if(0===this.length)return null;var e=new nL;let t;for(t=0;null!=this[t];t++)e[t]=this[t].getMin();return e},nT.prototype.getMinCell=function(){if(0===this.length)return null;var e=createListWithSameElement(2,0);let t,n,r;for(r=this[0][0],t=0;t<this.length;t++)for(n=0;n<this[t].length;n++)this[t][n]<r&&(r=this[t][n],e[0]=t,e[1]=n);return e},nT.prototype.getInterval=function(e){if(0===this.length)return null;let t=this[0].getInterval(e),n=this.length;for(var r=1;r<n;r++){var o=this[r].getInterval(e);t.x=Math.min(t.x,o.x),t.y=Math.max(t.y,o.y)}return t},nT.prototype.getFrame=function(){if(this.length<2)return;let e=this[0].getInterval(),t=this[1].getInterval();return new Rec(e.x,t.x,e.getAmplitude(),t.getAmplitude())},nT.prototype.getSums=function(e=1){let t=new nL,n=this.length;for(var r=0;r<n;r++)t[r]=this[r].getSum()*e;return t},nT.prototype.getRowsSums=function(){let e,t=this[0].clone();for(var n=1;null!=this[n];n++){e=this[n];for(var r=0;null!=e[r];r++)t[r]+=e[r]}return t},nT.prototype.getAverages=function(){let e=new nL;for(var t=0;null!=this[t];t++)e[t]=this[t].getMean();return e},nT.prototype.getRowsAverages=function(){let e,t,n,r,o=this.length,i=this[0].clone().factor(1/o);for(t=1;t<o;t++)for(e=this[t],r=e.length,n=0;n<r;n++)i[n]+=e[n]/o;return i},nT.prototype.getIntervals=function(){let e,t,n=this.length,r=new L;for(t=0;t<n;t++)e=this[t],r.push(e.getInterval());return r},nT.prototype.factor=function(e){let t,n,r=new nT,o=this.length;switch(_typeOf(e)){case"number":for(t=0;t<o;t++)n=this[t],r[t]=n.factor(e);break;case"nL":for(t=0;t<o;t++)n=this[t],r[t]=n.factor(e[t])}return r.name=this.name,r},nT.prototype.add=function(e){let t,n,r=new nT,o=this.length;for(n=0;n<o;n++)t=this[n],r[n]=t.add(e);return r.name=this.name,r},dL.prototype.getTimes=function(){let e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getTime());return t},dL.prototype.getYears=function(){let e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getYear());return t},dL.prototype.getFullYears=function(){let e,t=new nL;for(e=0;null!=this[e];e++)t.push(this[e].getFullYear());return t},dL.prototype.getMin=function(){if(0===this.length)return null;let e,t=this[0];for(e=1;null!=this[e];e++)t=t<this[e]?t:this[e];return t},dL.prototype.getMax=function(){if(0===this.length)return null;let e,t=this[0];for(e=1;null!=this[e];e++)t=t>this[e]?t:this[e];return t},dL.prototype.getInterval=function(){if(0===this.length)return null;var e=this[0],t=this[0];for(let n=1;n<this.length;n++)e=Math.min(this[n],e),t=Math.max(this[n],t);return new dI(e,t)},nL.prototype.getMin=function(){if(0===this.length)return null;let e,t=this[0];for(e=1;e<this.length;e++)t=Math.min(t,this[e]);return t},nL.prototype.getMax=function(){if(0===this.length)return null;let e,t=this[0],n=this.length;for(e=1;e<n;e++)t=Math.max(t,this[e]);return t},nL.prototype.getIndexOfMin=function(){if(0===this.length)return null;let e,t=this[0],n=0;for(e=1;e<this.length;e++)this[e]<t&&(t=this[e],n=e);return n},nL.prototype.getIndexOfMax=function(){if(0===this.length)return null;let e,t=this[0],n=0;for(e=1;e<this.length;e++)this[e]>t&&(t=this[e],n=e);return n},nL.prototype.getAmplitude=function(){if(0===this.length)return 0;let e=this[0],t=this[0],n=this.length;for(var r=1;r<n;r++)e=Math.min(e,this[r]),t=Math.max(t,this[r]);return t-e},nL.prototype.getSum=function(){if(0===this.length)return 0;let e,t=this[0],n=this.length;for(e=1;e<n;e++)t+=this[e];return t},nL.prototype.getProduct=function(){if(0===this.length)return null;let e,t=this[0],n=this.length;for(e=1;e<n;e++)t*=this[e];return t},nL.prototype.getInterval=function(e){if(0===this.length)return null;e=null!=e&&e;let t,n=-1/0,r=1/0,o=this.length;for(t=0;t<o;t++)e&&isNaN(this[t])||(n=Math.max(n,this[t]),r=Math.min(r,this[t]));return n==-1/0&&r==1/0&&(r=-1/0,n=1/0),new I(r,n)},nL.prototype.getIntervalWithAverage=function(){if(0===this.length)return null;let e,t=this[0],n=this[0],r=this[0],o=this.length;for(e=1;e<o;e++)t=Math.max(t,this[e]),n=Math.min(n,this[e]),r+=this[e];let i=new I(n,t);return i.average=r/o,i},nL.prototype.getNumbersSimplified=function(e,t){let n,r,o,i=this.length;switch(e=e||0,t=t||0,n=new nL,n.name=this.name,e){case 0:var s=Math.pow(10,t);this.forEach((function(e){n.push(Math.floor(e/s)*s)}));break;case 6:n=this.getQuantiles(t,2),n.name=this.name;break;case 1:case 2:t=Math.min(t||10,Math.floor(this.length/2));var l,a=this.getQuantiles(t),u=a.length;for(r=0;r<i;r++)if((l=this[r])<a[0])1==e?n.push(0):n.push(a._min);else for(o=0;o<u;o++)if(l>=a[o]&&(o+1==a.length||l<a[o+1])){1==e?n.push(o+1):n.push(a[o]);break}1==e&&(n.name=this.name+" (n quantile)");break;case 3:for(n.name=this.name+" (order of magnitude)",r=0;r<i;r++)n.push(Math.floor(Math.log(this[r])/Math.log(10)));break;case 4:for(n.name=this.name+" (rounded by order of magnitude)",r=0;r<i;r++)n.push(Math.pow(10,Math.floor(Math.log(this[r])/Math.log(10))));break;case 5:for(t=t||1,n.name=this.name+" (significant digits)",r=0;r<i;r++)n.push(Number(this[r].toPrecision(t)))}return n},nL.prototype.toPolygon=nL.prototype.getMean=function(){return this.getSum()/this.length},nL.prototype.getGeometricMean=function(){if(0==this.length)return 0;let e=this[0];for(var t=1;t<this.length;t++)e*=this[t];return Math.pow(e,1/this.length)},nL.prototype.getNorm=function(){let e=0,t=this.length;for(var n=0;n<t;n++)e+=Math.pow(this[n],2);return Math.sqrt(e)},nL.prototype.getVariance=function(e){let t=0,n=e||this.getMean(),r=this.length;for(var o=0;o<r;o++)t+=Math.pow(this[o]-n,2);return t/this.length},nL.prototype.getStandardDeviation=function(e){return Math.sqrt(this.getVariance(e))},nL.prototype.getMedian=function(){let e=this.getSorted(!0),t=(this.length-1)/2,n=Math.floor(t);return t==n?e[t]:.5*e[n]+.5*e[n+1]},nL.prototype.getQuantiles=function(e,t){e=null==e?4:e,t=t||0;var n=this.length;let r,o=this.getSorted(!0),i=n/e,s=Math.floor(i),l=i==s,a=new nL;for(a.name=this.name,r=0;r<e-1;r++)a[r]=l?o[(r+1)*i]:.5*o[(r+1)*s]+.5*o[(r+1)*s+1];if(a._sorted=o,a._min=o[0],a._max=o[o.length-1],0===t)return a;var u;let h,c;for((u=1==t?new nL:new sL).name=this.name,3==t&&(c=2==e?["low","high"]:["low","medium","high"]),r=0;r<n;r++){for(h=0;h<a.length;h++)if(this[r]<a[h]){u[r]=3==t?c[h]:1==t?h:(0==h?a._min:a[h-1])+"-"+a[h];break}null==u[r]&&(u[r]=3==t?c[h]:1==t?a.length:a[a.length-1]+"-"+a._max)}return u._quantiles=a,u},nL.prototype.getSorted=function(e){var t;return(t=(e=null==e||e)?nL.toL(this.slice().sort((function(e,t){return e-t})),!1):nL.toL(this.slice().sort((function(e,t){return t-e})),!1)).name=this.name,t},nL.prototype.getSortIndexes=function(e){null==e&&(e=!0);var t=[];let n=new nL,r=this.length;if(0===this.length)return n;for(var o=0;o<r;o++)t.push([o,this[o]]);for(e?t.sort((function(e,t){return e[1]<t[1]?1:-1})):t.sort((function(e,t){return e[1]<t[1]?-1:1})),o=0;null!=t[o];o++)n.push(t[o][0]);return n.name=this.name,n},nL.prototype.cleanNonFinites=function(e){if(null==e&&(e=this.getInterval()),!isFinite(e.x)||!isFinite(e.y)){var t,n,r=new nL,o=new nL,s=new nL,l=new nL;l.name=this.name;for(let e=0;e<this.length;e++)isFinite(this[e])?(null==t&&(t=this[e]),null==n&&(n=this[e]),t=Math.min(t,this[e]),n=Math.max(n,this[e]),l[e]=this[e]):this[e]==1/0?o.push(e):this[e]==-1/0?r.push(e):s.push(e);for(null==t&&(t=0),null==n&&(n=0),t--,n++,i=0;i<r.length;i++)l[r[i]]=t;for(i=0;i<o.length;i++)l[o[i]]=n;for(i=0;i<s.length;i++)l[s[i]]=0;return l}return this},nL.prototype.getNormalized=function(e){if(null==this)return;if(e=null==e?1:e,0===this.length)return new nL;let t,n=this.getInterval();var r=this.cleanNonFinites(n);if(this!=r)return r.getNormalized(e);var o=n.getAmplitude();let i;if(0===o)return i=createListWithSameElement(this.length,1),i.name=this.name,i.interval=n,i;for(i=new nL,e/=o,t=0;t<this.length;t++)i[t]=e*(this[t]-n.x);return i.name=this.name,i.interval=n,i},nL.prototype.getNormalizedToSum=function(e,t){return normalizeToSum(this,e,t)},nL.prototype.getNormalizedToMax=function(e){if(null==this)return;if(e=null==e?1:e,0===this.length)return null;let t,n=this.getMax();var r=this.cleanNonFinites();if(this!=r)return r.getNormalizedToMax(e);var o=new nL;for(t=0;t<this.length;t++)o[t]=e*this[t]/n;return o.name=this.name,o},nL.prototype.factor=function(e){let t,n=new nL,r=this.length;if(Array.isArray(e))for(t=0;t<r;t++)n.push(this[t]*e[t%this.length]);else for(t=0;t<r;t++)n.push(this[t]*e);return n.name=this.name,n},nL.prototype.add=function(e){let t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]+e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]+e[t%e.length]}return n.name=this.name,n},nL.prototype.subtract=function(e){let t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]-e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]-e[t%e.length]}return n.name=this.name,n},nL.prototype.divide=function(e){let t,n=new nL,r=_typeOf(e),o=this.length;switch(r){case"number":for(t=0;t<o;t++)n[t]=this[t]/e;break;case"nL":for(t=0;t<o;t++)n[t]=this[t]/e[t%e.length]}return n.name=this.name,n},nL.prototype.sqrt=function(){let e,t=new nL,n=this.length;for(e=0;e<n;e++)t.push(Math.sqrt(this[e]));return t.name=this.name,t},nL.prototype.pow=function(e){let t,n=new nL,r=this.length;for(t=0;t<r;t++)n.push(Math.pow(this[t],e));return n.name=this.name,n},nL.prototype.log=function(e){var t;e=e||0;let n=new nL,r=this.length;for(t=0;t<r;t++)n[t]=Math.log(this[t]+e);return n.name=this.name,n},nL.prototype.floor=function(){let e,t=new nL,n=this.length;for(e=0;e<n;e++)t.push(Math.floor(this[e]));return t.name=this.name,t},nL.prototype.approach=function(e,t){var n;let r=1-(t=t||.5),o=this.length;for(n=0;n<o;n++)this[n]=r*this[n]+t*e[n];return!0},nL.prototype.isEqual=function(e){let t=this.length;if(null==e||e.length!=t)return!1;for(var n=0;n<t;n++)if(this[n]!=e[n])return!1;return!0},nL.prototype.addRandom=function(e){let t;null==e&&(e=new I(0,1));let n=new nL,r=this.length,o=e.getAmplitude();for(t=0;t<r;t++)n[t]=this[t]+Math.random()*o+e.x;return n.name=this.name,n},nL.prototype.trim=function(e,t){if(null==e&&null==t)return this;let n=new nL;for(var r=0;r<this.length;r++)null!=e&&(n[r]=Math.max(this[r],e)),null!=t&&(n[r]=Math.min(this[r],t));return n.name=this.name,n},nL.prototype.clone=function(){let e=nL.toL(this.slice(),!1);return e.name=this.name,e.fnDerived=this.fnDerived,e},I.prototype.getMin=function(){return Math.min(this.x,this.y)},I.prototype.getMax=function(){return Math.max(this.x,this.y)},I.prototype.getAmplitude=function(){return Math.abs(this.y-this.x)},I.prototype.getSignedAmplitude=function(){return this.y-this.x},I.prototype.getMiddle=function(){return.5*(this.x+this.y)},I.prototype.getRandom=function(){return this.x+(this.y-this.x)*random()},I.prototype.getSign=function(){return this.x==this.y?0:Math.abs(this.y-this.x)/(this.y-this.x)},I.prototype.getScaled=function(e){let t=.5*(this.y-this.x),n=.5*(this.x+this.y);return new I(n-t*e,n+t*e)},I.prototype.getScaledFromProportion=function(e,t){let n=1-t,r=t*(this.y-this.x),o=n*(this.y-this.x),i=n*this.x+t*this.y;return new I(i-r*e,i+o*e)},I.prototype.add=function(e){return new I(this.x+e,this.y+e)},I.prototype.invert=function(){let e=this.x;this.x=this.y,this.y=e},I.prototype.adjustToContain=function(e){e<this.x&&(this.x=e),e>this.y&&(this.y=e)},I.prototype.getInterpolatedValue=function(e){return e*(this.y-this.x)+this.x},I.prototype.getInverseInterpolatedValue=function(e){return(e-this.x)/(this.y-this.x)},I.prototype.getInterpolatedValues=function(e){let t=new nL,n=e.length;for(var r=0;r<n;r++)t[r]=this.getInterpolatedValue(e[r]);return t},I.prototype.getInverseInterpolatedValues=function(e){let t=new nL,n=e.length;for(var r=0;r<n;r++)t.push(this.getInverseInterpolatedValue(e[r]));return t},I.prototype.intersect=function(e){return new I(Math.max(this.x,e.x),Math.min(this.y,e.y))},I.prototype.unite=function(e){return new I(Math.min(this.x,e.x),Math.max(this.y,e.y))},I.prototype.clone=function(){let e=new I(this.x,this.y);return e.name=name,e},I.prototype.contains=function(e){return this.y>this.x?e>=this.x&&e<=this.y:e>=this.y&&e<=this.y},I.prototype.isEqual=function(e){return this.x==e.x&&this.y==e.y},I.prototype.remap=function(e,t){let n=this.getInverseInterpolatedValue(e);return t.getInterpolatedValue(n)},I.prototype.toString=function(){return"Interval[x:"+this.x+"| y:"+this.y+"| amplitude:"+this.getAmplitude()+"]"},pol3DL.prototype.getBarycenter=function(){for(var e,t=0,n=0,r=0,o=0;o<this.length;o++)t+=(e=this[o].getBarycenter()).x,n+=e.y,r+=e.z;return new P3D(t/this.length,n/this.length,r/this.length)},cScale.prototype.getColor=function(e){return this.colorScaleFunction(e)},cScale.prototype.getColorList=function(e){let t,n=new cL;for(t=0;t<e;t++)n.push(this.getColor(t/(e-1)));return n},MetaCanvas.prototype._init=function(e){this.W=1,this.H=1,this.cX=1,this.cY=1,this.mX=0,this.mY=0,this.mP=new P(0,0),this.nF=0,this.N_FRAMES_MOUSE_UP_FAST=9,this.MOUSE_DOWN=!1,this.MOUSE_UP=!1,this.MOUSE_UP_FAST=!1,this.WHEEL_CHANGE=0,this.NF_DOWN=void 0,this.NF_UP=void 0,this.MOUSE_PRESSED=void 0,this.MOUSE_IN_DOCUMENT=!0,this.mX_DOWN=void 0,this.mY_DOWN=void 0,this.mX_UP=void 0,this.mY_UP=void 0,this.MOUSE_MOVED=!1,this.PREV_mX=0,this.PREV_mY=0,this.DX_MOUSE=0,this.DY_MOUSE=0,this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0,this.T_MOUSE_PRESSED=0,this.KEY_PRESSED=null,this.KEY_JUST_PRESSED=null,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1,this.IS_TOUCH="ontouchstart"in window||navigator.msMaxTouchPoints>0,this.force=0,this.cursorStyle="auto",this.backGroundColor="white",this.backGroundColorRGB=[255,255,255],this.cycleActive=void 0,this._prevMouseX=0,this._prevMouseY=0,this._setIntervalId=void 0,this._setTimeOutId=void 0,this._interactionCancelledFrame=void 0,this._tLastMouseDown=void 0,this._alphaRefresh=0,this.END_CYCLE_DELAY=3e3,this._LISTENERS_ADDED=!1,this.fontColor="#000000",this.fontSize="14",this.fontName="Arial",this.fontAlign="left",this.fontBaseline="top",this.fontStyle="",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("tabindex","10000"),this.canvas.setAttribute("style","outline:none"),this.container&&this.container.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this._adjustCanvas(this.dimensions);let t=this._onMouseOrKeyBoard.bind(this);this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",t,!1),this.canvas.addEventListener("touchend",t,!1),this.canvas.addEventListener("touchmove",t,!1)),this.canvas.addEventListener("mousemove",t,!1),this.canvas.addEventListener("mousedown",t,!1),this.canvas.addEventListener("mouseup",t,!1),this.canvas.addEventListener("mouseenter",t,!1),this.canvas.addEventListener("mouseleave",t,!1),this.canvas.addEventListener("click",t,!1),this.canvas.addEventListener("DOMMouseScroll",t,!1),this.canvas.addEventListener("mousewheel",t,{passive:!1}),this.canvas.addEventListener("keydown",t,!1),document.addEventListener("keydown",t,!1),this.canvas.addEventListener("keyup",t,!1),document.addEventListener("keyup",t,!1);let n,r,o=this._onResize.bind(this);null!=this.container?(n=this.container.ownerDocument,r=n?n.defaultView||n.parentWindow:window):r=window,r.addEventListener("resize",resizeThrottler(o,66),!1),parent.addEventListener("resize",resizeThrottler(o,66),!1),this._listeners={mousemove:[],mousedown:[],mouseup:[],mouseenter:[],mouseleave:[],mousewheel:[],click:[],keydown:[],keyup:[]},this.IS_TOUCH&&(this._listeners.touchstart=[],this._listeners.touchend=[],this._listeners.touchmove=[]),this.context.fillStyle="black",this.init(),e&&this._startCycle(),this.memory={}},MetaCanvas.prototype._getRelativeMousePos=function(e){let t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},MetaCanvas.prototype._onMouseOrKeyBoard=function(e){let t;if(this.IS_TOUCH)var n=null!=e.touches&&null!=e.touches[0]?e.touches[0]:e.targetTouches[0];switch(e.type){case"touchmove":this.force=n.force;case"mousemove":t="mousemove"==e.type?this._getRelativeMousePos(e):{x:null==n.clientX?n.pageX:n.clientX,y:(n.clientY,n.clientY)},this.mX=t.x,this.mY=t.y,this.mP.x=this.mX,this.mP.y=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mousedown":case"touchstart":"touchstart"==e.type&&(this.mX=n.clientX,this.mY=n.clientY),this.NF_DOWN=this.nF,this.MOUSE_PRESSED=!0,this.T_MOUSE_PRESSED=0,this._tLastMouseDown=(new Date).getTime(),this.mX_DOWN=this.mX,this.mY_DOWN=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mouseup":case"touchend":this.NF_UP=this.nF,this.MOUSE_PRESSED=!1,this.T_MOUSE_PRESSED=0,this.mX_UP=this.mX,this.mY_UP=this.mY,this.MOUSE_IN_DOCUMENT=!0,this.MOUSE_UP=!0;break;case"mouseenter":this.MOUSE_IN_DOCUMENT=!0;break;case"mouseleave":this.MOUSE_IN_DOCUMENT=!1,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1;break;case"keydown":this.SHIFT_PRESSED=e.shiftKey,this.KEY_PRESSED=e.key,this.KEY_JUST_PRESSED=e.key,this.COMMAND_PRESSED=91==e.keyCode;break;case"keyup":this.SHIFT_PRESSED=!1,this.KEY_PRESSED=null,this.COMMAND_PRESSED=!1}this._emit(e.type,e),this.cycleActive&&(new Date).getTime()>this._LAST_TIME+33&&this._onCycle()},MetaCanvas.prototype._onResize=function(e){let t=this.W,n=this.H;if(void 0===this.dimensions&&this._adjustCanvas(),this.onResize!==noOperation){var r=this._containerDimensions();r.width===t&&r.height===n||this.onResize(e)}},MetaCanvas.prototype._containerDimensions=function(){return this.container?{width:this.container.clientWidth,height:this.container.clientHeight}:{width:0,height:0}},MetaCanvas.prototype._adjustCanvas=function(e){if(void 0!==e)this.W=e.width,this.H=e.height;else{var t=this._containerDimensions();this.W=t.width,this.H=t.height}this.cX=Math.floor(.5*this.W),this.cY=Math.floor(.5*this.H),this.canvas.setAttribute("width",this.W),this.canvas.setAttribute("height",this.H),e&&null!=e.x&&this.canvas.setAttribute("x",e.x),e&&null!=e.y&&this.canvas.setAttribute("y",e.y)},MetaCanvas.prototype._startCycle=function(){this.cycleActive=!0,0===this._cycleInterval?setTimeout(this._onCycle.bind(this),10):(clearInterval(this._setIntervalId),this._setIntervalId=setInterval(this._onCycle.bind(this),this._cycleInterval))},MetaCanvas.prototype._stopCycle=function(e){clearInterval(this._setIntervalId),this.cycleActive=!1,this._setIntervalId=void 0,e&&e()},MetaCanvas.prototype.setDimensions=function(e,t,n,r){let o,i,s,l;null!=n&&null!=r?(o=e,i=t,s=n,l=r):(o=0,i=0,s=e,l=t),this.W=s,this.H=l,this.cX=.5*s,this.cY=.5*l,this.canvas.width=s,this.canvas.height=l,this.canvas.style.left=o+"px",this.canvas.style.top=i+"px",this.canvas.style.position="absolute",this._startCycle()},MetaCanvas.prototype.cycleFor=function(e){0===e?(this._setIntervalId&&clearTimeout(this._setTimeOutId),this._startCycle()):1==e?(this._stopCycle(),this._onCycle()):(this._setIntervalId?clearTimeout(this._setTimeOutId):this._startCycle(),this._stopAfter(e))},MetaCanvas.prototype._stopAfter=function(e,t){let n=this;this._setTimeOutId=setTimeout((function(){n._stopCycle(),t&&t()}),e)},MetaCanvas.prototype._onCycle=function(){if(0===this._alphaRefresh?null!=this.backGroundColorRGB?(this.context.fillStyle="rgb("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+")",this.context.fillRect(0,0,this.W,this.H)):this.context.clearRect(0,0,this.W,this.H):(this.context.fillStyle="rgba("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+","+this._alphaRefresh+")",this.context.fillRect(0,0,this.W,this.H)),this.setCursor("default"),this.MOUSE_DOWN=this.NF_DOWN==this.nF,this.MOUSE_UP=this.NF_UP==this.nF,this.MOUSE_UP_FAST=!this.MOUSE_UP_FAST&&this.MOUSE_UP&&this.nF-this.NF_DOWN<this.N_FRAMES_MOUSE_UP_FAST,this.DX_MOUSE=this.mX-this.PREV_mX,this.DY_MOUSE=this.mY-this.PREV_mY,this.MOUSE_MOVED=0!==this.DX_MOUSE||0!==this.DY_MOUSE,this.MOUSE_PRESSED?(this.T_MOUSE_PRESSED=(new Date).getTime()-this._tLastMouseDown,this.DX_MOUSE_PRESSED=this.DX_MOUSE,this.DY_MOUSE_PRESSED=this.DY_MOUSE,this.DX_MOUSE_DRAGGED=this.mX-this.mX_DOWN,this.DY_MOUSE_DRAGGED=this.mY-this.mY_DOWN,this.DRAGGABLE&&(this.x0+=this.DX_MOUSE_PRESSED,this.y0+=this.DY_MOUSE_PRESSED)):(this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0),this.ZOOMABLE){let e=1+.3*this.WHEEL_CHANGE;(this.ZOOM*e>=this.MAX_ZOOM||this.ZOOM*e<=this.MIN_ZOOM)&&(e=1),this.ZOOM*=e,this.ZOOM=Math.max(Math.min(this.ZOOM,this.MAX_ZOOM),this.MIN_ZOOM),this.x0=(this.x0-this.mX)*e+this.mX,this.y0=(this.y0-this.mY)*e+this.mY}this.cycle(),this.WHEEL_CHANGE=0,this.PREV_mX=this.mX,this.PREV_mY=this.mY,this.nF++,this.KEY_JUST_PRESSED=null,this._LAST_TIME=(new Date).getTime()},MetaCanvas.prototype._emit=function(e,t){switch(e){case"mousewheel":case"DOMMouseScroll":e="mousewheel",t||(t=window.event),t.wheelDelta?this.WHEEL_CHANGE=t.wheelDelta/120:t.detail&&(this.WHEEL_CHANGE=-t.detail/3),t.value=this.WHEEL_CHANGE}let n=this._listeners[e].length;for(var r=0;r<n;r++){var o=this._listeners[e][r];o.call(o.__context,t)}},MetaCanvas.prototype.getCycleInterval=function(){return this._cycleInterval},MetaCanvas.prototype.setCycleInterval=function(e){this._cycleInterval=e,this.cycleActive&&this._startCycle()},MetaCanvas.prototype.start=function(){return this._startCycle()},MetaCanvas.prototype.stop=function(){return this._stopCycle()},MetaCanvas.prototype.cycleOnMouseMovement=function(e){let t=this;this.cycleOnMouseMovementListener&&this._LISTENERS_ADDED&&e<=1&&(this.canvas.removeEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousewheel",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.removeEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!1),e>1&&(this.cycleOnMouseMovementListener=function(){t.cycleFor(e)},this._LISTENERS_ADDED||(this.canvas.addEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("mousewheel",this.cycleOnMouseMovementListener,{passive:!1}),this.canvas.addEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keydown",this.cycleOnMouseMovementListener,!1),document.addEventListener("keydown",boundMouseOrKeyboard,!1),this.canvas.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),document.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!0)),t.cycleFor(e)},MetaCanvas.prototype.on=function(e,t,n){t.__context=n,this._listeners[e].push(t)},MetaCanvas.prototype.off=function(e,t){let n=this._listeners[e].indexOf(t);n>-1&&this._listeners[e].splice(n,1)},MetaCanvas.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.W,this.H)},MetaCanvas.prototype.setBackgroundColor=function(e){"number"==typeof e?e=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":Array.isArray(e)&&(e=RGBtoHEX(e[0],e[1],e[2])),this.backGroundColor=e,this.backGroundColorRGB=colorStringToRGB(this.backGroundColor)},MetaCanvas.prototype.setBackgroundAlpha=function(e){this._alphaRefresh=e},MetaCanvas.prototype.fRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.fillRect(e,t,n,r)},MetaCanvas.prototype.sRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.strokeRect(e,t,n,r)},MetaCanvas.prototype.fsRect=function(e,t,n,r){"number"!=typeof e&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.fillRect(e,t,n,r),this.context.strokeRect(e,t,n,r)},MetaCanvas.prototype.fArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fCircle=function(e,t,n){this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.fill()},MetaCanvas.prototype.sCircle=function(e,t,n){this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke()},MetaCanvas.prototype.fsCircle=function(e,t,n){this.fCircle(e,t,n),this.context.stroke()},MetaCanvas.prototype.fEllipse=function(e,t,n,r){let o=.5522848,i=n*o,s=r*o,l=e+n,a=t+r;this.context.beginPath(),this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,l,t-s,l,t),this.context.bezierCurveTo(l,t+s,e+i,a,e,a),this.context.bezierCurveTo(e-i,a,e-n,t+s,e-n,t),this.context.moveTo(e-n,t),this.context.closePath(),this.context.fill()},MetaCanvas.prototype.sEllipse=function(e,t,n,r){let o=.5522848,i=n*o,s=r*o,l=e+n,a=t+r;this.context.beginPath(),this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,l,t-s,l,t),this.context.bezierCurveTo(l,t+s,e+i,a,e,a),this.context.bezierCurveTo(e-i,a,e-n,t+s,e-n,t),this.context.moveTo(e-n,t),this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsEllipse=function(e,t,n,r){this.fEllipse(e,t,n,r),this.context.stroke()},MetaCanvas.prototype._solidArc=function(e,t,n,r,o,i){this.context.beginPath(),this.context.arc(e,t,o,n,r),this.context.lineTo(e+i*Math.cos(r),t+i*Math.sin(r)),this.context.arc(e,t,i,r,n,!0),this.context.lineTo(e+o*Math.cos(n),t+o*Math.sin(n))},MetaCanvas.prototype.fSolidArc=function(e,t,n,r,o,i){this._solidArc(e,t,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sSolidArc=function(e,t,n,r,o,i){this._solidArc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fsSolidArc=function(e,t,n,r,o,i){this.fSolidArc(e,t,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.line=function(e,t,n,r){this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(n,r),this.context.stroke()},MetaCanvas.prototype.bezier=function(e,t,n,r,o,i,s,l){this.context.beginPath(),this.context.moveTo(e,t),this.context.bezierCurveTo(n,r,o,i,s,l),this.context.stroke()},MetaCanvas.prototype._lines=function(){if(null!=arguments){var e=arguments[0];this.context.beginPath(),this.context.moveTo(e[0],e[1]);for(var t=2;null!=e[t+1];t+=2)this.context.lineTo(e[t],e[t+1])}},MetaCanvas.prototype._linesM=function(){if(null==arguments)return;var e=arguments[0];let t=new Pol;this.context.beginPath(),this.context.moveTo(e[0],e[1]),t[0]=new P(e[0],e[1]);for(var n=2;null!=e[n+1];n+=2)this.context.lineTo(e[n],e[n+1]),t.push(new P(e[n],e[n+1]));return t.containsPoint(this.mP)},MetaCanvas.prototype.fLines=function(){this._lines(arguments),this.context.fill()},MetaCanvas.prototype.sLines=function(){this._lines(arguments),this.context.stroke()},MetaCanvas.prototype.fsLines=function(){this._lines(arguments),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fsLinesM=function(){let e=this._linesM(arguments);return this.context.fill(),this.context.stroke(),e},MetaCanvas.prototype._polygon=function(e){this.context.beginPath(),this.context.moveTo(e[0].x,e[0].y);for(var t=1;null!=e[t];t++)this.context.lineTo(e[t].x,e[t].y)},MetaCanvas.prototype.fPolygon=function(e){this._polygon(e),this.context.fill()},MetaCanvas.prototype.sPolygon=function(e,t){this._polygon(e),t&&this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsPolygon=function(e,t){this._polygon(e),t&&this.context.closePath(),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.fill()},MetaCanvas.prototype.sEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.stroke()},MetaCanvas.prototype.fsEqTriangle=function(e,t,n,r){this._eqTriangle(e,t,n,r),this.context.fill(),this.context.stroke()},MetaCanvas.prototype._eqTriangle=function(e,t,n,r){this.context.beginPath(),n=n||0,this.context.moveTo(r*Math.cos(n)+e,r*Math.sin(n)+t),this.context.lineTo(r*Math.cos(n+2.0944)+e,r*Math.sin(n+2.0944)+t),this.context.lineTo(r*Math.cos(n+4.1888)+e,r*Math.sin(n+4.1888)+t),this.context.lineTo(r*Math.cos(n)+e,r*Math.sin(n)+t)},MetaCanvas.prototype.fRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.fillRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.sRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.strokeRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.fsRectM=function(e,t,n,r,o){return o=null==o?0:o,this.context.fillRect(e,t,n,r),this.context.strokeRect(e,t,n,r),this.mY>t-o&&this.mY<t+r+o&&this.mX>e-o&&this.mX<e+n+o},MetaCanvas.prototype.fCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.fill(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.sCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.fsCircleM=function(e,t,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi),this.context.stroke(),this.context.fill(),Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.lineM=function(e,t,n,r,o=4){return this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(n,r),this.context.stroke(),this._distToSegmentSquared(e,t,n,r)<o*o},MetaCanvas.prototype._distToSegmentSquared=function(e,t,n,r){let o=Math.pow(e-n,2)+Math.pow(t-r,2);if(0===o)return Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2);let i=((this.mX-e)*(n-e)+(this.mY-t)*(r-t))/o;if(i<=0)return Math.pow(e-this.mX,2)+Math.pow(t-this.mY,2);if(i>=1)return Math.pow(n-this.mX,2)+Math.pow(r-this.mY,2);let s=e+i*(n-e),l=t+i*(r-t);return Math.pow(s-this.mX,2)+Math.pow(l-this.mY,2)},MetaCanvas.prototype.bezierM=function(e,t,n,r,o,i,s,l,a){return a=null==a?2:a,this.context.beginPath(),this.context.moveTo(e,t),this.context.bezierCurveTo(n,r,o,i,s,l),this.context.stroke(),!(this.mX<Math.min(e,s,n,o)-a||this.mX>Math.max(e,s,n,o)+a||this.mY<Math.min(t,l,r,i)-a||this.mY>Math.max(t,l,r,i)+a)&&distanceToBezierCurve(e,t,n,r,o,i,s,l,this.mP,!1)<a},MetaCanvas.prototype.drawImage=function(e){if(null!=e)switch(arguments.length){case 1:this.context.drawImage(e);break;case 3:this.context.drawImage(e,arguments[1],arguments[2]);break;case 5:this.context.drawImage(e,arguments[1],arguments[2],arguments[3],arguments[4]);break;case 9:this.context.drawImage(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}},MetaCanvas.prototype.fitImage=function(e,t,n){if(null==e||null==t)return;null==n&&(n=0);var r=e.width/e.height;let o,i=t.width/t.height,s=r/i;switch(n){case 0:o=r>=i;break;case 1:o=r<i;break;case 2:return void this.context.drawImage(e,t.x+.5*t.width-.5*e.width,t.y+.5*t.height-.5*e.height)}o?this.context.drawImage(e,.5*(e.width-e.width/s),0,e.width/s,e.height,t.x,t.y,t.width,t.height):this.context.drawImage(e,0,.5*(e.height-e.height*s),e.width,e.height*s,t.x,t.y,t.width,t.height)},MetaCanvas.prototype.fill=function(e){if("number"==typeof e)return arguments.length>3?void(this.context.fillStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.fillStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.fillStyle=e},MetaCanvas.prototype.stroke=function(e,t){if("number"==typeof e)return arguments.length>3?void(this.context.strokeStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.strokeStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.strokeStyle=e,t&&(this.context.lineWidth=t)},MetaCanvas.prototype.setLW=function(e){this.context.lineWidth=e},MetaCanvas.prototype.clipCircle=function(e,t,n){this.context.save(),this.context.beginPath(),this.context.arc(e,t,n,0,TwoPi,!1),this.context.closePath(),this.context.clip()},MetaCanvas.prototype.clipRect=function(e,t,n,r){this.context.save(),this.context.beginPath(),"Rec"==e.type&&(t=e.y,n=e.width,r=e.height,e=e.x),this.context.moveTo(e,t),this.context.lineTo(e+n,t),this.context.lineTo(e+n,t+r),this.context.lineTo(e,t+r),this.context.clip()},MetaCanvas.prototype.save=function(){this.context.save()},MetaCanvas.prototype.clip=function(){this.context.clip()},MetaCanvas.prototype.restore=function(){this.context.restore()},MetaCanvas.prototype.fText=function(e,t,n){this.context.fillText(e,t,n)},MetaCanvas.prototype.sText=function(e,t,n){this.context.strokeText(e,t,n)},MetaCanvas.prototype.fsText=function(e,t,n){this.context.strokeText(e,t,n),this.context.fillText(e,t,n)},MetaCanvas.prototype.fTextW=function(e,t,n){return this.context.fillText(e,t,n),this.context.measureText(e).width},MetaCanvas.prototype.fsTextW=function(e,t,n){return this.context.strokeText(e,t,n),this.context.fillText(e,t,n),this.context.measureText(e).width},MetaCanvas.prototype.fTextRotated=function(e,t,n,r){this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.fillText(e,0,0),this.context.restore()},MetaCanvas.prototype.fsTextRotated=function(e,t,n,r){this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.strokeText(e,0,0),this.context.fillText(e,0,0),this.context.restore()},MetaCanvas.prototype.fTextArc=function(e,t,n,r,o,i){if(null==e||""===e)return;var s;let l,a,u=Math.sqrt(Math.pow(t-r,2)+Math.pow(n-o,2)),h=Math.atan2(n-o,t-r);i&&(h-=.5*this.getTextW(e)/u);let c=e.split("");for(s=0;null!=c[s];s++)l=r+u*Math.cos(h),a=o+u*Math.sin(h),this.fTextRotated(c[s],l,a,h+HalfPi),h+=this.getTextW(c[s])/u},MetaCanvas.prototype.fTextM=function(e,t,n,r){return r=Number(r||this.fontSize),this.context.fillText(e,t,n),this.mY>n&&this.mY<n+r&&this.mX>t&&this.mX<t+this.context.measureText(e).width},MetaCanvas.prototype.fsTextM=function(e,t,n,r){return r=Number(r||this.fontSize),this.context.strokeText(e,t,n),this.context.fillText(e,t,n),this.mY>n&&this.mY<n+r&&this.mX>t&&this.mX<t+this.context.measureText(e).width},MetaCanvas.prototype.fTextRotatedM=function(e,t,n,r,o){o=o||12,this.context.save(),this.context.translate(t,n),this.context.rotate(r),this.context.fillText(e,0,0),this.context.restore();var i=this.mX-t;let s=this.mY-n,l=Math.sqrt(i*i+s*s),a=Math.atan2(s,i)-r,u=t+l*Math.cos(a),h=n+l*Math.sin(a);return h>n&&h<n+o&&u>t&&u<t+this.context.measureText(e).width},MetaCanvas.prototype.setTextDefaults=function(e,t,n,r,o,i){this.fontColor=ifDef(e,this.fontColor),this.fontSize=ifDef(String(t),this.fontSize),this.fontName=ifDef(n,this.fontName),this.fontAlign=ifDef(r,this.fontAlign),this.fontBaseline=ifDef(o,this.fontBaseline),this.fontStyle=ifDef(i,this.fontStyle),this.setText()},MetaCanvas.prototype.setText=function(e,t,n,r,o,i){let s=ifDef(e,this.fontColor),l=ifDef(String(t),this.fontSize),a=ifDef(n,this.fontName),u=ifDef(r,this.fontAlign),h=ifDef(o,this.fontBaseline),c=ifDef(i,this.fontStyle);""!==c&&(c+=" "),this.context.fillStyle=s,this.context.font=c+l+"px "+a,this.context.textAlign=u,this.context.textBaseline=h},MetaCanvas.prototype.fTextWidth=function(e,t,n,r,o=12){let i=this._textWidthSectionsInfo(e,r),s=i.sections,l=0;return e=i.newText,s.forEach((r=>{this.context.fillText(e.substr(l,r-l),t,n),l=r,n+=o})),this.context.fillText(e.substr(l),t,n),i.nLines},MetaCanvas.prototype.getFontFamily=function(){return this.fontName},MetaCanvas.prototype.setFontFamily=function(e){this.setText(void 0,void 0,e)},MetaCanvas.prototype.getTextW=function(e){return this.context.measureText(e).width},MetaCanvas.prototype.nLines=function(e,t){return this._textWidthSectionsInfo(e,t).nLines},MetaCanvas.prototype._textWidthSectionsInfo=function(e,t){if(this["sections_"+t+"_"+e])return this["sections_"+t+"_"+e];let n=e.replace(/[\s\n]+/g," ").trim(),r=n.split(" ").filter((e=>""!=e)),o=0,i=[],s=1,l="",a=0;return r.forEach((e=>{this.context.measureText(l+e).width>t&&""!=l&&(s++,o+=l.length+1,i.push(o),a=Math.max(this.context.measureText(l).width,a),l=""),l+=(""==l?"":" ")+e})),a=Math.max(this.context.measureText(l).width,a),this["sections_"+t+"_"+e]={sections:i,nLines:s,maxWidth:a,newText:n},this["sections_"+t+"_"+e]},MetaCanvas.prototype.getPixelColor=function(e,t){let n=this.context.getImageData(e,t,1,1).data;return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},MetaCanvas.prototype.getPixelColorRGBA=function(e,t){return Array.prototype.slice.call(this.context.getImageData(e,t,1,1).data)},MetaCanvas.prototype.captureCanvas=function(e=0,t=0,n,r){null==n&&(n=this.W),null==r&&(r=this.H);let o=new Image;if(null==e)return o.src=this.canvas.toDataURL(),o;var i=document.createElement("canvas");return i.width=n,i.height=r,i.getContext("2d").drawImage(this.canvas,e,t,n,r,0,0,n,r),o.src=i.toDataURL(),o},MetaCanvas.prototype.setCursor=function(e="default"){this.canvas.style.cursor=e},MetaCanvas.prototype.pointer=function(){this.canvas.style.cursor="pointer"},MetaCanvas.prototype.getFrame=function(){return new Rec(0,0,this.W,this.H)},MetaCanvas.prototype._linesInFrame=function(e,t,n){let r,o=Math.min(t.length,n.length);for(this.context.beginPath(),this.context.moveTo(e.projectX(t[0]),e.projectY(n[0])),r=1;r<o;r++)this.context.lineTo(e.projectX(t[r]),e.projectY(n[r]))},MetaCanvas.prototype.sLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.stroke()},MetaCanvas.prototype.fLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.fill()},MetaCanvas.prototype.fsLinesInFrame=function(e,t,n){this._linesInFrame(e,t,n),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.drawSmoothPolygon=function(e,t,n=30){let r,o;if(e.length<2)return null;if(this.context.beginPath(),2==e.length){var i=Math.atan2(e[1].y-e[0].y,e[1].x-e[0].x)-.5*Math.PI,s=n*Math.cos(i),l=n*Math.sin(i);return this.context.moveTo(e[0].x,e[0].y),this.context.bezierCurveTo(e[0].x+s,e[0].y+l,e[1].x+s,e[1].y+l,e[1].x,e[1].y),this.context.bezierCurveTo(e[1].x-s,e[1].y-l,e[0].x-s,e[0].y-l,e[0].x,e[0].y),void this.context.stroke()}let a=e.length,u=e[a-1],h=e[0],c=e[1];r=getSoftenControlPoints(u,h,c,n);let f,p=r[1];this.context.moveTo(h.x,h.y),u=h;let g=a+Number(t);for(o=1;o<g;o++)h=e[o%a],c=e[(o+1)%a],r=getSoftenControlPoints(u,h,c,n),f=r[0],this.context.bezierCurveTo(p.x,p.y,f.x,f.y,h.x,h.y),p=r[1],u=h;this.context.stroke()},MetaCanvas.prototype.drawEllipse=function(e,t,n,r){let o=.5522848,i=n*o,s=r*o,l=e+n,a=t+r;this.context.moveTo(e-n,t),this.context.bezierCurveTo(e-n,t-s,e-i,t-r,e,t-r),this.context.bezierCurveTo(e+i,t-r,l,t-s,l,t),this.context.bezierCurveTo(l,t+s,e+i,a,e,a),this.context.bezierCurveTo(e-i,a,e-n,t+s,e-n,t),this.context.moveTo(e-n,t)},MetaCanvas.prototype.drawPolygon=function(e,t,n,r){let o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+e[0].x,r+e[0].y),o=1;null!=e[o];o++)this.context.lineTo(n+e[o].x,r+e[o].y);t&&this.context.lineTo(n+e[0].x,r+e[0].y),this.context.stroke()},MetaCanvas.prototype.drawPolygonWithControlPoints=function(e,t,n,r){let o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+e[0].x,r+e[0].y),o=1;null!=e[o];o++)this.context.bezierCurveTo(n+t[2*(o-1)].x,r+t[2*(o-1)].y,n+t[2*o-1].x,r+t[2*o-1].y,n+e[o].x,r+e[o].y);this.context.stroke()},MetaCanvas.prototype.drawBezierPolygon=function(e,t,n){let r;t=t||0,n=n||0;let o,i=Math.floor((e.length-1)/3);for(this.context.moveTo(t+e[0].x,n+e[0].y),o=0;o<i;o++)r=3*o+1,this.context.bezierCurveTo(t+e[r].x,n+e[r].y,t+e[r+1].x,n+e[r+1].y,t+e[r+2].x,n+e[r+2].y)},MetaCanvas.prototype.drawMultiStyleCurve=function(e,t,n,r,o,i,s){let l,a,u,h,c;this.context.save(),this.context.lineJoin=this.context.lineCap="round";let f=new I(r,s),p=new I(n,i);for(l=0;l<e.length-1;l++)a=l/(e.length-2),h=f.getInterpolatedValue(a),c=p.getInterpolatedValue(a),u=interpolateColors(t,o,a),u=addAlpha(u,c),this.context.beginPath(),this.context.moveTo(e[l].x,e[l].y),this.context.lineTo(e[l+1].x,e[l+1].y),this.stroke(u,h),this.context.stroke();this.context.restore()},MetaCanvas.prototype.drawRoundRect=function(e,t,n,r,o){o=o||0;let i=t+r;this.context.moveTo(e+o,t),this.context.lineTo(e+n-o,t),this.context.quadraticCurveTo(e+n,t,e+n,t+o),this.context.lineTo(e+n,t+r-o),this.context.quadraticCurveTo(e+n,i,e+n-o,i),this.context.lineTo(e+o,i),this.context.quadraticCurveTo(e,i,e,i-o),this.context.lineTo(e,t+o),this.context.quadraticCurveTo(e,t,e+o,t)},MetaCanvas.prototype.drawTriangleFromBase=function(e,t,n,r,o){this.context.moveTo(e+.5*n*Math.cos(o+.5*Math.PI),t+.5*n*Math.sin(o+.5*Math.PI)),this.context.lineTo(e+.5*n*Math.cos(o-.5*Math.PI),t+.5*n*Math.sin(o-.5*Math.PI)),this.context.lineTo(e+r*Math.cos(o),t+r*Math.sin(o)),this.context.lineTo(e+.5*n*Math.cos(o+.5*Math.PI),t+.5*n*Math.sin(o+.5*Math.PI))},MetaCanvas.prototype.applyTransformationFunctions=function(e,t,n){if(null==this._fRect&&(this._line=this.line,this._sLines=function(){this.__lines(arguments),this.context.stroke()},this._fCircle=this.fCircle,this._sCircle=this.sCircle,this._fCircleM=this.fCircleM,this._sCircleM=this.sCircleM,this._fRect=this.fRect,this._sRect=this.sRect,this._fRectM=this.fRectM,this._sRectM=this.sRectM,this.__lines=this._lines,this.__polygon=this._polygon,this._fText=this.fText,this._fTextM=this.fTextM,this._sText=this.sText,this._fsText=this.fsText,this._fsTextM=this.fsTextM,this._clipRect=this.clipRect,this._drawImage=this.drawImage),null==e&&null==t)return this.line=this._line,this.sLines=this._sLines,this.fCircle=this._fCircle,this.sCircle=this._sCircle,this.fCircleM=this._fCircleM,this.sCircleM=this._sCircleM,this.fRect=this._fRect,this.sRect=this._sRect,this.fRectM=this._fRectM,this.sRectM=this._sRectM,this._lines=this.__lines,this._polygon=this.__polygon,this.fText=this._fText,this.fTextM=this._fTextM,this.sText=this._sText,this.fsText=this._fsText,this.fsTextM=this._fsTextM,this.clipRect=this._clipRect,void(this.drawImage=this._drawImage);this.fX=e,this.fY=t,this.sX=function(e){return this.fX(e+.5)-this.fX(e-.5)},this.sY=function(e){return this.fY(e+.5)-this.fY(e-.5)},null==e&&(this.fX=function(e){return e}),null==t&&(this.fY=function(e){return e}),this.line=function(e,t,n,r){this._line(this.fX(e),this.fY(t),this.fX(n),this.fY(r))},this.fRect=function(e,t,n,r){this._fRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.sRect=function(e,t,n,r){this._sRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.fRectM=function(e,t,n,r){return this._fRectM(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.sRectM=function(e,t,n,r){return this._sRectM(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.fCircle=function(e,t,n){this._fCircle(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.sCircle=function(e,t,n){this._sCircle(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.fCircleM=function(e,t,n){return this._fCircleM(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this.sCircleM=function(e,t,n){return this._sCircleM(this.fX(e),this.fY(t),Math.abs(this.fX(e+n)-this.fX(e)))},this._lines=function(){if(null!=arguments){var e=arguments[0];this.context.beginPath(),this.context.moveTo(this.fX(e[0]),this.fY(e[1]));for(var t=2;null!=e[t+1];t+=2)this.context.lineTo(this.fX(e[t]),this.fY(e[t+1]))}},this._polygon=function(e){this.context.beginPath(),this.context.moveTo(this.fX(e[0].x),this.fY(e[0].y));for(var t=1;null!=e[t];t++)this.context.lineTo(this.fX(e[t].x),this.fY(e[t].y))},this.fText=function(e,t,n){this._fText(e,this.fX(t),this.fY(n))},this.fTextM=function(e,t,n){this._fTextM(e,this.fX(t),this.fY(n))},this.sText=function(e,t,n){this._sText(e,this.fX(t),this.fY(n))},this.fsText=function(e,t,n){this._fsText(e,this.fX(t),this.fY(n))},this.fsTextM=function(e,t,n){this._fsTextM(e,this.fX(t),this.fY(n))},this.clipRect=function(e,t,n,r){this._clipRect(this.fX(e),this.fY(t),this.fX(e+n)-this.fX(e),this.fY(t+r)-this.fY(t))},this.drawImage=function(e,t,n,r,o){null==r&&this._drawImage(e,this.fX(t),this.fY(n)),this._drawImage(e,this.fX(t),this.fY(n),this.fX(t+r)-this.fX(t),this.fY(n+o)-this.fY(n))},this._fLines=function(){this.__lines(arguments),this.context.fill()}},MetaCanvas.prototype.resetTransformation=function(){this.applyTransformationFunctions(null,null)},MetaCanvas.prototype.mapRegion=function(e,t){this.applyTransformationFunctions((function(n){return(n-t.x)*e.width/t.width+e.x}),(function(n){return(n-t.y)*e.height/t.height+e.y})),this.invfX=function(n){return(n-e.x)*t.width/e.width+t.x},this.invfY=function(n){return(n-e.y)*t.height/e.height+t.y}},MetaCanvas.prototype.mapCanvas=function(e){this.applyTransformationFunctions((function(t){return(t-e.x)*this.W/e.width}),(function(t){return(t-e.y)*this.H/e.height})),this.invfX=function(t){return t*e.width/this.W+e.x},this.invfY=function(t){return t*e.height/this.H+e.y}},Forces.prototype.forcesForNetwork=function(e,t,n,r,o){var i;let s;t=t||0,n=n||new P(0,0),r=null==r?0:r,o=null!=o&&o,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this.nodes=new ndL;let l,a,u,h=e.nodes.length,c=e.relations;if(this.previousNetwork){t=0;var f=1e5,p=-1e5,g=1e5,d=-1e5;for(l=0;l<this.previousNetwork.nodes.length;l++)f=Math.min(f,this.previousNetwork.nodes[l].x),p=Math.max(p,this.previousNetwork.nodes[l].x),g=Math.min(g,this.previousNetwork.nodes[l].y),d=Math.max(d,this.previousNetwork.nodes[l].y);var m=p-f,y=d-g;for(l=0;l<h;l++){var x=e.nodes[l];if(i=this.previousNetwork.nodes.get(x.id))x.x=i.x,x.y=i.y;else{for(a=0;a<x.nodes.length;a++)if(i=this.previousNetwork.nodes.get(x.nodes[a].id)){x.x=i.x+.05*m*(Math.random()-.5),x.y=i.y+.05*y*(Math.random()-.5);break}null==i&&(x.x=f+m*Math.random(),x.y=g+y*Math.random())}}}for(e.nodes.forEach(((e,t)=>{null==e.x&&(e.x||(e.x=100*(Math.random()-.5),e.y=100*(Math.random()-.5)),e.vx=0,e.vy=0,e.ax=0,e.ay=0)})),l=0;l<h;l++)0===t?this.addNode(e.nodes[l],new P(e.nodes[l].x,e.nodes[l].y)):(u=Math.random()*TwoPi,this.addNode(e.nodes[l],new P(n.x+t*Math.cos(u),n.y+t*Math.sin(u))));for(l=0;l<h-1;l++)for(i=e.nodes[l],a=l+1;a<h;a++)if(s=e.nodes[a],c.nodesAreConnected(i,s)){switch(r){case 0:this.equilibriumDistances.push(this.dEqSprings);break;case 1:this.equilibriumDistances.push((1.1-c.getFirstRelationByIds(i.id,s.id,!1).weight)*this.dEqSprings);break;case 2:this.equilibriumDistances.push(Math.sqrt(Math.min(i.nodes.length,s.nodes.length))*this.dEqSprings*.1)}this.addForce(i,s,"Spring"),o&&this.addForce(i,s,"Repulsor",.5*this.dEqRepulsors)}else this.addForce(i,s,"Repulsor",this.dEqRepulsors);this.previousNetwork=e},Forces.prototype.addNode=function(e,t,n){t=null==t?new P(200*Math.random()-100,200*Math.random()-100):t,n=null==n?new P(0,0):n,this.nodes.addNode(e),e.x=t.x,e.y=t.y,e.vx=n.x,e.vy=n.y,e.ax=0,e.ay=0,e.r=1},Forces.prototype.addForce=function(e,t,n,r){this.from.addNode(e),this.to.addNode(t),this.forcesList.push(e.id+"*"+t.id+"*"+n),this.forcesTypeList.push(n),null!=r&&this.equilibriumDistances.push(r)},Forces.prototype.calculate=function(){let e,t,n,r,o,i,s,l,a;for(e=0;null!=this.forcesList[e];e++)if(t=this.from[e],n=this.to[e],r=this.forcesTypeList[e],i=n.x-t.x,s=n.y-t.y,l=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),a=this.equilibriumDistances[e],!("Repulsor"==r&&l>a||"Attractor"==r&&l<a))switch(r){case"Spring":case"Repulsor":case"Attractor":o=this.k*(l-a)/l,t.ax+=o*i,t.ay+=o*s,n.ax-=o*i,n.ay-=o*s;break;case"DirectedSpring":o=this.k*(l-a)/l,n.ax-=o*i,n.ay-=o*s;break;case"DirectedRepulsor":l<a&&(o=this.k*(l-a)/l,n.ax-=o*i,n.ay-=o*s)}},Forces.prototype.applyForces=function(){for(var e,t=0;t<this.nodes.length;t++)null!=(e=this.nodes[t]).fixed_x&&(e.x=.95*e.x+.05*e.fixed_x,e.ax=0,e.vx=0),null!=e.fixed_y&&(e.y=.95*e.y+.05*e.fixed_y,e.ay=0,e.vy=0),null!=e.fixed_x&&null!=e.fixed_y||(e.vx+=e.ax,e.vy+=e.ay,e.vx*=this.friction,e.vy*=this.friction,e.x+=e.vx,e.y+=e.vy,e.ax=0,e.ay=0)},Forces.prototype.calculateAndApplyForces=function(e){this.calculate(),this.applyForces()},Forces.prototype.iterate=function(e){for(var t=0;t<e;t++)this.calculate(),this.applyForces()},Forces.prototype.attractionToPoint=function(e,t,n){let r,o,i,s,l;t=null==t?1:t;for(var a=0;null!=this.nodes[a];a++)r=this.nodes[a],i=e.x-r.x,s=e.y-r.y,l=Math.pow(i,2)+Math.pow(s,2),o=null!=n?Math.min(t/l,n):t/l,r.ax+=o*i,r.ay+=o*s},Forces.prototype.avoidOverlapping=function(e=0){var t;let n,r,o,i,s,l,a,u,h,c,f,p,g=.5*e,d=this.nodes.length;for(t=0;null!=this.nodes[t+1];t++){n=this.nodes[(t+this._i0)%d],o=n.x-.5*n.width-g,s=n.x+.5*n.width+g,i=n.y-.5*n.height-g,l=n.y+.5*n.height+g;for(var m=t+1;null!=this.nodes[m];m++)r=this.nodes[(m+this._i0+t)%d],a=r.x-.5*r.width-g,h=r.x+.5*r.width+g,u=r.y-.5*r.height-g,c=r.y+.5*r.height+g,(o>a&&o<h||s>a&&s<h)&&(i>u&&i<c||l>u&&l<c)&&(f=r.x-n.x,p=r.y-n.y,Math.abs(f)>Math.abs(p)?f>0?(n.x-=.5*(s-a),r.x+=.5*(s-a)):(n.x+=.5*(h-o),r.x-=.5*(h-o)):p>0?(n.y-=.5*(l-u),r.y+=.5*(l-u)):(n.y+=.5*(c-i),r.y-=.5*(c-i)))}this._i0++},Forces.prototype.avoidOverlappingRadial=function(e,t){let n,r,o;e=e||0,t=t||1;let i,s,l,a,u,h=this.nodes.length,c=2*e;for(n=0;null!=this.nodes[n+1];n++){r=this.nodes[(n+this._i0)%h];for(var f=n+1;null!=this.nodes[f];f++)o=this.nodes[(f+this._i0+n)%h],i=o.x-r.x,s=o.y-r.y,l=Math.pow(i,2)+Math.pow(s,2),a=Math.pow(r.r+o.r+c,2),l<a&&(a=Math.sqrt(a),l=Math.sqrt(l),u=.5*(a-l)/l,r.x-=t*u*i,r.y-=t*u*s,o.x+=t*u*i,o.y+=t*u*s)}this._i0++},Forces.prototype.deactivateForcesFromNode=function(e){e.vx=e.vy=e.ax=e.ay=0},Forces.prototype._resetAccelerations=function(){let e;for(var t=0;null!=this.nodes[t];t++)e=this.nodes[t],e.ax=0,e.ay=0},Engine3D.prototype.setBasis=function(e){this._basis=e.clone(),this._basisBase=e.clone(),this._provisionalBase=e.clone()},Engine3D.prototype.setAngles=function(e){this._angles=e.clone(),this._freeRotation=!1,this._basis=this.basis3DRotation(this._basisBase,this._angles)},Engine3D.prototype.applyRotation=function(e){this._freeRotation||(this._freeRotation=!0,this.updateAngles(),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()),this._basis[0]=this.point3DRotation(this._provisionalBase[0],new P3D(-e.y,e.x,0)),this._basis[1]=this.point3DRotation(this._provisionalBase[1],new P3D(-e.y,e.x,0)),this._basis[2]=this.point3DRotation(this._provisionalBase[2],new P3D(-e.y,e.x,0)),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()},Engine3D.prototype.projectPoint3D_complete=function(e){return new P3D(1*(this._basis[0].x*e.x+this._basis[1].x*e.y+this._basis[2].x*e.z),1*(this._basis[0].y*e.x+this._basis[1].y*e.y+this._basis[2].y*e.z),1*(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z))},Engine3D.prototype.projectPoint3D=function(e){var t=this.lens/(this.lens+(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z));return new P3D((this._basis[0].x*e.x+this._basis[1].x*e.y+this._basis[2].x*e.z)*t,(this._basis[0].y*e.x+this._basis[1].y*e.y+this._basis[2].y*e.z)*t,t)},Engine3D.prototype.projectCoordinates=function(e,t,n){var r=this.lens/(this.lens+(this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n));return new P3D((this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n)*r,(this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n)*r,r)},Engine3D.prototype.scale=function(e){return this.lens/(this.lens+(this._basis[0].z*e.x+this._basis[1].z*e.y+this._basis[2].z*e.z))},Engine3D.prototype.sortedIndexesByPointsScale=function(e){let t,n=[];for(t=0;null!=e[t];t++)n[t]=[e[t],t];n=n.sort(this._sortingCriteria.bind(this));var r=new nL;for(t=0;null!=e[t];t++)r[t]=n[t][1];return r},Engine3D.prototype.sortListByPointsScale=function(e,t){let n,r=[];for(n=0;null!=e[n];n++)r[n]=[t[n],e[n]];r=r.sort(this._sortingCriteria.bind(this));var o=instanceSameType(e);for(o.name=e,n=0;null!=e[n];n++)o[n]=r[n][1];return o},Engine3D.prototype._sortingCriteria=function(e,t){let n=e[0],r=t[0];return this._basis[0].z*n.x+this._basis[1].z*n.y+this._basis[2].z*n.z<this._basis[0].z*r.x+this._basis[1].z*r.y+this._basis[2].z*r.z?1:-1},Engine3D.prototype.updateAngles=function(){this._angles=this.getEulerAngles()},Engine3D.prototype.getEulerAngles=function(){return new P3D(Math.atan2(-this._basis[1].z,this._basis[2].z),Math.asin(this._basis[0].z),Math.atan2(-this._basis[0].y,this._basis[0].x))},Engine3D.prototype.basis3DRotation=function(e,t){let n=Math.cos(t.x),r=Math.sin(t.x),o=Math.cos(t.y),i=Math.sin(t.y),s=Math.cos(t.z),l=Math.sin(t.z);return new Pol3D(new P3D(e[0].x*s*o+e[0].y*(s*r*i+l*n)+e[0].z*(l*r-s*n*i),-e[0].x*l*o+e[0].y*(s*n-l*r*i)+e[0].z*(l*n*i+s*r),e[0].x*i-e[0].y*r*o+e[0].z*o*n),new P3D(e[1].x*s*o+e[1].y*(s*r*i+l*n)+e[1].z*(l*r-s*n*i),-e[1].x*l*o+e[1].y*(s*n-l*r*i)+e[1].z*(l*n*i+s*r),e[1].x*i-e[1].y*r*o+e[1].z*o*n),new P3D(e[2].x*s*o+e[2].y*(s*r*i+l*n)+e[2].z*(l*r-s*n*i),-e[2].x*l*o+e[2].y*(s*n-l*r*i)+e[2].z*(l*n*i+s*r),e[2].x*i-e[2].y*r*o+e[2].z*o*n))},Engine3D.prototype.point3DRotation=function(e,t){let n=Math.cos(t.x),r=Math.sin(t.x),o=Math.cos(t.y),i=Math.sin(t.y),s=Math.cos(t.z),l=Math.sin(t.z);return new P3D(e.x*s*o+e.y*(s*r*i+l*n)+e.z*(l*r-s*n*i),-e.x*l*o+e.y*(s*n-l*r*i)+e.z*(l*n*i+s*r),e.x*i-e.y*r*o+e.z*o*n)},Engine3D.prototype.line3DCoordinates=function(e,t,n,r,o,i){let s=new Pol;var l=this.lens/(this.lens+(this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n));let a=this.lens/(this.lens+(this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i));if(l>0||a>0){if(l>0&&a>0)return s.push(new P((this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n+this._dx)*l,(this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n)*l)),s.push(new P((this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i+this._dx)*a,(this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i)*a)),s;var u=new P3D(this._basis[0].x*e+this._basis[1].x*t+this._basis[2].x*n,this._basis[0].y*e+this._basis[1].y*t+this._basis[2].y*n,this._basis[0].z*e+this._basis[1].z*t+this._basis[2].z*n),h=new P3D(this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i,this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i,this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i),c=(-this.lens+this._cuttingPlane-u.z)/(h.z-u.z),f=new P3D(u.x+c*(h.x-u.x),u.y+c*(h.y-u.y),-this.lens+this._cuttingPlane),p=this.lens/(this.lens+f.z);return l>0?(s.push(new P((u.x+this._dx)*l,u.y*l)),s.push(new P((f.x+this._dx)*p,f.y*p))):(s.push(new P((f.x+this._dx)*p,f.y*p)),s.push(new P((h.x+this._dx)*a,h.y*a))),s}return null},Engine3D.prototype.line3D=function(e,t){return this.line3DCoordinates(e.x,e.y,e.z,t.x,t.y,t.z)},Engine3D.prototype.quadrilater=function(e,t,n,r){let o=new Pol3D;var i=this.line3D(e,t);let s=this.line3D(t,n),l=this.line3D(n,r),a=this.line3D(r,e);return null!=i&&((null==a||i[0].x!=a[1].x&&i[0].y!=a[1].y)&&o.push(i[0]),o.push(i[1])),null!=s&&((null==i||s[0].x!=i[1].x&&s[0].y!=i[1].y)&&o.push(s[0]),o.push(s[1])),null!=l&&((null==s||l[0].x!=s[1].x&&l[0].y!=s[1].y)&&o.push(l[0]),o.push(l[1])),null!=a&&((null==l||a[0].x!=l[1].x&&a[0].y!=l[1].y)&&o.push(a[0]),o.push(a[1])),o};let interpolateColors=function(e,t,n,r){let o=interpolateColorsRGB(colorStringToRGB(e),colorStringToRGB(t),n,r);return"rgb("+Math.floor(o[0])+","+Math.floor(o[1])+","+Math.floor(o[2])+")"},interpolateColorsRGB=function(e,t,n,r){let o=1-n;return r?[Math.floor(Math.sqrt(o*e[0]*e[0]+n*t[0]*t[0])),Math.floor(Math.sqrt(o*e[1]*e[1]+n*t[1]*t[1])),Math.floor(Math.sqrt(o*e[2]*e[2]+n*t[2]*t[2]))]:[Math.floor(o*e[0]+n*t[0]),Math.floor(o*e[1]+n*t[1]),Math.floor(o*e[2]+n*t[2])]},distanceColorsRGB=function(e,t){let n=Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])+Math.abs(e[2]-t[2]);return Number((n/765).toFixed(4))},addAlpha=function(e,t){t=null==t?1:t;let n=colorStringToRGB(e);return null==n?"black":"rgba("+n[0]+","+n[1]+","+n[2]+","+t+")"},invertColor=function(e){let t=colorStringToRGB(e);return t=invertColorRGB(t[0],t[1],t[2]),RGBtoHEX(t[0],t[1],t[2])},stringToColor=function(e){if(null==e)return;if("null"==e||"undefined"==e)return"#202020";let t=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f","#d62720","#1f77b0","#2ca02a","#ff7f08","#9467ba","#bcbd20","#8c564f","#17bece","#dd4418","#206011","#e377c9","#3330fe","#dd8818","#ff220a","#1f66a9","#8c453f","#2ba01f","#dfc508","#945608","#ff008f","#e37708"],n=0;for(var r=0;r<e.length;r++)n+=e.charCodeAt(r)*(r*r+1);return t[Math.floor(getRandomWithSeed(n)*t.length)]},HEXtoRGB=function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]},RGBtoHEX=function(e,t,n){return"#"+toHex(Math.floor(e))+toHex(Math.floor(t))+toHex(Math.floor(n))},RGBArrayToString=function(e){return"rgb("+e[0]+","+e[1]+","+e[2]+")"},colorStringToHEX=function(e){let t=colorStringToRGB(e);return RGBtoHEX(t[0],t[1],t[2])},numberToHex=function(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return t},uinttoRGB=function(e){return new Array(e>>16,(e>>8)-(e>>16<<8),e-(e>>8<<8))},uinttoHEX=function(e){let t=uinttoRGB(e);return RGBToHEX(t[0],t[1],t[2])},RGBtouint=function(e,t,n){return Number(e)<<16|Number(t)<<8|Number(n)},HEXtouint=function(e){let t=HEXtoRGB(e);return RGBtouint(t[0],t[1],t[2])},grayByLevel=function(e){return"rgb("+(e=Math.floor(255*e))+","+e+","+e+")"},HEXtoHSV=function(e){let t=HEXtoRGB(e);return RGBtoHSV(t[0],t[1],t[2])},HSVtoHEX=function(e,t,n){let r=HSVtoRGB(e,t,n);return RGBtoHEX(r[0],r[1],r[2])},HSLtoHEX=function(e,t,n){let r=HSLtoRGB(e,t,n);return RGBtoHEX(r[0],r[1],r[2])},RGBtoHSV=function(e,t,n){var r,o,i,s=Math.min(Math.min(e,t),n),l=Math.max(Math.max(e,t),n);i=l/255;var a=l-s;return 0===a?new Array(0,0,e/255):0===l?(o=0,r=-1,new Array(r,o,i)):(o=a/l,r=e==l?(t-n)/a:t==l?2+(n-e)/a:4+(e-t)/a,(r*=60)<0&&(r+=360),new Array(r,o,i))},HSVtoRGB=function(e,t,n){let r,o,i,s,l,a,u,h;if(e=e||0,n=n||0,0===(t=t||0))return r=o=i=n,[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)];switch(e/=60,s=Math.floor(e),l=e-s,a=n*(1-t),u=n*(1-t*l),h=n*(1-t*(1-l)),s){case 0:r=n,o=h,i=a;break;case 1:r=u,o=n,i=a;break;case 2:r=a,o=n,i=h;break;case 3:r=a,o=u,i=n;break;case 4:r=h,o=a,i=n;break;default:r=n,o=a,i=u}return new Array(Math.floor(255*r),Math.floor(255*o),Math.floor(255*i))},HSLtoRGB=function(e,t,n){let r,o,i;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0===t)r=o=i=n;else{var l=n<.5?n*(1+t):n+t-n*t,a=2*n-l;r=s(a,l,e/360+1/3),o=s(a,l,e/360),i=s(a,l,e/360-1/3)}return[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)]},invertColorRGB=function(e,t,n){return[255-e,255-t,255-n]},toHex=function(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return t},getRandomColor=function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},colorStringToRGB=function(e,t){if(null==e)return;t=null==t?1:t,"#"==(e=(e=(e=String(e)).replace(/ /g,"")).toLowerCase())[0]&&(e=e.substr(1,6));let n={beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",cyan:"00ffff",fuchsia:"ff00ff",gold:"ffd700",gray:"808080",grey:"808080",green:"008000",magenta:"ff00ff",navy:"000080",pink:"ffc0cb",salmon:"fa8072",silver:"c0c0c0",turquoise:"40e0d0",violet:"ee82ee",white:"ffffff",yellow:"ffff00"};null!=n[e]&&(e=n[e]);let r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(e){return[parseInt(e[1])*t,parseInt(e[2])*t,parseInt(e[3])*t]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,process:function(e){return[parseInt(e[1])*t,parseInt(e[2])*t,parseInt(e[3])*t]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(e){return[parseInt(e[1],16)*t,parseInt(e[2],16)*t,parseInt(e[3],16)*t]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(e){return[parseInt(e[1]+e[1],16)*t,parseInt(e[2]+e[2],16)*t,parseInt(e[3]+e[3],16)*t]}}];for(var o=0;o<r.length;o++){var i=r[o].re,s=r[o].process,l=i.exec(e);if(l)return s(l)}return null},createSortedNumberList=function(e,t,n,r){if(null==e)return null;let o;Array.isArray(e)&&(e=e.length),e=Number(e),t=t||0,n=null==n?1:n;let i=new nL;for(o=0;o<e;o++)i.push(t+o*n);return null!=r&&(i.name=r),i},createNumberListWithinInterval=function(e,t,n,r){if(null==t&&(t=new I(0,1)),1==n)return createSortedNumberList(e,t.x,(t.y-t.x)/e);n=null==n?0:n;let o=null!=r?new _Alea("my",r,"seeds"):NumberOperators_random;var i=new nL;let s,l=t.getAmplitude(),a=Number(t.getMin());if(0===n)for(s=0;s<e;s++)i.push(a+Number(o()*l));return i},createRandomNormalDistribution=function(e,t,n){let r,o=new o;for(r=0;r<e;r++)o.push(normal(t,n));return o},createRandomBetaPERTDistribution=function(e,t,n,r,o,i){t=null==t?0:t,n=null==n?1:n,r=null==r?.5:r,o=null==o?1:o,i&&i(i);let s,l=new l;for(s=0;s<e;s++)l.push(betaPERT(t,n,r,o));return i&&randomSeedPop(),l},createRandomBimodalDistribution=function(e,t,n,r,o,i,s,l){t=null==t?0:t,n=null==n?1:n,r=null==r?.25:r,o=null==o?.75:o,i=null==i?1:i,s=null==s?.5:s,null!=l&&l(l);let a,u=new u;for(a=0;a<e;a++)random()>s?u.push(betaPERT(t,n,r,i)):u.push(betaPERT(t,n,o,i));return l&&randomSeedPop(),u},createRandomNumbers=function(e,t,n,r){n=null==n?-1:n,t=null==t?new I(0,1):t;var o=new nL;let i=t.getAmplitude();for(var s=-1==n?NumberOperators_random:new _Alea("my",n,"seeds"),l=0;l<e;l++)o[l]=null==r?s()*i+t.x:r(s()*i+t.x);return o},createUniformTable=function(e,t,n,r){let o=new T;for(var i=0;i<e;i++)o[i]=createListWithSameElement(t,n),r&&r[i]&&(o[i].name=r[i]);return o.downcast()},dotProduct=function(e,t){let n,r=0,o=Math.min(e.length,t.length);for(n=0;n<o;n++)r+=e[n]*t[n];return r},linearRegression=function(e,t,n){n=null==n||n>2?0:n;let r=new nL;if(null==e||null!=t&&e.length!=t.length||0===e.length)return 0===n?r:new P;null==t&&(t=e,e=createSortedNumberList(e.length,0,1));for(var o=0,i=0,s=0,l=0,a=0,u=e.length,h=0;h<u;h++)o+=e[h],i+=t[h],s+=e[h]*e[h],l+=e[h]*t[h],a+=t[h]*t[h];let c=u*s-o*o,f=0===c?0:(u*l-o*i)/c;if(2==n)return f;var p=i/u-f*o/u;if(1==n)return new P(f,p);let g=Math.pow((u*l-o*i)/Math.sqrt((u*s-o*o)*(u*a-i*i)),2);return r.push(f),r.push(p),r.push(g),r.push(u),r},distance=function(e,t,n){if(null==e||null==t)return;let r,o=0,i=Math.min(e.length,t.length);if("cosine"==(n=(n=null==n?"euclidean":n).toLowerCase()))return 1-cosineSimilarity(e,t);if("manhattan"==n){for(r=0;r<i;r++)o+=Math.abs(e[r]-t[r]);return o}if("euclidean"!=n)throw new Error("Invalid distanceMetric.");for(r=0;r<i;r++)o+=Math.pow(e[r]-t[r],2);return Math.sqrt(o)},cosineSimilarity=function(e,t,n,r){let o=(n=null==n?e.getNorm():n)*(r=null==r?t.getNorm():r);return 0===o?0:dotProduct(e,t)/o},covariance=function(e,t,n){if(null==e||null==t)return;var r=Math.min(e.length,t.length);let o,i,s,l=0;for(i=n&&e.infoObject?e.infoObject.average:null!=e.mean?e.mean:e.getMean(),s=n&&t.infoObject?t.infoObject.average:t.mean?t.mean:t.getMean(),o=0;o<r;o++)l+=(e[o]-i)*(t[o]-s);return l/r},standardDeviationTwoNumberLists=function(e,t){if(null==e||null==t)return;let n,r=0,o=Math.min(e.length,t.length);for(n=0;n<o;n++)r+=Math.pow(e[n]-t[n],2);return r/o},numericCorrelation=function(e,t,n,r){if(null==e||null==t)return;e?.infoObject?.standardDeviation&&(n=e.infoObject.standardDeviation),t?.infoObject?.standardDeviation&&(r=t.infoObject.standardDeviation),e?.standardDeviation&&(n=e.standardDeviation),t?.standardDeviation&&(r=t.standardDeviation),null==n&&(n=e.getStandardDeviation()),null==r&&(r=t.getStandardDeviation());let o=n*r;return 0===o?0:covariance(e,t)/o},slidingWindowCorrelation=function(e,t,n){if(null==e||null==t||e.length!=t.length)return;var r,o,i,s,l;(null==n||isNaN(n)||n<1)&&(n=5),n=Math.round(n);let a=e.length,u=new nL;for(r=0;r<a;r++){for(i=new nL,s=new nL,o=Math.max(0,r-n);o<=r+n;o++)o<0||o>=a||(i.push(e[o]),s.push(t[o]));l=numericCorrelation(i,s),u.push(l)}return u},normalizeToSum=function(e,t,n){if(null==e)return;t=null==t?1:t;let r,o=new nL;if(o.name=e.name,0===e.length)return o;if(0===(n=null==n?e.getSum():n))return e.clone();for(t/=n,r=0;r<e.length;r++)o[r]=t*e[r];return o},normalizeByZScore=function(e,t,n){if(null==e)return;if(0===e.length)return null;var r;t=t||e.getMean();let o=n||e.getStandardDeviation(t);0===o&&(o=1);var i=new nL;for(r=0;r<e.length;r++)i.push((e[r]-t)/o);return i.name=e.name,i},normalizeToMax=function(e,t){if(null==e)return;if(t=null==t?1:t,0===e.length)return null;var n=e.getMax();if(0===n&&0===(n=e.getMin()))return createListWithSameElement(e.length,0);let r=new nL;for(var o=0;null!=e[o];o++)r.push(t*(e[o]/n));return r.name=e.name,r},normalizeToInterval=function(e,t){if(null==e||null==t||0===e.length)return;var n;t=null==t?e.getInterval():t;let r=e.getInterval(),o=r.getAmplitude();if(0===o)return ListGenerators.createListWithSameElement(e.length,t.x,e.name);let i=t.getSignedAmplitude()/o,s=new nL;for(n=0;n<e.length;n++)s.push(t.x+i*(e[n]-r.x));return s.name=e.name,s},trimNumberList=function(e,t,n){return e.trim(t,n)},getAccumulativeSum=function(e){if(null!=e&&0!==e.length){var t=new nL;t[0]=e[0];for(var n=1;n<e.length;n++)t[n]=e[n]+t[n-1];return t}},shorten=function(e,t){if(null==e)return null;if(null==t||t>=e.length)return e;var n=e.length/t;let r,o,i,s,l=new nL,a=Math.floor(n);for(l.name=e.name,o=0;o<t;o++){for(s=Math.floor(o*n),r=0,i=0;i<a;i++)r+=e[s+i];l[o]=r/a}return l},simplify=function(e,t,n){if(null!=e){t=t||0,n=n||0;var r=new nL;if(r.name=e.name,0===t){var o=Math.pow(10,n);e.forEach((function(e){r.push(Math.floor(e/o)*o)}))}return r}},segmentNumberList=function(e,t,n){if(null==e||null==t)return null;var r=0==(n=null==n?0:n)?new e:new sL;r.name="segments "+e.name;for(var o=0;o<e.length;o++){for(var i=!1,s=0;s<t.length;s++)if(e[o]<t[s]){i=!0,r[o]=0==n?s:0==s?"<"+t[s]:t[s-1]+"-"+t[s];break}i||(r[o]=0==n?t.length:">="+t[t.length-1])}return r},averageSmoother=function(e,t,n){if(null==e)return;n=null==n?1:n,t=null==t?.1:t,t=Math.max(Math.min(t,.5),0),t*=.6;let r=e.length;var o=e.clone();let i,s,l,a,u,h,c=e.clone();for(i=0;i<n;i++)for(l=i%2?c:o,a=i%2?o:c,s=0;s<r;s++)h=0,u=0,s-1>=0&&(u++,h+=l[s-1]*t),s+1<r&&(u++,h+=l[s+1]*t),a[s]=h+l[s]*(1-u*t);return a},closestValue=function(e,t,n,r){if(null==e)return;n=null==n||n;var o=Math.abs(e[0]-t);let i,s=0;for(var l=1;l<e.length;l++)if(i=Math.abs(e[l]-t),i<o){if(1==r&&e[l]>t||2==r&&e[l]<t||3==r&&e[l]>=t||4==r&&e[l]<=t)continue;o=i,s=l}return n?e[s]:s},filterNumberListByInterval=function(e,t,n,r,o,i){return null},filterNumberListByNumber=function(e,t,n,r){r=r||!1;let o,i=new nL;if(r)switch(n){case"<":for(o=0;null!=e[o];o++)e[o]<t&&i.push(o);break;case"<=":for(o=0;null!=e[o];o++)e[o]<=t&&i.push(o);break;case">":for(o=0;null!=e[o];o++)e[o]>t&&i.push(o);break;case">=":for(o=0;null!=e[o];o++)e[o]>=t&&i.push(o);break;case"==":for(o=0;null!=e[o];o++)e[o]==t&&i.push(o);break;case"!=":for(o=0;null!=e[o];o++)e[o]!=t&&i.push(o)}else switch(n){case"<":for(o=0;null!=e[o];o++)e[o]<t&&i.push(e[o]);break;case"<=":for(o=0;null!=e[o];o++)e[o]<=t&&i.push(e[o]);break;case">":for(o=0;null!=e[o];o++)e[o]>t&&i.push(e[o]);break;case">=":for(o=0;null!=e[o];o++)e[o]>=t&&i.push(e[o]);break;case"==":for(o=0;null!=e[o];o++)e[o]==t&&i.push(e[o]);break;case"!=":for(o=0;null!=e[o];o++)e[o]!=t&&i.push(e[o])}return i},frameFromTwoNumberLists=function(e,t){if(null==e||null==t)return;let n=e.getInterval(),r=t.getInterval();return new Rec(n.x,r.x,n.getAmplitude(),r.getAmplitude())},rangeCounts=function(e,t,n,r){if(null==e)return;t=null==t?10:t;let o=1==(r=r||0)?[]:createListWithSameElement(t,0);if(null==(n=null==n?e.getInterval():n))return o;let i,s=n.y-n.x,l=e.length,a=new nL;for(var u=0;u<l;u++)i=Math.min(Math.floor(t*(e[u]-n.x)/s),t-1),a[u]=i,0===r&&o[i]++;return 1==r?a:o},simpleCompression=function(e,t){if(null==e)return null;var n;t=null==t||t;let r=new nL;if(r.name=e.name,0===e.length)return r;if(r[0]=e[0],t)for(n=1;n<e.length;n++)r[n]=e[n]-e[n-1]-1;else for(n=1;n<e.length;n++)r[n]=r[n-1]+e[n]+1;return r},regression=function(e,t,n,r){if(null==e||0==e.length)return null;if(null==t&&(t=createSortedNumberList(e.length,1)),"string"!=typeof(n=null==n?"linear":n)||"linear"!=n&&"exponential"!=n&&"logarithmic"!=n&&"power"!=n&&"polynomial"!=n)throw new Error("Invalid method in NumberListOperators.regression: "+n);r=null==r?2:r;let o=[];for(var i=0;i<t.length;i++)o.push([t[i],null==e[i]?null:e[i]]);let s=_Regression(n,o,r,{precision:3});var l=new nL;for(l.name=n+" Regression Series",i=0;i<s.points.length;i++)l.push(s.points[i][1]);var a=nL.toL(s.equation);return a.name="Coefficients",[{type:"nL",name:"Y Results",description:"Y Results are the forecasted values",value:l},{type:"nL",name:"Coefficients",description:"Coefficients of the regression equation",value:a},{type:"String",name:"Equation",description:"Equation in string form",value:s.string},{type:"Number",name:"R^2",description:"R^2 value",value:s.r2},{type:"Function",name:"fnModel",description:"Function that takes input and calculates output based on model",value:s.func}]},getDecimalsInterval=function(e){if(null==e)return null;let t,n,r=new I(0,0);for(t=0;t<e.length;t++)n=decimalPlaces(e[t]),r.adjustToContain(n);return r},setDecimals=function(e,t){if(null==e)return null;let n,r;if(e.isTable){var o=instanceSameType(e);for(o.name=e.name,n=0;n<e.length;n++)"nL"==e[n].type?o.push(setDecimals(e[n],t)):o.push(e[n].clone());return o}let i=new nL;for(i.name=e.name,n=0;n<e.length;n++)r=null==e[n]?null:Number(e[n].toFixed(t)),i.push(r);return i},getDistributionHeights=function(e,t,n){if(null==e)return null;var r,o,i;t=null==t||1!=t?0:t;var s=rangeCounts(e,n=null==n?50:n,null,0),l=rangeCounts(e,n,null,1),a=new e;for(randomSeed(1),r=0;r<e.length;r++)i=s[l[r]],0==t?(o=i-1,s[l[r]]--):o=random()*i,a.push(o);return randomSeedPop(),a},kNearestNeighbours=function(e,t,n,r,o,i,s){if(null==e||null==t||0==e.length)return;n=null==n?1:n,r=null==r?0:r,s=null!=s&&s;let l,a="number"==typeof t;if((o=null!=o&&o)||(e=e.transpose()),a){if(t<0||t>=e.length||Math.floor(t)!=t)throw new Error("Invalid value for second inlet.");l=t,t=e[l]}if(t.length!=e[0].length)throw new Error("The input nl must have the same number of values as columns of the numberTable.");let u=new e;u.push(new t),u.push(new t),u.assignNames("index,distance");for(var h=0;h<e.length;h++)a&&h==l||(u[0].push(h),u[1].push(distance(e[h],t,i)));return u=u.sortRowsByList(1,!s,!0),u=u.sliceRows(0,n-1),0==r?e.getColumns(u[0]):1==r?u[0]:u},skewness=function(e,t){if(null==e)return;let n=e.getMean();if((t=null==t?0:t)>=2)return Math.log2(n/e.getMedian());var r=e.getStandardDeviation();if(0==r)return 0;switch(t){case 0:for(var o=0,i=0;i<e.length;i++)o+=Math.pow(e[i]-n,3);return o/e.length/Math.pow(r,3);case 1:if(0==r)return 0;for(o=0,i=0;i<e.length;i++)o+=Math.pow(e[i]-n,3);var s=o/e.length/Math.pow(r,3),l=e.length;return l*l/((l-1)*(l-2))*s}},TableToObject=function(e,t){if(e){t||(t=e.getNames());for(var n=[],r=0;r<e[0].length;r++){for(var o={},i=0;i<t.length;i++)o[t[i]]=e[i][r];n.push(o)}return{array:n}}},ArrayOfArraysToTable=function(e){if(null===e||!isArray(e))return;var t=e.length;let n,r=new T;for(n=0;n<t;n++)isArray(e[n])&&r.push(L.toL(e[n]).downcast());return r.downcast()},tableToHtml=function(e,t,n,r,o,i,s,l,a,u){if(null==e)return;if(0==e.length)return"";if(!e.isTable&&(e.isList||Array.isArray(e))){var h=new T;h.push(e),e=h}n=null==n?"font-family: arial, sans-serif; border-collapse: collapse; width: 100%;":n,r=null==r?"border:1px solid rgba(200,200,200,.5); text-align: left; padding: 4px;":r,o=null==o?"background-color: #ffffff;":o,i=null==i?"background-color: #f0f0f0;":"same"==i?o:i,t=null==t?e[0].length:Math.min(t,e[0].length),l=null==l||l,u=null==u?"rgba(100,160,255,.5)":u;var c="string"==typeof r?'<td style="'+r+'">':"";let f='<tr style="'+o+'">',p='<tr style="'+i+'">';var g="";let d,m,y;a&&(d=function(e,t,n){0==t&&(t=1);var r='<div style="background-color: #eee; width:100%; border-style: solid; border-width: 1px; border-color:#aaa; display: inline-block;">';return r+='<div style="background-color:'+n+"; width:"+Math.max(0,Math.round(100*e/t))+'%; height: 100%; font-size:14px; color:black;">',r+="&nbsp;"+e+"</div></div>"},buildInformationObjectForTable(e)),g+='<table style="'+n+'">';let x=!1;for(m=0;m<e.length;m++)if(""!=e[m].name&&null!=e[m].name){x=!0;break}if(x){for(g+=f,m=0;m<e.length;m++)r.isList&&(c='<td style="'+r[m]+'">'),g+=c+"<b>"+(""==e[m].name?"Column "+(m+1):e[m].name)+"</b></td>";g+="</tr>"}for(y=0;y<t;y++){for(g+=y%2==1?f:p,m=0;m<e.length;m++){if(s&&null!=s[m]&&null!=s[m][y]&&""!=s[m][y]?g+='<td style="'+s[m][y]+'">':(r.isList&&(c='<td style="'+r[m]+'">'),g+=c),l){var w=null==e[m][y]?"":String(e[m][y]).toLowerCase();if(0==w.indexOf("http")&&(-1!=w.indexOf(".jpg")||-1!=w.indexOf(".jpeg")||-1!=w.indexOf(".png")||-1!=w.indexOf("photo")||-1!=w.indexOf("image"))){g+='<img src="'+e[m][y]+'" width=200>';continue}}"nL"==e[m].type&&("all"==a||a&&-1!=a.indexOf(m))?u&&"cL"==u.type&&u.length==e[0].length?g+=d(e[m][y],e[m].infoObject.max,u[y]):g+=d(e[m][y],e[m].infoObject.max,u):g+=e[m][y],g+="</td>"}g+="</tr>"}return g+="</table>"},tableToList=function(e){if(null==e)return;let t=new L;for(var n=0;n<e.length;n++)t=t.concat(e[n]);return t.downcast()},createColorScaleFromColors=function(e,t){if(null==e)return null;if(1==e.length)(function(t){return e[0]});else if(2==e.length){return e.rgbs=e.getRgbArrays(),function(t){var n=1-t;return"rgb("+Math.floor(n*e.rgbs[0][0]+t*e.rgbs[1][0])+","+Math.floor(n*e.rgbs[0][1]+t*e.rgbs[1][1])+","+Math.floor(n*e.rgbs[0][2]+t*e.rgbs[1][2])+")"}}if(null==t){var n=1/(e.length-1);t=createSortedNumberList(e.length-2,n,n)}return null==e.rgbs&&(e.rgbs=e.getRgbArrays()),(t=t.slice()).unshift(0),t.push(1),function(n){var r,o,i;for(r=0;null!=t[r+1];r++)if(n<=t[r+1])return i=1-(o=(n-t[r])/(t[r+1]-t[r])),"rgb("+Math.floor(i*e.rgbs[r][0]+o*e.rgbs[r+1][0])+","+Math.floor(i*e.rgbs[r][1]+o*e.rgbs[r+1][1])+","+Math.floor(i*e.rgbs[r][2]+o*e.rgbs[r+1][2])+")"}},blackScale=function(){return"black"},grayscale=function(e){let t=interpolateColorsRGB([0,0,0],[255,255,255],e);return RGBtoHEX(t[0],t[1],t[2])},antiGrayscale=function(e){let t=interpolateColorsRGB([255,255,255],[0,0,0],e);return RGBtoHEX(t[0],t[1],t[2])},antiTemperature=function(e){return temperature(1-e)},temperature=function(e){let t="#FFFFFF";return t=e<.2?interpolateColors("#000000",HSVtoHEX(234,1,1),5*e):e>.85?interpolateColors(HSVtoHEX(0,1,1),"#FFFFFF",(e-.85)/.15):HSVtoHEX(Math.round(360*(.65-(e-.2))),1,1),t},lightTemperature=function(e){return temperature(.1+.9*e)},sqrtTemperature=function(e){return temperature(Math.sqrt(e))},sqrt4Temperature=function(e){return temperature(Math.pow(e,.25))},quadraticTemperature=function(e){return temperature(Math.pow(e,2))},cubicTemperature=function(e){return temperature(Math.pow(e,3))},greenToRed=function(e){let t=interpolateColorsRGB([50,255,50],[255,50,50],e);return RGBtoHEX(t[0],t[1],t[2])},greenToBlue=function(e){let t=interpolateColorsRGB([50,255,50],[50,50,255],e);return RGBtoHEX(t[0],t[1],t[2])},grayToOrange=function(e){return"rgb("+Math.floor(100+155*e)+","+Math.floor(100+10*e)+","+Math.floor(100-100*e)+")"},sqrt4GrayToOrange=function(e){return grayToOrange(Math.pow(e,.25))},blueToRed=function(e){return"rgb("+Math.floor(255*e)+",0,"+Math.floor(255*(1-e))+")"},whiteToRed=function(e){let t=Math.floor(255-255*e);return"rgb(255,"+t+","+t+")"},redToBlue=function(e){let t=interpolateColorsRGB([255,0,0],[0,0,255],e);return RGBtoHEX(t[0],t[1],t[2])},greenWhiteRed=function(e){let t=[0,0,0];return t=e<.5?interpolateColorsRGB([50,255,50],[255,255,255],2*e):interpolateColorsRGB([255,255,255],[255,50,50],2*(e-.5)),"rgb("+t[0]+","+t[1]+","+t[2]+")"},blueWhiteRed=function(e){return"rgb("+(e<.5?Math.floor(510*e):255)+","+(e<.5?Math.floor(510*e):Math.floor(510*(1-e)))+","+(e<.5?255:Math.floor(510*(1-e)))+")"},blueBlackRed=function(e){return"rgb("+(e<.5?0:Math.floor(512*(e-.5)))+",0,"+(e<.5?Math.floor(255-512*e):0)+")"},grayBlackOrange=function(e){let t=[0,0,0];return t=e<.5?interpolateColorsRGB([100,100,100],[0,0,0],2*e):interpolateColorsRGB([0,0,0],[255,110,0],2*(e-.5)),"rgb("+t[0]+","+t[1]+","+t[2]+")"},grayWhiteOrange=function(e){let t=[0,0,0];return t=e<.5?interpolateColorsRGB([100,100,100],[255,255,255],2*e):interpolateColorsRGB([255,255,255],[255,110,0],2*(e-.5)),"rgb("+t[0]+","+t[1]+","+t[2]+")"},solar=function(e){let t=interpolateColorsRGB([0,0,0],interpolateColorsRGB([255,0,0],[255,255,0],e),Math.pow(.99*e+.01,.2));return RGBtoHEX(t[0],t[1],t[2])},antiSolar=function(e){return invertColor(solar(e))},get=function(e,t){return e.get(t)},getFirstElements=function(e,t){return null==e&&(t=0,e=[null,null,null,null,null,null,null,null,null,null]),[{type:"Object",name:"first value",description:"first value",value:e[(t=null==t?0:Number(t))+0]},{type:"Object",name:"second value",description:"second value",value:e[t+1]},{type:"Object",name:"third value",description:"third value",value:e[t+2]},{type:"Object",name:"fourth value",description:"fourth value",value:e[t+3]},{type:"Object",name:"fifth value",description:"fifth value",value:e[t+4]},{type:"Object",name:"sixth value",description:"sixth value",value:e[t+5]},{type:"Object",name:"seventh value",description:"seventh value",value:e[t+6]},{type:"Object",name:"eight value",description:"eight value",value:e[t+7]},{type:"Object",name:"ninth value",description:"ninth value",value:e[t+8]},{type:"Object",name:"tenth value",description:"tenth value",value:e[t+9]}]},containSameElements=function(e,t){if(null==e||null==t)return null;var n=e.length;let r;if(n==t.length){for(r=0;r<n;r++)if(e[r]!=t[r])return!1;return!0}},fractionOfSameElements=function(e,t){if(null==e||null==t)return null;var n=Math.max(e.length,t.length);let r,o=0;for(r=0;r<n;r++)e[r]==t[r]&&o++;return 0==n?0:o/n},getCorrespondenceBetweenLists=function(e,t,n,r){if(null==e||null==t)return null;if(e.length!=t.length)throw new Error("The two lists must be the same length");r=null!=r&&r;var o=new L;let i,s=Math.max(e.length,t.length);for(i=0;i<s;i++)e[i]==t[i]?o.push(null==n?e[i]:n):o.push(r);return o.downcast()},getConfusionMatrix=function(e,t){if(null==e||null==t)return null;if(e.length!=t.length)throw new Error("The two lists must be the same length");var n=union(e,t).getWithoutRepetitions().getSorted();let r,o,i={},s="-|-";for(r=0;r<n.length;r++)for(o=0;o<n.length;o++)i[n[r]+s+n[o]]=0;for(r=0;r<e.length;r++)i[e[r]+s+t[r]]++;var l=new T;for(l.name="Confusion Mx",r=0;r<=n.length;r++)for(0==r?(l.push(new sL),l[r].name="Predicted Class"):(l.push(new nL),l[r].name="Actual:"+n[r-1]),o=0;o<n.length;o++)0==r?l[r].push(n[o]):l[r].push(i[n[r-1]+s+n[o]]);return l},indexOf=function(e,t){if(null!=e)return e.indexOf(t)},replaceElement=function(e,t,n){if(null==e||null==t)return null;var r=new L;r.name=e.name;let o,i=e.length;for(o=0;o<i;o++)r[o]=e[o]==t?n:e[o];return r.downcast()},replaceElementAtIndex=function(e,t,n){if(null==e||null==n)return null;if("number"!=typeof(t=null==t?0:t)||t%1!=0||t<0||t>=e.length)throw new Error("Invalid index in replaceElement");var r=e.clone();return r[t]=n,r.downcast()},replaceNullsInList=function(e,t,n,r){if(null==e||null==t)return;if(0===t&&null==n)throw new Error("when mode is 0, must provide a non-null element to replace nulls");var o=e.length;let i,s,l,a,u,h,c=0,f=0,p=new L;switch(t){case 6:return n=e.getWithoutElement(null).getMode(),replaceNullsInList(e,0,n);case 3:for(i=0;i<o;i++)"number"==typeof e[i]&&(c+=e[i],f++);return replaceNullsInList(e,0,n=c/f);case 7:n=(n=e.getWithoutElement(null).getSorted()).length>1&&n.length/2==Math.floor(n.length/2)?.5*(n[n.length/2-1]+n[n.length/2]):n[Math.floor(n.length/2)];case 0:for(i=0;i<o;i++)p[i]=e[i]==r?n:e[i];break;case 1:for(i=0;i<o;i++)if(e[i]!=r){s=e[i];break}for(i=0;i<o;i++)e[i]==r?p[i]=s:p[i]=s=e[i];break;case 2:for(i=o-1;i>=0;i--)if(e[i]!=r){l=e[i];break}for(i=o-1;i>=0;i--)e[i]==r?p[i]=l:p[i]=l=e[i];break;case 4:for(u=0,i=0;i<o;i++)if(e[i]!=r){h=i,p[i]=n=e[i];break}if(n==r)return e;for(i==o&&(h=o);u<o;){for(i=u;i<h;i++)p[i]=n;for(i=h;i<o;i++){if(e[i]==r){u=i;break}p[i]=e[i]}if(i==o)u=h=o;else{for(i=u;i<o;i++)if(e[i]!=r){h=i;break}i==o&&(h=o)}u>=0&&(n=h==o?e[u-1]:.5*(e[u-1]+e[h]))}break;case 5:for(u=0,i=0;i<o;i++)if(e[i]!=r){h=i,p[i]=s=l=e[i];break}if(s==r)return e;for(i==o&&(h=o);u<o;){for(a=(l-s)/(1+h-u),i=u;i<h;i++)p[i]=s+(i-u+1)*a;for(i=h;i<o;i++){if(e[i]==r){u=i;break}p[i]=e[i]}if(i==o)u=h=o;else{for(i=u;i<o;i++)if(e[i]!=r){h=i;break}i==o&&(h=o)}u>0&&(s=e[u-1]),l=h==o?s:e[h]}}return p.name=e.name,p.downcast()},concat=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var e;let t=arguments[0].concat(arguments[1]);for(e=2;e<arguments.length;e++)t=t.concat(arguments[e]);return t},reverse=function(e){if(null!=e)return e.getReversed()},getBooleanDictionaryForList=function(e){if(null==e)return;var t={};let n,r=e.length;for(n=0;n<r;n++)t[e[n]]=!0;return t},getFirstOccurrenceDictionaryForList=function(e){if(null==e)return;var t;let n=e.length;var r={};for(t=0;t<n;t++)r[e[t]]=t;return r},getIndexesDictionary=function(e){if(null==e)return;let t,n={},r=e.length;for(t=0;t<r;t++)null==n[e[t]]&&(n[e[t]]=new nL),n[e[t]].push(t);return n},getIndexesTable=function(e){if(null==e)return;let t=new T;t[0]=new L,t[1]=new nT;let n,r,o,i={};for(o=0;o<e.length;o++)r=e[o],n=i[r],null==n?(t[0].push(r),t[1].push(new nL(o)),i[r]=t[0].length-1):t[1][n].push(o);return t[0]=t[0].downcast(),t},buildDictionaryObjectForDictionary=function(e){if(!(null==e||e.length<2||null==e[0]||null==e[1])){var t={};return e[0].forEach((function(n,r){t[n]=e[1][r]})),t}},mapWithTable=function(e,t,n,r){if(!(null==e||null==t||t.length<2)){var o=buildDictionaryObjectForDictionary(t),i=mapWithObject(e,o,n,r);return i.dictionaryObject=o,i}},mapWithObject=function(e,t,n,r){if(null==e||null==t)return;var o=new L;let i,s=e.length;for(i=0;i<s;i++)o[i]=t[e[i]];if(null!=n||r){var l=e.length;for(i=0;i<l;i++)null==o[i]&&(o[i]=r?e[i]:n)}return o.name=e.name,o.downcast()},sortListByNumberList=function(e,t,n){return null==n&&(n=!0),null==t||0===t.length?e:e.getSortedByList(t,!n,!1,!0)},getRankingsList=function(e,t,n,r){if(null==e)return null;t=null==t||t;var o=createSortedNumberList(e.length);o=o.getSortedByList(e,t,n);let i,s=new nL,l=e.length;for(i=0;i<l;i++)s[o[i]]=i;return r&&(s=s.getNormalized()),s.name=e.name,s},sortListByIndexes=function(e,t){let n=instantiate(_typeOf(e));n.name=e.name;let r,o=e.length;for(r=0;r<o;r++)n.push(e[t[r]]);return n},concatWithoutRepetitions=function(){let e=arguments.length;if(0===e)return;if(1==e)return arguments[0];var t,n;let r,o,i=arguments[0].clone(),s=getBooleanDictionaryForList(i);for(t=1;t<e;t++)for(r=arguments[t],o=r.length,n=0;n<o;n++)s[r[n]]||i.push(r[n]);return i.downcast()},slidingWindowOnList=function(e,t,n,r){r=r||0;let o,i,s,l=new T,a=e.length;switch(n=Math.max(1,n),r){case 0:for(i=0;i<a;i+=n)if(i+t<=a){for(o=new L,s=0;s<t;s++)o.push(e[i+s]);l.push(o.downcast())}break;case 1:for(i=0;i<a;i+=n){for(o=new L,s=0;s<Math.min(t,a-i);s++)o.push(e[i+s]);l.push(o.downcast())}break;case 2:for(i=0;i<a;i+=n){for(o=new L,s=0;s<t;s++)o.push(e[(i+s)%a]);l.push(o.downcast())}}return l.downcast()},getNewListForObjectType=function(e){let t=new L;return t[0]=e,instanceSameType(t.downcast())},union=function(e,t,n,r,o){if(null==e||null==t)return;var i=new L;let s,l,a=e.length,u=t.length,h=null==n?0:n.length,c=null==r?0:r.length,f=null==o?0:o.length;if("ndL"==e.type||"ndL"==t.type){for(i=new ndL,i=e.clone(),s=0;s<u;s++)null==e.get(t[s].id)&&i.addNode(t[s]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var p={};for(s=0;s<a;s++)p[e[s]]=e[s];for(s=0;s<u;s++)p[t[s]]=t[s];for(s=0;s<h;s++)p[n[s]]=n[s];for(s=0;s<c;s++)p[r[s]]=r[s];for(s=0;s<f;s++)p[o[s]]=o[s];for(l in p)i.push(p[l]);return i.downcast()},intersection=function(e,t,n,r,o){if(null==e||null==t)return;if(e.isTable&&t.isTable)return e.getColumns(t.getNames());let i,s=null;Array.isArray(n)||"object"!=typeof n||(s=n,n=null);let l,a,u=e.length,h=t.length;if("ndL"==e.type&&"ndL"==t.type){for(i=new ndL,l=0;l<u;l++)t.get(e[l].id)&&i.addNode(e[l]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var c=null==s?getBooleanDictionaryForList(e):s;let f={},p=null==n?null:getBooleanDictionaryForList(n),g=null==r?null:getBooleanDictionaryForList(r),d=null==o?null:getBooleanDictionaryForList(o);for(i=new L,l=0;l<h;l++)a=t[l],null!=f[a]||!c[a]||null!=p&&!p[a]||null!=g&&!g[a]||null!=d&&!d[a]||(f[a]=!0,i.push(a));return i.downcast()},difference=function(e,t){if(null==e||null==t)return;var n=getBooleanDictionaryForList(t);let r,o={},i=new L,s=e.length;for(e.type,r=0;r<s;r++)n[e[r]]||o[e[r]]||(i.push(e[r]),o[e[r]]=!0);return i.downcast()},symmetricDifference=function(e,t){if(null==e||null==t)return;var n=getBooleanDictionaryForList(e);let r,o=getBooleanDictionaryForList(t),i={},s=new L,l=e.length,a=t.length;for(e.type,r=0;r<l;r++)o[e[r]]||i[e[r]]||(s.push(e[r]),i[e[r]]=!0);for(r=0;r<a;r++)n[t[r]]||i[t[r]]||(s.push(t[r]),i[t[r]]=!0);return s.downcast()},jaccardIndex=function(e,t,n,r){if(null!=e&&null!=t){if(0===e.length&&0===t.length)return 0;n=null==n?0:n;var o=intersection(e,t,r).length;return(o+n)/(e.getWithoutRepetitions().length+t.getWithoutRepetitions().length-o)}},jaccardDistance=function(e,t){return 1-jaccardIndex(e,t)},filterList=function(e,t="=c",n,r,o,i){if(null==e)return;"="==t&&(t="=="),null==r&&(r=e),!0===i&&(i=1);let s,l=e.length;if(2==i){var a=new L;switch(t){case"==":for(s=0;s<l;s++)a.push(r[s]===n);break;case"<":for(s=0;s<l;s++)a.push(r[s]<n);break;case"<=":for(s=0;s<l;s++)a.push(r[s]<=n);break;case">":for(s=0;s<l;s++)a.push(r[s]>n);break;case">=":for(s=0;s<l;s++)a.push(r[s]>=n);break;case"!=":for(s=0;s<l;s++)a.push(r[s]!==n);break;case"contains":for(s=0;s<l;s++)a.push(r[s].includes(n));break;case"between":for(s=0;s<l;s++)a.push(r[s]>=n&&r[s]<=o);break;case"init":for(s=0;s<l;s++)a.push(0===r[s].indexOf(n));break;case"property value":for(s=0;s<l;s++)a.push(r[s][n]==o)}return a}var u=new L;let h=1==i?createSortedNumberList(e.length):e;switch(t){case"==":for(s=0;s<l;s++)r[s]==n&&u.push(h[s]);break;case"<":for(s=0;s<l;s++)r[s]<n&&u.push(h[s]);break;case"<=":for(s=0;s<l;s++)r[s]<=n&&u.push(h[s]);break;case">":for(s=0;s<l;s++)r[s]>n&&u.push(h[s]);break;case">=":for(s=0;s<l;s++)r[s]>=n&&u.push(h[s]);break;case"!=":for(s=0;s<l;s++)r[s]!=n&&u.push(h[s]);break;case"contains":for(s=0;s<l;s++)r[s].includes(n)&&u.push(h[s]);break;case"between":for(s=0;s<l;s++)r[s]>=n&&r[s]<=o&&u.push(h[s]);break;case"init":for(s=0;s<l;s++)0===r[s].indexOf(n)&&u.push(h[s]);break;case"property value":for(s=0;s<l;s++)r[s][n]==o&&u.push(h[s])}return u.downcast()},mapWithFunction=function(e,t,n,r,o,i,s,l,a,u){if(null==e||null==t)return;null==u&&(u=!0),"string"==typeof t&&(u=!1,t=stringToFunction(t));var h=new L;let c,f=e.length;if(u)for(c=0;c<f;c++)h[c]=t.call(this,e[c],c,n,r,i,s,l,a);else for(c=0;c<f;c++){var p=[e[c]];null!=n&&(p[1]=n),null!=r&&(p[2]=r),null!=i&&(p[3]=i),null!=s&&(p[4]=s),null!=l&&(p[5]=l),null!=a&&(p[6]=a),h[c]=t.apply(this,p)}return h.name=o,h.downcast()},mapFunctionsOnList=function(e,t,n,r){if(null==e||null==t)return;var o=new L;let i=Math.min(e.length,t.length);for(var s=0;s<i;s++){var l=t[s];"string"==typeof l&&(l=stringToFunction(l));var a=[e[s]];null!=n&&(a[1]=n),null!=r&&(a[2]=r),o[s]=l.apply(this,a)}return o.downcast()},aggregateList=function(e,t,n,r,o,i){if(null==e||null==t)return null;let s=new T;if(null!=n&&"string"==_typeOf(n)&&(n=ListOperators._aggregationDictionary[n]),18==n&&null==o)throw Error("weightList must be defined to aggregate to a weighted average.");if(null==(r=e.indexesTable)&&(r=getIndexesTable(e),e.indexesTable=r),11==n)return r;if(s[0]=r[0],0===n&&e==t)return s[1]=r[0],s;var l;let a;n=null==n?0:n;let u,h,c,f,p,g=r[1].length;switch(n){case 0:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(t[u[0]]);return s[1]=s[1].downcast(),s;case 1:for(s[1]=new nL,f=0;f<g;f++)u=r[1][f],s[1].push(u.length);return s;case 2:case 3:case 18:case 19:var d,m,y;for(s[1]=new nL,f=0;f<g;f++){u=r[1][f],d=0,m=0,y=0;var x=new nL;for(p=0;p<u.length;p++)h=u[p],d+=t[h],19==n&&x.push(t[h]),18==n&&(m+=t[h]*o[h],y+=o[h]);3==n?d/=u.length:18==n&&(d=0==y?0:m/y),19==n&&(d=x.getMedian()),2!=n||Number.isInteger(d)||(d=Number(parseFloat(d).toPrecision(12))),s[1].push(d)}return s;case 4:var w;for(s[1]=new nL,f=0;f<g;f++){for(u=r[1][f],w=99999999999,p=0;p<u.length;p++)h=u[p],w=Math.min(w,t[h]);s[1].push(w)}return s;case 5:var v;for(s[1]=new nL,f=0;f<g;f++){for(u=r[1][f],v=-99999999999,p=0;p<u.length;p++)h=u[p],v=Math.max(v,t[h]);s[1].push(v)}return s;case 6:var b;for(s=aggregateList(e,t,3,r),f=0;f<g;f++){for(u=r[1][f],d=0,b=s[1][f],p=0;p<u.length;p++)h=u[p],d+=Math.pow(t[h]-b,2);s[1][f]=Math.sqrt(d/u.length)}return s;case 16:case 7:for(s[1]=new T,f=0;f<g;f++){for(u=r[1][f],l=new L,p=0;p<u.length;p++)h=u[p],null!=t[h]&&l.push(t[h]);l=l.downcast(),16==n&&(l=l.getFrequenciesTable(!0)),s[1].push(l)}return 16==n?s:s.downcast();case 8:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(t[u[u.length-1]]);return s[1]=s[1].downcast(),s;case 9:for(s[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getMode());return s[1]=s[1].downcast(),s;case 10:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(t[u[Math.floor(Math.random()*u.length)]]);return s[1]=s[1].downcast(),s;case 11:case 16:break;case 12:for(s[1]=new nL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions().length);return s;case 13:for(s[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions());return s[1]=s[1].downcast(),s;case 14:case 17:var _=14==n?", ":"";for(s[1]=new sL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.join(_));return s;case 15:for(s[1]=new sL,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions().join(", "));return s;case 20:for(s[1]=new L,a=aggregateList(e,t,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(i(c));return s[1]=s[1].downcast(),s}return null},subCategoricalAnalysis=function(e,t){if(null==e||null==t)return;var n={};let r,o,i,s=!0;for(i=0;null!=e[i];i++)if(r=e[i],o=n[r],null==o)n[r]=t[i];else if(o!=t[i]){s=!1;break}n={};let l=!0;for(i=0;null!=t[i];i++)if(r=t[i],o=n[r],null==o)n[r]=e[i];else if(o!=e[i]){l=!1;break}return l&&s?1:s?2:l?3:0},getListEntropy=function(e,t,n,r){if(null==e)return;if(e.length<2)return 1==e.length?(e._mostRepresentedValue=e[0],e._biggestProbability=1,null!=t&&(e._P_valueFollowing=e[0]==t?1:0)):null!=t&&(e._P_valueFollowing=0),0;null!=e.infoObject&&(n=e.infoObject.frequenciesTable),null==n&&(n=e.getFrequenciesTable(!0)),e._mostRepresentedValue=n[0][0];let o=e.length;if(e._biggestProbability=n[1][0]/o,1==n[0].length)return e._P_valueFollowing=e[0]==t?1:0,0;let i=0;var s=Math.log(n[0].length);let l,a,u=n[1].length;for(l=0;l<u;l++)a=n[1][l],i-=a/o*Math.log(a/o);if(r>0&&(i*=1/s),2==r){var h=function(e,t){if(1==e)return 0;if(e==t)return 1;var n=t-(e-1);return(1/t*-(e-1)*Math.log(1/t)-n/t*1*Math.log(n/t))/Math.log(e)}(u,e.length);h<1&&(i=(i-h)/(1-h))}if(null!=t){var c=n[0].indexOf(t);e._P_valueFollowing=-1==c?0:n[1][c]/o}return i},getListDiversity=function(e,t,n){if(!((t=null==t?0:t)<0||t>2||null==e)){if(e.length<2)return 0;if(!e.isList){if(!Array.isArray(e))return;e=L.toL(e)}switch(null!=e.infoObject&&(n=e.infoObject.frequenciesTable),null==n&&(n=e.getFrequenciesTable()),t){case 0:for(var r=0,o=e.length*(e.length-1),i=0;i<n[1].length;i++)r+=n[1][i]*(n[1][i]-1);return 1-r/o;case 1:return n[0].length/e.length;case 2:return getListEntropy(e,null,null,1)*n[0].length/e.length}}},getInformationGain=function(e,t,n){if(null==e||null==t||e.length!=t.length)return null;var r=null==t.infoObject?getListEntropy(t):t.infoObject.entropy;let o,i,s=r,l={},a=new T,u=e.length;for(o=0;o<u;o++)i=e[o],null==l[i]&&(l[i]=new L,a.push(l[i])),l[i].push(t[o]);u=a.length;let h=t.length;var c;let f=0;for(o=0;o<u;o++)c=null==a[o].infoObject?getListEntropy(a[o]):a[o].infoObject.entropy,f+=a[o].length/h*c;return s=r-f,n&&(s/=r),s},groupElementsByPropertyValue=function(e,t,n,r,o){if(!e)return;null==r&&(r=0);let i,s,l,a,u,h={},c=new T;for(u=0;u<e.length;u++)s=e[u],i=null==t?s:s[t],void 0===h[i]&&(h[i]=new L,h[i].name=i,h[i].valProperty=i,c.push(h[i])),0===r?h[i].push(s):1==r&&h[i].push(u),(void 0===l||i<l)&&(l=i),(void 0===a||i>a)&&(a=i);if(o){for(u=l;u<a;u++)void 0===h[u]&&(h[u]=new L,h[u].name=u,h[u].valProperty=u,c.push(h[u]))}return n&&(c=c.getSortedByProperty("name")),c},repeatElements=function(e,t){if(!e||!t)return;let n=instanceSameType(e);n.name=e.name;for(var r=0;r<e.length;r++)for(var o=0;o<t[r%t.length];o++)n.push(e[r]);return n},_isCategorical=function(e,t){return t>1&&t<e.length&&(e.length<=20||t/e.length<.8)},buildInformationObjectForList=function(e,t){if(null==e)return;if(1==(t=null==t||t)&&null!=e.infoObject)return e.infoObject;let n,r,o=e.length;var i={isInfoObject:!0,type:e.type,name:e.name,length:o};if(i.frequenciesTable=e.getFrequenciesTable(!0,!0,!0),i.numberDifferentElements=i.frequenciesTable[0].length,i.mostFrequentElement=i.frequenciesTable[0][0],i.isNumeric="nL"==e.type,i.isCategorical=_isCategorical(e,i.numberDifferentElements),i.isLongTexts=!1,i.isDefault=!1,i.isNumericCategorical=i.isNumeric&&i.isCategorical,i.isUnique=i.numberDifferentElements==e.length,i.containsNulls=i.frequenciesTable[0].includes(null)||i.frequenciesTable[0].includes(void 0),i.containsNullsOrEqual=i.containsNulls||i.frequenciesTable[0].includes("")||i.frequenciesTable[0].includes("null"),i.isLongitude=!1,i.isLatitude=!1,i.isSmall=e.length<=100,"nL"==e.type){var s=999999999999,l=-999999999999,a=0,u=0,h=new nL,c=0,f=0,p=-999999999999,g=Math.max(Math.floor(e.length/50),1),d=!0;for(n=0;n<o;n++)r=e[n],s=Math.min(s,r),l=Math.max(l,r),a+=r,f+=r,r%1!=0&&(d=!1),++c==g&&(f/=c,p=Math.max(p,f),h.push(f),f=0,c=0);0!==c&&(f/=c,p=Math.max(p,f),h.push(f)),h=h.factor(1/p);var m=a;for(a/=e.length,n=0;n<o;n++)u+=Math.pow(e[n]-a,2);if(i.min=s,i.max=l,i.average=a,i.sum=m,i.standardDeviation=Math.sqrt(u/o),i.allIntegers=d,i.kind=d?"integer numbers":"numbers",i.allPositive=i.min>=0,i.allNegative=i.min<0,i.histogram=rangeCounts(e,50),e.name){var y=e.name.toLowerCase().trim();i.min>=-90&&i.max<=90&&("lat"==y||"lat."==y||y.match(/latitud.*/i))&&(i.isLatitude=!0),i.min>=-180&&i.max<=180&&("lon"==y||"lon."==y||"long"==y||y.match(/longitud.*/i)||"long."==y||"lng"==y)&&(i.isLongitude=!0)}}if("nL"!=e.type||i.allIntegers){if(i.categoricalColors=i.frequenciesTable[3],"sL"==e.type){var x=e.getLengths();for(i.averageTextLengths=0,i.minTextLength=999999999999999,i.maxTextLength=0,n=0;n<o;n++)i.averageTextLengths+=x[n],x[n]>i.maxTextLength&&(i.maxTextLength=x[n]),x[n]<i.minTextLength&&(i.minTextLength=x[n]);i.averageTextLengths=Number(numberToString(i.averageTextLengths/o,i.averageTextLengths/o<10?1:0)),i.averageTextLengths>40&&(i.isLongTexts=!0)}if(i.isLatitude||i.isLongitude)i.kind="geo coordinate";else if("sL"!=e.type||i.isCategorical)if("sL"!=e.type||i.isCategorical)if("L"==e.type){var w=0;for(n=0;n<i.frequenciesTable[0].length;n++)r=i.frequenciesTable[0][n],(isNaN(parseFloat(r))||!isFinite(r)||Math.floor(r)==r&&r<1e3)&&w++;i.isCategorical&&w/i.numberDifferentElements>.8?i.kind="categories":i.kind="strings"}else"nL"!=e.type?i.kind="categories":"nL"==e.type&&(i.kind="integer numbers",i.numberDifferentElements/e.length<=.2&&i.numberDifferentElements<=30&&(i.kind="categories"));else i.kind="strings";else i.kind="strings"}return i.entropy=i.numberDifferentElements==e.length?1:1==i.numberDifferentElements?0:getListEntropy(e,null,i.frequenciesTable),i.isLabel="sL"!=e.type&&i.isUnique&&i.maxTextLength<100,i.isDefault=!i.isNumeric&&!i.isCategorical&&!i.isLongTexts,e.infoObject=i,i},kCombinations=function(e,t){if(null==e||null==t)return;var n=new T;let r,o,i,s;if(t>e.length||t<=0)return n;if(t==e.length)return n.push(e.clone()),n;if(1==t){for(r=0;r<e.length;r++)n.push(new L(e[r]).downcast());return n}for(r=0;r<e.length-t+1;r++)for(i=e.slice(r,r+1),s=n(L.toL(e.slice(r+1)).downcast(),t-1),o=0;o<s.length;o++)n.push(L.toL(i.concat(s[o])).downcast());return n.downcast()},allSubLists=function(e,t){if(null==e)return null;var n=new T;let r;for(t&&n.push(new L),r=1;r<=e.length;r++)n=T.toL(n.concat(kCombinations(e,r)));return n.downcast()},crossCombineLists=function(e,t,n){if(null==e||null==t)return null;let r,o;n=null==n?" ":n;let i=new sL;for(r=0;r<e.length;r++)for(o=0;o<t.length;o++)i.push(e[r]+n+t[o]);return i},characterizeList=function(e,t,n){if(null==e)return null;if(!e.isList)throw new Error("first inlet must be a list");if(e.isTable){var r=new sL;for(let o=0;o<e.length;o++)r.push(characterizeList(e[o],t,n));return r}if(0==e.length)return"";if(null==e.infoObject&&buildInformationObjectForList(e),t=null==t?0:t,n=null!=n&&n,isNaN(t)||t%1!=0||t<0||t>14)throw new Error("Mode must be an integer between 0 and 14");if([1,2,3,4,9,10].includes(t)&&"nL"!=e.type)throw new Error("This mode only applicable for nL input");var o,i,s,l,a;switch(t){case 0:o=e[0]+(n?"(first)":"");break;case 1:o=e.getSum()+(n?"(sum)":"");break;case 2:var u=getDecimalsInterval(e);o=numberToString(e.infoObject.average,u.y+1)+(n?"(avg)":"");break;case 3:o=e.infoObject.min+(n?"(min)":"");break;case 4:o=e.infoObject.max+(n?"(max)":"");break;case 5:o="sL"!=e.type?e.toStringList().join(", ")+(n?"(all)":""):e.join(", ")+(n?"(all)":"");break;case 6:o=e.infoObject.mostFrequentElement+(n?"(common)":"");break;case 7:o=e.infoObject.numberDifferentElements+(n?"(unique count)":"");break;case 8:o="sL"!=(s=e.infoObject.frequenciesTable[0]).type?s.toStringList().join(",")+(n?"(unique)":""):s.join(", ")+(n?"(unique)":"");break;case 9:o=e.infoObject.min+"-"+e.infoObject.max+(n?"(range)":"");break;case 10:o=e.getMedian()+(n?"(median)":"");break;case 11:for(o="",i=0;i<3&&i<e.length;i++)""!=o&&(o+=", "),o+=String(e[i]);e.length>3&&(o+=", + "+(e.length-3)+" more"),n&&(o+="(short list)");break;case 12:l=e.infoObject.frequenciesTable;var h=0;for(o="",i=0;i<l[0].length;i++)i<5?(""!=o&&(o+=", "),o+=String(l[0][i])+":"+l[1][i]):h+=l[1][i];h>0&&(o+=", Other:"+h),o+=n?"(frequency)":"";break;case 13:for(s="sL"==e.type?e:e.toStringList(),l=(s=getWords(s.join(" "),!1,!0,null,null,null,2)).getFrequenciesTable(!0,!0),o="",i=0;i<5&&i<l[0].length;i++)""!=o&&(o+=", "),a=(a=(100*l[2][i]).toPrecision(2)).includes("e")?parseFloat(a):a,o+=String(l[0][i])+":"+a;o+=n?"(word rate)":"";case 14:o=e.name&&""!=e.name?e.name+": ":"","sL"!=e.type?o+=e.toStringList().getSubList(0,5).join(", ")+(n?"(name:5)":""):o+=e.getSubList(0,5).join(", ")+(n?"(name:5)":"")}return o=o.replace(/\n/g," ")},createDefaultCategoricalColorList=function(e,t,n,r=!1){let o=createCategoricalColors(2,e,null,null,null,null,null,r);return null!=t&&t<=1&&(o=o.addAlpha(t)),n&&(o=o.getInverted()),o},colorsForCategoricalList=function(e,t,n){if(null!=e){if(n){var r=new cL;r.name=e.name+" colors";for(var o=0;o<e.length;o++)r[o]=stringToColor(String(e[o]));return r}return createCategoricalColorListForList(e,t)[0].value}},createCategoricalColorListForList=function(e,t,n,r,o,i,s){if(null==e)return null;o=null==o?0:o;let l,a=e.getWithoutRepetitions();l=t&&o>0?t.getInterpolated(r,o):createCategoricalColors(2,a.length,null,n,r,o,t,s),null!=n&&n<=1&&(l=l.addAlpha(n)),i&&(l=l.getInverted());var u=T.toL([a,l]);let h=buildDictionaryObjectForDictionary(u);var c=mapWithTable(e,u,"black");return[{value:c=cL.toL(c),type:"cL"},{value:a,type:a.type},{value:l,type:"cL"},{value:u,type:"T"},{value:h,type:"Object"}]},createColorListFromColorScale=function(e,t,n){if(null==e)return;var r;n=null==n?0:n,t=null==t?grayToOrange:t;let o=new cL;switch(n){case 0:for(r=0;r<e;r++)o[r]=t(r/(e-1));break;case 1:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),2));break;case 2:for(r=0;r<e;r++)o[r]=t(Math.sqrt(r/(e-1)));break;case 3:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),4));break;case 4:for(r=0;r<e;r++)o[r]=t(Math.pow(r/(e-1),.25))}return o},createColorListFromNumberList=function(e,t,n){if(null==e)return null;n=null==n?0:n,t=null==t?grayToOrange:t;var r=new cL;let o,i,s=e.length;switch(n){case 0:o=normalizeToMax(e);break;case 1:break;case 2:o=e}for(i=0;i<s;i++)r[i]=t(o[i]);return r},createSymmetricalColorListFromNumberList=function(e,t,n,r,o,i){if(null==e)return;let s=null==i?e.getInterval():i,l=Math.max(Math.abs(s.x),Math.abs(s.y));n=null==n?"gray":n,r=null==r?"blue":r;var a=colorStringToRGB(t=null==t?"red":t);let u=colorStringToRGB(n),h=colorStringToRGB(r);var c=new cL;let f;for(var p=0;p<e.length;p++)f=Math.abs(e[p])/l,o>0&&(f=Math.sqrt(f)),o>1&&(f=Math.sqrt(f)),null!=i&&e[p]<i.x?c[p]=t:null!=i&&e[p]>i.y?c[p]=r:c[p]=RGBArrayToString(e[p]<0?interpolateColorsRGB(u,a,f):interpolateColorsRGB(u,h,f));return c},createColorListWithSingleColor=function(e,t){let n=new cL;for(var r=0;r<e;r++)n.push(t);return n},createColorListBetweenTwoColors=function(e,t,n){if(e=null==e?8:e,null==t||null==n)return;let r=new cL;for(var o=0;o<e;o++){var i=1==e?t:interpolateColors(t,n,o/(e-1),!0);r.push(i)}return r},createColorListSpectrum=function(e,t,n){e=null==e?8:e,t=null==t?1:t,n=null==n?1:n;let r,o=new cL;for(var i=0;i<e;i++)r=360*i/e,o.push(HSVtoHEX(r,t,n));return o},stringsToColors=function(e,t){if(null!=e){null!=t&&t.isTable&&(t=buildDictionaryObjectForDictionary(t));for(var n=new cL,r=0;r<e.length;r++)n[r]=t?t[String(e[r])]:null,null==n[r]&&(n[r]=stringToColor(String(e[r])));return n}},createCategoricalColors=function(e,t,n,r,o,i=.5,s,l){let a,u;n=null==n?temperature:n;let h=new cL;switch(e){case 0:for(a=0;a<t;a++)h[a]=n(a/(t-1));break;case 1:var c=createRandomNumbers(t,null,0);for(a=0;a<t;a++)h[a]=n(c[a]);break;case 2:var f;for(s=null==s?_HARDCODED_CATEGORICAL_COLORS:s,a=0;a<t;a++)if(h[a]=s[a%s.length],l&&a>=s.length)for(f=Math.floor(a/s.length),u=0;u<f;u++)h[a]=interpolateColors(h[a],"black",.2);break;case 3:h=createColorListSpectrum(t);break;case 4:case 5:var p,g,d=createRandomNumbers(1001,null,0),m=createSortedNumberList(t),y=createRandomNumbers(t,null,0),x=sortListByNumberList(m,y),w=Math.floor(2*t)+100,L=Math.floor(.6*t)+5,v=4==e,b=4==e,T=_evaluationFunction(x,v,b),_=x,M=0;for(a=0;a<w;a++){for(u=0;u<L;u++)p=_sortingVariation(x,d[M],d[M+1]),M=(M+2)%1001,(g=_evaluationFunction(p,v,b))>T&&(_=p,T=g);x=_}if(4==e){var S=createColorListSpectrum(t);for(a=0;a<t;a++)h.push(S[x[a]])}else for(a=0;a<t;a++)h.push(n(1/t+x[a]/(t+1)))}return i>0&&null!=o&&(h=h.getInterpolated(o,i)),null!=r&&(h=h.addAlpha(r)),h},_sortingVariation=function(e,t,n){let r=e.clone(),o=Math.floor(t*r.length),i=Math.floor(n*r.length),s=r[i];return r[i]=r[o],r[o]=s,r},_evaluationFunction=function(e,t,n){let r,o,i,s=0,l=e.length,a=Math.floor(l/2),u=n?4:1;for(var h=1;h<=u;h++)for(i=h*h,r=0;null!=e[r+h];r++)o=Math.abs(e[r+h]-e[r]),t&&o>a&&(o=l-o),s+=Math.sqrt(o/i);return s},createCategoricalColorListDictionaryObject=function(e,t,n,r,o,i){if(null!=e){if(e.isTable){var s,l,a,u,h,c,f=e,p=null==t?_HARDCODED_CATEGORICAL_COLORS:t;for(l=p.clone(),u={},s=0;s<f.length;s++)(c=buildInformationObjectForList(f[s])).isCategorical&&((h=c.numberDifferentElements)>=p.length?a=createCategoricalColorListDictionaryObject(f[s],p,n,r,o,i):(h>l.length&&(l=p.clone()),a=createCategoricalColorListDictionaryObject(f[s],l,n,r,o,i),l=l.getSubList(h,l.length-1)),u=Object.assign(u,a));return u}var g=e.getWithoutRepetitions(),d=createCategoricalColors(2,g.length,null,n,r,o,t);i&&(d=d.getInverted());var m={},y=d.length;for(s=0;s<y;s++)m[g[s]]=d[s];return m}},stringToDate=function(e,t,n){if(null==e)return null;if(n=null==n?"-":n,t=null==t?1:t,t=Number(t),"sL"==e.type||"Array"==_typeOf(e)){var r,o=new dL;for(o.name=e.name,r=0;r<e.length;r++)o.push(stringToDate(e[r],t,n));return o}if(e=String(e),1==t)return"-"!=n&&(e=e.replace(new RegExp(n,"g"),"-")),-1==e.indexOf(".")?parseDate(e):new Date(e);var i;let s=e.split(n);switch(t){case 0:return new Date(Number(s[2]),Number(s[0])-1,Number(s[1]));case 1:return new Date(e);case 2:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[0])-1,Number(s[1]));case 3:return i=(i=Number(s[0]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[2]));case 4:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[0]));case 5:return i=Number(s[2]),new Date(i,Number(s[1])-1,Number(s[0]));case 6:i=Number(e.substr(0,4));var l=Number(e.substr(4,2)),a=Number(e.substr(6,2));return new Date(i,l-1,a)}},dateToString=function(e,t,n){if(null==e)return null;if("dL"==e.type||"Array"==_typeOf(e)){var r,o=new sL;for(o.name=e.name,r=0;r<e.length;r++)o.push(dateToString(e[r],t,n));return o}n=null==n?"-":n,t=null==t?0:t,"string"==typeof e&&(e=new Date(e));let i=e.getFullYear(),s=String(i).substr(2),l=e.getMonth()+1,a=e.getDate();switch(t){case 0:return l+n+a+n+i;case 1:return i+n+l+n+a;case 2:return l+n+a+n+s;case 3:return s+n+l+n+a;case 4:return i+n+l+n+a+" "+(h=e.getHours())+":"+(c=(c=e.getMinutes())<10?"0"+c:c)+":"+(f=(f=e.getSeconds())<10?"0"+f:f);case 5:return a+" "+DateOperators_MONTH_NAMES[l-1]+" "+i;case 6:return u=0==(u=e.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u]+", "+a+" "+DateOperators_MONTH_NAMES[l-1]+" "+i;case 7:return DateOperators_MONTH_NAMES[l-1];case 8:var u;return u=0==(u=e.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u];case 9:return i+n+(l<10?"0"+l:l)+n+(a<10?"0"+a:a);case 10:var h,c,f;return(h=(h=e.getHours())<10?"0"+h:h)+":"+(c=(c=e.getMinutes())<10?"0"+c:c)+":"+(f=(f=e.getSeconds())<10?"0"+f:f);case 11:return(a<10?"0"+a:a)+n+(l<10?"0"+l:l)+n+i}},clearHoursMinutesSeconds=function(e){if(null==e)return null;let t=dateToString(e,1);return stringToDate(t,1)},currentDate=function(e){return new Date},addDaysToDate=function(e,t){if(null==e)return null;t=null==t?0:t,"string"==typeof e&&(e=parseDate(e));let n=new Date(e);return n.setDate(n.getDate()+t),n},addMillisecondsToDate=function(e,t){return new Date(e.getTime()+t)},parseDate=function(e){let t=(e=String(e)).match(/^(\d{4})[\-\.](\d{1,2})[\-\.](\d{1,2})$/);return t&&4==t.length?new Date(t[1],t[2]-1,t[3]):new Date(Date.parse(e))},parseDates=function(e){let t,n=new dL;for(t=0;null!=e[t];t++)n.push(this.parseDate(e[t]));return n},hoursBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToHours},daysBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToDays},weeksBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToWeeks},yearsBetweenDates=function(e,t){return(t.getTime()-e.getTime())*DateOperators_millisecondsToYears},nDayInYear=function(e){return Math.floor((e.getTime()-new Date(e.getFullYear(),0,1).getTime())*DateOperators_millisecondsToDays)},getDateDaysAgo=function(e){return addDaysToDate(new Date,-e)},getWeekInYear=function(e){if(null==e)return null;let t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},getNDaysInMonth=function(e,t){return new Date(t,e,0).getDate()},getDecimalDate=function(e){let t;if(null==e)return null;if("string"==typeof e){if(t=new Date(e),isNaN(t))throw new Error("Invalid format for date:"+e)}else t=e;var n=t.getFullYear();e=new Date(n,0,1);let r=new Date(n+1,0,1);return n+(t.getTime()-e.getTime())/(r.getTime()-e.getTime())},convertFromDecimalDate=function(e){if(null==e)return null;if("nL"==e.type){var t=new t;t.name=e.name;for(var n=0;n<e.length;n++)t.push(convertFromDecimalDate(e[n]));return t}let r=Math.floor(e),o=new Date(r,0,1),i=new Date(r+1,0,1),s=o.getTime()+(i.getTime()-o.getTime())*(e-r),l=new Date(Math.round(s));if(isNaN(l))throw new Error("Invalid decimal date value:"+e);return l},extractPropertiesFromDate=function(e,t){if(null==e)return null;if(t=null==t?0:t,isNaN(t)||t%1!=0||t<0||t>15)throw new Error("Invalid output type.");var n,r,o,i;switch(t){case 0:n=e.getFullYear();break;case 1:n=e.getMonth()+1;break;case 2:n=e.getDate();break;case 3:n=e.getDay();break;case 4:n=e.getHours();break;case 5:n=e.getMinutes();break;case 6:n=e.getSeconds();break;case 7:n=getDecimalDate(e);break;case 8:n=nDayInYear(e);break;case 9:r=getDecimalDate(e),n=Math.floor(4*(r-Math.floor(r)))+1;break;case 10:o=e.getHours()+(60*e.getMinutes()+e.getSeconds())/3600,n=Number(o.toFixed(5));break;case 11:for(n=[],i=0;i<7;i++)e.getDay()==i?n.push(1):n.push(0);break;case 12:for(n=[],i=0;i<12;i++)e.getMonth()==i?n.push(1):n.push(0);break;case 13:n=dateToString(e,8);break;case 14:n=dateToString(e,7);break;case 15:n=e.getHours()>=12?"pm":"am"}return n},StringListToNumberList=function(e){let t,n=new nL;for(n.name=e.name,t=0;null!=e[t];t++)n[t]=Number(e[t]);return n},toDateList=function(e,t,n){if(null==e)return;let r,o=new dL;o.name=e.name;let i=e.length;for(r=0;r<i;r++)o.push(stringToDate(e[r],t,n));return o},_y=function(e){return e.getFullYear()},_m=function(e){return e.getMonth()},_d=function(e){return e.getDate()-1},_h=function(e){return e.getHours()},_mn=function(e){return e.getMinutes()},_s=function(e){return e.getSeconds()},_ms=function(e){return e.getMilliseconds()},getDateLists=function(e){let t=new T;for(var n=0;n<e.length;n++)"dL"==e[n].type&&t.push(e[n]);return t},buildSummaryTableFromDates=function(e,t,n,r){if(null==e||"dL"!=e.type)return null;let o="Weekday by Hour Summary",i="Hour";1==(t=null==t?0:t)?(o="Month by Day Summary",i="Day"):2==t&&(o="Sequence",i="Date");let s=new T;null!=e.name?s.name=e.name+" "+o:s.name=o,s.push(new sL),s[0].name=i;let l,a,u,h,c,f,p=window&&window.navigator&&window.navigator.language?window.navigator.language:"en-US",g=new Date(2016,0,17,10,0,0,0);if(2==t){null!=r&&"dI"==r.type||(r=new dI(e.getMin(),e.getMax())),s.push(new u),s[1].name="Value";var d=daysBetweenDates(r.date0,r.date1);for(l=0;l<=d;l++)a=addDaysToDate(r.date0,l),s[0][l]=dateToString(a,1),s[1][l]=0;for(l=0;l<e.length;l++)h=Math.floor(daysBetweenDates(r.date0,e[l])),h<0||h>=s[1].length||(m?s[1][h]+=n[l]:s[1][h]++);return s}var m=n&&n.length==e.length;let y=0==t?7:12,x=0==t?1:30;for(l=0;l<y;l++)if(a=0==l?g:addDaysToDate(g,l*x),u=new u,u.name=a.toLocaleString(p,0==t?{weekday:"long"}:{month:"long"}),s.push(u),0==l)if(0==t)for(h=0;h<24;h++)s[0][h]=0==h?"Midnight":12==h?"Noon":String(h>12?h-12:h);else for(h=0;h<31;h++)s[0][h]=String(h+1);for(c=1;c<=y;c++)for(f=0;f<s[0].length;f++)s[c][f]=0;for(l=0;l<e.length;l++)0==t?(c=e[l].getDay(),f=e[l].getHours()):(c=e[l].getMonth(),f=e[l].getDate()-1),m?s[c+1][f]+=n[l]:s[c+1][f]++;return s},transformDateList=function(e,t,n,r){if(null==e)return null;if("sL"==e.type&&(e=toDateList(e)),null==t&&(t=nL.toL([0,1,2])),"nL"!=t.type&&!(t instanceof Array))throw new Error("Invalid input. Second argument must be a nL.");n=null==n?"":n;let o,i,s,l,a=["year","month","day of month","day of week","hour","minute","second","decimal date","day number of year","quarter","decimal hour","day","month","day name","month name","week number in year","day number"],u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];if("dL"==(r=null==r?"2000-01-01":r).type)r=r.getMin();else if("sL"==r.type)r=(r=toDateList(r)).getMin();else if("string"==typeof r)if("earliest"==r)r=e.getMin();else if(r=parseDate(r),isNaN(r))throw new Error("Invalid format for date:"+r);r=clearHoursMinutesSeconds(r),o=t.includes(13)||t.includes(14)?new T:new nT;for(var c=0;c<t.length;c++){var f=t[c];if(l=o.length,isNaN(f)||f%1!=0||f<0||f>16)throw new Error("Invalid output type.");if(11==f)for(i=0;i<7;i++)o.push(new nL),s=""==n?a[f]:n+" "+a[f],o[l+i].name=s+":"+u[i];else if(12==f)for(i=0;i<12;i++)o.push(new nL),s=""==n?a[f]:n+" "+a[f],o[l+i].name=s+":"+h[i];else 13==f||14==f?o.push(new sL):o.push(new nL),o[l].name=""==n?a[f]:n+" "+a[f];for(var p=0;p<e.length;p++){var g=e[p];switch(f){case 0:o[l].push(g.getFullYear());break;case 1:o[l].push(g.getMonth()+1);break;case 2:o[l].push(g.getDate());break;case 3:o[l].push(g.getDay());break;case 4:o[l].push(g.getHours());break;case 5:o[l].push(g.getMinutes());break;case 6:o[l].push(g.getSeconds());break;case 7:o[l].push(getDecimalDate(g));break;case 8:o[l].push(nDayInYear(g));break;case 9:var d=getDecimalDate(g);d=Math.floor(4*(d-Math.floor(d)))+1,o[l].push(d);break;case 10:var m=g.getHours()+(60*g.getMinutes()+g.getSeconds())/3600;m=Number(m.toFixed(5)),o[l].push(m);break;case 11:for(i=0;i<7;i++)g.getDay()==i?o[l+i].push(1):o[l+i].push(0);break;case 12:for(i=0;i<12;i++)g.getMonth()==i?o[l+i].push(1):o[l+i].push(0);break;case 13:o[l].push(dateToString(g,8));break;case 14:o[l].push(dateToString(g,7));break;case 15:o[l].push(getWeekInYear(g));break;case 16:o[l].push(Math.round(daysBetweenDates(r,clearHoursMinutesSeconds(g))))}}}return o},changeTimeResolution=function(e,t,n,r,o){if(null==e)return;if(n=null==n?100:n,r=null!=r&&r,o=null==o?0:o,(t=null==t?0:t)!=Math.floor(t)||t<0||t>9)throw new Error("Invalid mode value provided in changeTimeResolution");let i=e.type;if("sL"==e.type?e=toDateList(e):"nL"==e.type&&(e=convertFromDecimalDate(e)),"dL"!=e.type)throw new Error("changeTimeResolution input must be a dL, sL containing dates, or a nL of decimal dates");let s,l,a,u,h=encodeDatesAsNumericFeatures(e,[0,1,2,3,4,5,6,7]),c=h[7].getInterval(),f=convertFromDecimalDate(c.x),p=(convertFromDecimalDate(c.y).getTime()-f.getTime())/1e3,g=[315532800,31536e3,7862400,2678400,604800,86400,3600,60,1];if(0==t)for(t=9,t=9;t>=1;t--){if(r)l=changeTimeResolution(e,t).toNumberList().getWithoutRepetitions().length;else l=p/g[t-1];if(l<=n)break}t<1&&(t=1);let d=new dL;d.name=e.name;let m,y,x,w,L,v,b,_=new sL;_.name=null==e.name?"label":e.name+" label";let M=function(e){return e<10?"0"+e:""+e};for(s=0;s<e.length;s++){switch(m=h[0][s],y=h[1][s]-1,x=h[2][s],w=h[4][s],L=h[5][s],v=h[6][s],t){case 1:m=10*Math.floor(m/10),b=String(m),a=new Date(m,0);break;case 2:a=new Date(m,0),b=String(m);break;case 3:var S=" Q"+(Math.floor(y/3)+1);y=3*Math.floor(y/3),a=new Date(m,y),b=String(m)+S;break;case 4:a=new Date(m,y),b=String(m)+"-"+M(y+1)+"-01";break;case 5:u=new Date(m,y,x-h[3][s]),m=u.getFullYear(),y=u.getMonth(),x=u.getDate(),a=new Date(m,y,x),b=String(m)+"-"+M(y+1)+"-"+M(x);break;case 6:a=new Date(m,y,x),b=String(m)+"-"+M(y+1)+"-"+M(x);break;case 7:a=new Date(m,y,x,w),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":00:00";break;case 8:a=new Date(m,y,x,w,L),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":"+M(L)+":00";break;case 9:a=new Date(m,y,x,w,L,v),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":"+M(L)+":"+M(v)}d.push(a),_.push(b)}if("nL"==i?d=d.toNumberList():"sL"==i&&(d=dateToString(d,1)),0==o)return d;let N=new T;if(N.push(d),N.push(_),1==o)return N;l=p/g[t-1],l=Number.isInteger(l)?l+1:Math.ceil(l);var R={table:N,extra:{numPeriods:l,modeUsed:t,intervalDates:c}};return R.name=e.name+"("+t+")",R},getElementFromTable=function(e,t,n){return null==e[t]?null:e[t][n]},getSubTable=function(e,t,n,r,o){if(null==e)return e;var i=e.length;if(0===i)return null;let s=new T;r<=0&&(r=i-t+r),t=Math.min(t,i-1),r=Math.min(r,i-t);var l,a=e[0].length;if(0===a)return null;let u,h,c,f;for(o<=0&&(o=a-n+o),n=Math.min(n,a-1),o=Math.min(o,a-n),h=t;h<t+r;h++){for(l=e[h],u=new L,u.name=e[h].name,c=n;c<n+o;c++)f=l[c],u.push(f);s.push(u.downcast())}return s.downcast()},sliceColumns=function(e,t,n){return"string"==typeof t&&(t=e.getNames().indexOf(t)),null!=n&&"string"==typeof n&&(n=e.getNames().indexOf(n)),e.getSubList(t,n)},filterTable=function(e,t,n,r,o,i,s,l,a){if(null==e||0===e.length||null==e[0])return;if(e.isList&&!e.isTable){var u=new T;u.push(e),e=u}if(a)return e.getElements(filterList(e.getNames(),t,n,r,o,!0));if(void 0===t&&void 0===n)return s?createSortedNumberList(e[0].length):e;if("!contains"===t&&(void 0===n||""===n))return s?createSortedNumberList(e[0].length):e;null==t&&(t="=c"),"="==t&&(t="=="),t=t.toLowerCase();var h=new nL;let c,f,p,g,d,m,y=e.getLengths().getMax(),x=0,w=e.length,L=_typeOf(n),v=null!=r&&!0===r.isList;if(null!=n&&1==n.isList&&n.length>0){var b;l=null==l?0:l,h=filterTable(e,t,n[0],r,o,i,!0);for(var _=1;_<n.length;_++)p=n[_],b=filterTable(e,t,p,r,o,i,!0),h=1==l?intersection(h,b):union(h,b);return s?h:e.getRows(h)}if(v&&r.length!=y)throw new Error("selected L (in listToCheck position) must have same length as table");if(null!=r&&("string"==typeof r&&(r=e.getNames().indexOf(r)),-1==r))throw new Error("do not find any list with such name");null==n?(L="Null",n=""):"string"==L&&String(n)==String(Number(n))&&""!==n.trim()?(L="number",n=Number(n)):"boolean"==L&&(L="string",n=String(n)),"=c"==t&&(t="string"==L?"contains":"=="),"number"!=L||"between"!=t&&"!between"!=t||(isNaN(o)?t="noop":o=Number(o)),"between"!=t&&"!between"!=t||null!=o||(t="noop"),"fuzzy"!=t&&"fuzzywords"!=t||null!=o||(o=50),null!=r&&(x=r,w=r+1),v&&(x=0,w=1),(null==i||!0!==i&&!1!==i)&&(i=!0),"string"==L&&i&&(n=n.toLowerCase(),o=o?String(o).toLowerCase():o),"=="==t&&i&&(t="==i"),"!="==t&&i&&(t="!=i");var M=String(n);null==o||String(o);var S="string"==L;let N="number"==L;var R;switch(t){case"==":for(c=0;c<y;c++)for(f=x;f<w;f++)if(!("nL"==(R=v?r:e[f]).type&&S||"sL"==R.type&&N)&&(g=R[c],null==g&&(g=""),g==n)){h.push(c);break}break;case"==i":for(c=0;c<y;c++)for(f=x;f<w;f++)if(("nL"!=(R=v?r:e[f]).type||!S)&&(p=null==R[c]?"":R[c],p="sL"==R.type?p:String(p),p=i?p.toLowerCase():p,p==n)){h.push(c);break}break;case"!=":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:e[f][c],null==g&&(g=""),g==n){d=!1;break}d&&h.push(c)}break;case"!=i":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:e[f][c],p=null==g?"":String(g).toLowerCase(),p==n){d=!1;break}d&&h.push(c)}break;case"contains":for(c=0;c<y;c++)for(f=x;f<w;f++)if(("nL"!=(R=v?r:e[f]).type||!S)&&(p="sL"==R.type?R[c]:String(R[c]),p=i?p.toLowerCase():p,p.includes(M))){h.push(c);break}break;case"!contains":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:e[f][c],p=i?String(g).toLowerCase():String(g),p.includes(M)){d=!1;break}d&&h.push(c)}break;case"init":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:e[f][c],p=i?String(g).toLowerCase():String(g),0===p.indexOf(M)){h.push(c);break}break;case"<":case"<=":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:e[f][c],L==_typeOf(g)){if(p="string"==L?i?String(g).toLowerCase():String(g):Number(g),p<n){h.push(c);break}if(p==n&&"<="==t){h.push(c);break}}break;case">":case">=":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:e[f][c],L==_typeOf(g)){if(p="string"==L?i?String(g).toLowerCase():String(g):Number(g),p>n){h.push(c);break}if(p==n&&">="==t){h.push(c);break}}break;case"between":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:e[f][c],p="string"==L?i?String(g).toLowerCase():String(g):Number(g),"number"==L&&(p=Number(p)),n<=p&&p<=o){h.push(c);break}break;case"!between":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:e[f][c],p="string"==L?i?String(g).toLowerCase():String(g):Number(g),"number"==L&&(p=Number(p)),n>p||p>o){h.push(c);break}break;case"unique":var E={};for(c=0;c<y;c++){var O="";for(f=x;f<w;f++)g=v?r[c]:e[f][c],p=i?String(g).toLowerCase():String(g),O=O+"|"+p;null==E[O]&&(E[O]=!0,h.push(c))}break;case"fuzzy":case"fuzzywords":if(""==(n=String(n).trim()))break;o=Number(o);var C,D,P,I=new nT(2);for(c=0;c<y;c++)for(f=x;f<w;f++){for(g=v?r[c]:e[f][c],p=i?String(g).toLowerCase():String(g),C="fuzzywords"==t?p.split(" "):[p],D=0,P=0;P<C.length&&D<o;P++)m=100*(1-getLevenshteinDistance(C[P],n,!0)),D=Math.max(D,m);if(D>=o){I[0].push(c),I[1].push(D);break}}h=(I=I.sortRowsByList(1,!1,!0))[0];break;default:if("function"==typeof t)for(c=0;c<y;c++)for(f=x;f<w;f++)if(t.call(this,e[f][c],n,o,r,e,f,c,i)){h.push(c);break}}if(s)return h;var k=new T;k.name=e.name;let F=e.length;for(f=0;f<F;f++)k.push(e[f].getElements(h,!0));return k.downcast()},filterColumns=function(e,t,n,r,o,i){if(null==e)return;let s=new T;for(var l,a,u=0;u<e.length;u++)if(l=e[u],a=buildInformationObjectForList(l,!0),!(null!=t&&a.numberDifferentElements<t||null!=n&&a.numberDifferentElements/l.length>n||null!=r&&a.entropy<r||null!=o&&a.entropy>o)){switch(i){case 0:if(!a.isNumeric)continue;break;case 1:if("sL"!=l.type)continue;break;case 2:if(!a.isCategorical)continue;break;case 3:if("integer numbers"!=a.kind)continue;break;case 4:if(a.containsNulls)continue;break;case 5:if(l.includes("")||l.includes(" ")||l.includes("  "))continue;break;case 6:if("nL"!=l.type&&!a.isCategorical)continue}s.push(l)}return s.downcast()},getSubTableByElementOnList=function(e,t,n){if(null==e||null==t||null==n)return;var r,o;let i=e.length;t<0&&(t=i+t),t%=i;var s=instanceSameType(e);for(s.name=e.name,r=0;r<i;r++){var l=new L;l.name=e[r].name,s.push(l)}var a=e[t];let u,h=a.length;for(r=0;r<h;r++)if(n==a[r])for(u=s.length,o=0;o<u;o++)s[o].push(e[o][r]);for(i=s.length,r=0;r<i;r++)s[r]=s[r].downcast();return s.downcast()},getSubTableByElementsOnList=function(e,t,n){if(null!=e&&null!=t&&null!=n){var r,o;t<0&&(t=e.length+t),t%=e.length;var i=instanceSameType(e);i.name=e.name,e.forEach((function(e){var t=new L;t.name=e.name,i.push(t)}));var s=e[t],l=getBooleanDictionaryForList(n);for(r=0;null!=s[r];r++)if(l[s[r]])for(o=0;null!=i[o];o++)i[o].push(e[o][r]);return i.forEach((function(e,t){i[t]=e.downcast()})),i.downcast()}},getRandomRows=function(e,t,n,r,o){if(null==e||null==e[0])return null;if(n=null==n||n,null==t&&(t=.5),t<0)return null;let i,s=e[0].length;i=t<=1?Math.round(t*s):Math.round(t);let l=createSortedNumberList(s,0,1);return l=l.getRandomElements(i,n,o),r||(l=l.getSorted()),e.getRows(l)},transpose=function(e,t,n){return null!=e&&e.isTable?e.transpose(t,n):null},replaceElementInTable=function(e,t,n){if(null==e)return;var r=e.length;let o,i,s,l,a;var u=new T;for(i=0;i<r;i++){for(l=e[i],o=l.length,a=new L,u[i]=a,s=0;s<o;s++)a[s]=l[s]==t?n:l[s];a=a.downcast(),a.name=l.name}return u.downcast()},replaceSectionInTable=function(e,t,n,r,o,i){if(null==e)return;var s=null!=n&&n==r;let l,a,u,h=null!=o&&o==i;if(null==n&&(n=0),null==r&&(r=e.length-1),null==o&&(o=0),null==i&&(i=e[0].length-1),"string"!=typeof n&&"string"!=typeof r||(l=e.getNames()),"string"==typeof n&&(n=l.indexOf(n)),"string"==typeof r&&(r=l.indexOf(r)),s&&h)return t.isList&&(t=t[0]),t.isList&&(t=t[0]),replaceCellInTable(e,t,n,o);if(s){var c=new T;for(t.isTable&&(t=t[0]),a=0;a<e.length;a++)if(a==n){for(c[a]=new L,c[a].name=e[a].name,u=0;u<e[a].length;u++)c[a][u]=u<o||u>i?e[a][u]:t[u-o];c[a]=c[a].downcast()}else c[a]=e[a];return c.downcast()}if(h){for(c=new T,t.isTable&&(t=t.getRow(0)),a=0;a<e.length;a++)a<n||a>r?c[a]=e[a]:(c[a]=e[a].clone(),c[a][o]=t[a-n],c[a]=c[a].downcast());return c.downcast()}for(c=new T,r=Math.min(r,n+t.length),i=Math.min(i,o+t[0].length),a=0;a<e.length;a++)if(a<n||a>r)c[a]=e[a];else{for(c[a]=new L,c[a].name=e[a].name,u=0;u<e[a].length;u++)c[a][u]=u<o||u>i?e[a][u]:t[a-n][u-o];c[a]=c[a].downcast()}return c.downcast()},replaceNullsInTable=function(e,t,n,r,o,i){if(null==e)return;null!=r&&(t=null==t?0:t),null!=o&&(n=null==n?0:n),r=null==r&&null!=t?0:r,o=null==o&&null!=n?"-":o;var s=e.length;let l,a,u,h,c,f,p;var g=null!=t&&t.length&&t.isList?t:null;let d=null!=o&&o.length&&o.isList?o:null;var m=new T;if(g){s=Math.min(s,g.length);var y={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,element:0,previous:1,next:2,average:3,"local average":4,interpolate:5,common:6,median:7}}for(a=0;a<s;a++){for(h=e[a],l=h.length,f=!1,p=!1,u=0;u<l;u++)if(h[u]==i)p=!0;else if("number"!=typeof h[u]&&(f=!0,p))break;p?(c=g?replaceNullsInList(h,y[g[a]],d?d[a%s]:o,i):f?replaceNullsInList(h,3==n?6:n,o,i):replaceNullsInList(h,t,r,i),m[a]=c):m[a]=h}return m.downcast()},testClassificationModel=function(e,t,n,r){if(null==e||null==t||null==n)return null;r=r||0;var o=0;return t.forEach((function(t,r){n(e[0][r],e[1][r])!=t&&o++})),o/t.length},getRows=function(e,t){let n,r,o=new T;o.name=e.name;for(var i=0;null!=e[i];i++){n=e[i],r=instanceSameType(n),r.name=n.name;for(var s=0;null!=t[s];s++)r[s]=n[t[s]];o[i]=r.downcast()}return o},sortListsByNumberList=function(e,t,n){null==n&&(n=!0);var r=instantiate(_typeOf(e));r.name=e.name;let o,i=e.length,s=t.clone();for(o=0;o<s.length;o++)s[o]=o;for(s=sortListByNumberList(s,t,n),o=0;o<i;o++){r[o]=e[o].clone();for(var l=0;l<s.length;l++)r[o][l]=e[o][s[l]]}return r},aggregateTable=function(e,t,n,r,o,i,s,l){if(t=t||0,null==e)return;if(null==n&&(n=createSortedNumberList(e.length)),null==r&&(r=createListWithSameElement(e.length,9)),"sL"==n.type&&(n=e.getNames().indexesOfElements(n)),"nL"!=n.type&&Array.isArray(n)&&(n=nL.toL(n)),"string"==typeof t&&(t=e.getNames().indexOf(t)),!e.length||e.length<t||null==n||!n.length||null==r)return;if(null!=s&&3==s.length){var a;n=n.clone(),r=r.clone();for(var u=0;u<e.length;u++)n.includes(u)||(n.push(u),(a=buildInformationObjectForList(e[u])).isNumericCategorical?r.push(s[0]):a.isNumeric?r.push(s[1]):r.push(s[2]))}if(null!=t.length)if(t.length==e[0].length)y=t;else{if(0!=t.length){var h,c,f=e.getColumns(t),p=(f.getTypes(),new sL);for(_=f[0].length,u=0;u<_;u++){for(h=f[0][u],c=1;c<f.length;c++)h+="*__*"+f[c][u];p[u]=h}b=new T.toL([p].concat(e.getElements(n)));var g=new nL,d=new nL;g[0]=0,d[0]=0,null!=o&&(o=o.clone()).unshift("_");for(u=0;u<n.length;u++)g.push(n[u]+1),d.push(r[u]);var m=createSortedNumberList(b.length-1,1);return b=aggregateTable(b,0,m,d,o),b}t=t[0]}var y=null==y?e[t]:y;let x,w,L,v=getIndexesTable(y),b=new T,_=n.length;for(u=0;u<_;u++)L=n[u],w=e[L],x=aggregateList(y,w,u<r.length?r[u]:1,v,i,l)[1],o&&u<o.length?x.name=o[u]:x.name=w.name,b.push(x);return b.downcast()},disAggregateTable=function(e,t,n,r=","){if(null==e||null==n)return;"number"==typeof t&&(t=[t]);var o=null==t?e:e.getColumns(t);let i=e.get(n);var s=new L;s.name=i.name;let l=new T;for(var a=0;a<o.length;a++)l[a]=instanceSameType(o[a]),l[a].name=o[a].name;var u;for(l.push(s),a=0;a<o[0].length;a++){u=sL.toL(String(i[a]).split(r)).trim();for(var h=0;h<u.length;h++){for(var c=0;c<o.length;c++)l[c].push(o[c][a]);s.push(String(Number(u[h]))==u[h]?Number(u[h]):u[h])}}return s=s.downcast(),l},deSegmentTable=function(e,t,n){for(var r=normalizeToSum(t,(n=null==n?10:n)*t.length),o=new T,i=0;i<e.length;i++)o[i]=instanceSameType(e[i]),o[i].name=e[i].name;var s=new nL;o.push(s),s.name="weight per item";var l,a,u=new nL;o.push(u),u.name="count repetitions segment";for(var h=0;h<r.length;h++){l=Math.round(r[h]),a=t[h];for(var c=0;c<l;c++){for(i=0;i<e.length;i++)o[i].push(e[i][h]);s.push(a/l),u.push(l)}}return o},pivotTable=function(e,t,n,r,o,i,s,l,a){if(null==e||!e.length||null==t||null==n||null==r)return;let u=t.isList?t:e.get(t),h=n.isList?n:e.get(n);switch(r=r.isList?r:e.get(r),o=null==o?1:o,s=s||0,i){case 0:case 3:a=null;break;case 1:a=0}var c;let f,p;var g=new T;let d,m;if(1==s){var y={},x={};switch(u.forEach((function(e,t){c=h[t],f=String(e)+""+String(c),null==y[f]&&(y[f]=new nL,x[f]=new L),y[f].push(t),x[f].push(r[t])})),g[0]=new L,g[1]=new L,o){case 0:g[2]=new L;break;case 1:case 2:case 3:g[2]=new nL}for(f in y)switch(p=y[f],g[0].push(u[p[0]]),g[1].push(h[p[0]]),o){case 0:g[2].push(r[p[0]]);break;case 1:g[2].push(p.length);break;case 2:case 3:d=0,p.forEach((function(e){d+=r[e]})),3==o&&(d/=p.length),g[2].push(d)}if(g[0]=g[0].downcast(),g[1]=g[1].downcast(),0===o)g[2]=g[2].downcast();return g[0].name=u.name,g}g[0]=new L;var w={};let v={};var b,_;let M,S;u.forEach((function(e,t){if(c=h[t],M=r[t],null==(_=w[String(e)])&&(g[0].push(e),_=g[0].length-1,w[String(e)]=_),null==(b=v[String(c)])){switch(o){case 0:case 1:case 2:case 3:case 4:case 5:S=new L}g.push(S),S.name=String(c),b=g.length-1,v[String(c)]=b}switch(o){case 0:null==g[b][_]&&(g[b][_]=M);break;case 1:null==g[b][_]&&(g[b][_]=0),g[b][_]++;break;case 2:null==g[b][_]&&(g[b][_]=0),g[b][_]+=M;break;case 3:null==g[b][_]&&(g[b][_]=[0,0]),g[b][_][0]+=M,g[b][_][1]++;break;case 4:null==g[b][_]&&(g[b][_]=M),g[b][_]=Math.min(M,g[b][_]);break;case 5:null==g[b][_]&&(g[b][_]=M),g[b][_]=Math.max(M,g[b][_])}}));var N=!1;switch(o){case 0:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(e,t){null==g[m][t]&&(g[m][t]=a)})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0);break;case 1:case 2:case 4:case 5:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(e,t){null==g[m][t]&&(g[m][t]=a)})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0);break;case 3:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(e,t){null==g[m][t]?g[m][t]=a:g[m][t]=g[m][t][0]/g[m][t][1]})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0)}if(i&&N&&(g=replaceNullsInTable(g,5)),1==l){var R=g.slice(1),E=g.getNames().getSubList(1);"nL"==h.type&&(E=E.toNumberList()),R=L.toL(R).getSortedByList(E);var O=new T;return O[0]=g[0],g=O.concat(R)}return g[0]=g[0].downcast(),g.downcast()},unpivotTable=function(e,t,n){var r,o=e.get(t),i=e.getColumns(n),s=new T;s[0]=new L,s[0].name=o.name,s[1]=new sL,s[1].name="variables",s[2]=new L,s[2].name="value";for(var l=0;l<o.length;l++){r=o[l];for(var a=0;a<i.length;a++)s[0].push(r),s[1].push(i[a].name),s[2].push(i[a][l])}return s[0]=s[0].downcast(),s[2]=s[2].downcast(),s.downcast()},getCountPairsMatrix=function(e,t,n,r,o){if(null==e||e.length<2||null==e[0]||null==e[0][0])return null;var i,s;if(t=null!=t&&t,n=null==n?0:n,0==(r=null==r?0:r))i=e[0].getWithoutRepetitions(),s=e[1].getWithoutRepetitions(),t&&(i=(i=i.concat(s)).getWithoutRepetitions(),s=i);else if(1==r)if(t){var l=(i=e[0].concat(e[1])).getFrequenciesTable(!0);s=i=l[0]}else{l=e[0].getFrequenciesTable(!0);i=l[0],l=e[1].getFrequenciesTable(!0),s=l[0]}else if(2==r){if(t)l=(l=(i=e[0].concat(e[1])).getFrequenciesTable(!0)).sortRowsByList(0,!0),s=i=l[0];else l=(l=e[0].getFrequenciesTable(!0)).sortRowsByList(0,!0),i=l[0],l=(l=e[1].getFrequenciesTable(!0)).sortRowsByList(0,!0),s=l[0]}if(null!=o&&!isNaN(o)&&o>0){var a=createSortedNumberList(o);i.length>o&&(i=i.getElements(a)),s.length>o&&(s=s.getElements(a))}var u,h,c=new nT(s.length);if(s.forEach((function(e,t){c[t].name=String(e),i.forEach((function(e,n){c[t][n]=0}))})),e[0].forEach((function(t,n){var r=e[1][n];h=s.indexOf(r),-1!=(u=i.indexOf(t))&&-1!=h&&c[h][u]++})),0!=n){for(var f=0,p=0;p<c.length;p++)c[p]._max=c[p].getMax(),f=Math.max(f,c[p]._max);if(1==n&&0!=f)for(p=0;p<c.length;p++)for(var g=0;g<c[p].length;g++)d=(f-c[p][g])/f,c[p][g]=Number(d.toFixed(5));else if(2==n&&0!=f){var d;for(p=0;p<c.length;p++)for(g=0;c[p]._max>0&&g<c[p].length;g++)d=(c[p]._max-c[p][g])/c[p]._max,c[p][g]=Number(d.toFixed(5))}else if(3==n){var m;for(g=0;g<c[0].length;g++){m=0;for(p=0;p<c.length;p++)m+=c[p][g];for(p=0;0!=m&&p<c.length;p++)d=c[p][g]/m,c[p][g]=Number(d.toFixed(5))}}}let y=new T;return i.name=e[0].name,y.push(i),c=y.concat(c)},getPairsFrequencyTable=function(e){if(null==e||e.length<2||null==e[0]||null==e[0][0]||e[0].length!=e[1].length)return null;for(var t={},n=0;n<e[0].length;n++){var r=t[e[0][n]];null==r&&(r={sL:new L,c:0,s:e[0][n]},t[e[0][n]]=r),r.sL.push(e[1][n]),r.c++}var o=[];for(r in t)o.push(t[r]);o=o.sort((function(e,t){var n=t.c-e.c;return 0!=n?n:e.s<t.s?1:-1}));var i,s=new T;for(s[0]=instanceSameType(e[0]),s[0].name=""==e[0].name?"L 1":e[0].name,s[1]=instanceSameType(e[1]),s[1].name=""==e[1].name?"L 2":e[1].name,s[2]=new nL,s[2].name="Combination Frequency",n=0;n<o.length;n++){i=(r=o[n]).sL.getFrequenciesTable(!0);for(var l=0;l<i[0].length;l++)s[0].push(r.s),s[1].push(i[0][l]),s[2].push(i[1][l])}return s},concatenateRowElements=function(e,t){if(null==e||!e.isTable)return null;t=null==t?" ":t;let n,r,o,i=new i,s=e.getLengths().getMax(),l=!0;for(r=0;r<s;r++){for(n="",o=0;o<e.length;o++)o>0&&(n+=t),void 0!==e[o][r]&&(n+=String(e[o][r]),0==r&&(o>0&&(i.name+=t),i.name+=String(e[o].name),l=l&&0==String(e[o].name).length));i.push(n)}return l&&(i.name=""),i},filterTableByElementInList=function(e,t,n,r){if(null==e||e.length<=0||null==t)return;if(null==n)return e;if(r=null==r||r,"string"==typeof t){var o=e.getNames().indexOf(t);if(-1==o)throw new Error("The table doesn't contain a list with name "+t);t=o}var i=new T;let s,l,a=e.length,u=e[0].length;for(i.name=e.name,l=0;l<a;l++)i[l]=instanceSameType(e[l]),i[l].name=e[l].name;if(r){for(s=0;s<u;s++)if(e[t][s]==n)for(l=0;l<a;l++)i[l].push(e[l][s])}else for(s=0;s<u;s++)if(e[t][s]!=n)for(l=0;l<a;l++)i[l].push(e[l][s]);for(l=0;l<a;l++)"nL"!=i[l].type&&(i[l]=i[l].downcast());return i},filterTableByElementsInList=function(e,t,n,r){if(null==e||e.length<=0||null==t)return;if(null==n||0===n.length)return e;if(r=null==r||r,"string"==typeof t){var o=e.getNames().indexOf(t);if(-1==o)throw new Error("The table doesn't contain a list with name "+t);t=o}var i=getBooleanDictionaryForList(n),s=new T;let l,a,u=e.length,h=e[0].length;for(s.name=e.name,a=0;a<u;a++)s[a]=new L,s[a].name=e[a].name;if(r){for(l=0;l<h;l++)if(i[e[t][l]])for(a=0;a<u;a++)s[a].push(e[a][l])}else for(l=0;l<h;l++)if(!i[e[t][l]])for(a=0;a<u;a++)s[a].push(e[a][l]);for(a=0;a<u;a++)s[a]=s[a].downcast();return s},selectRows=function(e,t,n,r,o){if(null==e||e.length<=0)return;if(r=null==r||r,o=null!=o&&o,null==t||null==n||null==t.length)return r?e:null;if(Array.isArray(n)||(n=[n]),t.length!=n.length&&1!=t.length)return;var i=new nL;let s=e[0].length,l=1==t.length&&n.length>1,a={};l&&(a=getBooleanDictionaryForList(n));for(var u=0;u<s;u++){for(var h=!0,c=0;c<t.length&&h;c++){if(isNaN(t[c])||t[c]<0||t[c]>=e.length)return;e[t[c]][u]!=n[c]&&(h=!1,l&&a[e[t[c]][u]]&&(h=!0))}h&&i.push(u)}if(o){if(r)return i;var f=createSortedNumberList(e[0].length);return difference(f,i)}return r?e.getRows(i):e.getWithoutRows(i)},joinTables=function(e,t,n,r,o){if(null==e||null==t)return;var i=new T;let s,l;if(n=null==n?0:n,r=null==r?0:r,2==(o=null==o?0:o)){var a=joinTables(t,e,r,n,1),u=[0];for(let e=t.length;e<a.length;e++)u.push(e);for(let e=1;e<t.length;e++)u.push(e);return a.getColumns(u).downcast()}if("string"==typeof n){if(s=e.get(n),null==s)throw Error("the table doesn't contain a list with name "+n);n=e.indexOf(s)}else n<0&&(n+=e.length),s=e[n%=e.length];if("string"==typeof r){if(l=t.get(r),null==l)throw Error("the table doesn't contain a list with name "+r);r=t.indexOf(l)}else r<0&&(r+=t.length),l=t[r%=t.length];var h=getIndexesDictionary(l),c=e.length;let f=t.length;var p,g=s.length;let d;var m,y,x;let w,v=new L;for(v.name=s.name,i[0]=v,x=0;x<c;x++)x!=n&&(w=new L,w.name=e[x].name,w._list0=!0,w._listOnTable=e[x],i.push(w));for(x=0;x<f;x++)x!=r&&(w=new L,w.name=t[x].name,w._list0=!1,w._listOnTable=t[x],i.push(w));for(m=0;m<g;m++)if(d=h[p=s[m]],null!=d)for(y=0;y<d.length;y++)for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?i[x]._listOnTable[m]:i[x]._listOnTable[d[y]]);else if(1==o||3==o)for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?i[x]._listOnTable[m]:null);if(3==o){var b=getBooleanDictionaryForList(s);for(m=0;m<l.length;m++)if(!b[p=l[m]])for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?null:i[x]._listOnTable[m])}for(m=0;m<i.length;m++)delete i[m]._list0,delete i[m]._listOnTable,i[m]=i[m].downcast();return i.downcast()},joinMultipleTables=function(e,t,n){if(null==e||null==t)return;if(e.length<2)throw new Error("listOfTables must have at least two tables");if(t.length!=e.length)throw new Error("listOfIndexes must have same length as listOfTables");if(null==e[0])throw new Error("listOfTables[0] is null");if(null==e[1])throw new Error("listOfTables[1] is null");var r=joinTables(e[0],e[1],t[0],t[1],n);let o,i=e.length;for(o=2;o<i;o++)r=joinTables(r,e[o],0,t[o],n);return r},combineLists=function(e,t){if(null==e)return null;t=null==t||t;var n=new T;let r=new T,o=new nL,i=new nL,s=1;for(var l=0;l<e.length;l++)r[l]=new L,n[l]=e[l].getWithoutRepetitions(),o[l]=0,i[l]=n[l].length,s*=i[l];if(t||s>1e5)return s;for(l=0;l<s;l++){for(var a=0;a<e.length;a++)r[a].push(n[a][o[a]]);var u=!0;for(o[a=0]++,u=o[a]>=i[a];u&&a<e.length;)o[a]=0,o[a+1]++,u=o[++a]>=i[a]}for(a=0;a<e.length;a++)r[a]=r[a].downcast();return r.downcast()},completeTable=function(e,t,n){n=void 0===n?0:n;var r,o=new T;let i,s;o.name=e.name;for(var l=0;l<e.length;l++){for(i=null==(r=e[l])?getNewListForObjectType(n):instanceSameType(r),i.name=null==r?"":r.name,s=0;s<t;s++)i[s]=null==r||null==r[s]?n:r[s];o[l]=i}return o},getNumberTableFromTable=function(e){if(null==e||e.length<=0)return null;var t;let n=new nT;for(n.name=e.name,t=0;null!=e[t];t++)"nL"==e[t].type&&n.push(e[t]);return n},getVariablesInformationGain=function(e,t){if(null==e)return null;var n=new nL;return e.forEach((function(e){n.push(getInformationGain(e,t))})),n},splitTableByCategoricList=function(e,t,n){if(null==e||null==t)return null;var r,o=t.isList?t:e.get(t);let i=new L,s={};return o.forEach((function(t,n){null==(r=s[t])&&((r=new T).name=String(t),s[t]=r,i.push(r),e.forEach((function(e,t){r[t]=instanceSameType(e),r[t].name=e.name})),r._element=t),e.forEach((function(t,o){r[o].push(e[o][n])}))})),n?s:i},buildCorrelationsNetwork=function(e,t,n,r,o,i,s,l,a){if(null==e)return null;let u,h;t=null==t||Boolean(t),o=null==o?.9:o,i=Boolean(i),s=null==s?0:s,a=null==a?3:a;let c,f,p,g,d,m,y,x,w,v,b=e.length,T=e[0].length;var _=!1;let M=!1,S=!1;var N=new Net,R=new sL;let E;var O=t?T:b,C=0;let D=0;for(u=0;u<b;u++)E=e[u].type,"nL"==E?(R[u]="numbers",C++):"sL"==E&&e[u].getWithoutRepetitions().length/e[u].length>.8?(R[u]="texts"):(R[u]="categories",D++);var P;if(null!=r&&(w=r.isList?r:e.get(r),null!=w&&(v="cL"===w.type?w:"nL"===w.type?createColorListFromNumberList(w,blueToRed,0):createCategoricalColorListForList(w)[0].value)),null!=l&&(P=new nL,"number"==_typeOf(l)?l<=b&&"nL"!=(P=e[l]).type&&(P=null):l.isList&&"nL"==l.type&&l.length>=O&&(P=l)),null==n||n.isList||(n=e.get(n)),t){for(u=0;u<T;u++){for(g="_"+u,d=null==n?g:n[u],c=new Nd(g,d),c.i=u,c.row=e.getRow(u),c.numbers=new nL,c.categories=new L,c.texts=new sL,null!=v&&(c.color=v[u]),null!=P&&(c.weight=P[u]),h=0;h<b;h++)switch(R[h]){case"numbers":c.numbers.push(c.row[h]),S=!0;break;case"categories":c.categories.push(c.row[h]),_=!0;break;case"texts":c.texts.push(c.row[h]),M=!0}0===s?c.numbers.sd=c.numbers.getStandardDeviation():c.numbers.norm=c.numbers.getNorm(),N.addNode(c)}var I;for(u=0;u<T;u++){for(c=N.nodes[u],I=new nL,h=0;h<T;h++)2!=s&&h<u+1||(f=N.nodes[h],m=S?0===s?numericCorrelation(c.numbers,f.numbers,c.numbers.sd,f.numbers.sd):cosineSimilarity(c.numbers,f.numbers,c.numbers.norm,f.numbers.norm):0,y=_?2*Math.pow(jaccardIndex(c.categories,f.categories),.2)-1:0,x=S&&_?(m*C+y*D)/(C+D):S?m:y,2==s?I.push(u==h?0:x):(i&&Math.abs(x)>o||!i&&x>o)&&(g=u+"_"+h,d=null==n?g:c.name+"_"+f.name,p=new Rel(g,d,c,f,Math.abs(x)-.9*o),p.color=x>0?"blue":"red",p.pearson=m,p.jaccard=y,N.addRelation(p)));if(2==s){var k=N.nodes.getSortedByList(I,!1);for(I=I.getSorted(!1),h=0;h<a;h++)f=k[h],g=u+"_"+f.id,d=null==n?g:c.name+"_"+f.name,p=new Rel(g,d,c,f,I[h]),N.addRelation(p)}}}else if("nT"==e.type){for(u=0;u<b;u++)c=new Nd("list_"+u,null==e[u].name||""==e[u].name?"list_"+u:e[u].name),N.addNode(c),c.i=u,c.numbers=e[u],null!=v&&(c.color=v[u]),null!=P&&(c.weight=P[u]);for(u=0;u<b;u++)for(c=N.nodes[u],h=u+1;h<b;h++)f=N.nodes[h],m=numericCorrelation(c.numbers,f.numbers),x=m,(i&&Math.abs(x)>o||!i&&x>o)&&(g=u+"_"+h,d=c.name+"_"+f.name,p=new Rel(g,d,c,f,Math.abs(x)-.9*o),p.color=x>0?"blue":"red",p.pearson=m,N.addRelation(p))}return N},buildSimpleDecisionTree=function(e,t,n,r,o,i,s,l){if(null==e||null==t)return;let a,u,h=new T;for(var c=t.isList?t:e.get(t),f=0;f<e.length;f++)e[f]!=c&&(a=buildInformationObjectForList(e[f],!0),a.isCategorical?h.push(e[f]):a.isNumeric&&(u=e[f].getQuantiles(3,3),h.push(u)));return a=buildInformationObjectForList(c,!0),buildDecisionTree(h,c,n,r,o,i,s,l)},buildDecisionTree=function(e,t,n,r,o,i,s,l){if(null==e||null==t)return;if(null==l&&(l=blueWhiteRed),"number"==_typeOf(t)){var a=e.getWithoutElementAtIndex(t);t=e.get(t),e=a}r=null==r?.1:r,o=o||10,i=i||.002;var u=createSortedNumberList(t.length);let h=new Tr;return h.supervisedValue=n,null==n&&(h._colorDic=createCategoricalColorListForList(t)[4].value),_buildDecisionTreeNode(h,e,t,0,r,o,i,null,null,n,u,s,l),h.leavesWeights=h.getLeaves().getPropertyValues("weight"),h.sumWeightsLeaves=h.leavesWeights.getSum(),h.supervised=t,h},_buildDecisionTreeNode=function(e,t,n,r,o,i,s,l,a,u,h,c,f){var p=null==u;if(p){var g=n.getFrequenciesTable(!0);u=g[0][0]}var d=getListEntropy(n,u),m=0;let y=0,x=0;d>=o&&(x=getVariablesInformationGain(t,n),x.forEach((function(e,t){e>m&&(m=e,y=t)})));var w=d>=o&&m>s&&n.length>=i&&r<9&&n._P_valueFollowing>0&&n._P_valueFollowing<1;let L=new Nd(e.nodes.getNewId(),(null==a?"":a+":")+(w?t[y].name:"P="+n._biggestProbability+"("+n._mostRepresentedValue+")"));if(e.addNodeToTree(L,l),null==l&&(e.informationGainTable=new T,e.informationGainTable[0]=t.getNames(),x&&(e.informationGainTable[1]=x.clone(),e.informationGainTable=e.informationGainTable.sortRowsByList(x,!1))),L.entropy=d,L.weight=n.length,L.supervised=n,L.supervisedValue=u,L.indexes=L.indexesOnTable=h,L.value=a,L.fromList=null==l?"":l.bestFeatureName,L.mostRepresentedValue=n._mostRepresentedValue,L.biggestProbability=n._biggestProbability,L.valueFollowingProbability=n._P_valueFollowing,L.lift=L.valueFollowingProbability/e.nodes[0].valueFollowingProbability,L.i=e.nodes.length-1,""==L.fromList)L.filter={};else{if(L.filter={column:L.fromList},L.value&&L.value.includes&&L.value.includes("-")){var v=L.value.split("-");String(Number(v[0]))==v[0]&&String(Number(v[1]))==v[1]&&(L.filter.type="range",L.filter.value=[!0,Number(v[0]),!0,Number(v[1])])}null==L.filter.type&&(L.filter.type="in_array",L.filter.value=[L.value])}L.filters=[];var b=function(e){e.parent&&b(e.parent),e.filter.column&&L.filters.push(e.filter)};if(b(L),p){for(var _=new cL,M=0;M<g[0].length;M++)_[M]=e._colorDic[g[0][M]];L._color=L.color=interpolateColors("white",colorsLinearCombination(_,g[1]),L.valueFollowingProbability)}else L._color=L.color=f(1-L.valueFollowingProbability);if(c){var S=document.createElement("canvas");S.width=150,S.height=100;var N=S.getContext("2d");N.clearRect(0,0,150,100),_decisionTreeGenerateColorsMixture(N,150,100,["blue","red"],L.mostRepresentedValue==u?[Math.floor(L.biggestProbability*L.weight),Math.floor((1-L.biggestProbability)*L.weight)]:[Math.floor((1-L.biggestProbability)*L.weight),Math.floor(L.biggestProbability*L.weight)]);var R=new Image;R.src=S.toDataURL(),L.pattern=N.createPattern(R,"repeat")}if(!w)return L.isLeaf=!0,L.label=Math.floor(100*L.valueFollowingProbability)/100,L;L.isLeaf=!1,L.bestFeatureName=t[y].name,L.bestFeatureName=""===L.bestFeatureName?"list "+y:L.bestFeatureName,L.iBestFeature=y,L.informationGain=m,L.label=L.bestFeatureName;var E=t.concat([n,h]);let O,C,D;return splitTableByCategoricList(E,t[y]).forEach((function(t){O=t.getSubList(0,t.length-3),C=t[t.length-2],D=t[t.length-1],_buildDecisionTreeNode(e,O,C,r+1,o,i,s,L,t._element,p?null:u,D,c,f)})),L.to=L.to.getSortedByProperty("valueFollowingProbability",!1),L},_decisionTreeGenerateColorsMixture=function(e,t,n,r,o){let i,s,l,a=createListWithSameElement(o[0],r[0]);for(l=1;null!=r[l];l++)a=a.concat(createListWithSameElement(o[l],r[l]));for(i=0;i<t;i++)for(s=0;s<n;s++)l=4*(i+s*t),e.fillStyle=a.getRandomElement(),e.fillRect(i,s,1,1)},allListsSameLength=function(e){if(null==e)return null;var t=e.length;let n,r=e[0].length;for(n=1;n<t;n++)if(e[n].length!=r)return!1;return!0},getListsWithoutRepetition=function(e){if(null==e)return;var t=e.length;let n,r=new T;for(n=0;n<t;n++)r[n]=e[n].getWithoutRepetitions();return r.downcast()},getNumberOfDifferentElementsOfLists=function(e,t){if(null==e)return;var n=e.length;let r,o=new nL;for(o.name="(proportion)",r=0;r<n;r++)o[r]=e[r].countDifferentElements(),t&&(o[r]/=e[r].length);return o},buildInformationObjectForTable=function(e,t){if(null==e)return;if(1==(t=null==t||t)&&null!=e.infoObject)return e.infoObject;var n=e.length;let r,o,i=999999999999,s=-999999999999,l=0,a=!0;var u={type:e.type,name:e.name,length:n,kind:"mixed",allListsSameLength:!0,allListsSameSize:!0,allListsSameType:!0,allListsSameKind:!0,listsInfoObjects:new L,names:new sL,lengths:new nL,types:new sL,kinds:new sL};for(r=0;r<n;r++)o=buildInformationObjectForList(e[r],t),u.listsInfoObjects[r]=o,o.containsNulls&&(u.containsNulls=!0),u.names[r]=o.name,u.types[r]=o.type,u.kinds[r]=o.kind,u.lengths[r]=o.length,"categories"!=o.kind&&"integer numbers"!=o.kind&&(a=!1),r>0&&(u.lengths[r]!=u.lengths[r-1]&&(u.allListsSameLength=!1),u.types[r]!=u.types[r-1]&&(u.allListsSameType=!1),u.kinds[r]!=u.kinds[r-1]&&(u.allListsSameKind=!1),u.lengths[r]!=u.lengths[r-1]&&(u.allListsSameType=!1)),"nL"==o.type&&(i=Math.min(i,o.min),s=Math.min(s,o.max),l+=o.average);if(0!==l&&(l/=u.length),u.allListsSameLength)u.minLength=u.lengths[0],u.maxLength=u.lengths[0],u.averageLength=u.lengths[0];else{var h=u.lengths.getInterval();u.minLength=h.x,u.maxLength=h.y,u.averageLength=.5*(h.x+h.y)}if(u.allListsSameKind)switch(u.kinds[0]){case"numbers":u.kind="numbers";break;case"integer numbers":u.kind="integer numbers";break;case"texts":u.kind="texts";break;case"categories":u.kind="categories"}else a?u.kind="integers and categories":u.allListsSameType&&"nL"==u.types[0]&&(u.kind="numbers");return e.infoObject=u,u},getCategoricalLists=function(e){buildInformationObjectForTable(e);for(var t=new T,n=0;n<e.length;n++)e[n].infoObject.isCategorical&&t.push(e[n]);return t.downcast()},getTableSimplified=function(e,t,n,r){if(null==e||!(e.length>0))return null;let o;t=t||20;let i=e.length,s=new T;for(s.name=e.name,o=0;o<i;o++)s.push("nL"===e[o].type?e[o].getNumbersSimplified(1==r?6:2,t):e[o].getSimplified(t,n));return s.downcast()},concatTables=function(e,t){if(null!=e&&null!=t&&e.length==t.length){for(var n=new T,r=0;r<e.length;r++)n[r]=e[r].concat(t[r]),n[r].name=e[r].name;return n.downcast()}},concatRows=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var e,t,n,r,o;let i=0;for(e=0;e<arguments.length;e++)if(null!=arguments[e]&&(i=Math.max(i,arguments[e].length),!arguments[e].isTable))return null;for(e=0;e<arguments.length;e++)if(null!=arguments[e]){var s=(n=arguments[e]).getLengths(),l=s.getMax(),a=s.getMin();for(l!=a&&(n=completeTable(n,l,null));n.length<i;)n.push(createListWithSameElement(l,null,""));if(0==e)r=n.clone();else for(t=0;t<r.length;t++)o=r[t].name,r[t]=r[t].concat(n[t]),r[t].name=""!=o?o:n[t].name}return r},concatLists=function(e){if(null!=e){for(var t=e[0],n=1;n<e.length;n++)t=t.concat(e[n]);return t}},unionListsFromTables=function(e){if(null==e)return;var t=e[0].getWithoutRepetitions();let n,r,o,i=e.length;for(n=1;n<i;n++)for(o=e[n].length,r=0;r<o;r++)t.includes(e[n][r])||t.push(e[n][r]);return t},intersectListsFromTables=function(e){if(null==e)return;var t=e[0].getWithoutRepetitions();let n,r=e.length;for(n=1;n<r;n++)t=intersection(t,e[n]);return t},encodeStringLists=function(e,t,n,r){if(null==e)return;t=null==t?0:t,n=null==n?20:n,r=null==r||r;var o=new T;let i,s,l,a,u;for(buildInformationObjectForTable(e,!0),i=0;i<e.length;i++)if(a=!1,u=e[i],"nL"!=u.type){if("sL"!=u.type&&(u=u.toStringList(),buildInformationObjectForList(u)),u.infoObject.numberDifferentElements<2||u.infoObject.numberDifferentElements>n)a=!0;else{for(l=encodeStringsAsNumericFeatures(u,t),s=0;s<l.length;s++)l[s].name=u.name+":"+l[s].name;o=concat(o,l)}a&&!r&&o.push(u.clone())}else o.push(u.clone());return o},translateListsWithDictionary=function(e,t,n,r){if(null!=e&&null!=t){for(var o=new T,i=0;i<e.length;i++)o[i]=mapWithTable(e[i],t,n,r);return o.downcast()}},getModes=function(e,t=!0){if(null==e)return;t||(e=e.transpose());let n=toL(e.map((e=>e.getMode()))).downcast();return n.name="mode",n},getSubTables=function(e,t){if(null==e)return;let n=new L;n.name="subtables";for(var r=0;r<t.length;r++)n.push(e.getColumns(t[r]));return n},mapFunctionOnLists=function(e,t,n,r,o,i,s,l,a){if(null==e)return;let u=new L,h=e.length;for(var c=0;c<h;c++)u.push(mapWithFunction(e[c],t,n,r,null,o,i,s,l,a));return u.downcast()},mapFunctionsOnLists=function(e,t,n,r,o,i,s,l,a){if(null==e)return;let u=new L,h=Math.min(e.length,t.length);for(var c=0;c<h;c++)u.push(mapWithFunction(e[c],t[c],n,r,null,o,i,s,l,a));return u.downcast()},useVariablesDictionary=function(e,t){if(null!=e&&null!=t){for(var n=t.get("name",null,null,!0)||t[0],r=t.get("label",null,null,!0)||t[1],o=t.get("description",null,null,!0)||t[2],i=t.get("category",null,null,!0)||t[3],s=t.get("relevance",null,null,!0)||t[4],l=e.getNames(),a=(getFirstOccurrenceDictionaryForList(l),getFirstOccurrenceDictionaryForList(n)),u=(l.length,0);u<e.length;u++){var h=a[e[u].name];null!=h&&(e[u].label=r[h],e[u].description=o[h],e[u].category=i[h],e[u].relevance=s[h])}return e}},matrixToTwoColumns=function(e){var t=new T;t[0]=new sL,t[0].name=e[0].name,t[1]=new sL,t[1].name="related with";for(var n=1;n<e.length;n++)for(var r=0;r<e[0].length;r++)for(var o=0;o<e[n][r];o++)t[0].push(String(e[0][r])),t[1].push(e[n].name);return t},_preserveOrder=function(e,t){let n=t.getNames(),r=e.getNames().getWithoutElements(n);return e.getColumns(n.concat(r))},concatStrings=function(e,t){return null==t&&(t=""),sL.toL(e.join(t))},join=function(e,t="",n="",r="",o){if(null!=e)return o&&(t="\n"),n+e.join(t)+r},cleanTexts=function(e,t,n,r,o,i,s,l,a){if(null==e)return null;var u=new sL;u.name=e.name;for(var h=0;h<e.length;h++)u[h]=cleanText(e[h],t,n,r,o,i,s,l,a);return u},filterStringListByString=function(e,t,n,r){if(null==e||null==t)return null;var o;let i,s=r?new nL:new sL,l=e.length;for(n&&(i=new RegExp("\\b"+t+"\\b")),o=0;o<l;o++)n?e[o].match(i).length>0&&s.push(r?o:e[o]):-1!=e[o].indexOf(t)&&s.push(r?o:e[o]);return s},replaceStringsInTexts=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;let o,i,s=e.length,l=t.length;for(o=0;o<s;o++)if(r[o]=e[o],null!=r[o])for(i=0;i<l;i++)r[o]=replaceStringInText(r[o],t[i],n);return r},replaceStringInTexts=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;let o,i=e.length;for(o=0;o<i;o++)r[o]=null==e[o]?null:replaceStringInText(e[o],t,n);return r},replaceStringsInTextsByStrings=function(e,t,n){if(null==e||null==t||null==n)return null;var r=new sL;r.name=e.name;let o,i,s=e.length,l=t.length;for(o=0;o<s;o++)if(r[o]=e[o],null!=r[o])for(i=0;i<l;i++)r[o]=replaceStringInText(r[o],t[i],n[i]);return r},countStringsOccurrencesOnTexts=function(e,t,n){if(null==e||null==t)return null;let r=new nT;var o;let i,s,l,a,u=e.length,h=t.length;for(o=0;o<u;o++){for(s=e[o],a=new RegExp("\\b"+s+"\\b"),l=new nL,l.name=s,i=0;i<h;i++)l[i]=n?countRegexOccurrences(t[i],a):countOccurrences(t[i],s);r[o]=l}return r},getWordsInTextsOccurrencesTable=function(e,t,n=1,r,o=500,i=1e3,s,l=3,a,u=0,h){if(null==e)return;var c,f;let p,g=e.length;1==n&&(n=StringOperators_STOP_WORDS);let d,m=1==t,y=2==t||3==t||4==t;s=s||!0;let x,w={};for(c=0;c<g;c++)for(d=getWordsOccurrencesTable(e[c],n,r,o,l,h),f=0;f<d[0].length;f++)x=w[d[0][f]],null==x&&(x=new nT,x.push(new nL),x.push(new nL),w[d[0][f]]=x),x[0].push(c),x[1].push(d[1][f]);let L=new sL;for(var v in w)w.hasOwnProperty(v)&&(w[v][0].length<u*g?delete w[v]:L.push(v));for(p=createUniformTable(g+1,L.length,0),c=0;c<p.length;c++)0==c?p[c]=createListWithSameElement(L.length,"","words"):p[c].name="text "+(c-1);let b=0;for(var v in w)if(w.hasOwnProperty(v)){for(p[0][b]=v,x=w[v],c=0;c<x[0].length;c++)p[x[0][c]+1][b]+=x[1][c];b++}if(p[0].length>i&&(s=!0),p[0].name="words",y||s||a){var T,_=new nL;_=p[1].clone();var M=createListWithSameElement(p[0].length,0,"idf");for(c=1;c<p.length;c++)for((T=p[c]).name="text "+(c-1),f=0;f<T.length;f++)T[f]>0&&(c>1&&(_[f]+=T[f]),M[f]++);if(y)if(_=createListWithSameElement(p[0].length,0,"total tf-idf"),2==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]/=M[f],_[f]+=T[f];else if(3==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=Math.log(g/M[f]),_[f]+=T[f];else if(4==t)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=M[f],_[f]+=T[f];a&&(p.push(_),_.name="totals"),s&&(p=p.sortRowsByList(_,!1))}else for(c=1;c<p.length;c++)p[c].name="text "+(c-1);return m&&p.forEach((function(e,t){0!==t&&(p[t]=normalizeToSum(p[t]))})),i>0&&i<p[0].length&&(p=p.sliceRows(0,i-1)),p},createShortTextsNetwork=function(e,t,n,r,o,i,s,l){if(null==e||null==e.length||0===e.length)return;(new Date).getTime();var a=new Net;let u,h,c,f,p,g,d,m=e.join(" *** ").toLowerCase().split(" *** "),y=e.length,x=0;if(null==l||l.isColorList||(l=l.toColorList()),n=n||.2,r=r||0,i){i[0]=i[0].toLowerCase();var w,L=i[1][0]}var v,b;switch(r){case 0:v=function(e){return 1-Math.pow(2*e/(y-1)-1,2)};break;case 1:v=function(e){return 1/(e+1)};break;case 2:v=function(e){return 1-Math.pow(2*Math.pow(e/(y-1),.2)-1,2)};break;default:v=function(e){return 0===e?0:1/e}}for((new Date).getTime(),e.forEach((function(e,n){b=null==s||null==s[n]?"_"+n:s[n],_=new Nd("_"+n,b),a.addNode(_),_.content=e,null!=l&&(_.color=l[n]);var r=getWords(e,!0,t,!1,!1,0,3);for(p=r.length,g=new nL,h=0;null!=r[h];h++){c=r[h];var u=0;m.forEach((function(e,t){n!=t&&(u+=Number(-1!=e.indexOf(c)))})),0!==u?(g[h]=v(u),o&&(g[h]*=1-1/(countOccurrences(m[n],c)+1)),i&&(w=i[0].indexOf(c),g[h]*=-1==w?1:1-Math.pow(i[1][w]/L,.2)),x=Math.max(x,g[h])):(r.splice(h,1),h--)}f=Math.floor(3*Math.log(p+1)),(r=r.getSortedByList(g,!1).slice(0,f)).position={},r.forEach((function(e,t){r.position[e]=t})),g=g.getSorted(!1).slice(0,f),_.wordsTable=new T,_.wordsTable[0]=r,_.wordsTable[1]=g})),(new Date).getTime(),u=0;null!=a.nodes[u+1];u++){var _=a.nodes[u];for(h=u+1;null!=a.nodes[h];h++){var M=a.nodes[h];if(d=0,_.wordsTable[0].forEach((function(e,t){null!=(w=M.wordsTable[0].position[e])&&(d+=_.wordsTable[1][t]*M.wordsTable[1][w])})),d=Math.sqrt(d/x/Math.max(_.wordsTable[0].length,M.wordsTable[0].length)),d>n){var S=new Rel(_.id+"_"+M.id,_.id+"_"+M.id,_,M,d);a.addRelation(S)}}}return a},splitStrings=function(e,t,n,r,o){if(null==e)return null;null==t&&(t=","),null==n&&(n=4),r=null==r||r,o=null==o?"":o;var i=new T;let s,l,a;for(s=0;s<n;s++)i.push(new sL),i[s].name="Level "+(s+1);let u=new nL;for(s=0;s<e.length;s++){var h=splitString(e[s],t);if(null!=h){for(h=h.trim(),l=0;l<n;l++)if(l<h.length?(i[l][s]=h[l],l>=u.length&&u.push(l)):i[l][s]=null,r&&l==n-1&&h.length>n)for(a=l+1;a<h.length;a++)i[l][s]+=t+h[a]}else for(l=0;l<n;l++)i[l][s]=0==l?o:null}return 0==u.length?i=new T:u.length<i.length&&(i=i.getColumns(u)),i},encodeStringsAsNumericFeatures=function(e,t,n,r,o,i){if(null==e)return null;t=null==t?0:t,r=null!=r&&r,o=null!=o&&o,null==i&&(i=3!=t);let s,l,a,u={};"sL"!=e.type&&(e=e.toStringList()),r&&(e=e.toLowerCase()),null==n?s=e.getWithoutRepetitions().getSorted():(s=r?n.toLowerCase():n,s=s.getWithoutRepetitions().getSorted());let h=[];for(var c=0;c<s.length;c++)u[s[c]]=c,h.push(s[c]);let f="";if(o&&(f=""==e.name?"":e.name+":"),l=new nT,0==t||3==t)for(c=0;c<s.length;c++)l.push(new nL),l[c].name=f+s[c];else if(1==t)l.push(new nL),l[0].name=""==e.name?"Code":e.name+" Code";else{var p=(s.length-1>>>0).toString(2).length;for(c=0;c<p;c++)l.push(new nL),l[c].name=f+"Bit "+c}if(0==t||3==t)for(c=0;c<e.length;c++)if(a=u[e[c]],null!=a)for(var g=0;g<l.length;g++)l[g].push(g==a?1:0);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}else if(1==t)for(c=0;c<e.length;c++)if(a=u[e[c]],null!=a)l[0].push(a);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}else for(c=0;c<e.length;c++)if(a=u[e[c]],null!=a){var d=(a>>>0).toString(2),m=l.length-d.length;for(g=0;g<l.length;g++){var y=g-m<0?"0":d.substr(g-m,1);l[g].push(Number(y))}}else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}return 0==t&&l.length>1&&(l=l.getWithoutElementAtIndex(l.length-1)),l},correlationRatio=function(e,t,n){if(null==t||null==e)return null;if("L"==e.type&&(e=e.toStringList()),"nL"!=t.type)throw new Error("The first list must be a nL");if("sL"!=e.type)throw new Error("The second list must be a sL");if(t.length!=e.length)throw new Error("The two lists must have the same length");0!=(n=null==n?0:n)&&(t=normalizeByZScore(t));var r=new T;r.push(e),r.push(t),r=aggregateTable(r,0,[0,1],[0,7]);let o=t.getVariance()*t.length,i=t.getMean();if(0==o)return 0;let s,l,a=0,u=new t;for(var h=0;h<r[1].length;h++)l=r[1][h].getMean(),u.push(l),s=Math.pow(l-i,2)*r[1][h].length,a+=s;let c=1;if(0!=n){var f=t.getInterval();u=normalizeToInterval(u,f);var p,g=0,d=1/0,m=-1/0;for(h=0;h<u.length;h++)for(var y=h+1;y<u.length;y++)g+=p=Math.abs(u[h]-u[y]),d=Math.min(d,p),m=Math.max(m,p);var x=u.length*(u.length-1)/2;1==n?c=10*d:2==n?c=10*g/x:3==n&&(c=10*m)}return Number((Math.abs(c)*Math.sqrt(a/o)).toFixed(5))},splitByEnter=function(e,t){if(null==e)return null;let n=splitString(e,"\n",null,t);return n.length>1?n:(n=splitString(e,ENTER2,null,t),n.length>1?n:(n=splitString(e,ENTER3,null,t),n.length>1?n:new sL(e)))},replaceStringInText=function(e,t,n){if(null==e||null==t||null==n)return null;if("object"==typeof e)return e;if("[object RegExp]"!=Object.prototype.toString.call(t)){var r=(t=String(t)).match(/\/(.+)\/(.*)/);if(null==r)t=new RegExp(t,"g");else try{t=new RegExp(r[1],r[2])}catch(e){throw e}}return String(e).replace(t,n)},replaceStringsInText=function(e,t,n,r){if(null==e||null==t||null==n)return null;var o=e;let i,s,l=t.length;for(i=0;i<l;i++)s=t[i],r&&"[object RegExp]"!=Object.prototype.toString.call(s)&&(s=new RegExp("\\b"+escapeForRegExp(s)+"\\b","g")),o=replaceStringInText(o,s,Array.isArray(n)?String(n[i]):n);return o},removeTextsBetweenStrings=function(e,t,n,r,o,i){if(null==e||null==t||null==n)return null;var s=function(e){var i=e.indexOf(t),s=e.indexOf(n,i);return-1==i||-1==s?null:e.substr(0,i-(r?t.length:0))+e.substr(s+(o?0:n.length))},l=s(e);l&&(e=l);var a=1;for(i=i>0?i:Number.MAX_SAFE_INTEGER;l&&a<i;)l=s(e=l),a++;return e},getWords=function(e,t=!0,n=!0,r=!0,o=!0,i=0,s=3,l=" "){if(null==e)return null;var a;l=""==l?" ":l;var u=StringOperators_LINK_REGEX;let h,c,f;if("string"!=typeof e&&(e=String(e)),o&&(a=e.match(u)),e=e.toLowerCase().replace(u,""),f=" "==l?e.match(/[A-Za-z_0-9---]+/g):splitString(e,l,null,!0),null==f)return new sL;var p;if(f=sL.toL(f),f=f.getFilteredByFunction((function(e){return""!=e})),o&&null!=a&&(f=f.concat(a))," "==l&&(f=sL.toL(f).replace(/ /g,"")),null!=n){var g=!0;if(!0===n)n=StringOperators_STOP_WORDS,g=!1;else for(g=!1,c=0;c<n.length;c++)if("object"==typeof n[c]){g=!0;break}if(g){p=f.length;var d=n.length;for(h=0;h<p;h++)for(c=0;c<d;c++)if("string"==typeof n[c]){if(n[c]==f[h]){f.splice(h,1),h--,p=f.length;break}}else if(n[c].test(f[h])){f.splice(h,1),h--,p=f.length;break}}else f=f.getWithoutElements(n),p=f.length}if(s>1)for(p=f.length,h=0;h<p;h++)f[h].length<s&&(f.splice(h,1),h--,p=f.length);if(r){if(t)f=f.getFrequenciesTable(!0)[0];else{var m=f.getFrequenciesTable(),y=new sL;for(h=0;h<m[0].length;h++)for(c=0;c<m[1][h];c++)y.push(m[0][h]);f=y}return i>0&&(f=f.splice(0,i)),f}return t&&(f=f.getWithoutRepetitions()),i>0&&(f=f.splice(0,i)),f},getBigrams=function(e,t=!0,n=!0,r=!0,o=3){!0===n&&(n=StringOperators_STOP_WORDS);let i=(e=cleanText(e,!0,!0," ",!0,!0,n,!0,!0)).split(" "),s=new sL,l=i.length-1;for(let e=0;e<l;e++)i[e].length>=o&&i[e+1].length>=o&&s.push(i[e]+" "+i[e+1]);return t&&(s=s.getWithoutRepetitions()),s},substr=function(e,t,n){return null==e?null:(t=t||0,e.substr(t,n))},splitString=function(e,t,n,r){if(null==e)return null;if(null!=n&&!isNaN(n)&&0!=n){var o=e.match(/\w+/g);null==o&&(o=[e]);var i=!0,s=e.length/o.length/2;n>o.length&&(i=!1,s=0);for(var l,a,u,h=new h,c=e;c.length>0;){if(u=Math.max(1,Math.floor(c.length/(n-h.length)-s)),h.length==n-1){h.push(c);break}-1==(a=i?c.substring(u-1).search(/\s/):0)?a=u:a+=u,l=c.substring(0,a),h.push(l),c=c.substring(a)}return r?h.trim():h}return null==t&&(t=","),"string"==typeof t&&(t=t.replace("\\n","\n")),-1==e.indexOf(t)?new h(e):(h=h.toL(e.split(t)),r?h.trim():h)},getFirstTextBetweenStrings=function(e,t,n){if(null==e)return null;let r=e.indexOf(t);if(-1==r)return null;if(""===n||null==n)return e.substr(r+t.length);let o=e.indexOf(n,r+t.length+1);return-1==o?e.substring(r+t.length):e.substr(r+t.length,o-(r+t.length))},getAllTextsBetweenStrings=function(e,t,n){if(-1==e.indexOf(t))return new sL;let r,o,i,s=e.split(t),l=s.length,a=new sL;for(i=1;i<l;i++)r=s[i],n==t?a.push(r):(o=r.indexOf(n),o>=0&&a.push(r.substr(0,o)));return a},textContainsString=function(e,t,n,r){return e=r?t:e.toLowerCase(),t=r?t:t.toLowerCase(),n?e.match(new RegExp("\\b"+t+"\\b")).length>0:-1!=e.indexOf(t)},getParenthesisContents=function(e,t){let n=new sL;for(var r=e,o=getFirstParenthesisContentWithIndexes(e,t),i=0;""!==o.content&&o.index1<r.length-1&&i<e.length;)n.push(o.content),r=r.substr(o.index1+2),o=getFirstParenthesisContentWithIndexes(r,t),i++;return n},getFirstParenthesisContent=function(e,t){return getFirstParenthesisContentWithIndexes(e,t).content},getFirstParenthesisContentWithIndexes=function(e,t){let n=t?"[":"(",r=t?"]":")";var o=t?/\[/g:/\(/g;let i=t?/\]/g:/\)/g;var s=e.indexOf(n);if(-1==s)return{content:"",index0:0,index1:0};var l=e.indexOf(r),a=e.substring(s+1,l),u=a.match(o);let h=a.match(i);var c=(null==u?0:u.length)-(null==h?0:h.length);let f=0;for(;(c>0||-1==l)&&f<e.length;)l=e.indexOf(r,l),a=e.substring(s+1,l+1),l++,u=a.match(o),h=a.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f++;return{content:-1==(l=e.indexOf(r,l))?e.substring(s+1):e.substring(s+1,l),index0:s+1,index1:-1==l?e.length-1:l-1}},placeString=function(e,t,n){return e.substr(0,n)+t+e.substr(n+t.length)},insertString=function(e,t,n){return e.substr(0,n)+t+e.substr(n)},cleanText=function(e,t,n,r,o,i,s,l,a){return null==e?null:e.isList?cleanTexts(e,t,n,r,o,i,s,l,a):(t&&(e=removeEnters(e,r)),n&&(e=removeTabs(e,r)),o&&(e=removePunctuation(e)),i&&(e=e.toLowerCase()),null!=s&&(!0===s&&(s=StringOperators_STOP_WORDS),e=replaceStringsInText(e,s,"",!0)),l&&(e=removeDoubleSpaces(e)),a&&(e=removeAccentsAndDiacritics(e)),e)},removeEnters=function(e,t){return null==e?null:(t=null==t?"":t,e.replace(/(\r|\n)/g,t))},removeTabs=function(e,t){return null==e?null:(t=t||"",e.replace(/\t/g,t))},removePunctuation=function(e,t){return null==e?null:(t=t||"",e.replace(/[:,.;?!\(\)\"\']/gi,t))},removeDoubleSpaces=function(e){if(null==e)return null;let t=e,n=RegExp(/\s\s/g);for(;n.test(t);)t=t.replace(n," ");return t},removeHtmlTags=function(e){let t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText},escapeForRegExp=function(e){return null==e?null:e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},removeLinks=function(e){return(e+=" ").replace(/https*:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g," ").substr(0,e.length-2)},removeQuotes=function(e){return'"'==e.charAt(0)&&(e=e.substr(1)),'"'==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e},removeAccentsAndDiacritics=function(e){let t=e.replace(new RegExp(/[]/g),"a");return t=t.replace(new RegExp(//g),"ae"),t=t.replace(new RegExp(//g),"c"),t=t.replace(new RegExp(/[]/g),"o"),t=t.replace(new RegExp(//g),"oe"),t=t.replace(new RegExp(/[]/g),"u"),t=t.replace(new RegExp(/[]/g),"y"),t=t.replace(new RegExp(/[]/g),"A"),t=t.replace(new RegExp(//g),"AE"),t=t.replace(new RegExp(//g),"c"),t=t.replace(new RegExp(/[]/g),"E"),t=t.replace(new RegExp(/[]/g),"I"),t=t.replace(new RegExp(/[]/g),"e"),t=t.replace(new RegExp(/[]/g),"i"),t=t.replace(new RegExp(//g),"n"),t=t.replace(new RegExp(//g),"N"),t=t.replace(new RegExp(/[]/g),"O"),t=t.replace(new RegExp(//g),"OE"),t=t.replace(new RegExp(/[]/g),"U"),t=t.replace(new RegExp(/[]/g),"Y"),t},getWordsOccurrencesTable=function(e,t,n,r,o,i){if(null==e)return;if(0===e.length)return new T(new sL,new nL);1==t&&(t=StringOperators_STOP_WORDS);var s=getWords(e,!1,t,!1,n,null,o,i);let l;return l=null!=r?s.getFrequenciesTable(!0).sliceRows(0,r-1):s.getFrequenciesTable(!0),l[0].name="Word",l[1].name="Frequency",l},indexesOf=function(e,t,n){let r,o;if(n){var i;for(r=new nL,t=new RegExp("\\b"+t+"\\b"),o=e.search(t),-1!=o&&(e=e.substr(o));-1!=o;)r.push(o),i=o,o=e.search(t),e=e.substr(o+1),o>=0&&(o+=i);return r}if(o=e.indexOf(t),-1==o)return new nL;for(r=new nL(o),o=e.indexOf(t,o+1);-1!=o;)r.push(o),o=e.indexOf(t,o+1);return r},indexesOfString=function(e,t,n){return indexesOf(e,t,n)},repeatString=function(e,t){let n,r="";for(n=0;n<t;n++)r+=e;return r},countStringOccurrences=function(e,t,n){return countOccurrences(e,t,n)},countOccurrences=function(e,t,n){if(n)return countWordOccurrences(e,t);var r=0;let o=e.indexOf(t);for(;-1!=o;)r++,o=e.indexOf(t,o+t.length);return r},countWordOccurrences=function(e,t){let n=new RegExp("\\b"+t+"\\b");return countRegexOccurrences(e,n)},countRegexOccurrences=function(e,t){let n=e.match(t);return null==n?0:n.length},countStringsOccurrences=function(e,t,n){if(null==e||null==t)return;var r;let o=new nL,i=t.length;for(r=0;r<i;r++)o[r]=n?countRegexOccurrences(e,new RegExp("\\b"+t[r]+"\\b")):countOccurrences(e,t[r]);return o},validateEmail=function(e){return StringOperators_MAIL_REGEX.test(e)},validateUrl=function(e){return StringOperators_LINK_REGEX.test(e)},getClosestLevenshtein=function(e,t,n=0){let r=t[0],o=99999;return t.forEach((t=>{let n=getLevenshteinDistance(e,t);n<o&&(o=n,r=t)})),0==n?r:{closest:r,distance:o}},getLevenshteinDistance=function(e,t,n){if(t=null==t?"":t,0===(e=null==e?"":e).length&&0===t.length)return 0;if(0===e.length)return n?1:t.length;if(0===t.length)return n?1:e.length;var r=[];let o,i;for(o=0;o<=t.length;o++)r[o]=[o];for(i=0;i<=e.length;i++)r[0][i]=i;for(o=1;o<=t.length;o++)for(i=1;i<=e.length;i++)t.charAt(o-1)==e.charAt(i-1)?r[o][i]=r[o-1][i-1]:r[o][i]=Math.min(r[o-1][i-1]+1,Math.min(r[o][i-1]+1,r[o-1][i]+1));if(n){var s=r[t.length][e.length]/Math.max(e.length,t.length);return Number(s.toFixed(5))}return r[t.length][e.length]},getNgrams=function(e,t=2,n=2,r,o=0,i=0,s){let l,a,u;n<t&&(n=t),!0===r&&(r=StringOperators_STOP_WORDS),1!=(s=null==s?null==r?1:0:s)&&null==r&&(r=StringOperators_STOP_WORDS),1==s&&(r=null);let h=new sL;if(null==e||"string"!=typeof e)return h;let c=StringOperators_LINK_REGEX,f=(e=e.toLowerCase().replace(c,"")).match(/\w+|[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/g);if(null==f)return h;f=sL.toL(f);var p=/[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/;for(l=0;l<f.length;l++)if(u=f[l],!(r&&-1!=r.indexOf(f[l])||i&&f[l].length<i||1==f[l].length&&f[l].match(p))){for(1==t&&h.push(u),a=l+1;a<f.length&&a<l+n&&(!r||-1==r.indexOf(f[a])||0!=s)&&!(i&&f[a].length<i)&&(1!=f[a].length||!f[a].match(p));a++)if(a>=l+t-1){if(u=u+" "+f[a],2==s&&-1!=r.indexOf(f[a]))continue;if(h.push(u),0!==o&&h.length==o)break}else u=u+" "+f[a];if(0!==o&&h.length==o)break}return h},stringToFunction=function(string){if(null==string)return;var realCode;let myTempraryFunction;if(-1!=string.search(/function\(/))return realCode="myTempraryFunction = "+string,eval(realCode),myTempraryFunction;for(var func,i=0;i<methods.length;i++)if(methods[i].methodName==string){if(methods[i].isPrototype){var funcName=string;func=function(e,t,n,r,o,i,s){return null==e[funcName]?null:e[funcName](t,n,r,o,i,s)}}else func=methods[i].func;break}return null!=func?func:(realCode="myTempraryFunction = function(x){return "+string+"}",eval(realCode),myTempraryFunction)},stringFormat=function(e,t,n,r){if(null==e||null==t||null==n)return null;let o,i;if(r=null==r?0:r,"sL"==e.type||"Array"==_typeOf(e)){var s=new sL;for(s.name=e.name,o=0;o<e.length;o++)s.push(stringFormat(e[o],t,n,r));return s}if(e="string"!=typeof e?String(e):e,t="string"!=typeof t?String(t):t,n="string"!=typeof n?String(n):n,e.length!=t.length){if(0==r)return e;if(1==r)return null;throw new Error("Input string must be same length as the input pattern")}if(new Set(t).size!=t.length)throw new Error("All characters in the input pattern must be unique");var l=n;for(o=0;o<n.length;o++)i=t.indexOf(n[o]),-1!=i&&(l=l.substring(0,o)+e[i]+l.substring(o+1));return l},createListWithSameElement=function(e,t,n){if(null==e)return null;var r,o;switch(Array.isArray(e)&&(e=e.length),_typeOf(t)){case"number":r=new nL;break;case"L":r=new T;break;case"nL":r=new nT;break;case"Rec":r=new recL;break;case"string":r=new sL;break;default:r=new L}for(o=0;o<e;o++)r[o]=t;return null!=n&&(r.name=n),r},createIterationSequence=function(e,t,n){let r=createListWithSameElement(1,t);for(var o=1;o<e;o++)r[o]=n(r[o-1]);return r},createListWithUniqueElements=function(e,t=0,n,r,o=5){let i;var s,l;if(i=""==(n=null==n?"":n)&&1==t?new nL:new sL,null!=r&&(i.name=r),0==t){for(var a=1,u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=u.length;e>Math.pow(h,a);)a++;var c,f=createListWithSameElement(a,0);for(s=0;s<e;s++){for(c="",l=0;l<f.length;l++)c=u[f[l]]+c;for(i.push(n+c),l=0;l<f.length&&(f[l]++,f[l]==h);l++)f[l]=0}}else if(1==t)for(s=0;s<e;s++)""==n?i.push(s+1):i.push(n+(s+1));else if(2==t)for(s=0;s<e;s++)c=StringOperators_WORDLISTS.lorem.getRandomElements(o).join(" "),i.push(c);return i},replaceChomasInTextLine=function(e,t){let n,r,o,i=e.split('"');if(i.length<2)return e;for(t=null==t?",":t,o=new RegExp("\\"+t,"g"),r=0;null!=i[r];r++)n=.5*r!=Math.floor(.5*r),n&&(i[r]=i[r].replace(o,"*CHOMA*"));return e=sL.toL(i).getConcatenated("")},_replaceSpacesInLine=function(e){let t,n,r=e.split('"');if(r.length<2)return e;for(n=0;null!=r[n];n++)t=.5*n!=Math.floor(.5*n),t&&(r[n]=r[n].replace(/ /g,"*SPACE*"));return e=sL.toL(r).getConcatenated('"')},decodeTextNet=function(e){if(null==e)return;if(""===e)return new Net;var t,n;let r,o,i,s,l,a,u,h,c,f,p,g;console.log("\n\n*************////////// decodeTextNet //////////*************");let d,m,y,x,w,L=[],v=[],b=[],T=new Net,_=new sL;T.nodesPropertiesNames=new sL,T.relationsPropertiesNames=new sL,h=e.split(/\n/g),h.forEach((function(e,t){h[t]=e.trim()})),e=h.join("\n");for(var M=0;"\n"==e.charAt(0);)e=e.substr(1),M++;var S,N=e;for(a=N.search(/\n\n./g);-1!=a;)_.push(N.substr(0,a)),N=N.substr(a+2),a=N.search(/\n\n./g);_.push(N),_.forEach((function(e){if(-1==e.indexOf("\n")?(r=e,h=null):(h=e.split(/\n/g),r=h[0]),h&&(h=h.filter((e=>""!=e.trim()))),S=r,"\n"==r||""===r||" "==r||"  "==r);else if(0===r.indexOf("//"))null==b[M]&&(b[M]=[]),b[M].push({type:"comment",iStart:0,iEnd:r.length});else if("relations colors:"==r||"groups colors:"==r||"categories colors:"==r)h&&h.slice(1).forEach((function(e,t){a=e.indexOf(":"),"relations colors:"==S&&-1!=a&&null!=colorStringToRGB(e.split(":")[1])&&(L.push(e),null==b[M+t]&&(b[M+t]=[]),b[M+t].push({type:"relation_color",iStart:0,iEnd:e.length})),"groups colors:"!=S&&"categories colors:"!=S||-1==a||null==colorStringToRGB(e.split(":")[1])||(v.push(e),null==b[M+t]&&(b[M+t]=[]),b[M+t].push({type:"relation_color",iStart:0,iEnd:e.length}))}));else{for(u=99999999,a=r.indexOf(NetworkEncodings_nodeNameSeparators[0]),-1!=a&&(u=a,g=NetworkEncodings_nodeNameSeparators[0]),n=1;n<NetworkEncodings_nodeNameSeparators.length;)a=r.indexOf(NetworkEncodings_nodeNameSeparators[n]),-1!=a&&(u=Math.min(a,u),g=NetworkEncodings_nodeNameSeparators[n]),n++;a=99999999==u?-1:u,l=-1==a?r:r.substr(0,a),l=l.trim(),""!==l&&"---"!=l&&(i=_simplifyForTextNet(l),c=T.nodes.get(i),m=-1==a?r.length:a,null==c?(c=new Nd(i,l),c._nLine=M,T.addNode(c),c.content=-1!=a?r.substr(a+g.length).trim():"",c._lines=h?h.slice(1):new sL,c.position=T.nodes.length-1,c.impact=1,null==b[M]&&(b[M]=[]),b[M].push({type:"node_name",iStart:0,iEnd:m})):(null!=h&&(c._lines=c._lines.concat(h.slice(1))),c.content+=-1!=a?" |"+r.substr(a+g.length).trim():"",null==b[M]&&(b[M]=[]),b[M].push({type:"node_name_repeated",iStart:0,iEnd:m})))}c.content=c._lines.join(" / "),M+=(h?h.length:1)+1}));for(var R=!0;R;){R=!1;e:for(t=0;null!=T.nodes[t];t++)for(c=T.nodes[t],n=0;null!=c._lines[n];n++)if(r=c._lines[n],0===r.indexOf("=")){if(s=_simplifyForTextNet(r.substr(1)),f=T.nodes.get(s),f&&c!=f){R=!0,c._lines=f._lines.concat(f._lines),T.nodes.removeNode(f),T.nodes.ids[f.id]=c;break e}T.nodes.ids[s]=f,c._otherIds||(c._otherIds=[]),c._otherIds.push(s)}}let E=new sL;if(T.nodes.forEach((function(e){M=e._nLine,e._lines.forEach((function(t,r){-1!=t.indexOf("=")||(t.indexOf(":")>0?(o=t.trim(),y=removeAccentsAndDiacritics(o.split(":")[0]).replace(/\s/g,"_"),x=t.split(":")[1].trim(),x==String(Number(x))&&(x=Number(x)),null!=x&&("x"==y&&(y="_x"),"y"==y&&(y="_y"),e[y]=x,"category"==y&&E.pushIfUnique(String(x)),T.nodesPropertiesNames.includes(y)||T.nodesPropertiesNames.push(y))):(o=t,T.nodes.forEach((function(s){if(d=_regexWordForTextNet(s.id),a=o.search(d),-1==a&&s._otherIds)for(n=0;null!=s._otherIds[n]&&(d=_regexWordForTextNet(s._otherIds[n]),a=o.search(d),-1==a);n++);if(-1!=a)if(m=a+o.substr(a).match(d)[0].length,p=T.relations.getFirstRelationBetweenNodes(e,s,!0),null!=p)w=p.node0.name+" "+t,p.content+=" | "+w,null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_repeated_relation",iStart:a,iEnd:m});else{p=T.relations.getFirstRelationBetweenNodes(s,e,!0);var l=t;d=_regexWordForTextNet(e.id),a=l.search(d),-1!=a&&(l=(l=l.substr(a)).replace(d,"").trim()),d=_regexWordForTextNet(s.id),a=l.search(d),l=" "+l.substr(0,a).trim()+" ",i=t,p=new Rel(t,l,e,s),w=p.node0.name+" "+t,0==t.indexOf("- ")?(p.color="red",p.influence=-1):0==t.indexOf("+ ")?(p.color="blue",p.influence=1):p.influence=0,p.content=w,T.addRelation(p),null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_relation",iStart:a,iEnd:m})}}))))})),e.positionWeight=Math.pow(T.nodes.length-e.position-1/T.nodes.length,2),e.combinedWeight=e.positionWeight+.1*e.nodes.length})),E.length>0){console.log("categories:",E);let e=createDefaultCategoricalColorList(E.length),t={};E.forEach(((n,r)=>t[n]=interpolateColors(e[r],"white",.8))),T.nodes.forEach((e=>e.color=t[e.category]))}return L.forEach((function(e){a=e.indexOf(":"),e.substr(0,a).split(",").forEach((function(t){var n=e.substr(a+1);T.relations.forEach((function(e){-1!=e.name.indexOf(t)&&(e.color=n)}))}))})),v.forEach((function(e){a=e.indexOf(":"),e.substr(0,a).split(",").forEach((function(t){var n=e.substr(a+1);T.nodes.forEach((function(e){e.group==t&&(e.color=n),e.category==t&&(e.color=n)}))}))})),T.colorSegments=b,T},_simplifyForTextNet=function(e){return("es"==(e=e.toLowerCase()).substr(e.length-2)||"s"==e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e.trim()},_regexWordForTextNet=function(e,t){t=null==t||t;try{return new RegExp("(\\b)("+e+"|"+e+"s|"+e+"es)(\\b)",t?"gi":"i")}catch(e){return null}},encodeTextNet=function(e,t,n,r){if(null==e)return;var o="";let i,s;var l;return t=t||", ",n=n||[],r=r||[],e.nodes.forEach((function(e){o+=e.name,e.content&&""!==e.content&&(o+=t+e.content),o+="\n",n.forEach((function(t){null!=e[t]&&(o+=t+":"+String(e[t])+"\n")})),l=new sL,e.toRelations.forEach((function(e){var t=null!=e.content&&""!==e.content||!e.description?e.content:e.description;t&&""!==t?(i=_regexWordForTextNet(e.node1.name),s=t+(null!=i&&-1==t.search(i)?" "+e.node1.name:"")):s="connected with "+e.node1.name,-1==l.indexOf(s)&&(o+=s,o+="\n",l.push(s))})),o+="\n"})),o},modelInfluence=function(e,t,n=1,r=1){if(null==t)return;"string"==typeof t&&(t=e.get(t)),e.nodes.forEach((e=>e.impact=1)),e.relations.forEach((e=>e._impact_hits=0)),t.impact=n;!function(t,n){if(n>15)return;let o,i,s;for(var l=0;l<1e4;l++){let t=e.relations.getRandomElement();if(0==t.influence)continue;let n=t.node0,l=t.node1;i=r*(n.impact-1)**2*(1/(1+.9*t._impact_hits)),o=1+i,s=l.impact,t._impact_hits++,t.influence>0?(n.impact>1?l.impact*=o**2:l.impact/=o,"gras"==n.id&&"otter"==l.id&&console.log("1 grass otter | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",l.impact)):t.influence<0&&(n.impact>1?l.impact/=o:l.impact*=o**2,"gras"==l.id&&"deer"==n.id&&console.log("-1 deer grass | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",l.impact)),l.impact=0*l.impact+2/(1+Math.pow(Math.E,-2*(l.impact-1)))*1}}(0,0),e.nodes.forEach((e=>console.log(e.name,e.impact)))},NetworkToTable=function(e,t,n,r){if(null==e)return;t=null==t||t,r=null==r?0:r;var o=n?new T:new nT;let i=t?e.nodes.getIds():e.nodes.getNames();var s;i.name="node names",n&&(o[0]=i);let l,a,u=e.nodes.length,h=e.relations.length,c={};var f=n?1:0;for(l=0;l<u;l++)(s=createListWithSameElement(u,0)).name=i[l],o.push(s),c[e.nodes[l].id]=l;for(l=0;l<h;l++)a=e.relations[l],0===r?o[c[a.node0.id]+f][c[a.node1.id]]++:o[c[a.node0.id]+f][c[a.node1.id]]+=a.weight;return o},TableToNetworkPairs=function(e,t,n=0,r=!1,o=0,i,s=","){if(null==e||null==e[0]||null==e[1])return;var l;let a,u,h,c,f,p,g,d,m=new Net;if("nT"==e.type&&e.length>2&&e.length==e[0].length){for(l=e.length,p=0;p<l;p++)h=null==i?null==e[p].name||""==e[p].name?"node_"+p:e[p].name:i[p],h&&(a=new Nd(h,h),m.addNode(a));for(p=0;p<l;p++)for(d=e[p],a=m.nodes[p],g=0;g<l;g++)u=m.nodes[g],d[g]>n&&(f=new Rel(p+"_"+g,p+"_"+g,a,u,d[g]),m.addRelation(f));return m}let y=createSortedNumberList(e[0]);if(y.name="indexes",e[0].join("").includes(s)){let t=toT(e);e.push(y);var x=disAggregateTable(t,t.getWithoutElementAtIndex(0).getNames(),0);x.setNames(t.getNames()),y=x.get("indexes"),e=x=(x=x.getWithoutElement(y)).getColumns(3==x.length?[2,0,1]:[1,0])}if(e[1].join("").includes(s)){let t=toT(e);t.push(y),(x=disAggregateTable(t,t.getWithoutElementAtIndex(1).getNames(),1)).setNames(e.getNames()),y=x.get("indexes"),e=x=(x=x.getWithoutElement(y)).getColumns(3==x.length?[2,0,1]:[1,0])}if(e.length<2)return null;l=null==t?Math.min(e[0].length,e[1].length):Math.min(e[0].length,e[1].length,t.length),null==t&&e.length>2&&"nL"==_typeOf(e[2])&&e[2].length>=l&&(t=e[2]),_typeOf(e[0])==ndL&&(_typeOf(e[1]),NodeList);var w=new ndL;let L;for(p=0;p<l;p++)h=(""+e[0][p]).trim(),c=(""+e[1][p]).trim(),h&&c&&"undefined"!=h&&"undefined"!=c&&(a=m.nodes.get(h),null==a?(a=new Nd(h,h),m.addNode(a),a.color="rgb(255,140,80)",a.kind=e[0].name,a.indexes=new nL):a.weight++,a.indexes.push(y[p]),u=m.nodes.get(c),null==u?(u=new Nd(c,c),m.addNode(u),u.color="rgb(60,180,255)",u.kind=e[1].name,u.indexes=new nL):(u.weight++,"rgb(200,100,0)"==u.color&&(u.color="rgb(100,100,100)")),u.indexes.push(y[p]),null==t?r?(L=h+"_"+c+"_"+p,f=new Rel(L,h+"_"+c,a,u,1),m.addRelation(f)):(L=h+"_"+c+"_",f=w.get(L),null==f||r?(f=new Rel(L,L,a,u,1),w.addNode(f)):f.weight++):t[p]>n&&(f=new Rel(h+"_"+c,h+"_"+c,a,u,t[p]),m.addRelation(f)),i&&(f.content=i[p]));let v=0;if(m.nodes.forEach((e=>{e.indexes=e.indexes.getWithoutRepetitions(),v=Math.max(v,e.weight)})),null==t)if(r)for(p=0;p<w.length;p++)m.addRelation(w[p]);else for(p=0;p<w.length;p++)w[p].weight>n&&m.addRelation(w[p]);if(0)for(p=0;null!=m.nodes[p];p++)m.nodes[p].relations.length<0&&(m.removeNode(m.nodes[p]),p--);return m.nodes.forEach((e=>e.weight/=v)),v=0,m.relations.forEach((e=>{v=Math.max(v,e.weight)})),m.relations.forEach((e=>e.weight/=v)),m},matrixToNetwork=function(e){let t,n,r,o,i=new Net;for(var s=1;s<e.length;s++){t=i.get(e[s].name),null==t&&(t=new Nd(e[s].name,e[s].name),i.addNode(t));for(var l=0;l<e[0].length;l++)e[s][l]>0&&(o=String(e[0][l]),n=i.get(o),null==n&&(n=new Nd(o,o),i.addNode(n)),o=s-1+"_"+l,r=new Rel(o,t.name+"_"+n.name,t,n,e[s][l]),i.addRelation(r))}return i},CSVToTable=function(e,t=!0,n,r,o,i){if(null==e)return null;if(o=null!=o&&o,-1==e.indexOf("\n")&&-1==e.indexOf(",")&&-1==e.indexOf(";"))throw 0===e.indexOf("http:/")||0===e.indexOf("https:/")||0===e.indexOf("fttp:/")||0===e.indexOf("fttps:/")?new Error("The provided string seems to be a url, not a csv<br><br>Use <b>CSVLoader</b> to upload and decode csv files"):new Error("the provided string doesn't seem to be a csv, it contains no enters or chomas");var s,l=2==t;if(l&&(t=!0),null==e)return null;if(""===e)return new T;var a=(e=e.replace(/\$/g,"")).split('"');for(C=1;null!=a[C];C+=2)a[C]=a[C].replace(/\n|\r/g,"*ENTER*");var u=(e=a.join('"')).split(/\n|\r/g);if(1==u.length&&t)throw new Error("CSV contains only one line and firstRowIsHeader is true, a T can't be build");if("auto"==n){var h,c,f=[",",";",":","|","\t","+","-","_"],p=u.slice(0,11).join("\n"),g=0,d=",";for(C=0;C<f.length;C++){try{h=CSVToTable(p,t,f[C])}catch(e){h=null}if(null!=h&&0!=h.length){if(buildInformationObjectForTable(h),c=h.length,t)c-=h.getNames().getElementNumberOfOccurrences("");var m=h.reduce((function(e,t){return e+t.getElementNumberOfOccurrences(null)}),0),y=h.reduce((function(e,t){return e+t.length}),0);c-=0==y?0:m/y,h.infoObject.allListsSameLength||c--,c>g&&(g=c,d=f[C])}}n=d}"\\t"!=(n=null==n||""===n?",":n)&&"tab"!=n||(n="\t");var x=new T;let w=n;if(null==e||""===e||" "==e||0===u.length)return null;var v=0;let b;if(t)if(v=1,l)for(b=replaceChomasInTextLine(u[0],n).split(","),C=0;C<b.length;C++)b[C]=b[C].replace("*CHOMA*",n);else b=u[0].split(w);var _;let M,S,N;var R;for(C=0,R=v;R<u.length;R++)if(!(u[R].length<2)){for(N=replaceChomasInTextLine(u[R],n).split(w),s=0;s<N.length;s++)x[s]=null==x[s]?new L:x[s],t&&0===C&&(x[s].name=(null==b[s]?"":_removeQuotes(b[s])).trim()),M=N[s].replace(/\*CHOMA\*/g,n).replace(/\*ENTER\*/g,"\n"),M=""===M?r:M,null!=M?(M=String(M),S=Number(M.replace(",",".")),"string"==typeof(_=S||0===S&&""!==M?S:M)&&(_=_removeQuotes(_))):_=null,x[s][C]=_;C++}for(C=0;null!=x[C];C++)x[C]=x[C].downcast(),o&&"L"==x[C].type&&(x[C]=toStringList(x[C]));if((x=x.downcast()).name=i,l){for(var E=!0,O=0,C=0;C<x.length;C++)if("nL"==x[C].type&&(O++,String(Number(x[C].name))!=Number(x[C].name))){E=!1;break}if(!E)return x;var D=0,P=0;for(C=0;C<x.length;C++){if("nL"!=x[C].type)if(P++,x[C].includes(x[C].name))D++;else x[C].getWithoutRepetitions().length==x[C].length&&D++}if(P>0&&(D+O)/x.length>.3)for(C=0;C<x.length;C++)x[C].unshift(x[C].name),x[C].name="col "+C}return x},_removeQuotes=function(e){return 0===e.length||'"'!=e.charAt(0)&&"'"!=e.charAt(0)||'"'!=e.charAt(e.length-1)&&"'"!=e.charAt(e.length-1)||(e=e.substr(1,e.length-2)),e},TableToCSV=function(e,t=",",n=!0,r,o){if(null==e)return;let i,s,l,a,u,h=createListWithSameElement(e[0].length,"");for(i=0;null!=e[i];i++)for(l=e[i],a=l.type,u=i!=e.length-1,s=0;s<l.length;s++){if(null!==l[s])if("nL"===a)h[s]+=l[s];else h[s]+=null!=r?String(l[s]).replace(/,/g,r):'"'+l[s]+'"';u&&(h[s]+=t)}var c="";if(n){for(i=0;null!=e[i];i++)l=e[i],c+=null!=r?l.name.replace(/,/g,r):'"'+l.name+'"',i!=e.length-1&&(c+=t);c+="\n"}return(o?e.getTypes().join(t)+"\n":"")+c+h.getConcatenated("\n")},TableToJSONString=function(e,t){if(null==e)return"";let n=e.slice(0),r=e.getNames(),o=e.getTypes(),i=[];for(var s=0;s<e.length;s++)void 0===e[s].containsNulls?i.push(null):i.push(e[s].containsNulls);let l={data:n,name:e.name,type:e.type,handle:e.handle,names:r,types:o,nulls:i};if(void 0!==e.containsNulls&&(l.containsNulls=e.containsNulls),t)return l;try{return JSON.stringify(l)}catch(e){return JSON.stringify({error:"cannot convert."})}},JSONStringToTable=function(e){if(null==e||0==e.length)return new T;let t,n,r;if("object"==typeof e)t=e;else try{t=JSON.parse(e)}catch(e){return null}if(r="nT"==t.type?nT.toL(t.data):T.toL(t.data),r.name=null==t.name?t.name:String(t.name),r.type=t.type,null!=t.handle&&(r.handle=t.handle),null!=t.containsNulls&&(r.containsNulls=t.containsNulls),t.types&&t.types.length>0){for(n=0;n<t.types.length;n++)if(r[n])switch(t.types[n]){case"sL":r[n]=sL.toL(r[n],!1);break;case"nL":r[n]=nL.toL(r[n],!1);break;case"dL":r[n]=dL.toL(r[n],!0);break;case"iL":r[n]=iL.toL(r[n],!1)}}else for(n=0;n<r.length;n++)if(r[n]=r[n].downcast(),"sL"==r[n].type){for(var o=!0,i=0;o&&i<r[n].length;i++)o=!isNaN(r[n][i])&&""!==r[n][i].trim();o&&(r[n]=toNumberList(r[n]))}if(t.names)for(n=0;n<t.names.length;n++)r[n]&&(r[n].name=String(t.names[n]));if(t.nulls)for(n=0;n<t.nulls.length;n++)r[n]&&null!=t.nulls[n]&&(r[n].containsNulls=t.nulls[n]);return r},NumberListToPolygon=function(e){if(0===e.length)return null;let t=new Pol;for(var n=0;null!=e[n+1];n+=2)t.push(new P(e[n],e[n+1]));return t},NumberListToStringList=function(e){let t,n=new sL;for(t=0;null!=e[t];t++)n[t]=String(e[t]);return n.name=e.name,n},ObjectToTable=function(e,t){if(null==e)return null;let n,r,o,i,s,l;if(Array.isArray(e)){if(n=1,!t)for(r in t=[],e[0])e[0].hasOwnProperty(r)&&t.push(r)}else{var a=[];for(r in e)a.push(r);if(1==a.length&&Array.isArray(e[a[0]])){if(n=1,e=e[a[0]],!t)for(r in t=[],e[0])t.push(r)}else n=3,t||(t=a)}let u=new T;for(i=0;i<t.length;i++){var h=t[i];o=new L,u[i]=o,o.name=h}if(1==n)for(i=0;i<e.length;i++){var c=e[i];for(s=0;s<t.length;s++)u[s].push(c[t[s]])}else for(s=0;s<t.length;s++)for(o=e[t[s]],i=0;i<o.length;i++)u[s].push(o[i]);for(i=0;i<u.length;i++){var f=u[i].getTypeOfElements();if(""==f||"Object"==f){var p=!0,g="";for(l=0;l<u[i].length&&p;l++)if(null!==u[i][l]){if("Object"!=_typeOf(u[i][l])){p=!1;break}""==g?g=getObjectStructure(u[i][l]):g!=getObjectStructure(u[i][l])&&(p=!1)}p||(f="")}if("Object"==f){var d=ObjectToTable(u[i]),m=u[i].name;for(l=0;l<d.length;l++)d[l].name=m+"_"+d[l].name;u=T.toL(u.slice(0,i).concat(d).concat(u.slice(i+1))),i--}}for(i=0;i<u.length;i++)u[i]=u[i].downcast();return u=u.downcast(),u},ObjectToList=function(e,t){let n=ObjectToTable(e,t);if(1==n.getLengths.getMax())return n.getRow(0)},objectToString=function(e){try{return JSON.stringify(e)}catch(e){return JSON.stringify({error:"cannot convert."})}},conversor=function(e,t){if(null==e||null==t)return;var n;let r;switch(_typeOf(e)+"_"+t){case"Array_List":return ArrayToList(e);case"NumberTablePolygon":var o=new Pol,i=e.length>1;for(n=0;null!=e[0][n];n++)o[n]=new P(e[0][n],i?e[1][n]:0);return o;case"date_string":return dateToString(e);case"string_date":return stringToDate(e);case"date_number":return e.getTime();case"number_date":return new Date(e);case"List_StringList":case"NumberList_StringList":return NumberListToStringList(e);case"DateList_StringList":return DateListToStringList(e);case"StringList_NumberList":return StringListToNumberList(e);case"Object_string":return JSON.stringify(e,null,"\t");case"string_Object":return JSON.parse(e);case"string_ColorScale":return ColorScales[e];case"string_Table":return CSVToTable(e);case"StringList_DateList":return r=new dL,e.forEach((function(e){r.push(stringToDate(e))})),r.name=e.name,r;case"DateList_NumberList":return e.getTimes();case"Table_Network":return TableToNetworkPairs(e,null,0,!1)}switch(t){case"string":return e.toString();case"number":return Number(e)}return null},ArrayToList=function(e){if(null!=e)return L.toL(e).downcast()},angleFromTwoPoints=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},dot=function(e,t){return e.x*t.x+e.y*t.y},twoPointsInterpolation=function(e,t,n){return new P((1-n)*e.x+n*t.x,(1-n)*e.y+n*t.y)},pointMultiplication=function(e,t){return new P(e.x*t.x-e.y*t.y,e.y*t.x+e.x*t.y)},normalizeTableToMax=function(e,t){if(null==e)return;t=null==t?1:t;var n=new nT;let r,o=t/e.getMax();for(r=0;null!=e[r];r++)n[r]=e[r].factor(o);return n.name=e.name,n},normalizeLists=function(e,t,n){if(null==e||!e.length||!e[0].length)return;n=null==n?"min-max":n;var r=instanceSameType(e);let o;for(r.name=e.name,o=0;null!=e[o];o++)if("nL"==e[o].type)switch(n){case"max":r[o]=normalizeToMax(e[o],t);break;case"sum":r[o]=normalizeToSum(e[o],t);break;case"z-score":r[o]=normalizeByZScore(e[o]);break;default:r[o]=e[o].getNormalized()}else r[o]=e[o].clone();return r},normalizeListsToMax=function(e,t){if(null==e||!e[0].length)return;var n=new nT;let r,o,i=e.length;for(o=0;o<i;o++)r=e[o],n[o]=normalizeToMax(r,t);return n.name=e.name,n},normalizeListsToSum=function(e,t){if(null==e||!e[0].length)return;var n=new nT;let r,o,i=e.length;for(o=0;o<i;o++)r=e[o],n[o]=normalizeToSum(r,t);return n.name=e.name,n},normalizeListsToInterval=function(e,t,n){if(null==e||!e[0].length)return;var r=new nT;let o,i,s=e.length;for(i=0;i<s;i++)o=e[i],r[i]=normalizeToInterval(o,t,n);return r.name=e.name,r},averageSmootherOnLists=function(e,t,n){if(null!=e&&e[0].length){t=t||.5,n=n||1;var r=new nT;return r.name=e.name,e.forEach((function(o,i){r[i]=averageSmoother(e[i],t,n)})),r}},kMeans=function(e,t,n,r,o){if(null==e||null==e[0]||null==t||t<=0||0!==e.getLengths().getInterval().getAmplitude())return null;n=null==n?0:n,r=null==r||r<=0?1e3:r;var i=new nT;let s,l,a,u,h,c,f,p;i.name="k-means clusters";let g,d,m,y,x=new nT,w=e.length,v=e[0].length,b=e.transpose(),T=i.clone();if(t>=b.length)return b;var _,M=function(e,t){var n=t.length;for(s=0;s<n;s++)if(containSameElements(e,t[s]))return!0;return!1};for(l=0;l<t;l++)if(o&&l<o.length)x[l]=b[o[l]].clone();else{for(h=b.getRandomElement(),y=0;M(h,x)&&y<100;)h=b.getRandomElement(),y++;if(100==y){t=l;break}x[l]=h.clone()}for(p=0;p<r;p++){for(l=0;l<t;l++)i[l]=new nL,i[l].name="-means cluster "+l;for(s=0;s<v;s++){for(h=b[s],f=99999999,u=0,l=0;l<t;l++)c=distance(h,x[l]),c<f&&(f=c,u=l);i[u].push(s)}for(s=0;s<i.length;s++)if(0==i[s].length)for(l=0;l<i.length;l++)if(!(l==s||i[l].length<2)){var S=i[l].length-1;i[s].push(i[l][S]),i[l]=i[l].getWithoutElementAtIndex(S);break}if(i.isEqual(T))break;for(T=i.clone(),l=0;l<t;l++){for(d=i[l],g=d.length,x[l]=new nL,x[l].name="k-means mean "+l,m=x[l],h=b[d[0]],a=0;a<w;a++)m[a]=h[a]/g;for(s=1;s<g;s++)for(h=b[d[s]],a=0;a<w;a++)m[a]+=h[a]/g}}let N,R;if(1==n||5==n)for((_=new nL).name="mean index",s=0;s<t;s++)for(N=i[s],R=N.length,l=0;l<R;l++)_[N[l]]=s;var E;if(2==n||5==n){(E=new cL).name="mean color";var O=createDefaultCategoricalColorList(t);for(s=0;s<t;s++)for(N=i[s],R=N.length,l=0;l<R;l++)E[N[l]]=O[s]}var C=new L;if(4==n||5==n)for(s=0;s<t;s++){for(C[s]=new nT,C[s].name="k-means subtable_"+s,N=i[s],R=N.length,l=0;l<R;l++)C[s].push(b[N[l]]);C[s]=C[s].transpose()}switch(n){case 0:return i;case 1:return _;case 2:return E;case 3:return x;case 4:return C;case 5:return{indexes:i,means:x,meanNumber:_,colors:E,subtables:C}}return null},product=function(e,t){if(null==e||null==t)return;let n=e.length,r=e[0].length;if(0===n||0===r||n!=t[0].length||r!=t.length)return;var o=new nT;let i,s,l,a;for(i=0;i<n;i++)for(o[i]=new nL,s=0;s<n;s++){for(a=0,l=0;l<r;l++)a+=e[i][l]*t[l][s];o[i][s]=a}return o},getCovarianceMatrix=function(e){if(null!=e)return product(e,e.transpose()).factor(1/e.length)},generateNumberTable=function(e,t,n,r){e=null==e?0:e,n=null==n?t:n,r=null==r?1:r;var o=new o;let i;switch(e){case 0:i=function(e,t){return e==t?r:0};break;case 1:i=function(e,t){return r};break;case 2:i=function(e,t){return Math.random()*r};break;case 3:i=function(e,t){return e==t?Math.random()*r:0}}for(var s=0;s<t;s++){o[s]=new nL,o[s].name="col_"+s;for(var l=0;l<n;l++)o[s][l]=i(s,l)}return o},identity=function(e){return e},mergeObjects=function(e,t){if(null==e)return null;if(null==t)return e;let n=Object.assign(cloneObject(e),t);return isEqual(e,n)?e:n},cloneObject=function(e){if(null==e)return null;let t;if(e.clone&&"function"==typeof e.clone)return e.clone();try{t=JSON.stringify(e)}catch(n){t=JSON.stringify(serliazeObject(e))}return JSON.parse(t)},serliazeObject=function(e){if(null==e)return null;var t;let n,r;if(e.isTable){for(t=e.toArray(),n=e.length,r=0;r<n;r++)t[r]=serliazeObject(e[r]);return t}return e.isList?e.toArray():e},getInterval=function(e){if(null!=e)return null!=e.getInterval?e.getInterval():void 0},getFrame=function(e,t){let n;if(e.getFrame)return n=e.getFrame(),null!=t&&(n=n.expand(t)),n},getInfo=function(e,t){return null==e?null:(e.isTable?n=buildInformationObjectForTable(e,t):e.isList?n=buildInformationObjectForList(e,t):e.getInfo&&(n=e.getInfo()),null==n?null:(n.objectType=n.type,n.type=null,n));var n},getObjectStructure=function(e){let t=replaceValuesByNull(e);return objectToString(t)},replaceValuesByNull=function(e){let t={};for(var n in e)if(e.hasOwnProperty(n)){if("object"==typeof e[n]&&null!=e[n]){t[n]=replaceValuesByNull(e[n]);continue}t[n]=null}return t},getLength=function(e,t){if(null!=e&&null!=e.length){if((t=null!=t&&t)&&null!=e.length){for(var n=0,r=0;r<e.length;r++)r in e&&n++;return n}return e.length}},includes=function(e,t){if(null!=e)return e.includes(t)},getPropertyValue=function(e,t){if(null==e)return;var n="string"==typeof t?t.split("."):t;let r=e[n[0]],o=1;for(;null!=n[o];){if(null==r)return null;r=r[n[o]],o++}return r},getPropertyValues=function(e,t,n){if(null==e||null==e.length)return;if(e.isList)return e.getPropertyValues(t,n);let r,o=new L;o.name=t;let i=e.length;for(var s=0;s<i;s++)r=getPropertyValue(e[s],t),o[s]=null==r?n:r;return o.downcast()},getPropertyValuesInterval=function(e,t){if(null==e)return;let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;return e.forEach((e=>{null!=e[t]&&(n=Math.min(n,e[t]),r=Math.max(r,e[t]))})),new I(n,r)},getMultiplePropertyValues=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;let e=arguments[0],t=[];for(var n=1;n<arguments.length;n++){var r={name:"value"+(n-1),description:arguments[n]?"The value of property "+arguments[n]:""};r.value=arguments[n]?getPropertyValue(e,arguments[n]):null,r.type=null==r.value?"Object":_typeOf(r.value),t.push(arguments[n]?r:null)}return t.isOutput=!0,t},getName=function(e){if(null!=e)return e.name},isPropertyValue=function(e,t){if(null==e)return!1;for(var n in e)if(e[n]===t)return!0;return!1},getPropertiesNames=function(e){if(null==e)return;let t=sL.toL(Object.getOwnPropertyNames(e));return t.removeElement("__ob__"),t},getPropertiesNamesAndValues=function(e){if(null!=e){var t=new T;return t[0]=getPropertiesNames(e),t[1]=new L,t[0].forEach((function(n,r){t[1][r]=e[n]})),t[1]=t[1].downcast(),t}},setPropertyValue=function(e,t,n,r,o){if(null==e||null==t)return;let i=r?e:cloneObject(e);if(o&&null==n)return i;let s="string"==typeof t?t.split("."):t;for(var l=i,a=0;a<s.length-1;a++)l=l[s[a]]=l[s[a]]||{};return l[s[a]]=n,i},interpolateObjects=function(e,t,n,r){let o,i,s,l=_typeOf(e),a=1-(n=null==n?.5:n);if(l!=_typeOf(t))return n<.5?e:t;switch(l){case"number":return r&&Math.abs(e-t)<=r?t:a*e+n*t;case"I":return r&&Math.abs(e.x-t.x)+Math.abs(e.y-t.y)<=r?t:new I(a*e.x+n*t.x,a*e.y+n*t.y);case"nL":var u=Math.min(e.length,t.length),h=new nL;for(s=0,o=0;o<u;o++)h[o]=a*e[o]+n*t[o],i=Math.pow(t[o]-h[o],2),s+=i;return r&&s<r*r?t:h;case"Pol":u=Math.min(e.length,t.length);var c=new Pol;for(o=0;o<u;o++)c[o]=twoPointsInterpolation(e[o],t[o],n);return c;case"T":case"nT":var f=instanceSameType(t),p=(u=Math.min(e.length,t.length),!0);for(o=0;o<u;o++)f[o]=interpolateObjects(e[o],t[o],n,r),p=p&&f[o]==t[o];return p?t:f}return n<.5?e:t},replaceObject=function(e,t,n){return e==t?n:e},toList=function(e){return L.toL(e).downcast()},floor=function(e){return"number"==typeof e?Math.floor(e):e.floor?e.floor():null},addition=function(){let e,t;if(arguments.length<2){if(1==arguments.length&&null!=arguments[0]&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=addition(e,arguments[0][t]);return e}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnObjectWithList(arguments[0],arguments[1],ObjectOperators.addition);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=!1;i<o&&"string"!=i&&"string"!=o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r),s=!0);var l=o+"_"+i;switch(l){case"boolean_boolean":return n&&r;case"date_string":return s?r+dateToString(n):dateToString(n)+r;case"number_string":case"string_string":case"string_number":case"boolean_number":case"number_number":return n+r;case"PointPoint":return new P(n.x+r.x,n.y+r.y);case"Point3DPoint3D":return new P3D(n.x+r.x,n.y+r.y,n.z+r.z);case"numberPoint":return new P(n.x+r,n.y+r);case"numberPoint3D":return new P3D(n.x+r,n.y+r,n.z+r);case"Interval_number":return new I(n.x+r,n.y+r);case"IntervalPoint":return new P(n.getMin()+r.x,n.getMax()+r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x+r.x,n.y+r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()+r.x,n.getMax()+r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x+r.x,n.y+r.y,n.width+r.width,n.height+r.height);case"date_number":return new Date(n.getTime()+r/DateOperators_millisecondsToDays);case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(addition(n,r.date0),addition(n,r.date1));case"DateInterval_number":return new dI(addition(n.date0,r),addition(n.date1,r));case"DateInterval_Interval":return new dI(addition(n.date0,r.min),addition(n.date1,r.max));case"DateInterval_DateInterval":return new dI(addition(n.date0,r.date0),addition(n.date1,r.date1));case"string_StringList":return r.append(n,!1);case"StringList_string":return r.append(n,!0);default:return null}return n+r}for(e=arguments[0],t=1;t<arguments.length;t++)e=addition(e,arguments[t]);return e},multiplication=function(){let e,t;if(arguments.length<2){if(1==arguments.length&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=multiplication(e,arguments[0][t]);return e}return null}var n=arguments[0];let r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=o+"_"+i;if(2==arguments.length){if(null==arguments[0])return null;if("NumberTable_NumberTable"==s)return product(n,r);if(arguments[0].isList&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.multiplication);switch(i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r)),s=o+"_"+i,s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n*r;case"PointPoint":return pointMultiplication(n,r);case"Point3DPoint3D":return new P3D(n.x*r.x,n.y*r.y,n.z*r.z);case"numberPoint":return new P(n.x*r,n.y*r);case"numberPoint3D":return new P3D(n.x*r,n.y*r,n.z*r);case"Interval_number":return new I(n.getMin()*r,n.getMax()*r);case"IntervalPoint":return new P(n.getMin()*r.x,n.getMax()*r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x*r.x,n.y*r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()*r.x,n.getMax()*r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x*r.x,n.y*r.y,n.width*r.width,n.height*r.height);case"date_number":return new Date(n.getTime()*(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(multiplication(n,r.date0),multiplication(n,r.date1));case"DateInterval_number":return new dI(multiplication(n.date0,r),multiplication(n.date1,r));case"DateInterval_Interval":return new dI(multiplication(n.date0,r.min),multiplication(n.date1,r.max));case"DateInterval_DateInterval":return new dI(multiplication(n.date0,r.date0),multiplication(n.date1,r.date1));default:return null}return n*r}for(e=arguments[0],t=1;t<arguments.length;t++)e=multiplication(e,arguments[t]);return e},division=function(){let e,t;if(arguments.length<2){if(1==arguments.length&&arguments[0]&&arguments[0].isList){for(e=arguments[0][0],t=1;null!=arguments[0][t];t++)e=division(e,arguments[0][t]);return e}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.division);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r);i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r));var s=o+"_"+i;switch(s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n/r;case"PointPoint":return new P(n.x/r.x,n.y/r.y);case"Point3DPoint3D":return new P3D(n.x/r.x,n.y/r.y,n.z/r.z);case"numberPoint":return new P(n.x/r,n.y/r);case"numberPoint3D":return new P3D(n.x/r,n.y/r,n.z/r);case"Interval_number":return new I(n.getMin()/r,n.getMax()/r);case"IntervalPoint":return new P(n.getMin()/r.x,n.getMax()/r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x/r.x,n.y/r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()/r.x,n.getMax()/r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x/r.x,n.y/r.y,n.width/r.width,n.height/r.height);case"date_number":return new Date(n.getTime()/(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(division(n,r.date0),division(n,r.date1));case"DateInterval_number":return new dI(division(n.date0,r),division(n.date1,r));case"DateInterval_Interval":return new dI(division(n.date0,r.min),division(n.date1,r.max));case"DateInterval_DateInterval":return new dI(division(n.date0,r.date0),division(n.date1,r.date1));default:return null}return n/r}for(e=arguments[0],t=1;t<arguments.length;t++)e=division(e,arguments[t]);return e},applyFunctionOnInput=function(e,t,n,r,o,i,s){if(null!=e&&null!=t)return"string"==typeof t&&(t=stringToFunction(t)),t.apply(this,[e,n,r,o,i,s])},isEqual=function(e,t){return _recursiveEqual(e,t)},_recursiveEqual=function(e,t){if(e==t)return!0;let n=_typeOf(e);if("string"==n||"number"==n||"boolean"==n||"null"==n)return!1;if(null==e||null==t)return!1;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var r in e)if(!_recursiveEqual(e[r],t[r]))return!1;return 0!=Object.keys(e).length||null==e.toString||null==t.toString||e.toString()==t.toString()},arrayOfArraysToTable=function(e,t,n){if(null==e)return null;t=null==t||t,n=null==n||n;let r=new T,o=t?1:0;for(var i=0;i<e.length;i++){r[i]=new L,t&&e[i].length>0?r[i].name=String(e[i][0]):r[i].name="_";for(var s=o;s<e[i].length;s++)if(r[i][s-o]=e[i][s],n&&null!==r[i][s-o]){var l=String(r[i][s-o]),a=Number(l.replace(",",".")),u=a||0===a&&""!==l?a:l;"string"==typeof u&&(u=_removeQuotes(u)),r[i][s-o]=u}r[i]=r[i].downcast()}return r.downcast()},operate=function(operation,x,y,factor,mapFunction,name,numIterations){if(numIterations>1){var accumulated=x.isList?new T:new L;accumulated.push(x);for(var i=0;i<numIterations;i++)x=operate(operation,x,y,factor,mapFunction,name),accumulated.push(x);return accumulated.downcast()}if(numIterations<=-1)return operate(operation,operate(operation,x,y,factor,mapFunction,name,numIterations+1),y,factor,mapFunction,name);var f=null!=mapFunction?mapFunction:[_sum,_multiplication,_pow2,_pow3,Math.pow,Math.sqrt,Math.log,_logSum,Math.log2,_log2Sum,_log_y,Math.cos,_cosSum,Math.sin,_sinSum,Math.tan,_tanSum,Math.atan2,Math.floor,Math.round,Math.ceil,Math.abs,_modulo,_subtract,_divide][operation];factor=null==factor?1:factor;var type_x=null==x?"object":x.isTable?"table":x.isList?"list":"object";let type_y=null==y?"object":y.isTable?"table":y.isList?"list":"object";var combinedType=type_x+"_"+type_y;let nL,nT,l;switch("string"==_typeOf(f)&&eval("f = function(x,y){ return "+f+"}"),combinedType){case"object_list":for(nL=new L,nL.name=null==name?y.name:name,i=0;i<y.length;i++)nL[i]=1==factor?f(x,y[i]):factor*f(x,y[i]);return nL.downcast();case"list_object":for(nL=new L,nL.name=null==name?x.name:name,i=0;i<x.length;i++)nL[i]=1==factor?f(x[i],y):factor*f(x[i],y);return nL.downcast();case"list_list":for(nL=new L,nL.name=null==name?y.name:name,l=Math.min(x.length,y.length),i=0;i<l;i++)nL[i]=1==factor?f(x[i],y[i]):factor*f(x[i],y[i]);return nL.downcast();case"object_table":for(nT=new T,nT.name=name,i=0;i<y.length;i++)nT[i]=operate(operation,x,y[i],factor,mapFunction);return nT.downcast();case"table_object":for(nT=new T,nT.name=name,i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y,factor,mapFunction);return nT.downcast();case"list_table":case"table_list":case"table_table":for(nT=new T,nT.name=name,l=Math.min(x.length,y.length),i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y[i],factor,mapFunction);return nT.downcast();default:return 1==factor?f(x,y):factor*f(x,y)}},_sum=function(e,t){return e+t},_multiplication=function(e,t){return e*t},_pow2=function(e){return Math.pow(e,2)},_pow3=function(e){return Math.pow(e,2)},_logSum=function(e,t){return Math.log(e+t)},_log2Sum=function(e,t){return Math.log2(e+t)},_log_y=function(e,t){return Math.log(e)/Math.log(t)},_cosSum=function(e,t){return Math.cos(e+t)},_sinSum=function(e,t){return Math.sin(e+t)},_tanSum=function(e,t){return Math.tan(e+t)},_modulo=function(e,t){return e%t},_subtract=function(e,t){return e-t},_divide=function(e,t){return e/t},numberToString=function(e,t){let n=e.toFixed(t);if(0==t)return n;for(;"0"==n.charAt(n.length-1);)n=n.substring(0,n.length-1);return"."==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},getRandomWithSeed=function(e){return(e=(9301*(e=null==e?1:e)+49297)%233280)/233280},numberFromBinaryPositions=function(e){let t,n=0;for(t=0;null!=e[t];t++)n+=Math.pow(2,e[t]);return n},numberFromBinaryValues=function(e){let t=0,n=e.length;for(var r=0;r<n;r++)t+=1==e[r]?Math.pow(2,n-(r+1)):0;return t},powersOfTwoDecomposition=function(e,t){var n=new nL;let r;for(;0<e;)r=Math.floor(Math.log(e)/Math.LN2),n[r]=1,e-=Math.pow(2,r);t=Math.max(n.length,null==t?0:t);for(var o=0;o<n.length;o++)n[o]=n[o]?1:0;for(;n.length<t;)n.push(0);return n},toBinary=function(e,t,n=!0){let r=powersOfTwoDecomposition(e,t);return n||(r=r.getReversed()),r},binaryToNumber=function(e,t=!0){if(null==e)return;let n=t?e.getReversed():e,r=0,o=n.length;for(var i=0;i<o;i++)r+=0==Number(n[i])?0:Math.pow(2,o-(i+1));return r},positionsFromBinaryValues=function(e){let t,n=new nL;for(t=0;null!=e[t];t++)1==e[t]&&n.push(t);return n},_Alea=function(){return function(e){var t=0,n=0,r=0,o=1;0===e.length&&(e=[+new Date]);var i=_Mash();t=i(" "),n=i(" "),r=i(" ");for(var s=0;s<e.length;s++)(t-=i(e[s]))<0&&(t+=1),(n-=i(e[s]))<0&&(n+=1),(r-=i(e[s]))<0&&(r+=1);i=null;var l=function(){var e=2091639*t+2.3283064365386963e-10*o;return t=n,n=r,r=e-(o=0|e)};return l.uint32=function(){return 4294967296*l()},l.fract53=function(){return l()+11102230246251565e-32*(2097152*l()|0)},l.version="Alea 0.9",l.args=e,l}(Array.prototype.slice.call(arguments))},_Mash=function(){let e=4022871197;var t=function(t){t=t.toString();for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t},random=function(){return new _Alea},randomSeed=function(e){NumberOperators_stackRandom.push(NumberOperators_random),NumberOperators_stackRandom.length>100&&NumberOperators_stackRandom.shift(),NumberOperators_random=new _Alea("my",e,"seeds"),NumberOperators_lastNormal=NaN},randomSeedPop=function(){NumberOperators_stackRandom.length>0&&(NumberOperators_random=NumberOperators_stackRandom.pop())},decimalPlaces=function(e){let t=String(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},logistic=function(e,t,n,r){return null==e||isNaN(e)?null:(n=null==n?0:n,r=null==r?1:r,(t=null==t?1:t)/(1+Math.exp(-r*(e-n))))},formatShort=function(e,t){if(null==e)return;if(0==e||e==1/0)return String(e);if(isNaN(e))return e;if(t=null==t||t<1?2:t,String(e).length<=t)return String(e);let n=parseFloat(e.toPrecision(t)),r=Math.floor(Math.log10(n));var o="";return r>=15?(n=parseFloat((n/Math.pow(10,r)).toPrecision(t)),o="e"+r):r>=12?(n/=Math.pow(10,12),o="t"):r>=9?(n/=Math.pow(10,9),o="b"):r>=6?(n/=Math.pow(10,6),o="m"):r>=3?(n/=Math.pow(10,3),o="k"):r<-3&&(n=parseFloat((n/Math.pow(10,r)).toPrecision(t)),o="e"+r),n=parseFloat(n.toPrecision(12)),n+o},numberToPosition=function(e){let t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"},getSoftenControlPoints=function(e,t,n,r){r=r||10;let o=angleFromTwoPoints(e,n);return[new P(t.x-r*Math.cos(o),t.y-r*Math.sin(o)),new P(t.x+r*Math.cos(o),t.y+r*Math.sin(o))]},bezierCurvePoints=function(e,t,n,r,o,i,s,l,a){let u=1-a,h=u*n+a*o,c=u*r+a*i;return new P(a*(u*h+a*(u*o+a*s))+u*(u*(u*e+a*n)+a*h),a*(u*c+a*(u*i+a*l))+u*(u*(u*t+a*r)+a*c))},triangleContainsPoint=function(e,t,n,r){let o=(e.x-r.x)*(t.y-r.y)-(t.x-r.x)*(e.y-r.y),i=(t.x-r.x)*(n.y-r.y)-(n.x-r.x)*(t.y-r.y),s=(n.x-r.x)*(e.y-r.y)-(e.x-r.x)*(n.y-r.y);return o>0&&i>0&&s>0||o>=0&&i>=0&&s>=0},triangleArea=function(e){return Math.abs(e.a.x*(e.b.y-e.c.y)+e.b.x*(e.c.y-e.a.y)+e.c.x*(e.a.y-e.b.y))/2},lineFromTwoPoints=function(e,t){if(e.x==t.x)return new P(1/0,e.x);let n=(t.y-e.y)/(t.x-e.x);return new P(n,e.y-n*e.x)},distancePointToLine=function(e,t){let n,r;0===t.x?(n=1/0,r=e.x):(n=-1/t.x,r=e.y-n*e.x);let o=intersectionLines(t,new P(n,r));return Math.sqrt(Math.pow(e.x-o.x,2)+Math.pow(e.y-o.y,2))},distancePointToSegment=function(e,t,n){let r,o,i=t.x==n.x?1/0:(n.y-t.y)/(n.x-t.x),s=i==1/0?new P(1/0,t.x):new P(i,t.y-i*t.x);0===s.x?(r=1/0,o=e.x):(r=-1/s.x,o=e.y-r*e.x);let l=intersectionLines(s,new P(r,o));return l.x>=Math.min(t.x,n.x)&&l.x<=Math.max(t.x,n.x)?e.distanceToPoint(l):Math.min(e.distanceToPoint(t),e.distanceToPoint(n))},intersectionLines=function(e,t){if(e.x==t.x)return e.y==t.y?e.x==1/0?new P(e.y,0):new P(0,e.y):null;if(e.x==1/0)return new P(e.y,t.x*e.y+t.y);if(t.x==1/0)return new P(t.y,e.x*t.y+e.y);var n=(t.y-e.y)/(e.x-t.x);return new P(n,e.x*n+e.y)},intersectionLineRectangle=function(e,t,n,r){r=null!=r&&r;let o,i=lineFromTwoPoints(e,t),s=lineFromTwoPoints(n.getTopLeft(),n.getTopRight()),l=lineFromTwoPoints(n.getTopRight(),n.getBottomRight()),a=lineFromTwoPoints(n.getBottomLeft(),n.getBottomRight()),u=lineFromTwoPoints(n.getTopLeft(),n.getBottomLeft()),h=new Pol;if(o=intersectionLines(i,s),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,l),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,a),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,u),null!=o&&n.pointIsOnBorder(o)&&h.push(o),!r){for(var c=new Pol,f=0;f<h.length;f++)o=h[f],o.x>=Math.min(e.x,t.x)&&o.x<=Math.max(e.x,t.x)&&o.y>=Math.min(e.y,t.y)&&o.y<=Math.max(e.y,t.y)&&c.push(o);h=c}return h},numberTableToPolygon=function(e){if(null==e||e.length<2)return null;var t;let n=Math.min(e[0].length,e[1].length),r=new Pol;for(t=0;t<n;t++)r[t]=new P(e[0][t],e[1][t]);return r},numberTableToColorList=function(e,t){if(null==e)return;if(t=null==t||t,"T"!=e.type&&"nT"!=e.type)throw new Error("Input must be a table");if(e.length<3)throw new Error("T must have at least 3 lists");let n,r,o,i=new i;for(var s=0;s<e[0].length;s++){if(t)n=Math.max(0,Math.min(255,Math.round(e[0][s]))),r=Math.max(0,Math.min(255,Math.round(e[1][s]))),o=Math.max(0,Math.min(255,Math.round(e[2][s])));else{var l=HSVtoRGB(e[0][s],e[1][s],e[2][s]);n=Math.max(0,Math.min(255,Math.round(l[0]))),r=Math.max(0,Math.min(255,Math.round(l[1]))),o=Math.max(0,Math.min(255,Math.round(l[2])))}if(isNaN(n)||isNaN(r)||isNaN(o))throw new Error("Invalid format. T cells must be numbers in range [0,255]");i.push("rgb("+n+","+r+","+o+")")}return i},numberTableToNetwork=function(e,t,n){n=null==n?0:n;var r,o=new Net;let i;var s;let l;var a;let u,h;var c;if(0===t)for(s=0;null!=e[s+1];s++)for(r=e[s],0===s?(a=new Nd(r.name,r.name),o.addNode(a)):a=o.nodes[s],l=s+1;null!=e[l];l++)i=e[l],0===s?(u=new Nd(i.name,i.name),o.addNode(u)):u=o.nodes[l],i=e[l],(c=1/(1+standardDeviationTwoNumberLists(r,i)))>=n&&(h=new Rel(s+"_"+l,a.name+"_"+u.name,a,u,c),o.addRelation(h));return o},buildDendrogramFromPolygon=function(e){let t,n,r,o=new Tr,i=new ndL;var s=new Pol;e.forEach((function(e,n){t=new Nd("point_"+n,"point_"+n),t.weight=1,t.barycenter=e,t.point=e,t.polygon=new Pol(e),o.addNode(t),s.push(t),i.push(t)})),o.nodes=o.nodes.getReversed();for(var l,a=function(e,t){var r=new Nd("("+e.id+","+t.id+")","("+e.id+","+t.id+")");return r.polygon=e.polygon.concat(t.polygon),r.weight=r.polygon.length,n=e.weight+t.weight,r.barycenter=new P((e.weight*e.barycenter.x+t.weight*t.barycenter.x)/n,(e.weight*e.barycenter.y+t.weight*t.barycenter.y)/n),o.addNode(r),o._newCreateRelation(r,e),o._newCreateRelation(r,t),r};s.length>1;)l=_findClosestNodes(s),r=a(s[l[0]],s[l[1]]),r.distance=l.distance,s.splice(l[0],1),s.splice(l[1]-1,1),s.push(r);o.nodes=o.nodes.getReversed();var u=function(e,t){e.level=t+1,e.to.forEach((function(t){u(t,e.level)}))};return u(o.nodes[0],-1),o.leaves=i,o},_findClosestNodes=function(e){let t,n,r,o,i=9999999999;for(t=0;null!=e[t+1];t++)for(n=t+1;null!=e[n];n++)r=Math.pow(e[t].barycenter.x-e[n].barycenter.x,2)+Math.pow(e[t].barycenter.y-e[n].barycenter.y,2),r<i&&(i=r,o=[t,n]);return o.distance=i,o},sortOnXY=function(e){return e.sort((function(e,t){return e.x<t.x||e.x==t.x&&e.y<t.y?-1:1}))},expandFromBarycenter=function(e,t){let n=new Pol,r=e.getBarycenter();for(var o=0;null!=e[o];o++)n[o]=e[o].expandFromPoint(r,t);return n},simplifyPolygon=function(e,t){t=null==t||0===t||void 0===t?1:t;let n,r,o,i,s,l=e.clone(),a=e.length;for(s=0;s<a;s++)n=l[s],r=l[(s+1)%a],o=l[(s+2)%a],i=lineFromTwoPoints(n,o),distancePointToLine(r,i)<t&&(l=l.getWithoutElementAtIndex((s+1)%a),s--),a=l.length;return l},bezierPolygonContainsPoint=function(e,t,n,r){let o=e.getFrame();r.clearContext(),r.context.fillStyle="black",r.context.fillRect(0,0,o.width,o.height),null!=n&&(r.context.strokeStyle="black",r.context.lineWidth=n),r.context.fillStyle="white",r.context.beginPath(),r.drawBezierPolygon(e,-o.x,-o.y),r.context.fill(),null!=n&&r.context.stroke();let i=r.context.getImageData(t.x-o.x,t.y-o.y,1,1).data;return r.clearContext(),i[0]>0},placePointsInsidePolygon=function(e,t,n){let r=new Pol,o=e.getFrame();if(0===(n=n||0)){for(var i;r.length<t;)i=new P(o.x+Math.random()*o.width,o.y+Math.random()*o.height),polygonContainsPoint(e,i)&&r.push(i);return r}},placePointsInsideBezierPolygon=function(e,t,n,r){let o=new Pol,i=e.getFrame();if(0===(n=n||0)){for(var s,l=0;o.length<t&&l<1e3;)s=new P(i.x+Math.random()*i.width,i.y+Math.random()*i.height),l++,bezierPolygonContainsPoint(e,s,r)&&(o.push(s),l=0);return o}},geoCoordinateToDecimal=function(e){return Math.floor(e)+1.66667*(e-Math.floor(e))},geoDistance=function(e,t){let n=Math.pow(Math.sin(.5*(t.y-e.y)*gradToRad),2)+Math.cos(e.y*gradToRad)*Math.cos(t.y*gradToRad)*Math.pow(Math.sin(.5*(t.x-e.x)*gradToRad),2);return GeoOperators_EARTH_DIAMETER*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))},polygonLength=function(e){if(e.length<2)return 0;for(var t=geoDistance(e[0],e[1]),n=2;null!=e[n];n++)t+=geoDistance(e[n-1],e[n]);return t},minRect=function(){if(null==arguments||arguments.length<1)return null;var e;let t=arguments[0].clone();for(t.width=t.getRight(),t.height=t.getBottom(),e=1;null!=arguments[e];e++)t.x=Math.min(t.x,arguments[e].x),t.y=Math.min(t.y,arguments[e].y),t.width=Math.max(arguments[e].getRight(),t.width),t.height=Math.max(arguments[e].getBottom(),t.height);return t.width-=t.x,t.height-=t.y,t},packingRectangles=function(e,t,n=2){let r=function(e,t,n,r,o,i){for(var s,l=0;null!=e[l];l++)if(t+r>(s=e[l]).x-i&&t<s.x+s.width+i&&n+o>s.y-i&&n<s.y+s.height+i)return!0;return!1},o=t.getCenter(),i=t.width/t.height,s=new L;var l=new L;let a,u,h,c,f,p,g,d=0;for(let t=0;t<e.length;t++){if(h=e[t].width,c=e[t].height,0===t)a=o.x-.5*h,u=o.y-.5*c;else{for(f=.1*t,p=0;r(s,a,u,h,c,n);)p+=1,f+=.005*p,a=o.x+i*p*Math.cos(f)-.5*h,u=o.y+p*Math.sin(f)-.5*c;d=Math.max(d,i*p+.5*h)}l[t]=new Rec(a,u,h,c),s.push(l[t])}i=.5*t.width/d;for(let e=0;e<l.length;e++)g=l[e],g.x=o.x+(g.x-o.x)*i,g.y=o.y+(g.y-o.y)*i,g.width*=i,g.height*=i;return l},packingCircles=function(e,t,n){if(null==e||0===e.length)return null;var r=function(e,t,n,r,o){for(var i,s=0;null!=e[s];s++)if(i=e[s],Math.pow(i.x-t,2)+Math.pow(i.y-n,2)<Math.pow(i.z+r+o,2))return!0;return!1};n=null==n?0:n;for(var o,i,s,l=_.normalizeToMax(e).sqrt(),a=new Pol3D,u=0,h=0,c=0,f=0,p=t.getCenter(),g=100*l[0],d=t.width/t.height,m=0;m<l.length;m++){if(o=100*l[m],0===m)c=p.x,f=p.y,i=o;else{for(u=0,h=i+o+n+.1;r(a,c,f,o,n);)u+=.003*(h+=.06),c=p.x+d*h*Math.cos(u),f=p.y+h*Math.sin(u);g=Math.max(g,d*h+100*l[m])}a[m]=new _.P3D(c,f,o)}for(d=.5*t.width/(g+.001),m=0;null!=a[m];m++)(s=a[m]).x=p.x+(s.x-p.x)*d,s.y=p.y+(s.y-p.y)*d,s.z*=d;return a},fillWithRectangles=function(e,t,n,r){switch(null==n&&(n=new Rec(0,0,1,1)),t=t||0){case 0:return squarify(n,e);case 1:var o=e.getInterval();o.min<0&&(e=e.add(-o.min),o=new I(0,o.max-o.min));var i,s,l=e.getSum(),a=new L,u=n.y,h=n.height/l;for(s=0;null!=e[s];s++)i=h*e[s],a.push(new Rec(n.x,u,n.width,i)),u+=i;return a;case 2:(o=e.getInterval()).min<0&&(e=e.add(-o.min),o=new I(0,o.max-o.min)),l=e.getSum(),a=new L;var c,f=n.x,p=n.width/l;for(s=0;null!=e[s];s++)c=p*e[s],a.push(new Rec(f,n.y,c,n.height)),f+=c;return a;case 3:if(e.length<6);else if(6==e.length){var g=new Rec(.44,.36,.16,.45),d=new Rec(.6,.15,.3,.3),m=new Rec(.72,.45,.28,.32),y=new Rec(.38,.04,.22,.32),x=new P(.6,.36);g=expandRectangle(g,Math.sqrt(e[0]),x),d=expandRectangle(d,Math.sqrt(e[1]),x),y=expandRectangle(y,Math.sqrt(e[3]),x),m.x=d.x+.5*d.width,m.y=d.bottom;var w=new P(m.x+.3*m.width,d.bottom);(m=expandRectangle(m,Math.sqrt(e[2]),w)).y+=.2*m.height;var v=new P(.26,.36+Math.max(.3*g.height,.2*y.height)),b=new Rec(.1,v.y-.4,.2,.4),T=new Rec(.22,v.y,.16,.5);b=expandRectangle(b,Math.sqrt(e[4]),v),T=expandRectangle(T,Math.sqrt(e[5]),v);var _=.2*Math.max(y.width,g.width,T.right-v.x,b.right-v.x),M=Math.min(y.x,g.x)-Math.max(b.right,T.right)-_;return T.x+=M,b.x+=M,new L(g,d,m,y,b,T)}case 4:case 5:var S;S=0===(r=r||0)?Math.round(Math.sqrt(e.length)):Math.round(e.length/r);var N=Math.ceil(e.length/S),R=S*N-e.length,E=e.getMean(),O=concat(e,createListWithSameElement(R,E)),C=slidingWindowOnList(O,N,N,0),D=C.getSums(),k=this.fillWithRectangles(D,2,n);for(a=L(),s=0;s<S;s++)a=concat(a,this.fillWithRectangles(C[s],1,k[s]));return a}return null},squarify=function(e,t,n,r){if(null==t)return;if(0===t.length)return new recL;if(1===t.length)return new recL(e);let o,i;r=r||!1,o=(n=n||!1)?t:normalizeToSum(t),r||(i=null==t.positions?o.getSortIndexes():t.positions,o=null==o.sortedWeights?o.getSorted(!1):o.sortedWeights);var s=e.width*e.height;let l,a,u,h,c,f,p,g,d,m=new recL,y=e.clone(),x=new L,w=0,v=new Rec,b=t.length;var T;if(b>2)for(g=w;g<b;g++)if(u=Number.MAX_VALUE,0===o[g])m.push(new Rec(v.x,v.y,0,0));else{for(d=1;d<b&&(l=nL.toL(o.slice(g,g+d)),a=x.slice(),c=(T=l.getSum())*s,v.x=y.x,v.y=y.y,y.width>y.height?(v.width=c/y.height,v.height=y.height):(v.width=y.width,v.height=c/y.width),x=partitionRectangle(v,l,T),h=x.highestRatio,!(u<=h));d++)u=h;if(0===a.length){if(m.push(new Rec(y.x,y.y,y.width,y.height)),m.length==b){if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m}w++}else{if(m=m.concat(a),m.length==b){if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m}w+=a.length,f=a[a.length-1],y.width>y.height?(y.x=f.width+f.x,y.width-=f.width):(y.y=f.height+f.y,y.height-=f.height)}g=w-1}else 2==b?(l=o.clone(),v=e.clone(),m=partitionRectangle(v,l,l.getSum())):m[0]=new Rec(e.x,e.y,e.width,e.height);if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m},partitionRectangle=function(e,t,n){let r,o,i,s=e.width*e.height,l=new L,a=new Rec(e.x,e.y,e.width,e.height),u=1,h=t.length;for(o=0;o<h;o++)r=t[o]*s/n,e.width>e.height?(i=new Rec(a.x,a.y,r/a.height,a.height),l.push(i),a.x+=r/a.height):(i=new Rec(a.x,a.y,a.width,r/a.width),l.push(i),a.y+=r/a.width),i.ratio=Math.max(i.width,i.height)/Math.min(i.width,i.height),u=Math.max(u,i.ratio);return l.highestRatio=u,l},_getHighestRatio=function(e){let t,n,r=1;for(n=0;n<e.length;n++)t=e[n],r=Math.max(r,t.getRatio());return r},simplifyPolygons=function(e,t,n){let r,o=new polL;for(var i=0;null!=e[i];i++)r=simplifyPolygon(e[i],t),(r.length>0||!n)&&o.push(r);return o},createPolygon=function(e,t,n){let r=new Pol;if(0===t)for(var o=0;o<e;o++)r.push(new P(n.x+n.width*Math.random(),n.y+n.height*Math.random()));return r},twoNumberListsToPolygon=function(e,t){let n=Math.min(e.length,t.length),r=new Pol;for(var o=0;o<n;o++)r[o]=new P(e[o],t[o]);return r},colorListFromColorScale=function(e,t){return e.getColorList.apply(e,[t])},colorListFromColorScaleFunction=function(e,t){let n,r=new cL;for(n=0;n<t;n++)r[n]=e(n/(t-1));return r},colorsLinearCombination=function(e,t){if(null==e||0==e.length)return;if(1==e.length)return e[0];null==t&&(t=createListWithSameElement(e.length,1)),t=normalizeToSum(t);var n=colorStringToRGB(e[0],t[0]);let r;for(var o=1;o<e.length;o++)r=colorStringToRGB(e[o],t[o]),n[0]+=r[0],n[1]+=r[1],n[2]+=r[2];return"rgb("+Math.floor(n[0])+","+Math.floor(n[1])+","+Math.floor(n[2])+")"},polygon3DToColorList=function(e){let t,n=e.length,r=new cL;for(t=0;t<n;t++)r.push(point3DToColor(e[t]));return r},colorListToPolygon3D=function(e){let t,n=e.length,r=new Pol3D;for(t=0;t<n;t++)r.push(colorToPoint3D(e[t]));return r},randomColor=function(e){return e=null==e?1:e,"rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+e+")"},getFlowTable=function(e,t,n){if(null==e)return;t=t||!1;let r,o,i,s,l,a,u=e.length,h=e[0].length,c=new nL,f=new nL,p=new nL,g=-9999999,d=9999999,m=-9999999;for(l=0;l<h;l++){for(o=9999999,i=-9999999,s=0,a=0;a<u;a++){if(r=e[a],r.length!=h)return;i=Math.max(i,r[l]),o=Math.min(o,r[l]),s+=r[l]}c.push(o),f.push(i),p.push(s),d=Math.min(d,o),g=Math.max(g,i),m=Math.max(m,s)}var y=m-d;let x,w,L,v=new nT;var b=n?1:0;if(t&&n)return v=new nT(e.length+1),e[0].forEach((function(){v[0].push(0)})),e.forEach((function(e,t){e.forEach((function(e,n){var r=p[n];v[t+1][n]=e/(0===r?1e-5:r)+v[t][n]}))})),v;for(v=new nT,t?w=Math.max(d,0):(w=d,L=y),l=0;l<u;l++)x=new nL,v.push(x);for(n&&v.push(new nL),l=0;l<h;l++)for(r=e[0],t&&(L=p[l]-w),n&&(v[0][l]=0),0===L&&(L=1e-5),v[b][l]=(r[l]-w)/L,a=1;a<u;a++)r=e[a],v[a+b][l]=(r[l]-w)/L+v[a-1+b][l];return v},getFlowTableIntervals=function(e,t,n,r){if(null==e)return null;var o=getFlowTable(e,t,!0),i=new T;let s,l;var a=o.length;let u=o[0].length;var h,c,f,p,g=new nL;for(s=1;s<a;s++)for(o[s],h=new L,i[s-1]=h,l=0;l<u;l++)h.push(new I(o[s-1][l],o[s][l])),s==a-1&&(g[l]=o[s][l]);if(n)for(l=0;l<u;l++){for(f=new nL,h=i[s],s=0;s<a-1;s++)f.push(i[s][l].getAmplitude());var d=f.getSortIndexes();for(p=t||r?0:.5*(1-g[l]),s=0;s<a-1;s++)(c=i[d[s]][l]).y=p+c.getAmplitude(),c.x=p,p=c.y}else if(!t)for(l=0;l<u;l++)for(s=0;s<a-1;s++)c=i[s][l],r?(i[s][l].x=1-i[s][l].x,i[s][l].y=1-i[s][l].y):i[s][l]=c.add(.5*(1-g[l]));return i},scaleIntervals=function(e,t){if(null==e)return;t=null==t?1:t;var n=new L;let r,o=e.length;for(n.name=e.name,r=0;r<o;r++)n[r]=e[r].getScaled(t);return n},nlsToIntervalList=function(e,t,n){if(null==e||null==t)return;n=null!=n&&n;var r=Math.min(e.length,t.length);let o,i=new iL;for(n&&(t=addition(e,t)),o=0;o<r;o++)i.push(new I(e[o],t[o]));return i},fillTextRectangle=function(e,t,n,r,o,i,s,l,a,u,h){u=null!=u&&u,h=null!=h&&h;let c=textWordWrapReturnLines(e,r,o,i,l,a);h&&(n+=((null==o?600:o)-(null==i?16:i)*c.length)/2);let f=a.context.textAlign;u&&(a.context.textAlign="center",t+=(null==r?100:r)/2);let p=fillTextRectangleWithTextLines(c,t,n,o,i,s,a);return a.context.textAlign=f,p},fillTextRectangleWithTextLines=function(e,t,n,r,o,i,s){r=0===r||null==r?99999:r;for(var l=0;null!=e[l]&&(s.context.fillText(e[l],t,n+l*o),!((l+2)*o>r));l++);return i?e.length*o:e.length},textWordWrapReturnLines=function(e,t,n,r,o,i){t=t||100,n=n||600;var s=0===(r=r||16)?-1:Math.floor(n/r);let l=new sL;if(t<=0)return l.push(e),l;var a=e.split(/\\n|\n/);let u,h,c,f,p,g;for(u=0;u<a.length;u++)if(""!==a[u])if(i.context.measureText(a[u]).width<t&&l.length<s)l.push(a[u]);else{for(h=a[u].split(" "),c=1;h.length>0&&c<=h.length;)if(f=h.slice(0,c).join(" "),p=i.context.measureText(f).width,p>t){if(1==c&&(c=2),g=h.slice(0,c-1).join(" "),""!==g&&l.push(g),l.length==s){if(o){var d=l[l.length-1];i.context.measureText(d+"").width<=t?l[l.length-1]+="":(h=d.split(" "),g=h.slice(0,h.length-1).join(" ")+"",l.push(g))}return l}h=h.splice(c-1),c=1}else c++;c>0&&(g=h.join(" "),""!==g&&l.push(g))}else l.push("");return l.width=1==l.length?p:t,l},getMaxTextWidth=function(e,t){let n=t.getTextW(e[0]);for(var r=1;null!=e[r];r++)n=Math.max(n,t.getTextW(e[r]));return n},stringToObject=function(e){try{return JSON.parse(e)}catch(e){}if(null==e)return null;let t,n=e.split(/\r?\n/),r="[",o=!1;for(var i=0;i<n.length;i++)if(0!=n[i].trim().length){if("{"==n[i]){for(t="";"}"!=n[i]&&i<n.length;)t+=" "+n[i],i++;t+="}"}else t=n[i];t=(o?",\r\n":"\r\n")+t,o=!0,r+=t}r+="\r\n]";try{return JSON.parse(r)}catch(e){return null}},stringToHash=function(e,t,n){if(null==e)return null;t=null==t?4294967295:t,n=null==n?1:n;let r,o,i,s,l,a=2166136261;for(o=0,l=e.length;o<l;++o)i=e.charCodeAt(o),s=65280&i,s&&(a=_fnv_multiply(a^s>>8)),a=_fnv_multiply(a^255&i);a=_fnv_mix(a),r=a%t;let u=1==n?0:_fnv_mix(_fnv_multiply(a)),h=new h;for(o=0;o<n;o++)h.push(r<0?r+t:r),r=(r+u)%t;return 1==n?h[0]:h},_fnv_multiply=function(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)},_fnv_mix=function(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,4294967295&(e+=e<<5)},decodeIdentedTree=function(e,t,n){t=null==t?"":t,n=null==n?"\t":n;var r=new Tr,o=splitByEnter(e);let i=o.length;if(0===i||1==i&&(null==o[0]||""===o[0]))return null;var s;let l;var a;let u,h,c;var f;let p,g;for(""!==t&&null!=t&&(g=new Nd(t,t),r.addNodeToTree(g,null)),s=0;s<i;s++){for(u=(a=o[s]).length,l=0;l<u;l++)if(a.charAt(l)!=n){h=a.substr(l);break}f=new Nd(a,h),0===l?null!=g?r.addNodeToTree(f,g):r.addNodeToTree(f,null):(c=l+1-Number(null==g),p=null!=r.getLevel(c-1)&&r.getLevel(c-1).length>0?r.getLevel(c-1)[r.getLevel(c-1).length-1]:null,r.addNodeToTree(f,p))}return r.assignDescentWeightsToNodes(),r},TableToTree=function(e,t,n,r,o,i,s,l){if(null==e)return;if(0===e.length)throw new Error("T has no Lists");if(null===e[0])throw new Error("table[0] is null");if(null!=i&&i.length!=e[0].length)throw new Error("weightsList must have a value for each row in the table");if(null!=s&&s.length!=e[0].length)throw new Error("colors list must have a value for each row in the table");t=null==t?e[0].name:t,r=null==r?0:r,o=null==o||""==o?"rgb(255,255,255)":o,l=null==l?0:l,null!=i&&i.getMin()<0&&(i=normalizeToInterval(i,new I(0,1)));var a=new Tr;let u,h,c;var f=new Nd(t,t);a.addNodeToTree(f,null);var p=e.length;let g,d,m,y,x,w;if(n)if(x=0==r?p-1:0,s){var L=T.toL([e[x],s]);w=buildDictionaryObjectForDictionary(L)}else w=createCategoricalColorListForList(e[x])[4].value;if(1==l){if(2!=e.length)throw new Error("T must have 2 Lists for parent-child mode");var v,b,_,M=difference(e[0].getWithoutRepetitions(),e[1].getWithoutRepetitions());if(0==M.length)throw new Error("Invalid data for a tree. Likely has loops in the relationships.");for(g=0;g<M.length;g++)u=new Nd(String(M[g]),String(M[g])),a.addNodeToTree(u,f);for(;M.length>0;){for(v=new sL,g=0;g<e[0].length;g++)if(-1!=M.indexOfElement(e[0][g])){if(null==(_=a.nodes.get(String(e[0][g])))&&new Error("Invalid data for a tree. Nd "+String(e[0][g])+" not found as parent"),null!=(b=a.nodes.get(String(e[1][g]))))throw new Error("Invalid data for a tree. Nd "+String(e[1][g])+" has multiple parents.");b=new Nd(String(e[1][g]),String(e[1][g])),n&&0==r?b.color=w[String(e[1][g])]:!n||1!=r&&2!=r||(b.color=w[String(e[1][g])]),v.push(String(e[1][g])),a.addNodeToTree(b,_),null!=i&&(b.weight=i[g])}M=v.clone()}}else for(g=0;g<p;g++)if(null!=e[g])for(m=e[g],d=0;d<m.length;d++)y=m[d],null!=y&&(c=_getId(e,g,d),u=a.nodes.get(c),null==u?(u=new Nd(c,String(y)),n&&g==p-1&&0==r?u.color=w[y]:!n||1!=r&&2!=r||(u.color=w[e[0][d]]),0===g?a.addNodeToTree(u,f):(h=a.nodes.get(_getId(e,g-1,d)),a.addNodeToTree(u,h)),u.firstIndexInTable=d,u.indexesInTable=new nL(d),null!=i&&(u.weight=i[d])):(null!=i?u.weight+=i[d]:u.weight++,u.indexesInTable.push(d)));if(n&&2==r)for(g=0;g<a.nodes.length;g++)u=a.nodes[g],0==u.level?u.color=o:u.color=interpolateColors(u.color,o,(u.level-1)/(a.nLevels-1));a.assignDescentWeightsToNodes();var S=function(e){var t;if(0===e.to.length)return e.indexesInTable;for(e.indexesInTable=new nL,t=0;null!=e.to[t];t++)e.indexesInTable=e.indexesInTable.concat(S(e.to[t]));return e.indexesInTable};return S(a.nodes[0]),a},_getId=function(e,t,n){let r=1,o="_"+String(e[0][n]);for(;r<=t;)o+="_"+String(e[r][n]),r++;return o},TreeToTable=function(e,t,n){if(null!=e){t=null==t||t,n=null!=n&&n;var r,o,i=new T,s=e.getLeaves(),l=function(e,t,n){if(0==e)return!1;for(var r=0;r<i[e].length;r++)if(i[e][r]==t&&i[e-1][r]!=n)return!0;return!1};n||(l=function(){return!1});for(var a=0;a<s.length;a++){(r=e.getAncestorsOf(s[a]).reverse()).addNode(s[a]),t||(r=r.slice(1));for(var u=r.length-1;u>=0;u--){for(null==i[u]&&(i[u]=new sL),o=r[u].name;l(u,o,u>0?r[u-1].name:"");)o+="";i[u][a]=o}}return i}},treeToObject=function(e,t){if(null==e||"Tr"!=e.type)return null;let n,r={},o=[r],i=["name","id","level","weight","color"];e.traverse(null,null,(function(e){for(var s in 0==e.level?n=r:(n={},o[e.level].push(n)),e)"type"==s&&0==e.level||(t||i.includes(s))&&"object"!=typeof e[s]&&null!=e[s]&&(n[s]=e[s]);return e.to.length>0&&(n.children=[],o[e.level+1]=n.children),!0}));return r},objectToTree=function(e){if(null==e)return null;let t=new Tr;var n=function(e,t,r){var o=null!=r.name?r.name:"",i=null!=r.id?r.id:"_"+o;null!=e.nodes.get(i)&&(i=e.nodes.getNewId());var s=new Nd(i,o);e.addNodeToTree(s,t);var l=!0;for(var a in r)if("id"!=a&&"name"!=a)if("[object Array]"!=Object.prototype.toString.call(r[a]))s[a]=r[a];else if(l){for(var u=0;u<r[a].length;u++)n(e,s,r[a][u]);l=!1}else s[a]=JSON.parse(JSON.stringify(r[a]))};return n(t,null,e),t},filterNetworkByRelationsWeight=function(e,t=0,n,r,o){let i,s=new _.Net;switch(t){case 0:i=e.relations.getSortedByProperty("weight",!1).slice(0,n);break;case 1:i=e.relations.filter((e=>e.weight>n))}return i.forEach((e=>{let t=s.createNode(e.node0.name),n=s.createNode(e.node1.name);r&&r.forEach((r=>{t[r]=e.node0[r],n[r]=e.node1[r]}));let i=s.createRelation(t,n);o&&o.forEach((t=>{i[t]=e[t]})),i.weight=e.weight,i.color=e.color})),s},filterNodesByMinDegree=function(e,t){let n;for(n=0;null!=e.nodes[n];n++)e.nodes[n].nodes.length<t&&(e.removeNode(e.nodes[n]),n--);return null},degreeBetweenNodes=function(e,t,n){if(null==e||null==t||null==n)return null;if(t==n)return 0;let r,o,i,s=t.nodes,l=1;for(;null==s.get(n.id);){for(r=s.clone(),i=s.length,o=0;o<i;o++)r=concat(r,s[o].nodes);if(r=r.getWithoutRepetitions(),s.length==r.length)return-1;s=r,l++}return l},getNodesBetweenTwoNodes=function(e,t,n){let r,o,i=new ndL,s=e.nodes.length;for(r=0;r<s;r++)o=e.nodes[r],o.id!=t.id&&o.id!=n.id&&null!=t.nodes.get(o.id)&&null!=n.nodes.get(o.id)&&i.addNode(o);return i},getSubNetwork=function(e,t,n,r){let o,i,s,l=new Net;for(var a=0;a<t.length;a++)if(o=new Nd(t[a].id,t[a].name),l.addNode(o),n)for(var u=0;u<n.length;u++)o[n[u]]=t[a][n[u]];for(a=0;a<e.relations.length;a++)if(o=l.nodes.get(e.relations[a].node0.id),i=l.nodes.get(e.relations[a].node1.id),null!=o&&null!=i&&(s=new Rel(e.relations[a].id,e.relations[a].name,o,i,e.relations[a].weight),l.addRelation(s),r))for(u=0;u<r.length;u++)s[r[u]]=e.relations[a][r[u]];return l},shortestPath=function(e,t,n,r){if(null==e||null==t||null==n)return null;var o=spanningTree(e,t,n);let i=new ndL;r&&i.addNode(n);let s=o.nodes.get(n.id);if(null==s)return null;for(;s.parent.id!=t.id;)if(i.addNode(s.parent.node),s=s.parent,null==s)return null;return r&&i.addNode(t),i.getReversed()},shortestPaths=function(e,t,n,r,o){if(null==e||null==t||null==n)return null;var i;let s=new T;if(null!=t.nodes.get(n.id))return s.push(new ndL(t,n)),s;null==o&&(o=spanningTree(e,t,n));var l=o.nLevels;let a=new ndL(n),u=adjacentNodeList(e,a,!1),h=intersection(u,o.getLevel(l-2));var c=new T;let f;for(c.push(getRelationsBetweenNodeLists(e,h,a,!1));l>2;)l--,a=h,h=intersection(adjacentNodeList(e,a,!1),o.getLevel(l-2)),f=getRelationsBetweenNodeLists(e,h,a,!1),c.push(f);for(c=c.getReversed(),i=0;null!=c[0][i];i++)s.push(new ndL(t,c[0][i].getOther(t)));var p,g,d=function(e,t){var n,r=new T,o=e[e.length-1];return t.forEach((function(t){o.relations.get(t.id)&&((n=e.clone()).addNode(t.getOther(o)),r.push(n))})),r};let m,y;for(;s[0].length<o.nLevels;){for(p=new T,m=s.length,i=0;i<m;i++)y=s[i],g=d(y,c[y.length-1]),p=p.concat(g);s=p}return s},getRelationsBetweenNodeLists=function(e,t,n,r=!0){if(null==t||null==n)return null;var o=new relL;let i,s,l=e.relations.length;for(s=0;s<l;s++)i=e.relations[s],(null!=t.get(i.node0.id)&&null!=n.get(i.node1.id)||!r&&null!=t.get(i.node1.id)&&null!=n.get(i.node0.id))&&o.addRelation(i);return o},_extendPaths=function(e,t,n){if(e[0].length>=n)return e;var r,o;let i,s;var l=new T;let a,u,h,c=e.length;for(r=0;r<c;r++)for(a=e[r],s=a[a.length-1],i=s.nodes.getWithoutRepetitions(),h=i.length,o=0;o<h;o++)null==a.get(i[o].id)&&(u=a.clone(),u.addNode(i[o]),l.push(u));return _extendPaths(e=l,t,n)},loops=function(e,t=3){if(null==e)return null;let n=function(e,t){if(e.length!=t.length)return!1;if(null==t.get(e[0].id))return!1;for(var n=t.indexOf(e[0]),r=e.length,o=1;null!=e[o];o++)if(e[o]!=t[(o+n)%r])return!1;return!0};var r,o,i,s,l=new T;for(r=0;null!=e.nodes[r];r++){for(s=_getLoopsOnNode(e.nodes[r]),i=0;null!=l[i];i++)for(o=0;null!=s[o];o++)n(s[o],l[i])&&(s.splice(o,1),o--);l=l.concat(s)}return t&&(l=l.getFilteredByPropertyValue("length",t,"greater")),l.sort((function(e,t){return e.length>t.length?-1:1})),l},_getLoopsOnNode=function(e){if(0===e.to.length||0===e.from.length)return[];var t=new T;let n,r,o,i,s=new ndL;for(s.addNode(e),t.push(s),_loopsColumns(e.to,1,t,1),n=1;t[n];n++)for(r=1;null!=t[r];r++)for(o=0;null!=t[r][o];o++)i=t[r][o],delete i.onColumn,0===i.to.length&&(t[r].removeNodeAtIndex(o),o--);let l,a=new T;for(r=1;null!=t[r];r++)for(o=0;null!=t[r][o];o++)i=t[r][o],null!=i.to.get(e.id)&&(l=new ndL(i),a.push(l),_pathsToCentral(t,r,l,a));return a.sort((function(e,t){return e.length>t.length?-1:1})),a},_pathsToCentral=function(e,t,n,r){if(n.finished)return;if(0===t)return void(n.finished=!0);var o;let i,s,l,a=n[0],u=!0;var h=e[t-1].clone();h.addNodes(e[t]);var c=e[t-1].length;for(o=0;null!=h[o];o++)i=h[o],a==i||null!=n.get(i.id)||null!=s&&null!=s.get(i.id)||null!=i.to.get(a.id)&&(u?(s=n.clone(),n.unshift(i),n.ids[i.id]=i,_pathsToCentral(e,o<c?t-1:t,n,r),u=!1):(l=s.clone(),r.push(l),l.unshift(i),l.ids[i.id]=i,_pathsToCentral(e,o<c?t-1:t,l,r)))},_loopsColumns=function(e,t,n){let r;null==n[t]&&(n[t]=new ndL);let o=new ndL;for(var i=0;null!=e[i];i++)r=e[i],r.onColumn||(r.onColumn=!0,n[t].addNode(r),o.addNodes(r.to));for(o=o.getWithoutRepetitions(),i=0;i<o.length;i++)o[i].onColumn&&(o.removeNodeAtIndex(i),i--);o.length>0&&_loopsColumns(o,t+1,n)},spanningTree=function(e,t,n,r){if(null==e)return;if(r>0)return _spanningTree2(t,r,n);t=null==t?e.nodes[0]:t,r=null==r?0:r;var o=new Tr;let i=new Nd(t.id,t.name);var s;let l,a,u,h,c;i.node=t,o.addNodeToTree(i);let f=(s=t.nodes).length;var p=!1;for(h=0;h<f;h++)a=new Nd(s[h].id,s[h].name),a.id!=i.id&&(a.node=s[h],o.addNodeToTree(a,i),null!=n&&a.id==n.id&&(p=!0));if(p)return o;var g=s.clone();g.addNode(t);for(var d=0;;){for(l=0==r?new ndL:s.clone(),h=0;null!=s[h];h++)l.addNodes(s[h].nodes);if(l=l.getWithoutRepetitions(),l.removeElements(g),0===l.length)return o;for(h=0;h<l.length;h++){a=new Nd(l[h].id,l[h].name),a.node=l[h];var m=l[h].nodes;if(null!=m&&0!=m.length){for(var y=0;null!=m[y];y++)if(c=m[y].id,u=s.get(c),null!=u&&a.id!=c){o.addNodeToTree(a,o.nodes.get(c));break}null!=n&&a.id==n.id&&(p=!0)}}if(p&&(p=!0),p)return o;if(s=l,g=g.concat(l),++d>e.nodes)return null}return o},_spanningTree2=function(e,t,n){t=null==t?0:t;var r=new Tr,o=function(e,i){if(!n||e.id!=n.id){var s=r.nodes.get(e.id);if(null==s){var l;switch(s=new Nd(e.id,e.name),r.addNodeToTree(s,i),t){case 0:l=e.nodes;break;case 1:l=e.to;break;case 2:l=e.from}for(var a=0;a<l.length;a++)o(l[a],s)}}};if(Array.isArray(e)){var i=new Nd("root","root");r.addNodeToTree(i),e.forEach((e=>o(e,i)))}else o(e,null);return r},spreads=function(e,t,n=.5,r="sizeReceived",o=!0,i){let s=null==i;i=i||t;let l=s?0:t*n,a=s?t:t*(1-n);if(e[r]=(e[r]||0)+l,e.to.length>0&&t/i>.01){let t=a/e.to.length;e.to.forEach((e=>{spreads(e,t,n,r,o,i)}))}else e[r]+=a},influenceLevels=function(e,t,n=!0){let r,o=new T,i=new T,s=new relL,l=null!=t.length,a=l?t:new ndL;l||a.addNode(t);let u=Math.random();a.forEach((e=>{e.__mark=u,e.__level=-1}));let h=function(e,t,o=0){r.push(e);let i=function(e,t,r){if(0==e.length)return null;let o,i,l=new ndL,a=t==n;return e.forEach((e=>{e.__level=r,o=t?e.toRelations:e.fromRelations,o?.forEach((e=>{i=t?e.node1:e.node0,e._onImpactTo=!0,i.__mark!=u&&(i.__mark=u,a&&s.addRelation(e),l.addNode(i))}))})),l}(e,t,o);if(0!=i.length)return h(i,t,o+1),i};n?(r=o,h(a,!0),r=i,h(a,!1)):(r=o,h(a,!1),r=i,h(a,!0));let c=[];for(let t=0;t<e.nodes.length;t++)e.nodes[t].__mark!=u&&(c.push(e.nodes[t]),e.nodes[t].__level=-1);let f=new relL;for(let t=0;t<e.relations.length;t++)e.relations[t].node1?.__level-e.relations[t].node0?.__level==1&&f.addRelation(e.relations[t]);return{levelsTableMain:o,levelsTableSecondary:i,notImpacted:c,influenceRelations:s,extendedInfluenceRelations:f}},adjacentNodeList=function(e,t,n,r){if(null==e||null==t)return null;var o=n?t.clone():new ndL;let i,s,l,a;if(r){for(i=0;i<t.length;i++)for(s=0;s<t[i].to.length;s++)a=t[i].to[s].id,null==t.get(a)&&null==o.get(a)&&o.addNode(a);return o}for(i=0;i<t.length;i++)for(s=0;null!=t[i].relations[s];s++)l=t[i].relations[s].node0,a=t[i].relations[s].node1,null==t.get(l.id)&&null==o.get(l.id)&&o.addNode(l),null==t.get(a.id)&&null==o.get(a.id)&&o.addNode(a);return o},degreesPartition=function(e,t){let n,r,o,i,s=new ndL(t),l=t.nodes,a=new T(s),u=l.length>0;u&&a.push(l);var h=l.clone();for(h.push(t);u;){for(r=new ndL,o=0;null!=l[o];o++)for(n=l[o].nodes,i=0;i<n.length;i++)h.includes(n[i])||(r.push(n[i]),h.push(n[i]));u=r.length>0,u&&(l=r,a.push(l))}return a},getNodes=function(e){return null==e?null:null!=e.nodes?e.nodes:"Rel"==typeOf(e)?new ndL(e.node0,e.node1):null},buildDendrogram=function(e){if(null==e)return null;var t=new Tr;let n=new ndL;var r;let o,i,s,l,a,u=e.nodes.length;var h=2*e.relations.length/(u*(u-1));for(a=0;a<u;a++)s=new Nd("["+e.nodes[a].id+"]","["+e.nodes[a].id+"]"),s.nodes=new ndL(e.nodes[a]),t.addNode(s),n[a]=s;for(;n.length>1;){for(o=n[(r=_getClosestPair(n,!0,h))[0]],i=n[r[1]],l="["+o.id+"-"+i.id+"]",s=new Nd(l,l),s.weight=r.strength,t.addNode(s),t.createRelation(s,o,l+"-"+o.id),t.createRelation(s,i,l+"-"+i.id),s.node=new Nd(l,l),s.nodes=o.nodes.concat(i.nodes),a=0;a<o.nodes.length;a++)s.node.nodes.addNode(o.nodes[a]),s.node.relations.addRelation(o.relations[a]);for(a=0;a<i.nodes.length;a++)s.node.nodes.addNode(i.nodes[a]),s.node.relations.addRelation(i.relations[a]);n.removeElement(o),n.removeElement(i),n.addNode(s)}for(a=0;a<t.nodes.length;a++)o=t.nodes[a],o.nodes.length>1&&(o.level=Math.max(o.nodes[0].level,o.nodes[1].level)+1);return t},_getClosestPair=function(e,t,n){let r;if(2==e.length){var o=e[0].nodes.indexOf(e[1]);return t?(r=[0,1],r.strength=-1==o?0:e[0].relations[o].weight,r):((e=new ndL(e[0],e[1])).strength=-1==o?0:e[0].relations[o].weight,e)}var i;let s;var l,a;let u=-1;for(i=0;i<e.length-1;i++)for(l=e[i].nodes,s=i+1;s<e.length;s++)(a=_strengthBetweenSets(l,e[s].nodes,n))>u&&(r=[i,s],u=a);return r.strength=u,t?r:((e=new ndL(e[r[0]],e[r[1]])).strength=u,e)},_strengthBetweenSets=function(e,t,n){let r,o,i,s=0;for(r=0;r<e.length;r++)for(i=e[r],o=0;o<i.nodes.length;o++)t.includes(i.nodes[o])&&(s+=i.relations[o].weight);return s/(e.length*t.length*n)},buildNetworkClusters=function(e,t,n,r,o,i){if(null==e)return;var s;let l,a,u,h,c;if(null==t||0===t?s=_buildNetworkClustersLvn(e):(null!=e._dendrogramTree&&(n=e._dendrogramTree),null==n&&(n=buildDendrogram(e)),e._dendrogramTree=n,r=r||.5,s=new T,_iterativeBuildClusters(n.nodes[n.nodes.length-1],s,r)),o)for(l=createDefaultCategoricalColorList(s.length),h=s.length,a=0;a<h;a++)for(c=s[a].length,u=0;u<c;u++)s[a][u].color=l[a];if(1==i){var f=new sL;for(f.name="clusters names",a=0;a<e.nodes.length;a++)e.nodes[a]._index=a;for(a=0;a<s.length;a++)for(c=s[a].length,u=0;u<c;u++)f[s[a][u]._index]="cluster_"+a;return f}return s},_iterativeBuildClusters=function(e,t,n){1!=e.nodes.length?(1==e.nodes[0].nodes.length||e.nodes[0].weight>n?t.push(e.nodes[0].nodes):_iterativeBuildClusters(e.nodes[0],t,n),1==e.nodes[1].nodes.length||e.nodes[1].weight>n?t.push(e.nodes[1].nodes):_iterativeBuildClusters(e.nodes[1],t,n)):t.push(new ndL(e.node))},_buildNetworkClustersLvn=function(e){if(null==e)return e;var t=[];let n;for(n=0;n<e.nodes.length;n++)t.push("n"+e.nodes[n].id);let r=[];for(n=0;n<e.relations.length;n++){var o={source:"n"+e.relations[n].node0.id,target:"n"+e.relations[n].node1.id,weight:e.relations[n].weight};r.push(o)}let i=_jLvn().nodes(t).edges(r)(),s=new T;if(i)for(n=0;n<e.nodes.length;n++){var l=i["n"+e.nodes[n].id];null==s[l]&&(s[l]=new ndL),s[l].addNode(e.nodes[n])}else for(n=0;n<e.nodes.length;n++)s.push(new ndL(e.nodes[n]));return s},getNodesPageRanks=function(e,t,n){return addPageRankToNodes(e,t,n)},addPageRankToNodes=function(e,t=2,n){var r,o,i,s,l,a,u,h=e.nodes.length,c=(1-.85)/h,f=["toPageRank","fromPageRank","allPageRank"][t=0==t?0:1==t?1:t],p=1;for(e.minFromPageRank=e.minToPageRank=99999999,e.maxFromPageRank=e.maxToPageRank=-99999999,o=0;null!=e.nodes[o];o++)(s=e.nodes[o])[f]=1/h;let g;for(r=0;r<300;r++)for(o=0;null!=e.nodes[o];o++){switch(s=e.nodes[o],t){case 0:a=s.to;break;case 1:a=s.from;break;case 2:a=s.nodes}for(s[f]=c,n&&(u=t?s.fromRelations:s.toRelations),i=0;null!=a[i];i++)l=a[i],n&&(p=u[i].weight),s[f]+=.85*p*l[f]/(t?l.to.length:l.from.length);299==r&&(n&&(s[f]=Math.pow(s[f],4)),t?(e.minFromPageRank=Math.min(e.minFromPageRank,s[f]),g=e.maxFromPageRank=Math.max(e.maxFromPageRank,s[f])):(e.minToPageRank=Math.min(e.minToPageRank,s[f]),g=e.maxToPageRank=Math.max(e.maxToPageRank,s[f])))}return e.nodes.forEach((e=>{e[f]/=g,console.log(e[f])})),e.nodes.getPropertyValues(f)},fusionNetworks=function(e,t,n,r){t=null==t?1:t,n=null==n?1:n;var o=new Net;let i,s,l,a,u=new T;var h,c=createDefaultCategoricalColorList(e.length).getInterpolated("black",.17).getInterpolated("white",.55);for(e.forEach((function(e,t){u[t]=new ndL,e.nodes.forEach((function(e){i=o.nodes.get(e.id),null==i?(i=new Nd(e.id,e.name),i.basicId=e.basicId,i.mapId="map_"+t,i.mapsIds=[i.mapId],i.color=null==e.color?e.color:c[t],i.nMaps=1,i.weight=e.weight,i.kind=e.kind,r&&r.forEach((t=>i[t]=e[t])),o.addNode(i),u[t].addNode(i)):(i.nMaps+=1,i.mapsIds.push("map_"+t),i.color=null==i.color?"rgb(200,200,200)":i.color,e.weight&&null==i.weight&&(i.weight=e.weight),e.kind&&null==i.kind&&(i.kind=e.kind),r&&r.forEach((t=>{e[t]&&null==i[t]&&(i[t]=e[t])})))}))})),e.forEach((function(e){e.relations.forEach((function(e){s=new Rel(e.id,e.name,o.nodes.get(e.node0.id),o.nodes.get(e.node1.id)),s.color=e.color,s.content=e.content,s.description=e.description,s.weight=e.weight,o.addRelation(s)}))})),l=0;null!=o.nodes[l];l++)for(h=o.nodes[l],a=l+1;null!=o.nodes[a];a++)h.name==o.nodes[a].name&&(s=new Rel(h.id+"_"+o.nodes[a].id,"same variable",h,o.nodes[a]),s.color="black",s.distanceFactor=t,s.forceWeight=n,o.addRelation(s),s=new Rel(o.nodes[a].id+"_"+h.id,"same variable",o.nodes[a],h),s.color="black",s.distanceFactor=t,s.forceWeight=n,o.addRelation(s),s.node0.nMaps+=1,s.node1.nMaps+=1);for(l=0;null!=o.nodes[l];l++)o.nodes[l].hubWeight=Math.sqrt(o.nodes[l].nMaps-1);return o.mapsCluster=u,o},_jLvn=function(){let e,t,n,r={};function o(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t)}function i(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function s(e,t){var n=e._assoc_mat[t]?Object.keys(e._assoc_mat[t]):[],r=0;return n.forEach((function(n){var o=e._assoc_mat[t][n]||1;t==n&&(o*=2),r+=o})),r}function l(e,t){return void 0===e._assoc_mat[t]?[]:Object.keys(e._assoc_mat[t])}function a(e,t,n){return e._assoc_mat[t]?e._assoc_mat[t][n]:void 0}function u(e){var t={};return e.forEach((function(e){t[e.source]=t[e.source]||{},t[e.source][e.target]=e.weight,t[e.target]=t[e.target]||{},t[e.target][e.source]=e.weight})),t}function h(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=h(e[n]);return t}function c(e,t,n){t.nodes_to_com={},t.total_weight=0,t.internals={},t.degrees={},t.gdegrees={},t.loops={},t.total_weight=function(e){var t=0;return e.edges.forEach((function(e){t+=e.weight})),t}(e),void 0===n?e.nodes.forEach((function(n,r){t.nodes_to_com[n]=r;var o=s(e,n);o<0||(t.degrees[r]=o,t.gdegrees[n]=o,t.loops[n]=a(e,n,n)||0,t.internals[r]=t.loops[n])})):e.nodes.forEach((function(r){var o=n[r];t.nodes_to_com[r]=o;var i=s(e,r);t.degrees[o]=(t.degrees[o]||0)+i,t.gdegrees[r]=i;var a=0;l(e,r).forEach((function(t){var i=e._assoc_mat[r][t];if(i<=0)throw"Bad graph type, use positive weights";n[t]==o&&(a+=t==r?i:i/2)})),t.internals[o]=(t.internals[o]||0)+a}))}function f(e){var t=e.total_weight,n=0;return o(i(e.nodes_to_com)).forEach((function(r){var o=e.internals[r]||0,i=e.degrees[r]||0;t>0&&(n=n+o/t-Math.pow(i/(2*t),2))})),n}function p(e,t,n){var r={};return l(t,e).forEach((function(o){if(o!=e){var i=t._assoc_mat[e][o]||1,s=n.nodes_to_com[o];r[s]=(r[s]||0)+i}})),r}function g(e,t,n,r){r.nodes_to_com[e]=+t,r.degrees[t]=(r.degrees[t]||0)+(r.gdegrees[e]||0),r.internals[t]=(r.internals[t]||0)+n+(r.loops[e]||0)}function d(e,t,n,r){r.degrees[t]=(r.degrees[t]||0)-(r.gdegrees[e]||0),r.internals[t]=(r.internals[t]||0)-n-(r.loops[e]||0),r.nodes_to_com[e]=-1}function m(e){var t=0,n=h(e),r={};return Object.keys(e).forEach((function(o){var i=e[o],s=void 0===r[i]?-1:r[i];-1==s&&(r[i]=t,s=t,t+=1),n[o]=s})),n}function y(e,t){for(var n=!0,r=0,o=f(t),i=o;n&&-1!=r&&(o=i,n=!1,r+=1,e.nodes.forEach((function(r){var o=t.nodes_to_com[r],i=(t.gdegrees[r]||0)/(2*t.total_weight),s=p(r,e,t);d(r,o,s[o]||0,t);var l=o,a=0;Object.keys(s).forEach((function(e){var n=s[e]-(t.degrees[e]||0)*i;n>a&&(a=n,l=e)})),g(r,l,s[l]||0,t),l!=o&&(n=!0)})),!((i=f(t))-o<1e-7)););}function x(e,t){var n,r,s={nodes:[],edges:[],_assoc_mat:{}},l=i(e);return s.nodes=s.nodes.concat(o(l)),t.edges.forEach((function(t){r=t.weight||1;var o=e[t.source],i=e[t.target];n=a(s,o,i)||0,function(e,t){!function(e,t){e._assoc_mat[t.source]=e._assoc_mat[t.source]||{},e._assoc_mat[t.source][t.target]=t.weight,e._assoc_mat[t.target]=e._assoc_mat[t.target]||{},e._assoc_mat[t.target][t.source]=t.weight}(e,t);var n=e.edges.map((function(e){return e.source+"_"+e.target})).indexOf(t.source+"_"+t.target);-1!=n?e.edges[n].weight=t.weight:e.edges.push(t)}(s,{source:o,target:i,weight:n+r})})),s}var w=function(){var e=function(e,t){if(0===e.edges.length){var n={};return e.nodes.forEach((function(e){n[e]=e})),n}var o={};c(r,o,t);var i=f(o),s=[];y(r,o);var l=f(o),a=m(o.nodes_to_com);s.push(a),i=l;var u=x(a,r);for(c(u,o);y(u,o),!((l=f(o))-i<1e-7);)a=m(o.nodes_to_com),s.push(a),i=l,c(u=x(a,u),o);return s}(r,n);return function(e,t){for(var n=h(e[0]),r=1;r<t+1;r++)Object.keys(n).forEach((function(t){var o=t,i=n[t];n[o]=e[r][i]}));return n}(e,e.length-1)};return w.nodes=function(t){return arguments.length>0&&(e=t),w},w.edges=function(n){if(void 0===e)throw"Please provide the graph nodes first!";if(arguments.length>0){t=n;var o=u(n);r={nodes:e,edges:t,_assoc_mat:o}}return w},w.partition_init=function(e){return arguments.length>0&&(n=e),w},w},getNodesCentralities=function(e,t,n,r){if(null!=e){var o=new nL;0===(t=null==t?0:t)&&addEigenvectorCentralityToNodes(e,n,r),1===t&&addBetweennessCentralityToNodes(e,n,r);for(var i=0;i<e.nodes.length;i++)o[i]=0==t?e.nodes[i].eigenvectorCentrality:e.nodes[i].betweennessCentrality;return o}},addCentralitiesToNodes=function(e,t,n,r){if(null!=e)return 0===(t=null==t?0:t)&&addEigenvectorCentralityToNodes(e,n,r),1===t&&addBetweennessCentralityToNodes(e,n,r),2===t&&addReachToNodes(e,!1),3===t&&addReachToNodes(e,!0),e},_getAdjacencyMap=function(e,t,n,r){if(null==e)return null;t=null!=t&&t,n=null!=n&&n,r=null!=r&&r;for(var o={},i=0;i<e.nodes.length;i++)o[e.nodes[i].id]={};for(i=0;i<e.relations.length;i++){var s=e.relations[i],l=s[n?"node1":"node0"].id,a=s[n?"node0":"node1"].id;o[l][a]=1-.5*s.weight,t||(o[a][l]=o[l][a])}if(r)for(var l in o){var u=[];for(var h in o[l])u.push(o[l][h]);var c=0;for(i=0;i<u.length;i++)c+=u[i];for(var a in o[l])o[l][a]/=c}return o},addEigenvectorCentralityToNodes=function(e,t,n){if(null==e)return e;void 0===t&&(t=!0),void 0===n&&(n=!0);let r={};function o(e){var t=[];for(var n in e)t.push(e[n]);for(var r=0,o=0;o<t.length;o++)r+=t[o];var i=1/(r||1);for(var s in e)e[s]*=i}let i=_getAdjacencyMap(e,null,n);randomSeed(1);let s={};for(var l=0;l<e.nodes.length;l++)s[e.nodes[l].id]=random();o(s),randomSeedPop();for(l=0;l<100;l++){var a=s;for(var u in s={},a)s[u]=0;for(var h in s)for(var c in i[h])s[h]+=.01+a[c]*i[h][c]*(r[p]?r[p]:1);o(s);var f=0;for(var p in s)f+=Math.abs(s[p]-a[p]);if(f<1e-4*e.nodes.length){if(t){var g=[];for(var u in s)g.push(s[u]);var d=Math.max.apply(Math,g)||1;for(var m in s)s[m]/=d}for(var m in s){e.nodes.get(m).eigenvectorCentrality=s[m]}return e}}for(l=0;l<e.nodes.length;l++)e.nodes[l].eigenvectorCentrality=0;return e},addBetweennessCentralityToNodes=function(e,t,n){if(null==e)return e;void 0===t&&(t=!0),void 0===n&&(n=!1);var r=function(){this.init=function(){this.k=[],this.w=[],this.length=0},this.init(),this.push=function(e,t){for(var n=0;n<=this.w.length&&t<(this.w[n]||1/0);)n++;return this.k.splice(n,0,e),this.w.splice(n,0,t),this.length+=1,!0},this.pop=function(){return this.length-=1,this.w.pop(),this.k.pop()}},o=_getAdjacencyMap(e,null,!0);let i,s,l,a={};for(var u=0;u<e.nodes.length;u++)a[e.nodes[u].id]=0;for(u=0;u<e.nodes.length;u++){for(var h=e.nodes[u].id,c=new r,f={},p={},g=0;g<e.nodes.length;g++)p[e.nodes[g].id]=[];var d={id:0};c.push([0,h,h],0);var m=[],y={};for(g=0;g<e.nodes.length;g++)y[e.nodes[g].id]=0;for(y[h]=1;c.length;){var x=c.pop();if(i=x[0],s=x[1],l=x[2],!(l in f))for(var w in f[l]=i,m.push(l),y[l]+=y[s],o[l]){var L=f[l]+o[l][w];w in f||w in d&&!(L<d[w])?L==d[w]&&(p[w].push(l),y[w]=y[w]+y[l]):(d[w]=L,c.push([L,l,w],L),p[w]=[l],y[w]=0)}}var v={};for(g=0;g<e.nodes.length;g++)v[e.nodes[g].id]=0;for(;m.length;){for(w=m.pop(),g=0;g<p[w].length;g++)l=p[w][g],v[l]+=(1+v[w])*y[l]/y[w];w!=h&&(a[w]+=v[w])}}if(t){var b=[];for(var T in a)b.push(a[T]);var _=Math.max.apply(Math,b)||1;for(var h in a)a[h]/=_}for(var h in a){var M=e.nodes.get(h);M.betweennessCentrality=a[h],M.betweennessCentralityDegreeRatio=M.betweennessCentrality/(M.nodes.length+.001)}return e},addReachToNodes=function(e,t=!1){let n=function(e){return e.reach||(e.reach=new L,e.to.forEach((r=>{e.reach=e.reach.concat(n(r,t)),e.reach.push(r),t||(e.reach=e.reach.getWithoutRepetitions())}))),e.reach};e.nodes.forEach((e=>e.reach=null)),e.nodes.forEach((e=>{e.reach||n(e)})),e.nodes.forEach((e=>{console.log(e.name,e.reach.getPropertyValues("name").join(", ")),e.reach=e.reach.length}))},getLeaves=function(e){if(null!=e)return null!=e.getLeaves?e.getLeaves():null},createNetworkFromListAndFunction=function(e,t,n,r,o,i){if(null==e||null==t)return;var s,l;let a,u,h,c=new Net,f=e.length;for(r=null==r?.3:r,s=0;s<f;s++)u=new Nd("n_"+s,null==n?"n_"+s:n[s]),u.element=e[s],u.i=s,c.addNode(u);if(i)for(s=0;s<f;s++)for(u=c.nodes[s],l=s+1;l<f;l++)h=c.nodes[l],a=t(e[s],e[l]),a>r&&(o>0&&(a-=r),2==o&&(a/=1-r),c.addRelation(new Rel(s+"_"+l,s+"_"+l,u,h,a)));else for(s=0;s<f;s++)for(u=c.nodes[s],l=0;l<f;l++)s!=l&&(h=c.nodes[l],a=t(e[s],e[l]),a>r&&(o>0&&(a-=r),2==o&&(a/=1-r),c.addRelation(new Rel(s+"_"+l,s+"_"+l,u,h,a))));return c},createRandomNetwork=function(e,t,n,r,o){if(null==e||null==t)return null;var i,s,l;i=null!=o?function(){return o++,getRandomWithSeed(o)}:Math.random,n=null==n?0:n;let a,u=new Net;for(s=0;s<e;s++)u.addNode(new Nd("n"+s,"n"+s));switch(n){case 0:if(t<1)for(s=0;s<e-1;s++)for(a=u.nodes[s],l=s+1;l<e;l++)i()<t&&u.addRelation(new Rel(s+"_"+l,s+"_"+l,a,u.nodes[l],r?i():1));else for(t=Math.min(t,e*(e-1)*.5);u.relations.length<t;)(s=Math.floor(i()*e))!=(l=Math.floor(i()*e))&&null==u.relations.get(s+"_"+l)&&u.addRelation(new Rel(s+"_"+l,s+"_"+l,u.nodes[s],u.nodes[l],r?i():1));return u;case 1:var h,c,f,p=e*(e-1)*.5;for(s=0;s<p;s++)if(i()<t)for(h=!0;h;)if(a=u.nodes[Math.floor(u.nodes.length*i())],i()<(a.nodes.length+1)/1)for(;h;)c=u.nodes[Math.floor(u.nodes.length*i())],f=a.id+"_"+c.id,null==u.relations.get(f)&&null==u.relations.get(c.id+"_"+a.id)&&i()<(c.nodes.length+1)/1&&(u.addRelation(new Rel(f,f,a,c,r?i():1)),h=!1);return u}},textsToNet=function(e,t,n,r=.8,o=1){let i=transpose(getWordsInTextsOccurrencesTable(e,0,o),!0);return buildCorrelationsNetwork(i,!0,t||e,n,r)},parseNet=function(e,t=.2){let n=new _.Net;if(Array.isArray(e)&&2==e.length){let r=e[0],o=e[1];try{r=JSON.parse(r)}catch(e){}if(!Array.isArray(null==r)){r=[],e[0].split("\n").forEach((e=>{r.push(JSON.parse(e))}))}r.forEach((e=>{let t=e.node.labels[0],r=new _.Nd(String(e.node?.id),e.node?.properties?.fullName||e.node?.properties?.title);r.category=t,r.color=interpolateColors(stringToColor(t),"white",.7),r.urlImage=e.node?.properties?.savedImg,r.properties=e.node?.properties,n.addNode(r)}));try{o=JSON.parse(o)}catch(e){}if(!Array.isArray(o)){o=[],e[1].split("\n").forEach((e=>{o.push(JSON.parse(e))}))}o.forEach((e=>{let r=e.rel?.properties?.weight;r<t||null!=n.get(String(e.rel.start.id))&&null!=n.get(String(e.rel.end.id))&&(n.createRelation(e.rel.start.id,e.rel.end.id).weight=r)}))}return n},textToNet=function(e,t="\n\n",n,r,o,i,s,l=!1){if(null==e)return;let a;Array.isArray(e)?(a=e,e=e.join(/\n\n/)):a=null!=o?e.split(o):[e],a=a.filter((e=>""!=e));let u,h={},c=0;a.forEach(((e,n)=>{u=e.split(t),u.forEach(((e,t)=>{let r=getWords(e);s&&(r=r.concat(getBigrams(e))),r.forEach((e=>{let t=h[e];null==t&&(t={word:e,count:0,contexts:[],groups:[],locations:[]},h[e]=t),t.count++,t.groups.push(n),t.locations.push(c)})),c++}))}));let f=new L,p=0;for(let e in h){let t=h[e];f.push(t)}f=f.getSortedByProperty("count",!1).slice(0,n).filter((e=>e.count>1)),f.forEach((e=>{p=Math.max(p,e.count),e.vector=createListWithSameElement(c,0),e.locations.forEach((t=>e.vector[t]++)),e.vector.mean=e.vector.getMean(),e.vector.standardDeviation=e.vector.getStandardDeviation()}));let g=new L,d=r<=1;for(let e=0;e<f.length;e++)for(let t=e+1;t<f.length;t++){let n=f[e],o=f[t],i={pair_id:n.word+"_"+o.word,wordObject0:n,wordObject1:o,weight:numericCorrelation(n.vector,o.vector)};(!d||i.weight>=r)&&g.push(i)}d||(g=g.getSortedByProperty("weight",!1).slice(0,r));let m=new Net;g.forEach((e=>{let t=m.createRelation(e.wordObject0.word,e.wordObject1.word);null==t.node0.count&&(t.node0.count=e.wordObject0.count,t.node0.weight=Math.log(e.wordObject0.count),t.node0.groups=e.wordObject0.groups),null==t.node1.count&&(t.node1.count=e.wordObject1.count,t.node1.weight=Math.log(e.wordObject1.count),t.node1.groups=e.wordObject1.groups),t.content=t.node0.name+"|"+t.node1.name+" "+e.weight,t.weight=e.weight}));let y=a.length,x=createDefaultCategoricalColorList(y,"0.9").getInterpolated("white",.6);m.colorsTable=new T,m.colorsTable[0]=new sL,m.colorsTable[1]=new cL;for(let e=0;e<y;e++)m.colorsTable[0][e]=e,m.colorsTable[1][e]=x[e];return m.nodes.forEach((e=>{e.colorsTable=toL(e.groups).getFrequenciesTable(!0,!0).getColumns([0,2]),2==y&&(e.groupsProportion=(e.groups.filter((e=>0==e)).length-e.groups.filter((e=>1==e)).length)/e.groups.length),e.colorsTable[0]=e.colorsTable[0].map((e=>x[e]))})),l&&(u=e.toLowerCase().split(t),m.relations.forEach((e=>{e.content="",u.forEach((n=>{n.includes(e.node0.name)&&n.includes(e.node1.name)&&(""!=e.content&&(e.content+=t+" /// "),e.content+=n)}))}))),m},textToTree=function(e,t,n="text"){let r=new _.Tr,o=function(e,n,i){if(!e||""==e.trim())return;let s=null==i?"text":e.includes("\n")?e.split("\n")[0]:e.includes(".")?e.split(".")[0]:e.includes(" ")?e.split(" ")[0]:e.substr(0,100),l=new _.Nd(s,s);l.text=e,l.level=n,r.addNodeToTree(l,i),l.weight=e.length;let a=e.split(t[n]);if(console.log(n,s,a.length),a.length<2)return;let u=t[n].toString().includes("(");if(n<3&&(console.log("level:",n),console.log("div:",t[n]),console.log("blocks:",a),console.log("divisors[level]:",t[n]),console.log("captureDivisor:",u)),u){let e,r,i="";for(var h=0;h<a.length;h+=2)console.log("+++",h),e=a[h],e&&""!=e.trim()?(i=h>0?e[h-1]:"",r=e[h],console.log("   ++++++++ level, detectedDivisor:",n,i),n<t.length&&o(h>0?(i+r).trim():e.trim(),n+1,l)):h++}else a.forEach((e=>{e&&""!=e.trim()&&(e=e.trim(),n<t.length&&o(e,n+1,l))}))};return o(e,0),r.nodes[0].name=n,r},imageToTableOfRGBA=function(e,t){if(null==e||e.width<=0)return null;t=null!=t&&t;let n,r,o,i=_getPixelData(e);if(null==i)return null;if(t){n=new T;for(var s=0;s<e.width;s++){n.push(new cL);for(var l=0;l<e.height;l++)n[s].push("")}}else n=createUniformTable(e.width,e.height,[]);for(var a=0;a<i.length;a+=4)r=a/4%e.width,o=Math.floor(a/4/e.width),n[r][o]=t?"rgba("+i[a]+","+i[a+1]+","+i[a+2]+","+i[a+3]/255+")":[i[a],i[a+1],i[a+2],i[a+3]/255];return n},invertImageColors=function(e){if(null==e||e.width<=0)return null;let t=_getPixelData(e);if(null==t)return null;for(var n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2];let r=new ImageData(t,e.width,e.height);return _makeImageFromData(r)},grayscaleImage=function(e){if(null==e||e.width<=0)return null;let t=_getPixelData(e);if(null==t)return null;for(var n=0;n<t.length;n+=4){var r=.2126*t[n]+.7152*t[n+1]+.0722*t[n+2];t[n]=t[n+1]=t[n+2]=r}let o=new ImageData(t,e.width,e.height);return _makeImageFromData(o)},cropImage=function(e,t,n,r,o){if(null==e||e.width<=0)return null;if(e.isList){for(var i=new L,s=0;s<e.length;s++){var l=cropImage(e[s],t,n,r,o);i=i.concat(l)}return i}t=null==t?0:t,n=null==n?0:n,r=null==r?e.width:r,o=null==o?e.height:o;let a=document.createElement("canvas"),u=a.getContext("2d");a.width=e.width,a.height=e.height,u.drawImage(e,0,0);var h=u.getImageData(t,n,r,o);return _makeImageFromData(h)},resizeImage=function(e,t,n,r,o){if(null==e||e.width<=0)return null;r=null==r||0!=r&&1!=r?0:r,o=null==o?"topleft":o;let i=new MetaCanvas({container:null,dimensions:{width:t=null==t||Math.round(t)<=0?200:Math.round(t),height:n=null==n||Math.round(n)<=0?Math.round(t/e.width*e.height):Math.round(n)},noLoop:!0,noStart:!0});var s;if(0==r){var l,a,u,h,c=o;if("topleft"==c.toLowerCase()){var f=_getPixelData(e);c="rgba("+f[0]+","+f[1]+","+f[2]+","+(f[3]/255).toFixed(2)+")"}i.fill(c),i.fRect(0,0,t,n),l=(t-(u=(h=Math.min(n,t*e.height/e.width))*e.width/e.height))/2,a=(n-h)/2,i.drawImage(e,0,0,e.width,e.height,l,a,u,h),s=i.captureCanvas()}else 1==r&&(i.drawImage(e,0,0,e.width,e.height,0,0,t,n),s=i.captureCanvas());return s},getDataURL=function(e,t){if(null==e||e.width<=0)return null;let n=new MetaCanvas({container:null,dimensions:{width:e.width,height:e.height},noLoop:!0,noStart:!0});n.drawImage(e,0,0);let r=n.captureCanvas();return t?'<img src="'+r.src+'">':r.src},_getPixelData=function(e){if(null==e||e.width<=0)return null;let t;try{var n=document.createElement("canvas"),r=n.getContext("2d");n.width=e.width,n.height=e.height,r.drawImage(e,0,0),t=r.getImageData(0,0,e.width,e.height).data}catch(e){throw e}return t},_makeImageFromData=function(e){if(null==e||null==e.width||e.width<=0||e.height<=0)return null;try{var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.putImageData(e,0,0);var r=document.createElement("img");r.src=t.toDataURL("image/png")}catch(e){throw e}return r},expandSimpleHtml=function(e,t,n){if(null==e||""===e)return"";var r;if(n&&(e=e.replaceAll("\n","<br>")),e.split("<").length!=e.split(">").length)return e;var o=e;if(-1!=o.indexOf("<fs"))for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fs",">"))&&(o=o.replace("<fs"+r+">",'<font style="font-size:'+Number(r)+'px">')),-1==o.indexOf(">")&&(r=null);for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<ff",">"))&&(o=o.replace("<ff"+r+">",'<font face="'+r+'">'));for(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(//,"<br/>")).replace(/<fcBlack>/g,'<font color="#000000">')).replace(/<.White>/g,'<font color="#FFFFFF">')).replace(/<fcRed>/g,'<font color="#FF0000">')).replace(/<fcGreen>/g,'<font color="#00FF00">')).replace(/<fcBlue>/g,'<font color="#0000FF">')).replace(/<fcOrange>/g,'<font color="#FFAA00">')).replace(/<fcCyan>/g,'<font color="#00FFFF">')).replace(/<fcYellow>/g,'<font color="#FFFF00">')).replace(/<fcMagenta>/g,'<font color="#FF00FF">'),r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fcuint",">"))&&(o=o.replace("<fcuint"+r+">",'<font color="'+uinttoHEX(r)+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fccolor",">"))&&(o=o.replace("<fccolor"+r+">",'<font color="'+colorStringToHEX(r)+'">'));for(r="";null!=r;)if(null!=(r=getFirstTextBetweenStrings(o,"<frgb",">"))){var i=r.split(".");o=o.replace("<frgb"+r+">",'<font color="'+RGBtoHEX(Number(i[0]),Number(i[1]),Number(i[2]))+'">')}if(-1!=o.indexOf("<fc"))for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fc",">"))&&(o=o.replace("<fc"+r+">",'<font color="'+("#"==r[0]?"":"#")+r+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<tl",">"))&&(o=o.replace("<tl"+r+">",'<textformat leftmargin="'+r+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<tv",">"))&&(o=o.replace("<tv"+r+">",'<textformat leading="'+r+'">'));let s,l,a;for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<e",">"))&&(s=r.split("*")[0],l=r.split("*")[1],a=r.split("*").length>2&&"s"==r.split("*")[2]?"_self":"_blank",o="http://"==s.substr(0,7)||"https://"==s.substr(0,8)?o.replace("<e"+r+">","<u><a href='"+s+"' target='"+a+"'>"+l+"</a></u>"):o.replace("<e"+r+">","<u><a href='javascript:document.clickLink(\""+s+'","'+t+"\")' FastHtml.onclick='event.preventDefault(); clickLink(\""+s+'","'+t+"\"); return false; '>"+l+"</a></u>"));return o=(o=(o=(o=(o=(o=o.replace(/<pl>/g,'<p align="left">')).replace(/<pc>/g,'<p align="center">')).replace(/<pr>/g,'<p align="right">')).replace(/<pj>/g,'<p align="justify">')).replace(/<\/f>/g,"</font>")).replace(/<\/t>/g,"</textformat>")},clickLink=function(e,t){for(var n=0;n<FastHtml_clickLinkFunctionsToCall.length;n++)FastHtml_clickLinkFunctionsToCall[n].call(FastHtml_clickLinkTargetsToCall[n],e,t)},_typeDict={L:L,iL:iL,cL:cL,P:P,P3D:P3D,Pol:Pol,Pol3D:Pol3D,Rec:Rec,T:T,nT:nT,polL:polL,Nd:Nd,sL:sL,ndL:ndL,relL:relL,recL:recL,Rel:Rel,Net:Net,Tr:Tr,dI:dI,dL:dL,nL:nL,I:I,pol3DL:pol3DL,cScale:cScale,MetaCanvas:MetaCanvas,Engine3D:Engine3D,Forces:Forces},TwoPi=6.28318530718;function ifDef(e,t){return null!=e?e:t}function typeOf(e){if(null==e)return null;var t=typeof e;return"object"!==t?t:null!=e.type?e.type:"[object Array]"==Object.prototype.toString.call(e)?"Array":null!=e.getDate?"date":"Object"}var _typeOf=function(e){if(null==e)return null;var t=typeof e;return"object"!==t?t:null!=e.type?e.type:"[object Array]"==Object.prototype.toString.call(e)?"Array":null!=e.getDate?"date":"Object"},noOperation=function(){};function resizeThrottler(e,t){var n;return function(r){n||(n=setTimeout((function(){n=null,e(r)}),t))}}function instantiate(e,t){switch(e){case"number":case"string":return window[e](t);case"date":if(!t||0===t.length)return new Date;if(1==t.length){if(t[0].match(/d*.-d*.-d*Dd*.:d*.:d*/)){var n=t[0].split(" ");return n[0]=n[0].split("-"),n[1]?n[1]=n[1].split(":"):n[1]=new Array(0,0,0),new Date(Date.UTC(n[0][0],Number(n[0][1])-1,n[0][2],n[1][0],n[1][1],n[1][2]))}return"NaN"!=Number(t[0])?new Date(Number(t[0])):new Date(t[0])}return new Date(Date.UTC.apply(null,t));case"boolean":return window[e]("false"!=t&&"0"!=t);case"L":case"T":case"sL":case"nL":case"nT":case"ndL":case"relL":case"Pol":case"Pol3D":case"polL":case"dL":case"cL":case"iL":return _typeDict[e].apply(new _typeDict[e],t);case null:case void 0:case"undefined":return null}var r,o,i;return i=window[e],(o=function(){}).prototype=i.prototype,r=new o,i.apply(r,t),r}function instanceSameType(e,t){return instantiate(typeOf(e),t)}let plasma=createColorScaleFromColors(cL.toL(["rgb(13,8,135)","rgb(125,3,168)","rgb(203,70,121)","rgb(248,148,65)","rgb(240,249,33)"]),[.25,.5,.75]),viridis=createColorScaleFromColors(cL.toL(["rgb(68,1,84)","rgb(59,81,139)","rgb(33,144,141)","rgb(92,200,99)","rgb(253,231,37)"]),[.25,.5,.75]),_HARDCODED_CATEGORICAL_COLORS=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f"],DateOperators_millisecondsToHours=1/36e5,DateOperators_millisecondsToDays=1/864e5,DateOperators_millisecondsToWeeks=1/6048e5,DateOperators_millisecondsToYears=3169e-14,DateOperators_MONTH_NAMES=["january","february","march","april","may","june","july","august","september","october","november","december"],DateOperators_MONTH_NAMES_SHORT=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],DateOperators_MONTH_NDAYS=[31,28,31,30,31,30,31,31,30,31,30,31],DateOperators_WEEK_NAMES=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],StringOperators_ENTER=String.fromCharCode(13),StringOperators_ENTER2=String.fromCharCode(10),StringOperators_ENTER3=String.fromCharCode(8232),StringOperators_SPACE=String.fromCharCode(32),StringOperators_SPACE2=String.fromCharCode(160),StringOperators_TAB=" ",StringOperators_TAB2=String.fromCharCode(9),StringOperators_LINK_REGEX=/(^|\s+)(https*\:\/\/\S+[^\.\s+])/,StringOperators_MAIL_REGEX=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,StringOperators_STOP_WORDS="t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","),StringOperators_WORDLISTS={},NetworkEncodings_nodeNameSeparators=["|",":"," is "," are ",".",","],NumberOperators_stackRandom=[],NumberOperators_random=Math.random,NumberOperators_lastNormal=1,NumberOperators_SG_MAGICCONST=1+Math.log(4.5),NumberOperators_LOG4=Math.log(4),TableEncodings_ENTER=String.fromCharCode(13),TableEncodings_ENTER2=String.fromCharCode(10),TableEncodings_ENTER3=String.fromCharCode(8232),TableEncodings_SPACE=String.fromCharCode(32),TableEncodings_SPACE2=String.fromCharCode(160),TableEncodings_TAB="  ",TableEncodings_TAB2=String.fromCharCode(9),GeoOperators_EARTH_RADIUS=6371009,GeoOperators_EARTH_DIAMETER=2*GeoOperators_EARTH_RADIUS,DrawTexts_POINT_TO_PIXEL=1.3333,DrawTexts_PIXEL_TO_POINT=.75,FastHtml_clickLinkFunctionsToCall=[],FastHtml_clickLinkTargetsToCall=[],FastHtml_target=null,FastHtml_linkFunction=null,_parseData=function(e,t,n){switch(t){case"csv":return toT(e,n);case"json":return JSON.parse(e);default:return e}};exports._parseData=_parseData,exports.loadData=function(e,t,n,r){var o=_parseData;fetch(e).then((e=>e.text())).then((i=>t({result:o(i,n,r),path:e})))},exports.loadDatas=function(e,t,n,r,o){let i=0,s=e[i],l=new L,a=_parseData,u="string"==typeof r?r:null,h=Array.isArray(r)?r:null,c=function(){fetch(s).then((e=>e.text())).then((r=>{let f=h?h[i]:u,p={result:a(r,f,o),path:s,nFile:i};l.push(p),t?.(p,l),i<e.length-1?(s=e[++i],c()):n?.(l.downcast())}))};c()};let loadImage=function(e,t){if(null!=e){var n=document.createElement("img");n.onload=function(){let r={path:e,result:n};t.call(this,r)},n.onerror=function(){let n={path:e,result:null};t.call(this,n)},n.src=e}},loadImages=function(e,t,n){var r=0,o=e[r],i=new L,s=new iL,l=function(){loadImage(o,(a=>{i.push(a),s.push(a.result),t?.(a,{paths:e.slice(0,s.length),results:s}),r<e.length-1?(o=e[++r],l()):n?.({paths:e,results:s})}))};l()},downloadData=function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),document.body.appendChild(n),n.click()},downloadTable=function(e,t){let n=TableToCSV(e,",",!0);downloadData(n,t)};exports.LOG=function(...e){if(null!=e&&null!=e[0])if(e[0].isTable){var t={};e[0].forEach((e=>{t[e.name]=e.serial()}))}else if(!e[0].isList)return"Net"==e[0].type?(e[0].nodes.forEach((e=>{e.nodes.forEach((e=>e.color?console.log("%c  "+e.name,"color:"+e.color):console.log("  "+e.name)))})),void console.groupEnd()):void("-"!=e[0]?console.log.apply(null,e):console.table("----------------------------------------------"))},exports.passPropertiesObjects=function(e,t,n,r){n.forEach((n=>e.forEach(((e,o)=>{r&&null!=e[n]||(e[n]=t[o][n])}))))},exports.passPropertiesToNodes=function(e,t,n,r=!1){n.forEach((n=>t.nodes.forEach((t=>{let o=e.get(t.id);o&&(r&&null!=o[n]||(o[n]=t[n]))}))))};let toL=function(e){return L.toL(e).downcast()},tosL=function(e){return sL.toL(e)},tonL=function(e){return nL.toL(e)},toT=function(e){if("string"==typeof e)return CSVToTable.apply(null,arguments);e=e[0].isList?e:e.map((e=>e.toL()));return T.toL(e).downcast()},tonT=function(e){return nT.toL(e)},serial=function(e){return e.isTable?e.map((e=>e.slice())):e.isList?e.slice():void 0};Array.prototype.toL=function(){return toL(this)},Array.prototype.tosL=function(){return tosL(this)},Array.prototype.tonL=function(){return tonL(this)},Array.prototype.toT=function(){return toT(this)},Array.prototype.tonT=function(){return tonT(this)},Array.prototype.serial=function(){return serial(this)},exports.toL=toL,exports.tosL=tosL,exports.tonL=tonL,exports.toT=toT,exports.tonT=tonT,exports.serial=serial,L.prototype._filter=Array.prototype.filter,L.prototype.filter=function(...e){return LOG(""),this._filter(e).toL()},L.prototype.pushNew=function(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||this.push(arguments[e])},L.prototype.concatNew=function(e){let t=[];return e.forEach((e=>{this.includes(e)||t.push(e)})),this.concat(t)},exports.deepAssign=function(e,t,n=0){for(var r in n++,e)if(null!=t[r])if(t[r]instanceof Array)e[r]=t[r];else{var o=typeof t[r];!("number"==o||"string"==o||"boolean"==o)?exports.deepAssign(e[r],t[r],n):e[r]=t[r]}},exports.expandTags=function(e,t){return t=t??",",e.join(t).getWithoutElement().split(t).tosL().trim()};var TableToNetwork=function(e,t,n,r=!0){let o,i,s=new Net;if(Array.isArray(t)||(t=e.get(t)),t.forEach(((t,n)=>{o=s.createNode(t,t),e.forEach((e=>{"name"!=e.name&&"id"!=e.name&&(i=e.name.replace(" ","_").toLowerCase(),o[i]=e[n])}))})),n){let e;s.nodes.forEach(((t,o)=>{s.nodes.forEach(((i,l)=>{if(o!=l&&(r||!(l<o))&&(e=n(t,i),e)){let n=s.createRelation(t,i,t.name+"_"+i.name);for(let t in e)n[t]=e[t]}}))}))}return s};Net.prototype.createNode=function(e,t){var n=this.nodes.get(e);return n||(n=new Nd(e,t||e),this.addNode(n),n)},Net.prototype.filter=function(e){for(var t=this.nodes.filter((t=>e(t))),n=0;n<this.nodes.length;n++)t.includes(this.nodes[n])||(this.removeNode(this.nodes[n]),n--)},MetaCanvas.prototype.fTexts=function(e,t,n,r=null,o=null){e.forEach(((e,i)=>{r&&(this.fontSize=r[i]),o&&(this.fontColor=o[i]),this.fText(e,t[i],n[i])}))},MetaCanvas.prototype.fCircles=function(e,t,n,r=null){e.forEach(((e,o)=>{r&&this.fill(r[o]),this.fCircle(e,t[o],n[o])}))},MetaCanvas.prototype._setDragZoomTransformation=function(e){this.applyTransformationFunctions((e=>e*this.ZOOM+this.x0),(e=>e*this.ZOOM+this.y0))},MetaCanvas.prototype.setDRAGGABLE=function(e){this.DRAGGABLE!=e&&(this.DRAGGABLE=e,e?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.ZOOMABLE?this.x0=this.y0=0:this.resetTransformation())},MetaCanvas.prototype.setZOOMABLE=function(e,t=50,n=.1){this.ZOOMABLE!=e&&(this.ZOOMABLE=e,this.MAX_ZOOM=t,this.MIN_ZOOM=n,e?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.DRAGGABLE?this.ZOOM=1:this.resetTransformation())},exports.buildTagsNetwork=function(e,t=",",n=1){if(null!=e){var r=new Net;if(1==e.length||!e.isTable&&e.isList){var o=e.isTable?e[0]:e,i={};let s,l;o.forEach(((e,n)=>{if(null==e)return;let r=e.split(t);for(let e=0;e<r.length;e++)for(let t=e+1;t<r.length;t++){r[e]<r[t]?(s=r[e],l=r[t]):(s=r[t],l=r[e]);let o=i[s+"_"+l];null==o&&(o=i[s+"_"+l]={count:0,indexes:[],indexesDic:{}}),o.count++,o.indexesDic["_"+n]||(o.indexes.push(n),o.indexesDic["_"+n]=!0)}}));new nL;let a,u,h,c=1,f=1;for(let e in i){let t=i[e].count;if(t>=n){let o=e.split("_");a=r.createNode(o[0]),u=r.createNode(o[1]),null==a.indexes&&(a.indexes=[]),null==u.indexes&&(u.indexes=[]),a.indexes=a.indexes.concat(i[e].indexes),u.indexes=u.indexes.concat(i[e].indexes),a.weight++,u.weight++,c=Math.max(c,a.weight,u.weight),h=r.createRelation(a,u),h.weight=1+t-n,h.count=t,f=Math.max(f,h.weight)}}return r.nodes.forEach((e=>{e.weight=.5+.5*e.weight/c,e.indexes=_.tonL(e.indexes).getWithoutRepetitions()})),r.relations.forEach((e=>e.weight=.2+.8*e.weight/f)),r}var s=e[0];o=e[1];return s.forEach((e=>{var t=new Nd(e,e);r.addNode(t),t.kind=nameActor??"actor",t.color="blue"})),o.forEach(((e,t)=>{if(null!=e){var n=r.nodes[t];e.split(",").toL().trim().forEach((e=>{var t=r.createNode(e,e);t.kind=nameTags??"tag",t.color="red",r.createRelation(n,t)}))}})),r}},exports.expandForBarycenters=function(e,t){if(e){var n=new PolL;return n.name=e.name,e.forEach((e=>n.push(expandForBarycenter(e,t)))),n}},exports.closestPointToLine=function(e,t,n,r,o,i){let s=o-n,l=i-r,a=((e-n)*s+(t-r)*l)/(s**2+l**2);return new _.P(n+s*a,r+l*a)},exports.distanceToLine2=function(e,t,n,r,o,i){let s=this.closestPointToLine(e,t,n,r,o,i);return(s.x-e)**2+(s.y-t)**2},exports.distanceToLine=function(e,t,n,r,o,i){let s=this.closestPointToLine(e,t,n,r,o,i);return Math.sqrt((s.x-e)**2+(s.y-t)**2)},exports.dataDropper=function(e,t,n){if(!e)return;if(!t)return;let r;n?n?.startsWith("DATA")&&(r="https://moebio.protozoo.com/data/"+n.substr(5),n="../data/"+n.substr(5)):r="https://moebio.protozoo.com/dataDropper/"+(n="data/"),""==n||n.endsWith("/")||(n+="/",r+="/"),n+=t,r+=t;var o=new XMLHttpRequest;o.onreadystatechange=function(){console.log("dataDropper | this.readyState: "+this.readyState),4==this.readyState&&console.log("sent")},o.open("POST","https://moebio.protozoo.com/dataDropper/storeData.php",!0);o.send(n+"<***>"+e);return r},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*Math.random())]},random=Math.random,NumberOperators_random=Math.random,exports.L=L,exports.iL=iL,exports.cL=cL,exports.P=P,exports.P3D=P3D,exports.Pol=Pol,exports.Pol3D=Pol3D,exports.Rec=Rec,exports.T=T,exports.nT=nT,exports.polL=polL,exports.Nd=Nd,exports.sL=sL,exports.ndL=ndL,exports.relL=relL,exports.recL=recL,exports.Rel=Rel,exports.Net=Net,exports.Tr=Tr,exports.dI=dI,exports.dL=dL,exports.nL=nL,exports.I=I,exports.pol3DL=pol3DL,exports.cScale=cScale,exports.MetaCanvas=MetaCanvas,exports.Engine3D=Engine3D,exports.Forces=Forces,exports.interpolateColors=interpolateColors,exports.interpolateColorsRGB=interpolateColorsRGB,exports.distanceColorsRGB=distanceColorsRGB,exports.addAlpha=addAlpha,exports.invertColor=invertColor,exports.stringToColor=stringToColor,exports.HEXtoRGB=HEXtoRGB,exports.RGBtoHEX=RGBtoHEX,exports.RGBArrayToString=RGBArrayToString,exports.colorStringToHEX=colorStringToHEX,exports.numberToHex=numberToHex,exports.uinttoRGB=uinttoRGB,exports.uinttoHEX=uinttoHEX,exports.RGBtouint=RGBtouint,exports.HEXtouint=HEXtouint,exports.grayByLevel=grayByLevel,exports.HEXtoHSV=HEXtoHSV,exports.HSVtoHEX=HSVtoHEX,exports.HSLtoHEX=HSLtoHEX,exports.RGBtoHSV=RGBtoHSV,exports.HSVtoRGB=HSVtoRGB,exports.HSLtoRGB=HSLtoRGB,exports.invertColorRGB=invertColorRGB,exports.toHex=toHex,exports.getRandomColor=getRandomColor,exports.colorStringToRGB=colorStringToRGB,exports.createSortedNumberList=createSortedNumberList,exports.createNumberListWithinInterval=createNumberListWithinInterval,exports.createRandomNormalDistribution=createRandomNormalDistribution,exports.createRandomBetaPERTDistribution=createRandomBetaPERTDistribution,exports.createRandomBimodalDistribution=createRandomBimodalDistribution,exports.createRandomNumbers=createRandomNumbers,exports.createUniformTable=createUniformTable,exports.dotProduct=dotProduct,exports.linearRegression=linearRegression,exports.distance=distance,exports.cosineSimilarity=cosineSimilarity,exports.covariance=covariance,exports.standardDeviationTwoNumberLists=standardDeviationTwoNumberLists,exports.numericCorrelation=numericCorrelation,exports.slidingWindowCorrelation=slidingWindowCorrelation,exports.normalizeToSum=normalizeToSum,exports.normalizeByZScore=normalizeByZScore,exports.normalizeToMax=normalizeToMax,exports.normalizeToInterval=normalizeToInterval,exports.trimNumberList=trimNumberList,exports.getAccumulativeSum=getAccumulativeSum,exports.shorten=shorten,exports.simplify=simplify,exports.segmentNumberList=segmentNumberList,exports.averageSmoother=averageSmoother,exports.closestValue=closestValue,exports.filterNumberListByInterval=filterNumberListByInterval,exports.filterNumberListByNumber=filterNumberListByNumber,exports.frameFromTwoNumberLists=frameFromTwoNumberLists,exports.rangeCounts=rangeCounts,exports.simpleCompression=simpleCompression,exports.regression=regression,exports.getDecimalsInterval=getDecimalsInterval,exports.setDecimals=setDecimals,exports.getDistributionHeights=getDistributionHeights,exports.kNearestNeighbours=kNearestNeighbours,exports.skewness=skewness,exports.TableToObject=TableToObject,exports.ArrayOfArraysToTable=ArrayOfArraysToTable,exports.tableToHtml=tableToHtml,exports.tableToList=tableToList,exports.createColorScaleFromColors=createColorScaleFromColors,exports.blackScale=blackScale,exports.grayscale=grayscale,exports.antiGrayscale=antiGrayscale,exports.antiTemperature=antiTemperature,exports.temperature=temperature,exports.lightTemperature=lightTemperature,exports.sqrtTemperature=sqrtTemperature,exports.sqrt4Temperature=sqrt4Temperature,exports.quadraticTemperature=quadraticTemperature,exports.cubicTemperature=cubicTemperature,exports.greenToRed=greenToRed,exports.greenToBlue=greenToBlue,exports.grayToOrange=grayToOrange,exports.sqrt4GrayToOrange=sqrt4GrayToOrange,exports.blueToRed=blueToRed,exports.whiteToRed=whiteToRed,exports.redToBlue=redToBlue,exports.greenWhiteRed=greenWhiteRed,exports.blueWhiteRed=blueWhiteRed,exports.blueBlackRed=blueBlackRed,exports.grayBlackOrange=grayBlackOrange,exports.grayWhiteOrange=grayWhiteOrange,exports.solar=solar,exports.antiSolar=antiSolar,exports.get=get,exports.getFirstElements=getFirstElements,exports.containSameElements=containSameElements,exports.fractionOfSameElements=fractionOfSameElements,exports.getCorrespondenceBetweenLists=getCorrespondenceBetweenLists,exports.getConfusionMatrix=getConfusionMatrix,exports.indexOf=indexOf,exports.replaceElement=replaceElement,exports.replaceElementAtIndex=replaceElementAtIndex,exports.replaceNullsInList=replaceNullsInList,exports.concat=concat,exports.reverse=reverse,exports.getBooleanDictionaryForList=getBooleanDictionaryForList,exports.getFirstOccurrenceDictionaryForList=getFirstOccurrenceDictionaryForList,exports.getIndexesDictionary=getIndexesDictionary,exports.getIndexesTable=getIndexesTable,exports.buildDictionaryObjectForDictionary=buildDictionaryObjectForDictionary,exports.mapWithTable=mapWithTable,exports.mapWithObject=mapWithObject,exports.sortListByNumberList=sortListByNumberList,exports.getRankingsList=getRankingsList,exports.sortListByIndexes=sortListByIndexes,exports.concatWithoutRepetitions=concatWithoutRepetitions,exports.slidingWindowOnList=slidingWindowOnList,exports.getNewListForObjectType=getNewListForObjectType,exports.union=union,exports.intersection=intersection,exports.difference=difference,exports.symmetricDifference=symmetricDifference,exports.jaccardIndex=jaccardIndex,exports.jaccardDistance=jaccardDistance,exports.filterList=filterList,exports.mapWithFunction=mapWithFunction,exports.mapFunctionsOnList=mapFunctionsOnList,exports.aggregateList=aggregateList,exports.subCategoricalAnalysis=subCategoricalAnalysis,exports.getListEntropy=getListEntropy,exports.getListDiversity=getListDiversity,exports.getInformationGain=getInformationGain,exports.groupElementsByPropertyValue=groupElementsByPropertyValue,exports.repeatElements=repeatElements,exports._isCategorical=_isCategorical,exports.buildInformationObjectForList=buildInformationObjectForList,exports.kCombinations=kCombinations,exports.allSubLists=allSubLists,exports.crossCombineLists=crossCombineLists,exports.characterizeList=characterizeList,exports.createDefaultCategoricalColorList=createDefaultCategoricalColorList,exports.colorsForCategoricalList=colorsForCategoricalList,exports.createCategoricalColorListForList=createCategoricalColorListForList,exports.createColorListFromColorScale=createColorListFromColorScale,exports.createColorListFromNumberList=createColorListFromNumberList,exports.createSymmetricalColorListFromNumberList=createSymmetricalColorListFromNumberList,exports.createColorListWithSingleColor=createColorListWithSingleColor,exports.createColorListBetweenTwoColors=createColorListBetweenTwoColors,exports.createColorListSpectrum=createColorListSpectrum,exports.stringsToColors=stringsToColors,exports.createCategoricalColors=createCategoricalColors,exports._sortingVariation=_sortingVariation,exports._evaluationFunction=_evaluationFunction,exports.createCategoricalColorListDictionaryObject=createCategoricalColorListDictionaryObject,exports.stringToDate=stringToDate,exports.dateToString=dateToString,exports.clearHoursMinutesSeconds=clearHoursMinutesSeconds,exports.currentDate=currentDate,exports.addDaysToDate=addDaysToDate,exports.addMillisecondsToDate=addMillisecondsToDate,exports.parseDate=parseDate,exports.parseDates=parseDates,exports.hoursBetweenDates=hoursBetweenDates,exports.daysBetweenDates=daysBetweenDates,exports.weeksBetweenDates=weeksBetweenDates,exports.yearsBetweenDates=yearsBetweenDates,exports.nDayInYear=nDayInYear,exports.getDateDaysAgo=getDateDaysAgo,exports.getWeekInYear=getWeekInYear,exports.getNDaysInMonth=getNDaysInMonth,exports.getDecimalDate=getDecimalDate,exports.convertFromDecimalDate=convertFromDecimalDate,exports.extractPropertiesFromDate=extractPropertiesFromDate,exports.StringListToNumberList=StringListToNumberList,exports.toDateList=toDateList,exports._y=_y,exports._m=_m,exports._d=_d,exports._h=_h,exports._mn=_mn,exports._s=_s,exports._ms=_ms,exports.getDateLists=getDateLists,exports.buildSummaryTableFromDates=buildSummaryTableFromDates,exports.transformDateList=transformDateList,exports.changeTimeResolution=changeTimeResolution,exports.getElementFromTable=getElementFromTable,exports.getSubTable=getSubTable,exports.sliceColumns=sliceColumns,exports.filterTable=filterTable,exports.filterColumns=filterColumns,exports.getSubTableByElementOnList=getSubTableByElementOnList,exports.getSubTableByElementsOnList=getSubTableByElementsOnList,exports.getRandomRows=getRandomRows,exports.transpose=transpose,exports.replaceElementInTable=replaceElementInTable,exports.replaceSectionInTable=replaceSectionInTable,exports.replaceNullsInTable=replaceNullsInTable,exports.testClassificationModel=testClassificationModel,exports.getRows=getRows,exports.sortListsByNumberList=sortListsByNumberList,exports.aggregateTable=aggregateTable,exports.disAggregateTable=disAggregateTable,exports.deSegmentTable=deSegmentTable,exports.pivotTable=pivotTable,exports.unpivotTable=unpivotTable,exports.getCountPairsMatrix=getCountPairsMatrix,exports.getPairsFrequencyTable=getPairsFrequencyTable,exports.concatenateRowElements=concatenateRowElements,exports.filterTableByElementInList=filterTableByElementInList,exports.filterTableByElementsInList=filterTableByElementsInList,exports.selectRows=selectRows,exports.joinTables=joinTables,exports.joinMultipleTables=joinMultipleTables,exports.combineLists=combineLists,exports.completeTable=completeTable,exports.getNumberTableFromTable=getNumberTableFromTable,exports.getVariablesInformationGain=getVariablesInformationGain,exports.splitTableByCategoricList=splitTableByCategoricList,exports.buildCorrelationsNetwork=buildCorrelationsNetwork,exports.buildSimpleDecisionTree=buildSimpleDecisionTree,exports.buildDecisionTree=buildDecisionTree,exports._buildDecisionTreeNode=_buildDecisionTreeNode,exports._decisionTreeGenerateColorsMixture=_decisionTreeGenerateColorsMixture,exports.allListsSameLength=allListsSameLength,exports.getListsWithoutRepetition=getListsWithoutRepetition,exports.getNumberOfDifferentElementsOfLists=getNumberOfDifferentElementsOfLists,exports.buildInformationObjectForTable=buildInformationObjectForTable,exports.getCategoricalLists=getCategoricalLists,exports.getTableSimplified=getTableSimplified,exports.concatTables=concatTables,exports.concatRows=concatRows,exports.concatLists=concatLists,exports.unionListsFromTables=unionListsFromTables,exports.intersectListsFromTables=intersectListsFromTables,exports.encodeStringLists=encodeStringLists,exports.translateListsWithDictionary=translateListsWithDictionary,exports.getModes=getModes,exports.getSubTables=getSubTables,exports.mapFunctionOnLists=mapFunctionOnLists,exports.mapFunctionsOnLists=mapFunctionsOnLists,exports.useVariablesDictionary=useVariablesDictionary,exports.matrixToTwoColumns=matrixToTwoColumns,exports._preserveOrder=_preserveOrder,exports.concatStrings=concatStrings,exports.join=join,exports.cleanTexts=cleanTexts,exports.filterStringListByString=filterStringListByString,exports.replaceStringsInTexts=replaceStringsInTexts,exports.replaceStringInTexts=replaceStringInTexts,exports.replaceStringsInTextsByStrings=replaceStringsInTextsByStrings,exports.countStringsOccurrencesOnTexts=countStringsOccurrencesOnTexts,exports.getWordsInTextsOccurrencesTable=getWordsInTextsOccurrencesTable,exports.createShortTextsNetwork=createShortTextsNetwork,exports.splitStrings=splitStrings,exports.encodeStringsAsNumericFeatures=encodeStringsAsNumericFeatures,exports.correlationRatio=correlationRatio,exports.splitByEnter=splitByEnter,exports.replaceStringInText=replaceStringInText,exports.replaceStringsInText=replaceStringsInText,exports.removeTextsBetweenStrings=removeTextsBetweenStrings,exports.getWords=getWords,exports.getBigrams=getBigrams,exports.substr=substr,exports.splitString=splitString,exports.getFirstTextBetweenStrings=getFirstTextBetweenStrings,exports.getAllTextsBetweenStrings=getAllTextsBetweenStrings,exports.textContainsString=textContainsString,exports.getParenthesisContents=getParenthesisContents,exports.getFirstParenthesisContent=getFirstParenthesisContent,exports.getFirstParenthesisContentWithIndexes=getFirstParenthesisContentWithIndexes,exports.placeString=placeString,exports.insertString=insertString,exports.cleanText=cleanText,exports.removeEnters=removeEnters,exports.removeTabs=removeTabs,exports.removePunctuation=removePunctuation,exports.removeDoubleSpaces=removeDoubleSpaces,exports.removeHtmlTags=removeHtmlTags,exports.escapeForRegExp=escapeForRegExp,exports.removeLinks=removeLinks,exports.removeQuotes=removeQuotes,exports.removeAccentsAndDiacritics=removeAccentsAndDiacritics,exports.getWordsOccurrencesTable=getWordsOccurrencesTable,exports.indexesOf=indexesOf,exports.indexesOfString=indexesOfString,exports.repeatString=repeatString,exports.countStringOccurrences=countStringOccurrences,exports.countOccurrences=countOccurrences,exports.countWordOccurrences=countWordOccurrences,exports.countRegexOccurrences=countRegexOccurrences,exports.countStringsOccurrences=countStringsOccurrences,exports.validateEmail=validateEmail,exports.validateUrl=validateUrl,exports.getLevenshteinDistance=getLevenshteinDistance,exports.getClosestLevenshtein=getClosestLevenshtein,exports.getNgrams=getNgrams,exports.stringToFunction=stringToFunction,exports.stringFormat=stringFormat,exports.createListWithSameElement=createListWithSameElement,exports.createIterationSequence=createIterationSequence,exports.createListWithUniqueElements=createListWithUniqueElements,exports.replaceChomasInTextLine=replaceChomasInTextLine,exports._replaceSpacesInLine=_replaceSpacesInLine,exports.decodeTextNet=decodeTextNet,exports._simplifyForTextNet=_simplifyForTextNet,exports._regexWordForTextNet=_regexWordForTextNet,exports.encodeTextNet=encodeTextNet,exports.modelInfluence=modelInfluence,exports.NetworkToTable=NetworkToTable,exports.TableToNetwork=TableToNetwork,exports.TableToNetworkPairs=TableToNetworkPairs,exports.matrixToNetwork=matrixToNetwork,exports.CSVToTable=CSVToTable,exports._removeQuotes=_removeQuotes,exports.TableToCSV=TableToCSV,exports.TableToJSONString=TableToJSONString,exports.JSONStringToTable=JSONStringToTable,exports.NumberListToPolygon=NumberListToPolygon,exports.NumberListToStringList=NumberListToStringList,exports.ObjectToTable=ObjectToTable,exports.ObjectToList=ObjectToList,exports.objectToString=objectToString,exports.conversor=conversor,exports.ArrayToList=ArrayToList,exports.angleFromTwoPoints=angleFromTwoPoints,exports.dot=dot,exports.twoPointsInterpolation=twoPointsInterpolation,exports.pointMultiplication=pointMultiplication,exports.normalizeTableToMax=normalizeTableToMax,exports.normalizeLists=normalizeLists,exports.normalizeListsToMax=normalizeListsToMax,exports.normalizeListsToSum=normalizeListsToSum,exports.normalizeListsToInterval=normalizeListsToInterval,exports.averageSmootherOnLists=averageSmootherOnLists,exports.kMeans=kMeans,exports.product=product,exports.getCovarianceMatrix=getCovarianceMatrix,exports.generateNumberTable=generateNumberTable,exports.identity=identity,exports.mergeObjects=mergeObjects,exports.cloneObject=cloneObject,exports.serliazeObject=serliazeObject,exports.getInterval=getInterval,exports.getFrame=getFrame,exports.getInfo=getInfo,exports.getObjectStructure=getObjectStructure,exports.replaceValuesByNull=replaceValuesByNull,exports.getLength=getLength,exports.includes=includes,exports.getPropertyValue=getPropertyValue,exports.getPropertyValues=getPropertyValues,exports.getPropertyValuesInterval=getPropertyValuesInterval,exports.getMultiplePropertyValues=getMultiplePropertyValues,exports.getName=getName,exports.isPropertyValue=isPropertyValue,exports.getPropertiesNames=getPropertiesNames,exports.getPropertiesNamesAndValues=getPropertiesNamesAndValues,exports.setPropertyValue=setPropertyValue,exports.interpolateObjects=interpolateObjects,exports.replaceObject=replaceObject,exports.toList=toList,exports.floor=floor,exports.addition=addition,exports.multiplication=multiplication,exports.division=division,exports.applyFunctionOnInput=applyFunctionOnInput,exports.isEqual=isEqual,exports._recursiveEqual=_recursiveEqual,exports.arrayOfArraysToTable=arrayOfArraysToTable,exports.operate=operate,exports._sum=_sum,exports._multiplication=_multiplication,exports._pow2=_pow2,exports._pow3=_pow3,exports._logSum=_logSum,exports._log2Sum=_log2Sum,exports._log_y=_log_y,exports._cosSum=_cosSum,exports._sinSum=_sinSum,exports._tanSum=_tanSum,exports._modulo=_modulo,exports._subtract=_subtract,exports._divide=_divide,exports.numberToString=numberToString,exports.getRandomWithSeed=getRandomWithSeed,exports.numberFromBinaryPositions=numberFromBinaryPositions,exports.numberFromBinaryValues=numberFromBinaryValues,exports.powersOfTwoDecomposition=powersOfTwoDecomposition,exports.toBinary=toBinary,exports.binaryToNumber=binaryToNumber,exports.positionsFromBinaryValues=positionsFromBinaryValues,exports._Alea=_Alea,exports._Mash=_Mash,exports.random=random,exports.randomSeed=randomSeed,exports.randomSeedPop=randomSeedPop,exports.decimalPlaces=decimalPlaces,exports.logistic=logistic,exports.formatShort=formatShort,exports.numberToPosition=numberToPosition,exports.getSoftenControlPoints=getSoftenControlPoints,exports.bezierCurvePoints=bezierCurvePoints,exports.triangleContainsPoint=triangleContainsPoint,exports.triangleArea=triangleArea,exports.lineFromTwoPoints=lineFromTwoPoints,exports.distancePointToLine=distancePointToLine,exports.distancePointToSegment=distancePointToSegment,exports.intersectionLines=intersectionLines,exports.intersectionLineRectangle=intersectionLineRectangle,exports.numberTableToPolygon=numberTableToPolygon,exports.numberTableToColorList=numberTableToColorList,exports.numberTableToNetwork=numberTableToNetwork,exports.buildDendrogramFromPolygon=buildDendrogramFromPolygon,exports._findClosestNodes=_findClosestNodes,exports.sortOnXY=sortOnXY,exports.expandFromBarycenter=expandFromBarycenter,exports.simplifyPolygon=simplifyPolygon,exports.bezierPolygonContainsPoint=bezierPolygonContainsPoint,exports.placePointsInsidePolygon=placePointsInsidePolygon,exports.placePointsInsideBezierPolygon=placePointsInsideBezierPolygon,exports.geoCoordinateToDecimal=geoCoordinateToDecimal,exports.geoDistance=geoDistance,exports.polygonLength=polygonLength,exports.minRect=minRect,exports.packingCircles=packingCircles,exports.packingRectangles=packingRectangles,exports.fillWithRectangles=fillWithRectangles,exports.squarify=squarify,exports.partitionRectangle=partitionRectangle,exports._getHighestRatio=_getHighestRatio,exports.simplifyPolygons=simplifyPolygons,exports.createPolygon=createPolygon,exports.twoNumberListsToPolygon=twoNumberListsToPolygon,exports.colorListFromColorScale=colorListFromColorScale,exports.colorListFromColorScaleFunction=colorListFromColorScaleFunction,exports.colorsLinearCombination=colorsLinearCombination,exports.polygon3DToColorList=polygon3DToColorList,exports.colorListToPolygon3D=colorListToPolygon3D,exports.randomColor=randomColor,exports.getFlowTable=getFlowTable,exports.getFlowTableIntervals=getFlowTableIntervals,exports.scaleIntervals=scaleIntervals,exports.nlsToIntervalList=nlsToIntervalList,exports.fillTextRectangle=fillTextRectangle,exports.fillTextRectangleWithTextLines=fillTextRectangleWithTextLines,exports.textWordWrapReturnLines=textWordWrapReturnLines,exports.getMaxTextWidth=getMaxTextWidth,exports.stringToObject=stringToObject,exports.stringToHash=stringToHash,exports._fnv_multiply=_fnv_multiply,exports._fnv_mix=_fnv_mix,exports.decodeIdentedTree=decodeIdentedTree,exports.TableToTree=TableToTree,exports._getId=_getId,exports.TreeToTable=TreeToTable,exports.treeToObject=treeToObject,exports.filterNetworkByRelationsWeight=filterNetworkByRelationsWeight,exports.objectToTree=objectToTree,exports.filterNodesByMinDegree=filterNodesByMinDegree,exports.degreeBetweenNodes=degreeBetweenNodes,exports.getNodesBetweenTwoNodes=getNodesBetweenTwoNodes,exports.getSubNetwork=getSubNetwork,exports.shortestPath=shortestPath,exports.shortestPaths=shortestPaths,exports.getRelationsBetweenNodeLists=getRelationsBetweenNodeLists,exports._extendPaths=_extendPaths,exports.loops=loops,exports._getLoopsOnNode=_getLoopsOnNode,exports._pathsToCentral=_pathsToCentral,exports._loopsColumns=_loopsColumns,exports.spanningTree=spanningTree,exports.spreads=spreads,exports.influenceLevels=influenceLevels,exports._spanningTree2=_spanningTree2,exports.adjacentNodeList=adjacentNodeList,exports.degreesPartition=degreesPartition,exports.getNodes=getNodes,exports.buildDendrogram=buildDendrogram,exports._getClosestPair=_getClosestPair,exports._strengthBetweenSets=_strengthBetweenSets,exports.buildNetworkClusters=buildNetworkClusters,exports._iterativeBuildClusters=_iterativeBuildClusters,exports._buildNetworkClustersLvn=_buildNetworkClustersLvn,exports.getNodesPageRanks=getNodesPageRanks,exports.addPageRankToNodes=addPageRankToNodes,exports.fusionNetworks=fusionNetworks,exports._jLvn=_jLvn,exports.getNodesCentralities=getNodesCentralities,exports.addCentralitiesToNodes=addCentralitiesToNodes,exports.addEigenvectorCentralityToNodes=addEigenvectorCentralityToNodes,exports.addBetweennessCentralityToNodes=addBetweennessCentralityToNodes,exports.addReachToNodes=addReachToNodes,exports.getLeaves=getLeaves,exports.createNetworkFromListAndFunction=createNetworkFromListAndFunction,exports.createRandomNetwork=createRandomNetwork,exports.textToNet=textToNet,exports.textToTree=textToTree,exports.textsToNet=textsToNet,exports.parseNet=parseNet,exports.imageToTableOfRGBA=imageToTableOfRGBA,exports.invertImageColors=invertImageColors,exports.grayscaleImage=grayscaleImage,exports.cropImage=cropImage,exports.resizeImage=resizeImage,exports.getDataURL=getDataURL,exports._getPixelData=_getPixelData,exports._makeImageFromData=_makeImageFromData,exports.expandSimpleHtml=expandSimpleHtml,exports.clickLink=clickLink,exports.downloadData=downloadData,exports.downloadTable=downloadTable,exports.loadImage=loadImage,exports.loadImages=loadImages,exports.StringOperators_STOP_WORDS=StringOperators_STOP_WORDS}));