!function(t,e){"function"==typeof define&&define.amd?define(["exports"],(function(n){e(t._=n)})):"object"==typeof exports&&"string"!=typeof exports.nodeName?e(exports):e(t._={})}("undefined"!=typeof self?self:this,(function(exports){"use strict";function DataType(){Object.apply(this),this.type="DataType"}function L(){DataType.apply(this);var t,e=[],n=arguments.length;for(t=0;t<n;t++)e.push(arguments[t]);return e=L.toL(e)}function iL(){for(var t=[],e=arguments.length,n=0;n<e;n++)t[n]=arguments[n];var r=L.apply(this,t);return r=iL.toL(r)}function cL(){var t,e=[],n=arguments.length;for(t=0;t<n;t++)e[t]=arguments[t];var r=L.apply(this,e);return r=cL.toL(r)}function P(t,e){DataType.apply(this,arguments),this.type="P",this.x=Number(t)||0,this.y=Number(e)||0}function P3D(t,e,n){P.apply(this,arguments),this.type="P3D",this.z=n}function Pol(){var t=L.apply(this,arguments);return t=Pol.toL(t)}function Pol3D(){var t=L.apply(this,arguments);return t=Pol3D.toL(t)}function Rec(t,e,n,r){DataType.apply(this),this.type="Rec",this.x=Number(t)||0,this.y=Number(e)||0,this.width=Number(n)||0,this.height=Number(r)||0}function T(){var t,e=[],n=arguments.length;for(t=0;t<n;t++)e[t]=arguments[t].isList?arguments[t]:new L(arguments[t]);var r=L.apply(this,e);return r=T.toL(r)}function nT(){var t=arguments,e=[];if(1==arguments.length)if("number"==typeof t[0])for(var n=0;n<t[0];n++)e.push(new nL);else Array.isArray(t[0])&&(e=i(t[0],1));else if(arguments.length>1)if("number"==typeof t[0]){var r=new nL;for(n=0;n<t.length;n++)r.push(t[n]);e.push(r)}else{var o=Array.prototype.slice.call(t);e=i(o,1)}function i(t,e){var n;if(void 0!==t.type)return"nT"==(n=t.clone()).type?n:"nL"==n.type&&1==e?[n]:"nL"==n.type&&e>1?n:[];n=[];for(var r=0;r<t.length;r++)Array.isArray(t[r])&&(t[r]=i(t[r],++e)),n[r]=t[r];return 0==n.length?[]:"number"==typeof n[0]&&1==e?[n]:n}return e=nT.toL(e)}function polL(){var t=T.apply(this,arguments);return t=polL.toL(t)}function Nd(t,e){this.id=null==t?"":t,this.name=null!=e?e:t,this.type="Nd",this.nodeType=null,this.x=0,this.y=0,this.z=0,this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL,this.weight=1,this.descentWeight=1,this.level=0,this.parent=null,this.vx=0,this.vy=0,this.vz=0,this.ax=0,this.ay=0,this.az=0}function sL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=String(arguments[e]);var n=L.apply(this,t);return n=sL.toL(n)}function ndL(){var t=ndL.toL([]);if(arguments&&arguments.length>0){var e=Array.prototype.slice.call(arguments);e.forEach((function(e){t.addNode(e)}))}return t}function relL(){var t=ndL.apply(this,arguments);return t.name="",t=relL.toL(t)}function recL(){var t=L.apply(this,arguments);return t=recL.toL(t)}function Rel(t,e,n,r,o,i){Nd.call(this,t,e),this.type="Rel",this.node0=n,this.node1=r,this.weight=null==o?1:o,this.content=null==i?"":i}function Net(){this.type="Net",this.nodes=new ndL,this.relations=new relL}function Tr(){Net.apply(this),this.type="Tr",this.nLevels=0,this._createRelation=this.createRelation,this.createRelation=this._newCreateRelation}function dI(t,e){DataType.apply(this,arguments),this.date0=t,this.date1=e,this.type="dI"}function dL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=Number(arguments[e]);var n=L.apply(this,t);return n=dL.toL(n)}function nL(){for(var t=[],e=arguments.length,n=0;n<e;n++)t[n]=Number(arguments[n]);var r=L.apply(this,t);return r=nL.toL(r)}function I(t,e){DataType.apply(this,arguments),this.x=Number(t),this.y=Number(e),this.type="I"}function pol3DL(){var t=L.apply(this,arguments);return t=pol3DL.toL(t)}function cScale(t){DataType.apply(this,arguments),this.name="",this.type="cScale",this.colorScaleFunction=t||blackScale}function MetaCanvas(t){null==t&&(t={container:document.querySelector("#maindiv"),cycle:function(){},onResize:function(){}}),this.container=t.container,this.container=this.container||document.querySelector("#maindiv"),"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.dimensions=t.dimensions,this.init=t.init||noOperation,this.cycle=t.cycle||noOperation,this.onResize=t.onResize||t.resize||noOperation,this._cycleInterval=void 0===t.cycleInterval?30:t.cycleInterval,t.noLoop&&(this._cycleInterval=0),this._init(!t.noStart)}function Engine3D(t){t=null==t?{}:t,this.lens=null==t.lens?300:t.lens,this._freeRotation=!1,this.setBasis(new Pol3D(new P3D(1,0,0),new P3D(0,1,0),new P3D(0,0,1))),this._cuttingPlane=10,this._dx=0,null!=t.angles&&this.setAngles(t.angles)}function Forces(t){this.k=t&&t.k?t.k:.01,this.dEqSprings=t&&t.dEqSprings?t.dEqSprings:100,this.dEqRepulsors=t&&t.dEqRepulsors?t.dEqRepulsors:500,this.friction=t&&t.friction?t.friction:.8,this.nodes=new ndL,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this._i0=0}DataType.prototype={},DataType.prototype.constructor=DataType,DataType.prototype.setType=function(t){this.type=t},DataType.prototype.getType=function(){return this.type},DataType.prototype.toString=function(){},L.prototype=new DataType,L.prototype.constructor=L,L.toL=function(t,e){if(null!=t){if(e){switch(e){case"number":case"nL":return nL.toL(t,!1);case"string":case"sL":return sL.toL(t,!1);case"Date":case"dL":return dL.toL(t,!1)}t.pushNew=L.prototype.pushNew,t.concatNew=L.prototype.concatNew}return t.type="L",t.name=t.name||"",t.setType=L.prototype.setType,t.toArray=L.prototype.toArray,t._constructor=L,t.downcast=L.prototype.downcast,t.get=L.prototype.get,t.getElements=L.prototype.getElements,t.isEqual=L.prototype.isEqual,t.getTypeOfElements=L.prototype.getTypeOfElements,t.getTypes=L.prototype.getTypes,t.getType=L.prototype.getType,t.getLengths=L.prototype.getLengths,t.getWithoutRepetitions=L.prototype.getWithoutRepetitions,t.getSimplified=L.prototype.getSimplified,t.getFrequenciesTable=L.prototype.getFrequenciesTable,t.allElementsAreEqual=L.prototype.allElementsAreEqual,t.countElement=L.prototype.countElement,t.countOccurrences=L.prototype.countOccurrences,t.countDifferentElements=L.prototype.countDifferentElements,t.getMode=L.prototype.getMode,t.getMin=L.prototype.getMin,t.getMax=L.prototype.getMax,t.indexOfElement=L.prototype.indexOfElement,t.indexesOf=L.prototype.indexesOf,t.indexOfElements=L.prototype.indexOfElements,t.indexesOfElements=L.prototype.indexesOfElements,t.getElementByName=L.prototype.getElementByName,t.getElementsByNames=L.prototype.getElementsByNames,t.getFirstElementByPropertyValue=L.prototype.getFirstElementByPropertyValue,t.add=L.prototype.add,t.getElementNumberOfOccurrences=L.prototype.getElementNumberOfOccurrences,t.getPropertyValues=L.prototype.getPropertyValues,t.getRandomElement=L.prototype.getRandomElement,t.getRandomElements=L.prototype.getRandomElements,t.isSorted=L.prototype.isSorted,t.getSortedByIndexes=L.prototype.getSortedByIndexes,t.getReversed=L.prototype.getReversed,t.getSortedByProperty=L.prototype.getSortedByProperty,t.getSorted=L.prototype.getSorted,t.getSortedByList=L.prototype.getSortedByList,t.getSortedRandom=L.prototype.getSortedRandom,t.getSubList=L.prototype.getSubList,t.getSubListByType=L.prototype.getSubListByType,t.getFilteredByPropertyValue=L.prototype.getFilteredByPropertyValue,t.getFilteredByBooleanList=L.prototype.getFilteredByBooleanList,t.toStringList=L.prototype.toStringList,t.toNumberList=L.prototype.toNumberList,t.toColorList=L.prototype.toColorList,t.clone=L.prototype.clone,t.toString=L.prototype.toString,t.getNames=L.prototype.getNames,t.getLabels=L.prototype.getLabels,t.getDescriptions=L.prototype.getDescriptions,t.getCategories=L.prototype.getCategories,t.applyFunction=L.prototype.applyFunction,t.getWithoutElementAtIndex=L.prototype.getWithoutElementAtIndex,t.getWithoutElement=L.prototype.getWithoutElement,t.getWithoutElements=L.prototype.getWithoutElements,t.getWithoutElementsAtIndexes=L.prototype.getWithoutElementsAtIndexes,t.getFilteredByFunction=L.prototype.getFilteredByFunction,t.insert=L.prototype.insert,t.insertMany=L.prototype.insertMany,t._concat=Array.prototype.concat,t.concat=L.prototype.concat,t.removeElement=L.prototype.removeElement,t.removeElementAtIndex=L.prototype.removeElementAtIndex,t.removeElementsAtIndexes=L.prototype.removeElementsAtIndexes,t.removeElements=L.prototype.removeElements,t.pushIfUnique=L.prototype.pushIfUnique,t.replace=L.prototype.replace,t.setNames=L.prototype.setNames,t.setPropertyValues=L.prototype.setPropertyValues,t._splice=Array.prototype.splice,t.splice=L.prototype.splice,t.isList=!0,t}},iL.prototype=new L,iL.prototype.constructor=iL,iL.toL=function(t){let e=L.toL(t);return e.type="iL",e.getInterval=iL.prototype.getInterval,e.getAmplitudes=iL.prototype.getAmplitudes,e},cL.prototype=new L,cL.prototype.constructor=cL,cL.toL=function(t){let e=L.toL(t);return e.type="cL",e.name=t.name||"",e.getRgbArrays=cL.prototype.getRgbArrays,e.getInterpolated=cL.prototype.getInterpolated,e.getInverted=cL.prototype.getInverted,e.addAlpha=cL.prototype.addAlpha,e},P.prototype=new DataType,P.prototype.constructor=P,P3D.prototype=new P,P3D.prototype.constructor=P3D,Pol.prototype=new L,Pol.prototype.constructor=Pol,Pol.toL=function(t){let e=L.toL(t);return e.type="Pol",e.getFrame=Pol.prototype.getFrame,e.getBarycenter=Pol.prototype.getBarycenter,e.getCenter=Pol.prototype.getCenter,e.add=Pol.prototype.add,e.factor=Pol.prototype.factor,e.getRotated=Pol.prototype.getRotated,e.getClosestPoint=Pol.prototype.getClosestPoint,e.toNumberList=Pol.prototype.toNumberList,e.containsPoint=Pol.prototype.containsPoint,e.touchesPolygon=Pol.prototype.touchesPolygon,e.approach=Pol.prototype.approach,e.clone=Pol.prototype.clone,e},Pol3D.prototype=new L,Pol3D.prototype.constructor=Pol3D,Pol3D.toL=function(t){let e=L.toL(t);return e.type="Pol3D",e.getBarycenter=Pol3D.prototype.getBarycenter,e},Rec.prototype=new DataType,Rec.prototype.constructor=Rec,T.prototype=new L,T.prototype.constructor=T,T.toL=function(t){for(var e=0;e<t.length;e++)Array.isArray(t[e])&&!t[e].isList&&(t[e]=L.toL(t[e]));let n=L.toL(t);return n.type="T",n.applyFunction=T.prototype.applyFunction,n.getListsDowncasted=T.prototype.getListsDowncasted,n.get=T.prototype.get,n.getColumns=T.prototype.getColumns,n.getWithoutColumn=T.prototype.getWithoutColumn,n.getWithoutColumns=T.prototype.getWithoutColumns,n.getRow=T.prototype.getRow,n.getRows=T.prototype.getRows,n.getCell=T.prototype.getCell,n.getLengths=T.prototype.getLengths,n.getListLength=T.prototype.getListLength,n.sliceRows=T.prototype.sliceRows,n.getRows=T.prototype.getRows,n.getWithoutRow=T.prototype.getWithoutRow,n.getWithoutRows=T.prototype.getWithoutRows,n.transpose=T.prototype.transpose,n.sortRowsByList=T.prototype.sortRowsByList,n.sortRowsByLists=T.prototype.sortRowsByLists,n.clone=T.prototype.clone,n.cloneWithEmptyLists=T.prototype.cloneWithEmptyLists,n.appendRows=T.prototype.appendRows,n.insertRow=T.prototype.insertRow,n.trim=T.prototype.trim,n.removeRow=T.prototype.removeRow,n.pushRow=T.prototype.pushRow,n.isTable=!0,n},nT.prototype=new T,nT.prototype.constructor=nT,nT.toL=function(t){let e=T.toL(t);return e.type="nT",e.getSums=nT.prototype.getSums,e.getRowsSums=nT.prototype.getRowsSums,e.getAverages=nT.prototype.getAverages,e.getRowsAverages=nT.prototype.getRowsAverages,e.getIntervals=nT.prototype.getIntervals,e.factor=nT.prototype.factor,e.add=nT.prototype.add,e.getMax=nT.prototype.getMax,e.getMaxValues=nT.prototype.getMaxValues,e.getMaxCell=nT.prototype.getMaxCell,e.getMin=nT.prototype.getMin,e.getMinValues=nT.prototype.getMinValues,e.getMinCell=nT.prototype.getMinCell,e.getInterval=nT.prototype.getInterval,e.getFrame=nT.prototype.getFrame,e},polL.prototype=new T,polL.prototype.constructor=polL,polL.toL=function(t){let e=T.toL(t);return e.type="polL",e.getFrame=polL.prototype.getFrame,e.getBarycenter=polL.prototype.getBarycenter,e.getCenter=polL.prototype.getCenter,e.add=polL.prototype.add,e.factor=polL.prototype.factor,e.getRotated=polL.prototype.getRotated,e.clone=polL.prototype.clone,e},Nd.prototype=new DataType,Nd.prototype.constructor=Nd,sL.prototype=new L,sL.prototype.constructor=sL,sL.toL=function(t,e){e=null==e||e;var n=L.toL(t);if(e)for(var r=0;r<n.length;r++)n[r]=String(n[r]);return n.type="sL",n.getLengths=sL.prototype.getLengths,n.countTags=sL.prototype.countTags,n.includesSubString=sL.prototype.includesSubString,n.indexesOfSubString=sL.prototype.indexesOfSubString,n.toLowerCase=sL.prototype.toLowerCase,n.toUpperCase=sL.prototype.toUpperCase,n.append=sL.prototype.append,n.getSurrounded=sL.prototype.getSurrounded,n.replace=sL.prototype.replace,n.getConcatenated=sL.prototype.getConcatenated,n.trim=sL.prototype.trim,n.clone=sL.prototype.clone,n.add=sL.prototype.add,n},ndL.prototype=new L,ndL.prototype.constructor=ndL,ndL.toL=function(t,e){e=null!=e&&e;var n=L.toL(t);if(e)for(var r=n.length,o=0;o<r;o++)n[o]="Nd"==_typeOf(n[o])?n[o]:new Nd(String(n[o]),String(n[o]));return n.type="ndL",n.ids={},Array(),n.addNode=ndL.prototype.addNode,n.addNodes=ndL.prototype.addNodes,n.removeNode=ndL.prototype.removeNode,n.removeNodes=ndL.prototype.removeNodes,n.removeNodeAtIndex=ndL.prototype.removeNodeAtIndex,n.getByName=ndL.prototype.getByName,n.get=ndL.prototype.get,n.getNodesByIds=ndL.prototype.getNodesByIds,n.normalizeWeights=ndL.prototype.normalizeWeights,n.getWeights=ndL.prototype.getWeights,n.getIds=ndL.prototype.getIds,n.getDegrees=ndL.prototype.getDegrees,n.getPolygon=ndL.prototype.getPolygon,n._push=Array.prototype.push,n.getWithoutRepetitions=ndL.prototype.getWithoutRepetitions,n.removeElements=ndL.prototype.removeElements,n.clone=ndL.prototype.clone,n},relL.prototype=new ndL,relL.prototype.constructor=relL,relL.toL=function(t){let e=ndL.toL(t);return e.type="relL",e.addRelation=relL.prototype.addRelation,e.removeRelation=relL.prototype.removeRelation,e.getRelationsWithNode=relL.prototype.getRelationsWithNode,e.getFirstRelationBetweenNodes=relL.prototype.getFirstRelationBetweenNodes,e.getFirstRelationByIds=relL.prototype.getFirstRelationByIds,e.getAllRelationsBetweenNodes=relL.prototype.getAllRelationsBetweenNodes,e.getRelatedNodesToNode=relL.prototype.getRelatedNodesToNode,e.nodesAreConnected=relL.prototype.nodesAreConnected,e.getChildrenOfNode=relL.prototype.getChildrenOfNode,e},recL.prototype=new L,recL.prototype.constructor=recL,recL.toL=function(t){let e=L.toL(t);return e.type="recL",e.getFrame=recL.prototype.getFrame,e.add=recL.prototype.add,e.clone=recL.prototype.clone,e.factor=recL.prototype.factor,e.getIntersectionArea=recL.prototype.getIntersectionArea,e.intersectsRectangle=recL.prototype.intersectsRectangle,e},Rel.prototype=new Nd,Rel.prototype.constructor=Rel,Net.prototype=new DataType,Net.prototype.constructor=Net,Tr.prototype=new Net,Tr.prototype.constructor=Tr,dI.prototype=new DataType,dI.prototype.constructor=dI,dL.prototype=new L,dL.prototype.constructor=dL,dL.toL=function(t,e){e=null==e||e;let n=L.toL(t);if(e)for(var r=0;r<n.length;r++)n[r]=new Date(n[r]);return n.type="dL",n.getTimes=dL.prototype.getTimes,n.getYears=dL.prototype.getYears,n.getFullYears=dL.prototype.getFullYears,n.getMin=dL.prototype.getMin,n.getMax=dL.prototype.getMax,n.getInterval=dL.prototype.getInterval,n},nL.prototype=new L,nL.prototype.constructor=nL,nL.toL=function(t,e){e=null==e||e;var n=L.toL(t);let r=n.length;if(e)for(var o=0;o<r;o++)n[o]=Number(n[o]);return n.type="nL",n.getMin=nL.prototype.getMin,n.getMax=nL.prototype.getMax,n.getAmplitude=nL.prototype.getAmplitude,n.getIndexOfMin=nL.prototype.getIndexOfMin,n.getIndexOfMax=nL.prototype.getIndexOfMax,n.getSum=nL.prototype.getSum,n.getProduct=nL.prototype.getProduct,n.getInterval=nL.prototype.getInterval,n.getIntervalWithAverage=nL.prototype.getIntervalWithAverage,n.getNumbersSimplified=nL.prototype.getNumbersSimplified,n.getMean=nL.prototype.getMean,n.getNorm=nL.prototype.getNorm,n.getStandardDeviation=nL.prototype.getStandardDeviation,n.getVariance=nL.prototype.getVariance,n.getMedian=nL.prototype.getMedian,n.getQuantiles=nL.prototype.getQuantiles,n.getSorted=nL.prototype.getSorted,n.getSortIndexes=nL.prototype.getSortIndexes,n.cleanNonFinites=nL.prototype.cleanNonFinites,n.getNormalized=nL.prototype.getNormalized,n.getNormalizedToMax=nL.prototype.getNormalizedToMax,n.getNormalizedToSum=nL.prototype.getNormalizedToSum,n.factor=nL.prototype.factor,n.add=nL.prototype.add,n.subtract=nL.prototype.subtract,n.divide=nL.prototype.divide,n.sqrt=nL.prototype.sqrt,n.pow=nL.prototype.pow,n.log=nL.prototype.log,n.floor=nL.prototype.floor,n.isEqual=nL.prototype.isEqual,n.addRandom=nL.prototype.addRandom,n.trim=nL.prototype.trim,n.getGeometricMean=nL.prototype.getGeometricMean,n.approach=nL.prototype.approach,n.clone=nL.prototype.clone,n},I.prototype=new P,I.prototype.constructor=I,pol3DL.prototype=new L,pol3DL.prototype.constructor=pol3DL,pol3DL.toL=function(t){let e=L.toL(t);return e.type="pol3DL",e.getBarycenter=pol3DL.prototype.getBarycenter,e},cScale.prototype=new DataType,cScale.prototype.constructor=cScale,MetaCanvas.prototype.constructor=MetaCanvas,Engine3D.prototype.constructor=Engine3D,Forces.prototype.constructor=Forces,P.prototype.getNorm=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},P.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},P.prototype.factor=function(t){return t>=0||t<0?new P(this.x*t,this.y*t):null!=t.type&&"P"==t.type?new P(this.x*t.x,this.y*t.y):void 0},P.prototype.normalize=function(){let t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x/t,this.y/t)},P.prototype.normalizeToValue=function(t){let e=t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x*e,this.y*e)},P.prototype.subtract=function(t){return new P(this.x-t.x,this.y-t.y)},P.prototype.add=function(t){return new P(t.x+this.x,t.y+this.y)},P.prototype.addCoordinates=function(t,e){return new P(t+this.x,e+this.y)},P.prototype.distanceToPoint=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},P.prototype.distanceToPointSquared=function(t){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)},P.prototype.angleToPoint=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},P.prototype.expandFromPoint=function(t,e){return new P(t.x+e*(this.x-t.x),t.y+e*(this.y-t.y))},P.prototype.interpolate=function(t,e){return new P((1-e)*this.x+e*t.x,(1-e)*this.y+e*t.y)},P.prototype.cross=function(t){return this.x*t.y-this.y*t.x},P.prototype.dot=function(t){return this.x*t.x+this.y*t.y},P.prototype.getRotated=function(t,e){return e=null==e?new P:e,new P(Math.cos(t)*(this.x-e.x)-Math.sin(t)*(this.y-e.y)+e.x,Math.sin(t)*(this.x-e.x)+Math.cos(t)*(this.y-e.y)+e.y)},P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},L.prototype.downcast=function(){if(0===this.length)return this;let t;switch(this.getTypeOfElements()){case"number":return t=nL.toL(this,!1),t.name=this.name,t;case"string":return t=sL.toL(this,!1),t.name=this.name,t;case"Rec":return this;case"date":return t=dL.toL(this,!1),t.name=this.name,t;case"L":case"dL":case"iL":case"sL":case"T":t=T.toL(this,!1);break;case"Array":t=T.toL(this,!1).getListsDowncasted();break;case"nL":return t=nT.toL(this,!1),t.name=this.name,t;case"P":t=Pol.toL(this,!1);break;case"Pol":t=polL.toL(this,!1);break;case"Nd":t=ndL.toL(this,!1);break;case"Rel":t=relL.toL(this,!1)}var e=this.length;let n,r=!1,o=!0;if(null==t||null==t.type&&""==t){for(n=0;n<e;n++)if(null==this[n]&&(r=!0),null==this[n]||!this[n].isList){o=!1;break}o&&(t=T.toL(this,!1))}if(null!=t?t.name=this.name:t=this,o){for(n=0;n<e;n++)if(null==t[n]||t[n].containsNulls){r=!0;break}}else if(!r)for(n=0;n<e;n++)if(null==t[n]){r=!0;break}return t.containsNulls=r,t},L.prototype.get=function(t){if(Array.isArray(t))return this.getElements(t);if("string"==typeof t){t=t.trim();for(var e=!1,n=0;n<this.length;n++)if(this[n].name==t){e=!0,t=n;break}if(!e)return null}else(t=null==t?0:t)<0&&(t+=this.length),t>=this.length&&(t=Math.floor(t)%this.length);return this[t]},L.prototype.getElements=function(t,e){if(null==t)return;var n=instanceSameType(this);n.name=this.name;let r,o,i=t.length,s=_typeOf(n);var l="sL"==_typeOf(t);for(r=0;r<i;r++)o=l?this.getElementByName(t[r]):this[t[r]<0?t[r]+this.length:t[r]],null==o?(e||!l&&null===this[t[r]])&&n.push(null):"ndL"==s?n.addNode(o):n.push(o);return"L"!=n.type?n:n.downcast()},L.prototype.toArray=function(){let t=this.slice(0);return t.name=this.name,t.type=this.type,t},L.prototype.isEqual=function(t){if(null==t||this.length!=t.length)return!1;var e;let n=this.length;if(this.isTable){for(e=0;e<n;e++)if(!this[e].isEqual(t[e]))return!1;return!0}for(e=0;e<n;e++)if(this[e]!=t[e])return!1;return!0},L.prototype.getLengths=function(){return tonL(this.map((t=>t.length)))},L.prototype.getTypeOfElements=function(){let t=_typeOf(this[0]),e=this.length;for(var n=1;n<e;n++)if(_typeOf(this[n])!=t)return"";return t},L.prototype.getTypes=function(){let t=new sL,e=this.length;for(var n=0;n<e;n++)t[n]=_typeOf(this[n]);return t},L.prototype.getNames=function(t,e,n){let r=new sL;r.name=n?"labels":"names";let o,i=this.length;t&&this.isTable&&buildInformationObjectForTable(this);for(var s=0;s<i;s++)o=n&&null!=this[s].label?this[s].label:this[s].name,t&&this[s].isList?this[s].infoObject.isCategorical&&this[s].infoObject.isNumeric?r[s]="[#c] "+o:this[s].infoObject.isCategorical?r[s]="[c] "+o:this[s].infoObject.isNumeric?r[s]="[#] "+o:r[s]=o:r[s]=o,e&&(r[s]+=" ("+this[s].countDifferentElements()+")");return r},L.prototype.getLabels=function(t,e){return this.getNames(t,e,!0)},L.prototype.getDescriptions=function(){let t=new sL,e=this.length;for(var n=0;n<e;n++)t[n]=this[n].description;return t},L.prototype.getCategories=function(){let t=new sL,e=this.length;for(var n=0;n<e;n++)t[n]=this[n].category;return t},L.prototype.getReversed=function(){let t=this.clone();return t.reverse(),t},L.prototype.getSubList=function(){var t;let e;if(null==arguments[0])return;if(arguments[0].isList)return this.getElements(arguments[0]);"number"==_typeOf(arguments[0])?t=null!=_typeOf(arguments[1])&&"number"==_typeOf(arguments[1])?new I(arguments[0],arguments[1]):new I(arguments[0],this.length-1):null!=arguments[0].x&&(t=arguments[0]),t.x<0&&(t.x=this.length+t.x),t.y<0&&(t.y=this.length+t.y);var n=new I(Math.max(Math.min(Math.floor(t.x),this.length),0),Math.max(Math.min(Math.floor(t.y),this.length-1),0));let r;if(arguments[2]&&(n.y+=arguments[2]),"nL"==this.type)return r=nL.toL(this.slice(n.x,n.y+1),!1),r.name=this.name,r;if("sL"==this.type)return r=sL.toL(this.slice(n.x,n.y+1),!1),r.name=this.name,r;var o=this.type;if(r="L"==o||"T"==o?new L:instantiate(o),"ndL"==o)for(e=n.x;e<=n.y;e++)r.addNode(this[e]);else for(e=n.x;e<=n.y;e++)r.push(this[e]);return r.name=this.name,"L"==o||"T"==o?r.downcast():r},L.prototype.getSubListByType=function(t){let e=new L;e.name=this.name;for(var n=0;n<this.length;n++)_typeOf(this[n])==t&&e.push(this[n]);return e.downcast()},L.prototype.getElementNumberOfOccurrences=function(t){let e=0,n=0,r=this.indexOf(t,n);for(;r>-1;)e++,n=r+1,r=this.indexOf(t,n);return e},L.prototype.clone=function(){let t,e=instanceSameType(this),n=this.length;for(t=0;t<n;t++)e.push(this[t]);return e.name=this.name,e.fnDerived=this.fnDerived,e},L.prototype.getWithoutRepetitions=function(t,e){return toL([...new Set(this)]).downcast()},L.prototype.getSimplified=function(t,e,n){if(!t)return;var r=this.getFrequenciesTable(!0,!1,!1,n);let o,i=getFirstOccurrenceDictionaryForList(r[0]),s=this.length;null==e&&(e="other");var l="sL"==this.type?new sL:new L;for(l.name=this.name,o=0;o<s;o++)l.push(i[this[o]]<t-1?this[o]:e);return l},L.prototype.countElement=function(t){let e=0,n=this.length;for(var r=0;r<n;r++)t==this[r]&&e++;return e},L.prototype.countOccurrences=function(){let t=new nL,e={},n=this.length;for(var r=0;r<n;r++)null==e[this[r]]&&(e[this[r]]=0),e[this[r]]++;for(r=0;r<n;r++)t[r]=e[this[r]];return t},L.prototype.countDifferentElements=function(){if(this.infoObject)return this.infoObject.numberDifferentElements;var t={};let e=0;for(var n=0;n<this.length;n++)null==t[this[n]]&&(t[this[n]]=1,e++);return e},L.prototype.getFrequenciesTable=function(t=!0,e,n,r){var o;let i,s;if(this.freqTable)l=(o=this.freqTable.getColumns([0,1]))[0],a=o[1];else{o=new T;var l=instanceSameType(this),a=new nL;o[0]=l,o[1]=a,o._indexesDictionary={};var u=this.length;for(i=0;i<u;i++)s=o._indexesDictionary[this[i]],null==s&&(s=l.length,l[s]=this[i],a[s]=0,o._indexesDictionary[this[i]]=s),r&&i<r.length?a[s]+=r[i]:a[s]++}var h=0;if(t){var c=[];for(i=0;i<a.length;i++)c[i]=[a[i],l[i]],h+=a[i];var f=c.sort((function(t,e){return e[0]-t[0]}));for(o[0]=instanceSameType(l),o[1]=new nL,i=0;i<a.length;i++)o[0][i]=f[i][1],o[1][i]=f[i][0];o._indexesDictionary=null}if(o[0].name=""==this.name?"Element":this.name,o[1].name="Frequency",e&&(0==h&&(h=o[1].getSum()),o[2]=normalizeToSum(o[1],1,h),o[2].name="Occurrences normalized to sum"),n){var p=stringsToColors(o[0]);p.name="Categorical colors",o.push(p)}return this.freqTable=o,o},L.prototype.allElementsAreEqual=function(){let t;if(this.length<2)return!0;var e=this[0];let n=this.length;for(t=1;t<n;t++)if(this[t]!=e)return!1;return!0},L.prototype.getMode=function(){let t={};var e=0;let n;for(var r=0;r<this.length&&(null==t[this[r]]&&(t[this[r]]=0),t[this[r]]++,!(t[this[r]]>e&&(e=t[this[r]],n=this[r],e>.5*this.length)));r++);return n},L.prototype.getMin=function(){if(0===this.length)return null;let t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.min(e,this[t]);return e},L.prototype.getMax=function(){if(0===this.length)return null;let t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.max(e,this[t]);return e},L.prototype.add=function(t){if(t.constructor==Number){var e,n=this.length,r=instanceSameType(this);for(e=0;e<n;e++)r.push(this[e]+t);return r}},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*random())]},L.prototype.getRandomElements=function(t,e,n,r){if(null==t)return;var o=null!=n?new _Alea("my",n,"seeds"):NumberOperators_random;e=null==e||e,t=Math.min(t,this.length);let i,s=instanceSameType(this);if(r){var l=this;if(e)l=u=this.getWithoutRepetitions();t=Math.min(t,l.length);var a=new T;a.push(createSortedNumberList(l.length,0,1)),a.push(createNumberListWithinInterval(l.length,new I(0,1),0,n)),a=(a=(a=a.sortRowsByList(1)).sliceRows(0,t-1)).sortRowsByList(0),s=l.getElements(a[0])}else if(e){var u=this.getWithoutRepetitions();t=Math.min(t,u.length);for(var h=createNumberListWithinInterval(u.length,new I(0,1),0,n),c=u.getSortedByList(h),f=0;f<t;f++)s.push(c[f])}else for(;s.length<t;)i=this[Math.floor(this.length*o())],s.push(i);return s.name=this.name,s},L.prototype.getPropertyValues=function(t,e){let n,r=new L;r.name=t;let o=this.length;for(var i=0;i<o;i++)n=getPropertyValue(this[i],t),r[i]=null==n?e:n;return r.downcast()},L.prototype.isSorted=function(t){t=null==t||Boolean(t);var e=this.length;let n;if(t){for(n=1;n<e;n++)if(this[n]<this[n-1])return!1}else for(n=1;n<e;n++)if(this[n]>this[n-1])return!1;return!0},L.prototype.getSortedByIndexes=function(t){if(null==t)return;var e=instanceSameType(this);let n;e.name=this.name;let r=this.length;for(n=0;n<r;n++)-1!=t[n]&&e.push(this[t[n]]);return e},L.prototype.getSortedByProperty=function(t,e,n){if(t.includes("."))return this.getSortedByList(this.getPropertyValues(t),e,null!=n?this.getPropertyValues(t):null);if(e=null==e||e,0==this.length)return this.clone();var r=_typeOf(this[0][t]);let o="number"!=r&&"date"!=r;var i;return i=n?e?o?function(e,r){return e[t]==r[t]?e[n]>r[n]?1:-1:e[t]>r[t]?1:-1}:function(e,r){return e[t]==r[t]?e[n]-r[n]:e[t]-r[t]}:o?function(e,r){return e[t]==r[t]?r[n]>e[n]?1:-1:r[t]>e[t]?1:-1}:function(e,r){return e[t]==r[t]?r[n]-e[n]:r[t]-e[t]}:e?o?function(e,n){return e[t]>n[t]?1:-1}:function(e,n){return e[t]-n[t]}:o?function(e,n){return n[t]>e[t]?1:-1}:function(e,n){return n[t]-e[t]},this.clone().sort(i)},L.prototype.getSorted=function(t){return this.getSortedByList(this,t)},L.prototype.getSortedByList=function(t,e,n,r){if(null==t)return null;e=null==e||e,r=null!=r&&r;var o=[];let i,s=this.length;if(n&&"nL"==t.type)for(i=0;i<s;i++)o[i]=[this[i],t[i]+1e4*Math.random()*Number.MIN_VALUE,i];else if("dL"==t.type)for(i=0;i<s;i++)o[i]=[this[i],t[i].getTime(),i];else for(i=0;i<s;i++)o[i]=[this[i],t[i],i];let l=("nL"==t.type||"dL"==t.type)&&!r;var a;a=e?l?function(t,e){return t[1]-e[1]}:r?function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:t[2]-e[2]}:function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}:l?function(t,e){return e[1]-t[1]}:r?function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:t[2]-e[2]}:function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:0},o=o.sort(a);var u=instanceSameType(this);for(u.name=this.name,i=0;i<s;i++)u[i]=o[i][0];return u},L.prototype.getSortedRandom=function(){let t=this.clone();return t.name=this.name,t.sort((function(){return random()-.5})),t},L.prototype.indexOfElement=function(t){let e,n=this.length;for(e=0;e<n;e++)if(this[e]==t)return e;return-1},L.prototype.indexesOf=function(t){var e=this.indexOf(t);let n=new nL;for(;-1!=e;)n.push(e),e=this.indexOf(t,e+1);return n},L.prototype.indexOfElements=function(t){if(null==t)return;var e=new nL;let n=t.length;for(var r=0;r<n;r++)e[r]=this.indexOf(t[r]);return e},L.prototype.indexesOfElements=function(t,e){if(null==t)return;var n,r=new nL;let o,i;this.length;if(n=getFirstOccurrenceDictionaryForList(this),e)for(o=0;o<t.length;o++)i=n[t[o]],r[o]=null==i?-1:i;else for(o=0;o<t.length;o++)i=n[t[o]],null!=i&&r.push(i);return r},L.prototype.getElementByName=function(t,e){if(null==t)return null;for(var n=this.length,r=0;r<n;r++)if(this[r].name==t)return e?r:this[r];return e?-1:null},L.prototype.getElementsByNames=function(t,e,n,r){if(null==t)return;var o=e?new nL:new L;let i,s,l,a,u=this.length;for(i=0;i<t.length;i++){for(l=t[i],a=!1,s=0;s<u;s++)if(this[s].name==l){o.push(e?s:this[s]),a=!0;break}n&&!a&&o.push(e?-1:r)}return e?o:o.downcast()},L.prototype.getFirstElementByPropertyValue=function(t,e){let n=this.length;for(var r=0;r<n;r++)if(this[r][t]==e)return this[r];return null},L.prototype.getFilteredByBooleanList=function(t){let e,n=new L;n.name=this.name;let r=this.length;for(e=0;e<r;e++)t[e]&&n.push(this[e]);return n.downcast()},L.prototype.getFilteredByPropertyValue=function(t,e,n){n=null==n?"equal":n;var r=new L;let o;r.name="filtered_"+this.name;let i=this.length;switch(n){case"equal":for(o=0;o<i;o++)this[o][t]==e&&r.push(this[o]);break;case"different":for(o=0;o<i;o++)this[o][t]!=e&&r.push(this[o]);break;case"greater":for(o=0;o<i;o++)this[o][t]>e&&r.push(this[o]);break;case"lower":for(o=0;o<i;o++)this[o][t]<e&&r.push(this[o])}return r.downcast()},L.prototype.getWithoutElementsAtIndexes=function(t){let e,n,r=this.length;for(n="L"==this.type?new L:instantiate(_typeOf(this)),t=nL.toL(t.slice(),!1),e=0;e<t.length;e++)t[e]<0&&(t[e]+=this.length);for(e=0;e<r;e++)t.includes(e)||n.push(this[e]);return"L"==this.type?n.downcast():(n.name=this.name,n)},L.prototype.getWithoutElementAtIndex=function(t){let e,n=this.length;t<0&&(t+=n),e="L"==this.type?new L:instanceSameType(this);for(var r=0;r<n;r++)r!=t&&e.push(this[r]);return e.name=this.name,"L"==this.type?e.downcast():e},L.prototype.getWithoutElement=function(t){if(null==t&&(t=null),null!=t&&!this.includes(t))return this;var e=new L;let n;e.name=this.name;let r=this.length;for(n=0;n<r;n++)this[n]!=t&&e.push(this[n]);return e.downcast()},L.prototype.getWithoutElements=function(t){let e,n,r=this.length;if(e="L"==this.type?new L:instanceSameType(this),this.isTable)for(n=0;n<r;n++)t.includes(this[n])||e.push(this[n]);else{var o=getBooleanDictionaryForList(t);for(n=0;n<r;n++)o[this[n]]||e.push(this[n])}return e.name=this.name,"L"==this.type?e.downcast():e},L.prototype.getFilteredByFunction=function(t,e){let n=instanceSameType(this),r=this.length;for(var o=0;o<r;o++)t(this[o],o,this)&&("ndL"==n.type?n.addNode(this[o]):n.push(this[o]));return n.name=e||this.name,"L"==this.type?n.downcast():n},L.prototype.insert=function(t,e,n){if(n=null==n||n,e=null==e?0:e,null!=t){if("string"==typeof e&&(e=this.getNames().indexOf(e)),-1==e)throw new Error("element with given name not found");var r;if(n)return(r=this.clone()).name=this.name,r[e]=t,r.downcast();(r=new L).name=this.name;for(var o=0;o<this.length+1;o++)r[o]=o<e?this[o]:o==e?t:this[o-1];return r.downcast()}},L.prototype.insertMany=function(t,e,n){if(null==t||null==e)return null;if(n=null==n||n,t.length!=e.length)throw new Error("indexes and elements need to be the same length");if("sL"==e.type&&(e=this.getNames().indexesOfElements(e)),null==e||e.length!=t.length)throw new Error("some elements with given names not found");let r;if(n){var o=Math.min(t.length,e.length);r=this.clone(),r.name=this.name;for(var i=0;i<o;i++)r[e[i]]=t[i];return r.downcast()}r=new L,r.name=this.name,t=t.getSortedByList(e),e=e.getSorted();for(i=0;i<t.length;i++)r[e[i]+i]=t[i];var s=0;for(i=0;i<this.length;i++){for(;null!=r[s];)s++;r[s]=this[i],s++}return r.downcast()},L.prototype.concat=function(){if(null==arguments[0])return this;if(arguments[0].type==this.type){if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nL"==this.type)return nL.toL(this._concat.apply(this,arguments),!1);if("sL"==this.type)return sL.toL(this._concat.apply(this,arguments),!1);if("dL"==this.type)return dL.toL(this._concat.apply(this,arguments),!1);if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nT"==this.type)return nT.toL(this._concat.apply(this,arguments),!1);if("ndL"==this.type){var t,e=this.clone(),n=arguments[0],r=n.length;for(t=0;t<r;t++)e.addNode(n[t]);return e}}return L.toL(this._concat.apply(this,arguments)).downcast()},L.prototype.toNumberList=function(t,e){if("nL"==this.type)return this;e=null==e?0:e;var n=new nL;let r,o=this.length,i=!1;if("dL"==this.type)for(""==n.name&&(n.name="decimal date"),r=0;r<o;r++)n[r]=getDecimalDate(this[r]);else for(r=0;r<o;r++)n[r]=0==e?parseFloat(this[r]):Number(this[r]),isNaN(n[r])&&(n[r]=t,null==t&&(i=!0));return i&&(n=L.toL(n)),n.name=this.name,n.downcast()},L.prototype.toStringList=function(){if("sL"==this.type)return this;var t=this.length;let e,n=new sL;for(n.name=this.name,e=0;e<t;e++)n[e]=String(this[e]);return n},L.prototype.toColorList=function(t,e){let n;if("cL"==this.type)return this;if("nL"==this.type){let t=this.getInterval();if(t.x<0&&t.y>0){let e=Math.max(t.x,t.y);n=new _.cL,this.forEach((t=>{let r=t?.5-.5*t/e:.5;n.push(_.interpolateColors(_.blueWhiteRed(r),"rgb(255,255,255)",.6))}))}else n=createColorListFromNumberList(this,e);return n.name="colors",n}if(t)return colorsForCategoricalList(this,null,!0);if("sL"==this.type){var r,o=new cL;o.name=this.name;for(var i=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,s=0;s<this.length&&null!=(r=colorStringToRGB(this[s]));s++)i.test(this[s])?o.push(this[s]):o.push("rgb("+r[0]+","+r[1]+","+r[2]+")");if(o.name="colors",null!=r)return o}return n=colorsForCategoricalList(this),n.name="colors",n},L.prototype.removeElements=function(t){let e,n={},r=this.length,o=t.length;for(e=0;e<o;e++)n[t[e]]=!0;for(e=0;e<r;e++)n[this[e]]&&(this.splice(e,1),e--)},L.prototype.removeElement=function(t){let e=this.indexOf(t);-1!=e&&this.splice(e,1)},L.prototype.pushIfUnique=function(t){let e=!this.includes(t);return e&&this.push(t),e},L.prototype.removeElementAtIndex=function(t){this.splice(t,1)},L.prototype.removeElementsAtIndexes=function(t){t=t.sort((function(t,e){return t-e}));for(var e=0;null!=t[e];e++)this.splice(t[e]-e,1)},L.prototype.setNames=function(t,e=!0,n){if(null==t)return this;var r,o;"string"==typeof t&&-1!=t.search(/\n|\r|\,/)&&(t=t.split(/\n|\r|\,/g)),"string"==typeof t&&(t=[t]);var i=null==n?createSortedNumberList(t.length):n;"sL"==i.type&&(i=this.getElementsByNames(i,!0,!0));let s=Math.min(i.length,t.length);var l=e?this:this.clone();for(r=0;r<s;r++){if(-1==(o=i[r])&&"sL"==n.type)throw new Error("No element found with name: "+n[r]);if(o<0||o>=this.length)throw new Error("Invalid index: "+o);l[o].name=t[r]}return l},L.prototype.setPropertyValues=function(t,e,n){if(null==t||null==e)return null;Array.isArray(e)||(e=[e]);var r=e.length;let o=this.length;for(var i=n?this:this.clone(),s=0;s<o;s++)i[s]=setPropertyValue(this[s],t,e[s%r],n);return i},L.prototype.splice=function(){switch(this.type){case"nL":return nL.toL(this._splice.apply(this,arguments));case"sL":return sL.toL(this._splice.apply(this,arguments));case"ndL":return ndL.toL(this._splice.apply(this,arguments));case"dL":return dL.toL(this._splice.apply(this,arguments))}return L.toL(this._splice.apply(this,arguments)).downcast()},iL.prototype.getInterval=function(){if(0===this.length)return null;var t=Math.max(this[0].x,this[0].y);let e,n=Math.min(this[0].x,this[0].y),r=this.length;for(e=1;e<r;e++)t=Math.max(t,this[e].x,this[e].y),n=Math.min(n,this[e].x,this[e].y);return new I(n,t)},iL.prototype.getAmplitudes=function(){if(0===this.length)return null;var t;let e=new nL;for(t=0;t<this.length;t++)e[t]=this[t].getAmplitude();return e},cL.prototype.getRgbArrays=function(){let t=new L,e=this.length;for(var n=0;n<e;n++)t[n]=colorStringToRGB(this[n]);return t},cL.prototype.getInterpolated=function(t,e){let n=new cL,r=this.length;for(var o=0;o<r;o++)n[o]=interpolateColors(this[o],t,e);return n.name=this.name,n},cL.prototype.getInverted=function(){let t=new cL,e=this.length;for(var n=0;n<e;n++)t[n]=invertColor(this[n]);return t.name=this.name,t},cL.prototype.addAlpha=function(t){let e=new cL,n=this.length;for(var r=0;r<n;r++)e[r]=addAlpha(this[r],t);return e.name=this.name,e},P3D.prototype.distanceToPoint3D=function(t){return Math.sqrt(Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2)+Math.pow(Math.abs(this.z-t.z),2))},P3D.prototype.distanceToPointSquared=function(t){return Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2)+Math.pow(Math.abs(this.z-t.z),2)},P3D.prototype.getNorm2=function(){return this.x*this.x+this.y*this.y+this.z*this.z},P3D.prototype.getNorm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},P3D.prototype.normalizeToValue=function(t){let e=t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2));return new P3D(this.x*e,this.y*e,this.z*e)},P3D.prototype.cross=function(t){return new P3D(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},P3D.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},P3D.prototype.angleToPoint=function(t){let e=this.getNorm(),n=t.getNorm();return Math.acos(this.dot(t)/(e*n))},P3D.prototype.add=function(t){return new P3D(t.x+this.x,t.y+this.y,t.z+this.z)},P3D.prototype.subtract=function(t){return new P3D(this.x-t.x,this.y-t.y,this.z-t.z)},P3D.prototype.factor=function(t){return new P3D(this.x*t,this.y*t,this.z*t)},P3D.prototype.interpolate=function(t,e){return new P3D((1-e)*this.x+e*t.x,(1-e)*this.y+e*t.y,(1-e)*this.z+e*t.z)},P3D.prototype.getAngles=function(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),e=.5*Math.PI-Math.atan2(this.z/t,this.y/t),n=-Math.asin(this.x/t);return e<-Math.PI&&(e+=2*Math.PI),e>Math.PI&&(e-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(e,n,0)},P3D.prototype.getInverseAngles=function(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),e=-.5*Math.PI+Math.atan2(-this.z/t,-this.y/t),n=Math.asin(-this.x/t);return e<-Math.PI&&(e+=2*Math.PI),e>Math.PI&&(e-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(e,n,0)},P3D.prototype.clone=function(){return new P3D(this.x,this.y,this.z)},P3D.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"},Pol3D.prototype.getBarycenter=function(){let t=0,e=0,n=0;for(var r=0;r<this.length;r++)t+=this[r].x,e+=this[r].y,n+=this[r].z;return new P3D(t/this.length,e/this.length,n/this.length)},Rec.prototype.getRight=function(){return this.x+this.width},Rec.prototype.getBottom=function(){return this.y+this.height},Rec.prototype.setRight=function(t){this.width=t-this.x},Rec.prototype.setBottom=function(t){this.height=t-this.y},Rec.prototype.getTopLeft=function(){return new P(this.x,this.y)},Rec.prototype.getTopRight=function(){return new P(this.x+this.width,this.y)},Rec.prototype.getBottomRight=function(){return new P(this.x+this.width,this.y+this.height)},Rec.prototype.getBottomLeft=function(){return new P(this.x,this.y+this.height)},Rec.prototype.getCenter=function(){return new P(this.x+.5*this.width,this.y+.5*this.height)},Rec.prototype.getRandomPoint=function(){return new P(this.x+Math.random()*this.width,this.y+Math.random()*this.height)},Rec.prototype.getIntersection=function(t){if(t.x+t.width<this.x||t.x>this.x+this.width||t.y+t.height<this.y||t.y>this.y+this.height)return null;let e=Math.max(t.x,this.x),n=Math.max(t.y,this.y);return new Rec(e,n,Math.min(t.x+t.width,this.x+this.width)-e,Math.min(t.y+t.height,this.y+this.height)-n)},Rec.prototype.interpolate=function(t,e){let n=1-e;return new Rec(n*this.x+e*t.x,n*this.y+e*t.y,n*this.width+e*t.width,n*this.height+e*t.height)},Rec.prototype.getRatio=function(){return Math.max(this.width,this.height)/Math.min(this.width,this.height)},Rec.prototype.getArea=function(){return this.width*this.height},Rec.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},Rec.prototype.pointIsOnBorder=function(t,e){if(e=null==e?1:e,t.x>=this.x-e&&t.x<=this.x+this.width+e){if(t.y>=this.y-e&&t.y<=this.y+e)return!0;if(t.y>=this.y+this.height-e&&t.y<=this.y+this.height+e)return!0;if(t.y>=this.y-e&&t.y<=this.y+this.height+e&&(t.x<this.x+e||t.x>this.x+this.width-e))return!0}return!1},Rec.prototype.getNormalRectangle=function(){return new Rec(Math.min(this.x,this.x+this.width),Math.min(this.y,this.y+this.height),Math.abs(this.width),Math.abs(this.height))},Rec.prototype.intersectsRectangle=function(t){return this.x+this.width>=t.x&&this.y+this.height>=t.y&&t.x+t.width>=this.x&&t.y+t.height>=this.y},Rec.prototype.containsRectangle=function(t){return t.getRight()<=this.getRight()&&t.x>=this.x&&t.getBottom()<=this.getBottom()&&t.y>=this.y},Rec.prototype.expand=function(t,e){return e=e||new P(this.x+.5*this.width,this.y+.5*this.height),new Rec((this.x-e.x)*t+e.x,(this.y-e.y)*t+e.y,this.width*t,this.height*t)},Rec.prototype.expandHorizontal=function(t,e){return e=e||this.x+.5*this.width,new Rec((this.x-e)*t+e,this.y,this.width*t,this.height)},Rec.prototype.expandVertical=function(t,e){return e=e||this.y+.5*this.height,new Rec(this.x,(this.y-e)*t+e,this.width,this.height*t)},Rec.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},Rec.prototype.clone=function(){return new Rec(this.x,this.y,this.width,this.height)},Rec.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"},T.prototype.applyFunction=function(t){let e,n=new T;for(n.name=this.name,e=0;null!=this[e];e++)n[e]=this[e].applyFunction(t);return n.downcast()},T.prototype.getListsDowncasted=function(){return T.toL(this.map((function(t){return t.downcast()})))},T.prototype.get=function(t,e,n,r){var o;let i;if(t&&Array.isArray(t))return this.getColumns(t);if("string"==typeof t){for(t=t.trim(),i=!1,o=0;o<this.length;o++)if(this[o].name==t){i=!0,t=o;break}if(!i)return null}else(t=null==t?0:t)<0&&(t+=this.length);var s=this[t];if(null==s){if("number"==typeof t){if(t>this.length)throw new Error("provided indexElementInColumn bigger than list in indexOrNameOfColumn");return null}if("string"!=typeof t)throw new Error("indexOrNameOfColumn should be a number or a string")}if(null==s)return null;if(r)return s.getWithoutRepetitions();if(null==e&&null==n)return s;var l=s.length;null==e&&(e=0),null==n&&(n=l-1),e<0&&(e+=s.length),n<0&&(n+=s.length),n=Math.min(n,l-1);var a=new L;for(a.name=s.name,o=e;o<=n;o++)a.push(s[o]);return a.downcast()},T.prototype.getColumns=function(t,e,n,r,o){if(null==t)return;var i;if("string"==_typeOf(t)&&t.includes(",")&&(t=t.split(",")),null!=t.length&&"string"!=_typeOf(t)||(t=[t]),o)return i=this.getWithoutColumns(t),null==e&&null==n||(i=i.sliceRows(e,n)),i.name=this.name,i.downcast();i=new T;let s,l,a=t.length;for(s=0;s<a;s++)l=this.get(t[s],e,n),null==l?r&&i.push(new L):i.push(l);return i.downcast()},T.prototype.getWithoutColumn=function(t){if(null==t)return;let e=this.get(t);return null==e?this:this.getWithoutElement(e)},T.prototype.getWithoutColumns=function(t){if(null==t)return;let e=this.getColumns(t);return null==e||0==e.length?this:this.getWithoutElements(e)},T.prototype.getRow=function(t){if((t=null==t?0:t)<0&&(t+=this.length>0?this[0].length:0),!Number.isInteger(Number(t)))return null;var e=new L;let n,r=this.length;for(n=0;n<r;n++)e[n]=this[n][t];return e.downcast()},T.prototype.getRows=function(t,e){if(null==t)return e?this:void 0;"I"==t.type&&(t.x<0&&this.length>0&&(t.x+=this[0].length),t.y<0&&this.length>0&&(t.y+=this[0].length),t=createSortedNumberList(Math.floor(t.y-t.x+1),t.x));let n,r,o,i,s=new T,l=this.length,a=t.length,u=!1;for(r=0;r<l;r++){for(n=instanceSameType(this[r]),o=0;o<a;o++)i=t[o],i<0&&(i+=this[0].length,u=!0),n[o]=this[r][i];"nL"!=n.type&&(n=n.downcast()),n.name=this[r].name,s[r]=n}return s.name=this.name,s.downcast()},T.prototype.getCell=function(t,e){return this.get(t).get(e)},T.prototype.getListLength=function(t){if(!((t=t||0)>=this.length))return this[t].length},T.prototype.getLengths=function(){let t=new nL,e=this.length;for(var n=0;n<e;n++)t[n]=null==this[n]?0:this[n].length;return t},T.prototype.sliceRows=function(t,e){if(null==t)return this;var n;t.x&&(e=t.y,t=t.x),t=null==t?0:t,e=null==e?this[0].length-1:e;let r,o=new T,i=this.length;for(o.name=this.name,n=0;n<i;n++)r=this[n].getSubList(t,e),r&&(r.name=this[n].name),o.push(r);return o.downcast()},T.prototype.getWithoutRow=function(t){let e=new T,n=this.length;if(e.name=this.name,t<0&&(t+=this.length>0?this[0].length:0),!Number.isInteger(Number(t)))return this;for(var r=0;r<n;r++)e[r]=L.toL(this[r].slice(0,t).concat(this[r].slice(t+1))).downcast(),e[r].name=this[r].name;return e.downcast()},T.prototype.getWithoutRows=function(t){let e,n=new T,r=this.length;n.name=this.name,t=nL.toL(t.slice(),!1);for(var o=0;o<t.length;o++)t[o]<0&&(t[o]+=this.length>0?this[0].length:0);let i=getBooleanDictionaryForList(t);for(o=0;o<r;o++){n[o]=instanceSameType(this[o]),e=this[o].length;for(var s=0;s<e;s++)null==i[s]&&n[o].push(this[o][s]);n[o].name=this[o].name}return n.downcast()},T.prototype.sortRowsByList=function(t,e,n){if(null==t)return;var r=t.isList?t.clone():this.get(t);if(null==r)return;e=null==e||e,n=null!=n&&n;var o=instanceSameType(this);let i=this.length;for(var s=[],l=0;l<r.length;l++)s[l]=[l,r[l]];var a=("nL"==r.type||"dL"==r.type)&&!n;let u;var h;for(u=e?a?function(t,e){return t[1]-e[1]}:n?function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:t[0]-e[0]}:function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}:a?function(t,e){return e[1]-t[1]}:n?function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:t[0]-e[0]}:function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:0},s=s.sort(u),o.name=this.name,l=0;l<i;l++){(h=instanceSameType(this[l])).name=this[l].name,o[l]=h;for(var c=0;c<r.length;c++)h[c]=this[l][s[c][0]]}return o},T.prototype.sortRowsByLists=function(t,e){if(null==t)return;if("number"==typeof t)(r=new nL).push(t),t=r;else if("string"==typeof t){(r=new sL).push(t),t=r}if("sL"==t.type){for(var n=this.getNames(),r=new nL,o=0;o<t.length;o++){if(-1==(h=n.indexOf(t[o])))throw new Error("No list with name "+t[o]);r.push(h)}t=r}null==e&&(e=!0),null==e.isList&&(e=createListWithSameElement(t.length,e));let i=new nL;for(o=0;o<e.length;o++)1==e[o]||"true"==e[o]||1==e[o]?i.push(1):i.push(-1);var s=instanceSameType(this);let l=this.length;var a=[];for(o=0;o<this[0].length;o++)a[o]={i:o,t:this,lists:t,polarity:i};var u;for(a=a.sort((function(t,e){for(var n,r,o,i=0;i<t.lists.length;i++){if(n=t.t[t.lists[i]][t.i],r=e.t[e.lists[i]][e.i],o=i<t.polarity.length?t.polarity[i]:1,n<r)return-1*o;if(n>r)return 1*o;if(i==t.lists.length-1)return t.i-e.i}return 0})),s.name=this.name,o=0;o<l;o++){(u=instanceSameType(this[o])).name=this[o].name,s[o]=u;for(var h=0;h<this[o].length;h++)u[h]=this[o][a[h].i]}return s},T.prototype.transpose=function(t,e){var n=t?this.getSubList(1):this;let r,o=n.length;var i=instantiate(_typeOf(n));if(0===n.length)return i;let s,l,a;for(s=0;s<o;s++)for(a=n[s],r=a.length,l=0;l<r;l++)0===s&&(i[l]="nT"==this.type?new nL:new L),i[l][s]=n[s][l];if(r=n[0].length,"nT"!=this.type)for(l=0;l<r;l++)i[l]=i[l].downcast();if(t)for(r=this[0].length,l=0;l<r;l++)i[l].name=String(this[0][l]);if(e){var u=new sL,h=t?1:0;for(o=this.length,s=h;s<o;s++)u.push(this[s].name);i._splice(0,0,u),i=i.downcast(),t&&(u.name=this[0].name)}return i},T.prototype.removeRow=function(t){for(var e=0;null!=this[e];e++)this[e].splice(t,1)},T.prototype.pushRow=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;let t=arguments;1==t.length&&t[0].length==this.length&&(t=t[0]);for(var e=0;e<t.length&&e<this.length;e++)this[e].push(t[e])},T.prototype.clone=function(){let t,e=this.length,n=instanceSameType(this);for(n.name=this.name,t=0;t<e;t++)n.push(this[t].clone());return void 0!==this.containsNulls&&(n.containsNulls=this.containsNulls),n},T.prototype.cloneWithEmptyLists=function(){let t,e,n=this.length,r=instanceSameType(this);for(r.name=this.name,t=0;t<n;t++)e=instanceSameType(this[t]),e.name=this[t].name,r.push(e);return r},T.prototype.appendRows=function(t){if(null==t)return this;let e,n;for(t==this&&(t=t.clone()),e=0;e<t.length;e++)for(e>=this.length&&(this[e]=instanceSameType(t[e]),this[e].name=t[e].name),n=0;n<t[e].length;n++)this[e].push(t[e][n]);return this},T.prototype.insertRow=function(t,e,n,r){if(null==t)return null;n=null!=n&&n;var o,i,s=(r=null!=r&&r)?this:this.clone();for(o=0;o<s.length&&o<t.length;o++)i="nL"!=s[o].type||isNaN(t[o])?t[o]:Number(t[o]),s[o]=s[o].insert(i,null==e?s[o].length:e,n);return s},T.prototype.trim=function(){return this.reduce(((t,e)=>(t.push("sL"==e.type?e.trim():e),t)),new T).downcast()},polL.prototype.getFrame=function(){if(0===this.length)return null;let t=this[0].getFrame(),e=new Rec(t.x,t.y,t.getRight(),t.getBottom());for(var n=1;null!=this[n];n++)t=this[n].getFrame(),e.x=Math.min(e.x,t.x),e.y=Math.min(e.y,t.y),e.width=Math.max(e.width,t.getRight()),e.height=Math.max(e.height,t.getBottom());return e.width-=e.x,e.height-=e.y,e},polL.prototype.getCenter=function(){let t=this.getFrame();return new P(t.x+.5*t.width,t.y+.5*t.height)},polL.prototype.getBarycenter=function(){let t;if(0===this.length)return null;let e=new P(this[0].x,this[0].y);for(t=1;null!=this[t];t++)e.x+=this[t].getBarycenter().x,e.y+=this[t].getBarycenter().y;return e.x/=this.length,e.y/=this.length,e},polL.prototype.add=function(t){let e;if("P"===_typeOf(t)){var n=new polL;for(e=0;null!=this[e];e++)n[e]=this[e].add(t);return n.name=this.name,n}},polL.prototype.factor=function(t){let e=new polL;for(var n=0;null!=this[n];n++)e[n]=this[n].factor(t);return e.name=this.name,e},polL.prototype.getRotated=function(t,e){let n=new polL;for(var r=0;null!=this[r];r++)n[r]=this[r].getRotated(t,e);return n.name=this.name,n},polL.prototype.clone=function(){let t=new polL;for(var e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},Pol.prototype.getFrame=function(){if(0===this.length)return null;let t,e=new Rec(this[0].x,this[0].y,this[0].x,this[0].y);for(var n=1;null!=this[n];n++)t=this[n],e.x=Math.min(e.x,t.x),e.y=Math.min(e.y,t.y),e.width=Math.max(e.width,t.x),e.height=Math.max(e.height,t.y);return e.width-=e.x,e.height-=e.y,e},Pol.prototype.getCenter=function(){let t=this.getFrame();return new P(t.x+.5*t.width,t.y+.5*t.height)},Pol.prototype.getBarycenter=function(t){let e;t=null==t||t;let n=1-Number(t);if(0===this.length)return null;let r=new P(this[0].x,this[0].y);for(e=1;null!=this[e+n];e++)r.x+=this[e].x,r.y+=this[e].y;return r.x/=this.length,r.y/=this.length,r},Pol.prototype.add=function(t){let e;if("P"===_typeOf(t)){var n=new Pol;for(e=0;null!=this[e];e++)n[e]=this[e].add(t);return n.name=this.name,n}},Pol.prototype.factor=function(t){let e,n=new Pol;if(n.name=this.name,t>=0||t<0){for(e=0;null!=this[e];e++)n[e]=new P(this[e].x*t,this[e].y*t);return n}if(null!=t.type&&"P"==t.type){for(e=0;null!=this[e];e++)n[e]=new P(this[e].x*t.x,this[e].y*t.y);return n}return null},Pol.prototype.getRotated=function(t,e){e=null==e?this.getCenter():e;for(var n=new Pol,r=0;null!=this[r];r++)n[r]=new P(Math.cos(t)*(this[r].x-e.x)-Math.sin(t)*(this[r].y-e.y)+e.x,Math.sin(t)*(this[r].x-e.x)+Math.cos(t)*(this[r].y-e.y)+e.y);return n.name=this.name,n},Pol.prototype.getClosestPoint=function(t){let e,n=this[0],r=Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2);for(var o=1;null!=this[o];o++)e=Math.pow(t.x-this[o].x,2)+Math.pow(t.y-this[o].y,2),e<r&&(r=e,n=this[o]);return n},Pol.prototype.toNumberList=function(){let t,e=new nL;for(t=0;null!=this[t];t++)e[2*t]=this[t].x,e[2*t+1]=this[t].y;return e},Pol.prototype.containsPoint=function(t){let e,n,r,o;for(o=!1,e=-1,r=this.length,n=r-1;++e<r;n=e)(this[e].y<=t.y&&t.y<this[n].y||this[n].y<=t.y&&t.y<this[e].y)&&t.x<(this[n].x-this[e].x)*(t.y-this[e].y)/(this[n].y-this[e].y)+this[e].x&&(o=!o);return o},Pol.prototype.touchesPolygon=function(t){let e=this.getFrame(),n=t.getFrame();if(e.x>n.x+n.width||e.x+e.width<n.x||e.y>n.y+n.height||e.y+e.height<n.y)return!1;for(var r=0;r<this.length;r++)if(t.containsPoint(this[r]))return!0;return!1},Pol.prototype.approach=function(t,e){let n=1-(e=e||.5);this.forEach((function(r,o){r.x=n*r.x+e*t[o].x,r.y=n*r.y+e*t[o].y}))},Pol.prototype.clone=function(){let t=new Pol;for(var e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},Nd.prototype.cleanRelations=function(){this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelations=new relL,this.from=new ndL,this.fromRelations=new relL},Nd.prototype.getDegree=function(){return this.relations.length},Nd.prototype.getParent=function(){return this.parent},Nd.prototype.getLeaves=function(){var t=new ndL,e=function(n){0!==n.to.length?n.to.forEach(e):t.addNode(n)};return e(this),t},Nd.prototype.loadImage=function(t){Loader.loadImage(t,(function(t){this.image=t.result}),this)},Nd.prototype.clone=function(t){let e=new Nd(this.id,this.name);return e.x=this.x,e.y=this.y,e.z=this.z,e.nodeType=this.nodeType,e.weight=this.weight,e.descentWeight=this.descentWeight,t?.forEach((t=>{e[t]=this[t]})),e},sL.prototype.getLengths=function(){let t=new nL;return this.forEach((function(e){t.push(null==e?0:e.length)})),t},sL.prototype.countTags=function(t=","){let e=new nL;return this.forEach((function(n){n.includes(t)?e.push(n.split(t).length):e.push(0)})),e},sL.prototype.includesSubString=function(t){for(var e=0;e<this.length;e++)if(this[e].includes(t))return!0;return!1},sL.prototype.indexesOfSubString=function(t){for(var e=new nL,n=0;n<this.length;n++)this[n].includes(t)&&e.push(n);return e},sL.prototype.append=function(t,e){e=null==e||e;let n=new sL;n.name=this.name;let r,o="sL"==_typeOf(t);if(e)for(r=0;null!=this[r];r++)n[r]=this[r]+(o?t[r]:t);else for(r=0;null!=this[r];r++)n[r]=(o?t[r]:t)+this[r];return n},sL.prototype.getSurrounded=function(t,e){e=null==e?"":e;let n,r=new sL;r.name=this.name;var o=Array.isArray(t);let i=Array.isArray(e);for(n=0;null!=this[n];n++)r[n]=(o?t[n]:t)+this[n]+(i?e[n]:e);return r},sL.prototype.replace=function(t,e){if(null==t)return this;var n=new sL;let r,o=this.length;for(n.name=this.name,r=0;r<o;r++)n[r]=this[r].replace(t,e);return n},sL.prototype.add=function(t){let e;return"string"==typeof t&&(e=this.map((e=>e+t)).tosL()),Array.isArray(t)&&(e=this.map(((e,n)=>e+t[n%t.length])).tosL()),e.name=this.name,e},sL.prototype.getConcatenated=function(t){let e;t=null==t?" ":t;let n="",r=this.length;for(e=0;e<r;e++)n+=this[e],e<this.length-1&&(n+=t);return n},sL.prototype.toLowerCase=function(){let t,e=new sL;e.name=this.name;let n=this.length;for(t=0;t<n;t++)e[t]=this[t].toLowerCase();return e},sL.prototype.toUpperCase=function(){let t,e=new sL;e.name=this.name;let n=this.length;for(t=0;t<n;t++)e[t]=this[t].toUpperCase();return e},sL.prototype.trim=function(t){if(this.isTable)return this.trim();if("sL"!=this.type)return null;let e,n=this.length,r=new sL;for(e=0;e<n;e++)r[e]=t?this[e].substring(0,t).trim():this[e].trim();return r.name=this.name,r},sL.prototype.clone=function(){let t=sL.toL(this.slice(),!1);return t.name=this.name,t.fnDerived=this.fnDerived,t},ndL.prototype.removeNodes=function(){let t,e=this.length;for(t=0;t<e;t++)this.ids[this[t].id]=null,this.removeElement(this[t])},ndL.prototype.addNode=function(t){this.ids[t.id]=t,this._push(t)},ndL.prototype.addNodes=function(t){let e;for(e=0;null!=t[e];e++)this.addNode(t[e])},ndL.prototype.removeNode=function(t){this.ids[t.id]=null,this.removeElement(t)},ndL.prototype.removeNodeAtIndex=function(t){this.ids[this[t].id]=null,this.splice(t,1)},ndL.prototype.normalizeWeights=function(){let t,e=-9999999,n=this.length;for(t=0;t<n;t++)e=Math.max(this[t].weight,e);for(t=0;t<n;t++)this[t].weight/=e},ndL.prototype.getByName=function(t){let e,n=this.length;for(e=0;e<n;e++)if(this[e].name==t)return this[e];return null},ndL.prototype.get=function(t){return this.ids[t]},ndL.prototype.getNodesByIds=function(t){let e,n=new ndL,r=t.length;for(var o=0;o<r;o++)e=this.ids[t[o]],null!=e&&n.addNode(e);return n},ndL.prototype.getWeights=function(){let t,e=new nL;for(t=0;null!=this[t];t++)e[t]=this[t].weight;return e},ndL.prototype.getIds=function(){let t=new sL,e=this.length;for(var n=0;n<e;n++)t[n]=this[n].id;return t},ndL.prototype.getDegrees=function(){let t=new nL;for(var e=0;null!=this[e];e++)t[e]=this[e].nodes.length;return t},ndL.prototype.getPolygon=function(t){let e=new Pol;for(var n=0;null!=this[n];n++)e[n]=new P(this[n].x+t.cX,this[n].y+t.cY);return e},ndL.prototype.clone=function(){let t,e=new ndL,n=this.length;for(t=0;t<n;t++)e.addNode(this[t]);return e.name=this.name,e},ndL.prototype.getWithoutRepetitions=function(){let t,e=new ndL;for(e.name=this.name,t=0;null!=this[t];t++)null==e.get(this[t].id)&&e.addNode(this[t]);return e},ndL.prototype.removeElements=function(t){let e;for(e=0;null!=this[e];e++)null!=t.get(this[e].id)&&(this.ids[this[e].id]=null,this.splice(e,1),e--)},relL.prototype.addRelation=function(t){this.addNode(t)},relL.prototype.removeRelation=function(t){this.removeNode(t)},relL.prototype.getRelationsWithNode=function(t){let e,n=[];for(e=0;null!=this[e];e++){var r=this[e];r.node0!=t&&r.node1!=t||n.push(r)}return n},relL.prototype.getRelatedNodesToNode=function(t){let e,n=new ndL;for(e=0;e<this.length;e++){var r=this[e];r.node0.id==t.id&&n.push(r.node1),r.node1.id==t.id&&n.push(r.node0)}return n},relL.prototype.getChildrenOfNode=function(t){let e,n=new ndL;for(e=0;e<this.length;e++){var r=this[e];r.node0.id==t.id&&n.addNode(r.node1)}return n},relL.prototype.getAllRelationsBetweenNodes=function(t,e,n){let r;n=null!=n&&n;let o=[];for(r=0;null!=this[r];r++){var i=this[r];(i.node0==t&&i.node1==e||!n&&i.node0==e&&i.node1==t)&&o.push(i)}return o},relL.prototype.nodesAreConnected=function(t,e,n){return null!=t.to.get(e.id)||!n&&null!=e.to.get(t.id)},relL.prototype.getFirstRelationBetweenNodes=function(t,e,n){n=null!=n&&n;for(var r=0;null!=this[r];r++)if(this[r].node0.id==t.id&&this[r].node1.id==e.id||!n&&this[r].node1.id==t.id&&this[r].node0.id==e.id)return this[r];return null},relL.prototype.getFirstRelationByIds=function(t,e,n){let r,o,i=n||!1;for(r=0;null!=this[r];r++)if(o=this[r],o.node0.id==t&&o.node1.id==e)return o;if(i)return null;for(r=0;null!=this[r];r++)if(o=this[r],o.node0.id==e&&o.node1.id==t)return o;return null},recL.prototype.getFrame=function(){if(0===this.length)return null;var t=this[0].clone();t.width=t.getRight(),t.height=t.getBottom();for(var e=1;null!=this[e];e++)t.x=Math.min(t.x,this[e].x),t.y=Math.min(t.y,this[e].y),t.width=Math.max(this[e].getRight(),t.width),t.height=Math.max(this[e].getBottom(),t.height);return t.width-=t.x,t.height-=t.y,t},recL.prototype.clone=function(){let t=new recL;for(var e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},recL.prototype.add=function(){},recL.prototype.factor=function(){},recL.prototype.getIntersectionArea=function(){let t,e,n,r=0;for(var o=0;null!=this[o+1];o++){t=this[o];for(var i=o+1;null!=this[i];i++)e=this[i],n=t.getIntersection(e),r+=null==n?0:n.getArea()}return r},recL.prototype.intersectsRectangle=function(t){if(null==t)return!1;for(var e=0;e<this.length;e++)if(this[e].intersectsRectangle(t))return!0;return!1},Rel.prototype.getOther=function(t){return t==this.node0?this.node1:this.node0},Rel.prototype.clone=function(t,e){var n;return(n=e?new Rel(this.id,this.name,e.nodes.get(this.node0.id),e.nodes.get(this.node1.id)):new Rel(this.id,this.name,this.node0,this.node1)).x=this.x,n.y=this.y,n.z=this.z,n.nodeType=this.nodeType,n.weight=this.weight,n.descentWeight=this.descentWeight,t?.forEach((t=>{n[t]=this[t]})),n},Net.prototype.getNodes=function(){return this.nodes},Net.prototype.getRelations=function(){return this.relations},Net.prototype.getNodesIds=function(){return this.nodes.getIds()},Net.prototype.addNode=function(t){this.nodes.addNode(t)},Net.prototype.getByName=function(t){return this.nodes.getByName(t)},Net.prototype.get=function(t){return this.nodes.get(t)},Net.prototype.createRelation=function(t,e,n,r,o,i){null==t.type&&(t=this.createNode(t)),null==e.type&&(e=this.createNode(e)),null==n&&(n=t.id+"_"+e.id);var s=this.relations.get(n);return s||(null==i&&(i=t.name+"_"+e.name),s=new Rel(n,i,t,e,r,o),this.addRelation(s),s)},Net.prototype.addRelation=function(t){this.relations.addNode(t),t.node0.nodes.addNode(t.node1),t.node0.relations.addNode(t),t.node0.to.addNode(t.node1),t.node0.toRelations.addNode(t),t.node1.nodes.addNode(t.node0),t.node1.relations.addNode(t),t.node1.from.addNode(t.node0),t.node1.fromRelations.addNode(t)},Net.prototype.connect=function(t,e,n,r,o){let i=new Rel(n=n||t.id+"_"+e.id,n,t,e,r=r||1);return this.addRelation(i),i.content=o,i},Net.prototype.removeNode=function(t){this.removeNodeRelations(t),this.nodes.removeNode(t)},Net.prototype.removeNodeRelations=function(t){for(var e=0;null!=t.relations[e];e++)this.removeRelation(t.relations[e]),e--},Net.prototype.removeNodes=function(){this.nodes.deleteNodes(),this.relations.deleteNodes()},Net.prototype.removeRelation=function(t){this.relations.removeElement(t),t.node0.nodes.removeNode(t.node1),t.node0.relations.removeRelation(t),t.node0.to.removeNode(t.node1),t.node0.toRelations.removeRelation(t),t.node1.nodes.removeNode(t.node0),t.node1.relations.removeRelation(t),t.node1.from.removeNode(t.node0),t.node1.fromRelations.removeRelation(t)},Net.prototype.removeIsolatedNodes=function(t=1){let e,n=0;for(e=0;null!=this.nodes[e];e++)this.nodes[e].getDegree()<t&&(this.nodes[e]._toRemove=!0);for(e=0;null!=this.nodes[e];e++)this.nodes[e]._toRemove&&(this.removeNode(this.nodes[e]),n++,e--);return n},Net.prototype.lightClone=function(){let t=new Net;return t.nodes=this.nodes,t.relations=this.relations,t},Net.prototype.clone=function(t,e,n,r){let o,i,s=new Net;return null==t&&(t=[]),null==e&&(e=[]),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(e){o=new Nd(n+e.id,r+e.name),""!==n&&(o.basicId=e.id),""!==r&&(o.basicName=e.name),t&&(t.forEach((function(t){null!=e[t]&&(o[t]=e[t])})),o.weight=e.weight,o.color=e.color,o.kind=e.kind),s.addNode(o)})),this.relations.forEach((function(t){i=new Rel(n+t.id,r+t.name,s.nodes.get(n+t.node0.id),s.nodes.get(n+t.node1.id),t.weight),""!==n&&(i.basicId=t.id),""!==r&&(i.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(i[e]=t[e])})),s.addRelation(i)})),s},Tr.prototype.addNodeToTree=function(t,e){if(this.addNode(t),null==e)t.level=0,t.parent=null;else{var n=new Rel(e.id+"_"+t.id,e.id+"_"+t.id,e,t);this.addRelation(n),t.level=e.level+1,t.parent=e,e.weight++}t.weight=1,this.nLevels=Math.max(this.nLevels,t.level+1)},Net.prototype._newCreateRelation=function(t,e,n,r){null==n&&(n=this.relations.getNewId()),this._createRelation(t,e,n,r),e.level=t.level+1,e.parent=t,this.nLevels=Math.max(this.nLevels,e.level+1)},Tr.prototype.addFather=function(t,e){if(null!=e.parent||-1==this.nodes.indexOf(e))return!1;this.addNode(t),e.parent=t,e.level=1,this.nLevels=Math.max(this.nLevels,1),this.createRelation(t,e)},Tr.prototype.getLevel=function(t){t=0===t?0:t;var e=new ndL;e.name="level_"+t;let n,r=this.nodes.length;for(n=0;n<r;n++)this.nodes[n].level==t&&e.addNode(this.nodes[n]);return e},Tr.prototype.getLeaves=function(t){let e,n,r=new ndL;if(r.name="leaves",t){if(0===t.to.length)return r.addNode(t),r;var o=function(t){if(0===t.to.length)r.addNode(t);else for(n=t.to.length,e=0;e<n;e++)o(t.to[e])};for(n=t.to.length,e=0;e<n;e++)o(t.to[e])}else for(n=this.nodes.length,e=0;e<n;e++)0===this.nodes[e].to.length&&r.addNode(this.nodes[e]);return r},Tr.prototype.assignDescentWeightsToNodes=function(){this._assignDescentWeightsToNode(this.nodes[0])},Tr.prototype._assignDescentWeightsToNode=function(t){let e;if(0===t.to.length)return t.descentWeight=t.weight,t.descentWeight;for(t.descentWeight=0,e=0;null!=t.to[e];e++)t.descentWeight+=this._assignDescentWeightsToNode(t.to[e]);return t.weight=t.descentWeight,t.descentWeight},Tr.prototype.getReport=function(){return"Tr contains "+this.nodes.length+" nodes and "+this.relations.length+" relations"},Tr.prototype.traverse=function(t,e,n){if(null==this||"Tr"!=this.type)return;if(null==t&&null==(t=this.getLevel(0)[0]))return;e=null==e?0:e;var r=[t];let o,i,s,l,a=0,u=new ndL;for(;r.length>0;)if(i=0==e?r.pop():r.shift(),l=!0,n&&(l=n(i,a++,this)),u.addNode(i),l&&(s=this.relations.getChildrenOfNode(i),0!=s.length))if(0==e)for(o=s.length-1;o>=0;o--)r.push(s[o]);else for(o=0;o<s.length;o++)r.push(s[o]);return u},Tr.prototype.getAncestorsOf=function(t){if(null!=this&&"Tr"==this.type){var e,n,r;if("Nd"==t.type)(r=new ndL).addNode(t);else{if("ndL"!=t.type)return;r=t}var o=new ndL;for(n=0;n<r.length;n++)for(e=r[n];null!=e.parent;)o.addNode(e.parent),e=e.parent;return o=o.getWithoutRepetitions()}},Tr.prototype.buildFilteredTree=function(t){if(null==this||"Tr"!=this.type)return;if("ndL"!=t.type)throw new Error("Invalid input type for buildFilteredTree");var e=this.clone();let n,r,o=this.getAncestorsOf(t),i=new ndL;for(r=0;r<e.nodes.length;r++)n=e.nodes[r],null==o.get(n.id)&&null==t.get(n.id)&&i.addNode(n);for(r=0;r<i.length;r++)e.removeNode(i[r]);return e},Tr.prototype.clone=function(t,e,n,r){let o,i,s=new Tr;return s.nLevels=this.nLevels,null==t&&(t=[]),null==e&&(e=[]),t.push("parent"),t.push("level"),t.push("bOpen"),t.push("color"),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(e){o=new Nd(n+e.id,r+e.name),""!==n&&(o.basicId=e.id),""!==r&&(o.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(o[t]=e[t])})),s.addNode(o)})),this.relations.forEach((function(t){i=new Rel(n+t.id,r+t.name,s.nodes.get(n+t.node0.id),s.nodes.get(n+t.node1.id),t.weight),""!==n&&(i.basicId=t.id),""!==r&&(i.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(i[e]=t[e])})),s.addRelation(i)})),s},dI.prototype.toString=function(){return"DateInterval["+this.date0+", "+this.date1+"]"},dI.prototype.getMax=function(){return this.date1>this.date0?this.date1:this.date0},dI.prototype.getMin=function(){return this.date0<this.date1?this.date0:this.date1},dI.prototype.getTimesInterval=function(){return new I(this.date0.getTime(),this.date1.getTime())},dI.prototype.getProduct=function(t){if(null!=t){if("I"==t.type){var e=this.date0.getTime(),n=this.date1.getTime()-e;return new dI(new Date(e+t.x*n),new Date(e+t.y*n))}return null}},nT.prototype.getMax=function(){if(0===this.length)return null;var t=this[0].getMax();let e;for(e=1;null!=this[e];e++)t=Math.max(this[e].getMax(),t);return t},nT.prototype.getMaxValues=function(){if(0===this.length)return null;var t=new nL;let e;for(e=0;null!=this[e];e++)t[e]=this[e].getMax();return t},nT.prototype.getMaxCell=function(){if(0===this.length)return null;var t=createListWithSameElement(2,0);let e,n,r;for(r=this[0][0],e=0;e<this.length;e++)for(n=0;n<this[e].length;n++)this[e][n]>r&&(r=this[e][n],t[0]=e,t[1]=n);return t},nT.prototype.getMin=function(){if(0===this.length)return null;var t=this[0].getMin();let e;for(e=1;null!=this[e];e++)t=Math.min(this[e].getMin(),t);return t},nT.prototype.getMinValues=function(){if(0===this.length)return null;var t=new nL;let e;for(e=0;null!=this[e];e++)t[e]=this[e].getMin();return t},nT.prototype.getMinCell=function(){if(0===this.length)return null;var t=createListWithSameElement(2,0);let e,n,r;for(r=this[0][0],e=0;e<this.length;e++)for(n=0;n<this[e].length;n++)this[e][n]<r&&(r=this[e][n],t[0]=e,t[1]=n);return t},nT.prototype.getInterval=function(t){if(0===this.length)return null;let e=this[0].getInterval(t),n=this.length;for(var r=1;r<n;r++){var o=this[r].getInterval(t);e.x=Math.min(e.x,o.x),e.y=Math.max(e.y,o.y)}return e},nT.prototype.getFrame=function(){if(this.length<2)return;let t=this[0].getInterval(),e=this[1].getInterval();return new Rec(t.x,e.x,t.getAmplitude(),e.getAmplitude())},nT.prototype.getSums=function(t=1){let e=new nL,n=this.length;for(var r=0;r<n;r++)e[r]=this[r].getSum()*t;return e},nT.prototype.getRowsSums=function(){let t,e=this[0].clone();for(var n=1;null!=this[n];n++){t=this[n];for(var r=0;null!=t[r];r++)e[r]+=t[r]}return e},nT.prototype.getAverages=function(){let t=new nL;for(var e=0;null!=this[e];e++)t[e]=this[e].getMean();return t},nT.prototype.getRowsAverages=function(){let t,e,n,r,o=this.length,i=this[0].clone().factor(1/o);for(e=1;e<o;e++)for(t=this[e],r=t.length,n=0;n<r;n++)i[n]+=t[n]/o;return i},nT.prototype.getIntervals=function(){let t,e,n=this.length,r=new L;for(e=0;e<n;e++)t=this[e],r.push(t.getInterval());return r},nT.prototype.factor=function(t){let e,n,r=new nT,o=this.length;switch(_typeOf(t)){case"number":for(e=0;e<o;e++)n=this[e],r[e]=n.factor(t);break;case"nL":for(e=0;e<o;e++)n=this[e],r[e]=n.factor(t[e])}return r.name=this.name,r},nT.prototype.add=function(t){let e,n,r=new nT,o=this.length;for(n=0;n<o;n++)e=this[n],r[n]=e.add(t);return r.name=this.name,r},dL.prototype.getTimes=function(){let t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getTime());return e},dL.prototype.getYears=function(){let t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getYear());return e},dL.prototype.getFullYears=function(){let t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getFullYear());return e},dL.prototype.getMin=function(){if(0===this.length)return null;let t,e=this[0];for(t=1;null!=this[t];t++)e=e<this[t]?e:this[t];return e},dL.prototype.getMax=function(){if(0===this.length)return null;let t,e=this[0];for(t=1;null!=this[t];t++)e=e>this[t]?e:this[t];return e},dL.prototype.getInterval=function(){if(0===this.length)return null;var t=this[0],e=this[0];for(let n=1;n<this.length;n++)t=Math.min(this[n],t),e=Math.max(this[n],e);return new dI(t,e)},nL.prototype.getMin=function(){if(0===this.length)return null;let t,e=this[0];for(t=1;t<this.length;t++)e=Math.min(e,this[t]);return e},nL.prototype.getMax=function(){if(0===this.length)return null;let t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.max(e,this[t]);return e},nL.prototype.getIndexOfMin=function(){if(0===this.length)return null;let t,e=this[0],n=0;for(t=1;t<this.length;t++)this[t]<e&&(e=this[t],n=t);return n},nL.prototype.getIndexOfMax=function(){if(0===this.length)return null;let t,e=this[0],n=0;for(t=1;t<this.length;t++)this[t]>e&&(e=this[t],n=t);return n},nL.prototype.getAmplitude=function(){if(0===this.length)return 0;let t=this[0],e=this[0],n=this.length;for(var r=1;r<n;r++)t=Math.min(t,this[r]),e=Math.max(e,this[r]);return e-t},nL.prototype.getSum=function(){if(0===this.length)return 0;let t,e=this[0],n=this.length;for(t=1;t<n;t++)e+=this[t];return e},nL.prototype.getProduct=function(){if(0===this.length)return null;let t,e=this[0],n=this.length;for(t=1;t<n;t++)e*=this[t];return e},nL.prototype.getInterval=function(t){if(0===this.length)return null;t=null!=t&&t;let e,n=-1/0,r=1/0,o=this.length;for(e=0;e<o;e++)t&&isNaN(this[e])||(n=Math.max(n,this[e]),r=Math.min(r,this[e]));return n==-1/0&&r==1/0&&(r=-1/0,n=1/0),new I(r,n)},nL.prototype.getIntervalWithAverage=function(){if(0===this.length)return null;let t,e=this[0],n=this[0],r=this[0],o=this.length;for(t=1;t<o;t++)e=Math.max(e,this[t]),n=Math.min(n,this[t]),r+=this[t];let i=new I(n,e);return i.average=r/o,i},nL.prototype.getNumbersSimplified=function(t,e){let n,r,o,i=this.length;switch(t=t||0,e=e||0,n=new nL,n.name=this.name,t){case 0:var s=Math.pow(10,e);this.forEach((function(t){n.push(Math.floor(t/s)*s)}));break;case 6:n=this.getQuantiles(e,2),n.name=this.name;break;case 1:case 2:e=Math.min(e||10,Math.floor(this.length/2));var l,a=this.getQuantiles(e),u=a.length;for(r=0;r<i;r++)if((l=this[r])<a[0])1==t?n.push(0):n.push(a._min);else for(o=0;o<u;o++)if(l>=a[o]&&(o+1==a.length||l<a[o+1])){1==t?n.push(o+1):n.push(a[o]);break}1==t&&(n.name=this.name+" (n quantile)");break;case 3:for(n.name=this.name+" (order of magnitude)",r=0;r<i;r++)n.push(Math.floor(Math.log(this[r])/Math.log(10)));break;case 4:for(n.name=this.name+" (rounded by order of magnitude)",r=0;r<i;r++)n.push(Math.pow(10,Math.floor(Math.log(this[r])/Math.log(10))));break;case 5:for(e=e||1,n.name=this.name+" (significant digits)",r=0;r<i;r++)n.push(Number(this[r].toPrecision(e)))}return n},nL.prototype.toPolygon=nL.prototype.getMean=function(){return this.getSum()/this.length},nL.prototype.getGeometricMean=function(){if(0==this.length)return 0;let t=this[0];for(var e=1;e<this.length;e++)t*=this[e];return Math.pow(t,1/this.length)},nL.prototype.getNorm=function(){let t=0,e=this.length;for(var n=0;n<e;n++)t+=Math.pow(this[n],2);return Math.sqrt(t)},nL.prototype.getVariance=function(t){let e=0,n=t||this.getMean(),r=this.length;for(var o=0;o<r;o++)e+=Math.pow(this[o]-n,2);return e/this.length},nL.prototype.getStandardDeviation=function(t){return Math.sqrt(this.getVariance(t))},nL.prototype.getMedian=function(){let t=this.getSorted(!0),e=(this.length-1)/2,n=Math.floor(e);return e==n?t[e]:.5*t[n]+.5*t[n+1]},nL.prototype.getQuantiles=function(t=4,e=0){var n=this.length;let r,o=this.getSorted(!0),i=n/t,s=Math.floor(i),l=i==s,a=new nL;for(a.name=this.name,r=0;r<t-1;r++)a[r]=l?o[(r+1)*i]:.5*o[(r+1)*s]+.5*o[(r+1)*s+1];if(a._sorted=o,a._min=o[0],a._max=o[o.length-1],0===e)return a;var u;let h,c;for((u=1==e?new nL:new sL).name=this.name,3==e&&(c=2==t?["low","high"]:["low","medium","high"]),r=0;r<n;r++){for(h=0;h<a.length;h++)if(this[r]<a[h]){u[r]=3==e?c[h]:1==e?h:(0==h?a._min:a[h-1])+"-"+a[h];break}null==u[r]&&(u[r]=3==e?c[h]:1==e?a.length:a[a.length-1]+"-"+a._max)}return u._quantiles=a,u},nL.prototype.getSorted=function(t){var e;return(e=(t=null==t||t)?nL.toL(this.slice().sort((function(t,e){return t-e})),!1):nL.toL(this.slice().sort((function(t,e){return e-t})),!1)).name=this.name,e},nL.prototype.getSortIndexes=function(t){null==t&&(t=!0);var e=[];let n=new nL,r=this.length;if(0===this.length)return n;for(var o=0;o<r;o++)e.push([o,this[o]]);for(t?e.sort((function(t,e){return t[1]<e[1]?1:-1})):e.sort((function(t,e){return t[1]<e[1]?-1:1})),o=0;null!=e[o];o++)n.push(e[o][0]);return n.name=this.name,n},nL.prototype.cleanNonFinites=function(t){if(null==t&&(t=this.getInterval()),!isFinite(t.x)||!isFinite(t.y)){var e,n,r=new nL,o=new nL,s=new nL,l=new nL;l.name=this.name;for(let t=0;t<this.length;t++)isFinite(this[t])?(null==e&&(e=this[t]),null==n&&(n=this[t]),e=Math.min(e,this[t]),n=Math.max(n,this[t]),l[t]=this[t]):this[t]==1/0?o.push(t):this[t]==-1/0?r.push(t):s.push(t);for(null==e&&(e=0),null==n&&(n=0),e--,n++,i=0;i<r.length;i++)l[r[i]]=e;for(i=0;i<o.length;i++)l[o[i]]=n;for(i=0;i<s.length;i++)l[s[i]]=0;return l}return this},nL.prototype.getNormalized=function(t){if(null==this)return;if(t=null==t?1:t,0===this.length)return new nL;let e,n=this.getInterval();var r=this.cleanNonFinites(n);if(this!=r)return r.getNormalized(t);var o=n.getAmplitude();let i;if(0===o)return i=createListWithSameElement(this.length,1),i.name=this.name,i.interval=n,i;for(i=new nL,t/=o,e=0;e<this.length;e++)i[e]=t*(this[e]-n.x);return i.name=this.name,i.interval=n,i},nL.prototype.getNormalizedToSum=function(t,e){return normalizeToSum(this,t,e)},nL.prototype.getNormalizedToMax=function(t){if(null==this)return;if(t=null==t?1:t,0===this.length)return null;let e,n=this.getMax();var r=this.cleanNonFinites();if(this!=r)return r.getNormalizedToMax(t);var o=new nL;for(e=0;e<this.length;e++)o[e]=t*this[e]/n;return o.name=this.name,o},nL.prototype.factor=function(t){let e,n=new nL,r=this.length;if(Array.isArray(t))for(e=0;e<r;e++)n.push(this[e]*t[e%this.length]);else for(e=0;e<r;e++)n.push(this[e]*t);return n.name=this.name,n},nL.prototype.add=function(t){let e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]+t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]+t[e%t.length]}return n.name=this.name,n},nL.prototype.subtract=function(t){let e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]-t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]-t[e%t.length]}return n.name=this.name,n},nL.prototype.divide=function(t){let e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]/t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]/t[e%t.length]}return n.name=this.name,n},nL.prototype.sqrt=function(){let t,e=new nL,n=this.length;for(t=0;t<n;t++)e.push(Math.sqrt(this[t]));return e.name=this.name,e},nL.prototype.pow=function(t){let e,n=new nL,r=this.length;for(e=0;e<r;e++)n.push(Math.pow(this[e],t));return n.name=this.name,n},nL.prototype.log=function(t){var e;t=t||0;let n=new nL,r=this.length;for(e=0;e<r;e++)n[e]=Math.log(this[e]+t);return n.name=this.name,n},nL.prototype.floor=function(){let t,e=new nL,n=this.length;for(t=0;t<n;t++)e.push(Math.floor(this[t]));return e.name=this.name,e},nL.prototype.approach=function(t,e){var n;let r=1-(e=e||.5),o=this.length;for(n=0;n<o;n++)this[n]=r*this[n]+e*t[n];return!0},nL.prototype.isEqual=function(t){let e=this.length;if(null==t||t.length!=e)return!1;for(var n=0;n<e;n++)if(this[n]!=t[n])return!1;return!0},nL.prototype.addRandom=function(t){let e;null==t&&(t=new I(0,1));let n=new nL,r=this.length,o=t.getAmplitude();for(e=0;e<r;e++)n[e]=this[e]+Math.random()*o+t.x;return n.name=this.name,n},nL.prototype.trim=function(t,e){if(null==t&&null==e)return this;let n=new nL;for(var r=0;r<this.length;r++)null!=t&&(n[r]=Math.max(this[r],t)),null!=e&&(n[r]=Math.min(this[r],e));return n.name=this.name,n},nL.prototype.clone=function(){let t=nL.toL(this.slice(),!1);return t.name=this.name,t.fnDerived=this.fnDerived,t},I.prototype.getMin=function(){return Math.min(this.x,this.y)},I.prototype.getMax=function(){return Math.max(this.x,this.y)},I.prototype.getAmplitude=function(){return Math.abs(this.y-this.x)},I.prototype.getSignedAmplitude=function(){return this.y-this.x},I.prototype.getMiddle=function(){return.5*(this.x+this.y)},I.prototype.getRandom=function(){return this.x+(this.y-this.x)*random()},I.prototype.getSign=function(){return this.x==this.y?0:Math.abs(this.y-this.x)/(this.y-this.x)},I.prototype.getScaled=function(t){let e=.5*(this.y-this.x),n=.5*(this.x+this.y);return new I(n-e*t,n+e*t)},I.prototype.getScaledFromProportion=function(t,e){let n=1-e,r=e*(this.y-this.x),o=n*(this.y-this.x),i=n*this.x+e*this.y;return new I(i-r*t,i+o*t)},I.prototype.add=function(t){return new I(this.x+t,this.y+t)},I.prototype.invert=function(){let t=this.x;this.x=this.y,this.y=t},I.prototype.adjustToContain=function(t){t<this.x&&(this.x=t),t>this.y&&(this.y=t)},I.prototype.getInterpolatedValue=function(t){return t*(this.y-this.x)+this.x},I.prototype.getInverseInterpolatedValue=function(t){return(t-this.x)/(this.y-this.x)},I.prototype.getInterpolatedValues=function(t){let e=new nL,n=t.length;for(var r=0;r<n;r++)e[r]=this.getInterpolatedValue(t[r]);return e},I.prototype.getInverseInterpolatedValues=function(t){let e=new nL,n=t.length;for(var r=0;r<n;r++)e.push(this.getInverseInterpolatedValue(t[r]));return e},I.prototype.intersect=function(t){return new I(Math.max(this.x,t.x),Math.min(this.y,t.y))},I.prototype.unite=function(t){return new I(Math.min(this.x,t.x),Math.max(this.y,t.y))},I.prototype.clone=function(){let t=new I(this.x,this.y);return t.name=name,t},I.prototype.contains=function(t){return this.y>this.x?t>=this.x&&t<=this.y:t>=this.y&&t<=this.y},I.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y},I.prototype.remap=function(t,e){let n=this.getInverseInterpolatedValue(t);return e.getInterpolatedValue(n)},I.prototype.toString=function(){return"Interval[x:"+this.x+"| y:"+this.y+"| amplitude:"+this.getAmplitude()+"]"},pol3DL.prototype.getBarycenter=function(){for(var t,e=0,n=0,r=0,o=0;o<this.length;o++)e+=(t=this[o].getBarycenter()).x,n+=t.y,r+=t.z;return new P3D(e/this.length,n/this.length,r/this.length)},cScale.prototype.getColor=function(t){return this.colorScaleFunction(t)},cScale.prototype.getColorList=function(t){let e,n=new cL;for(e=0;e<t;e++)n.push(this.getColor(e/(t-1)));return n},MetaCanvas.prototype._init=function(t){this.W=1,this.H=1,this.cX=1,this.cY=1,this.mX=0,this.mY=0,this.mP=new P(0,0),this.nF=0,this.N_FRAMES_MOUSE_UP_FAST=9,this.MOUSE_DOWN=!1,this.MOUSE_UP=!1,this.MOUSE_UP_FAST=!1,this.WHEEL_CHANGE=0,this.NF_DOWN=void 0,this.NF_UP=void 0,this.MOUSE_PRESSED=void 0,this.MOUSE_IN_DOCUMENT=!0,this.mX_DOWN=void 0,this.mY_DOWN=void 0,this.mX_UP=void 0,this.mY_UP=void 0,this.MOUSE_MOVED=!1,this.PREV_mX=0,this.PREV_mY=0,this.DX_MOUSE=0,this.DY_MOUSE=0,this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0,this.T_MOUSE_PRESSED=0,this.KEY_PRESSED=null,this.KEY_JUST_PRESSED=null,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1,this.IS_TOUCH="ontouchstart"in window||navigator.msMaxTouchPoints>0,this.force=0,this.cursorStyle="auto",this.backGroundColor="white",this.backGroundColorRGB=[255,255,255],this.cycleActive=void 0,this._prevMouseX=0,this._prevMouseY=0,this._setIntervalId=void 0,this._setTimeOutId=void 0,this._interactionCancelledFrame=void 0,this._tLastMouseDown=void 0,this._alphaRefresh=0,this.END_CYCLE_DELAY=3e3,this._LISTENERS_ADDED=!1,this.fontColor="#000000",this.fontSize="14",this.fontName="Arial",this.fontAlign="left",this.fontBaseline="top",this.fontStyle="",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("tabindex","10000"),this.canvas.setAttribute("style","outline:none"),this.container&&this.container.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this._adjustCanvas(this.dimensions);let e=this._onMouseOrKeyBoard.bind(this);this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",e,!1),this.canvas.addEventListener("touchend",e,!1),this.canvas.addEventListener("touchmove",e,!1)),this.canvas.addEventListener("mousemove",e,!1),this.canvas.addEventListener("mousedown",e,!1),this.canvas.addEventListener("mouseup",e,!1),this.canvas.addEventListener("mouseenter",e,!1),this.canvas.addEventListener("mouseleave",e,!1),this.canvas.addEventListener("click",e,!1),this.canvas.addEventListener("DOMMouseScroll",e,!1),this.canvas.addEventListener("mousewheel",e,{passive:!1}),this.canvas.addEventListener("keydown",e,!1),document.addEventListener("keydown",e,!1),this.canvas.addEventListener("keyup",e,!1),document.addEventListener("keyup",e,!1);let n,r,o=this._onResize.bind(this);null!=this.container?(n=this.container.ownerDocument,r=n?n.defaultView||n.parentWindow:window):r=window,r.addEventListener("resize",resizeThrottler(o,66),!1),parent.addEventListener("resize",resizeThrottler(o,66),!1),this._listeners={mousemove:[],mousedown:[],mouseup:[],mouseenter:[],mouseleave:[],mousewheel:[],click:[],keydown:[],keyup:[]},this.IS_TOUCH&&(this._listeners.touchstart=[],this._listeners.touchend=[],this._listeners.touchmove=[]),this.context.fillStyle="black",this.init(),t&&this._startCycle(),this.memory={}},MetaCanvas.prototype._getRelativeMousePos=function(t){let e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},MetaCanvas.prototype._onMouseOrKeyBoard=function(t){let e;if(this.IS_TOUCH)var n=null!=t.touches&&null!=t.touches[0]?t.touches[0]:t.targetTouches[0];switch(t.type){case"touchmove":this.force=n.force;case"mousemove":e="mousemove"==t.type?this._getRelativeMousePos(t):{x:null==n.clientX?n.pageX:n.clientX,y:(n.clientY,n.clientY)},this.mX=e.x,this.mY=e.y,this.mP.x=this.mX,this.mP.y=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mousedown":case"touchstart":"touchstart"==t.type&&(this.mX=n.clientX,this.mY=n.clientY),this.NF_DOWN=this.nF,this.MOUSE_PRESSED=!0,this.T_MOUSE_PRESSED=0,this._tLastMouseDown=(new Date).getTime(),this.mX_DOWN=this.mX,this.mY_DOWN=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mouseup":case"touchend":this.NF_UP=this.nF,this.MOUSE_PRESSED=!1,this.T_MOUSE_PRESSED=0,this.mX_UP=this.mX,this.mY_UP=this.mY,this.MOUSE_IN_DOCUMENT=!0,this.MOUSE_UP=!0;break;case"mouseenter":this.MOUSE_IN_DOCUMENT=!0;break;case"mouseleave":this.MOUSE_IN_DOCUMENT=!1,this.SHIFT_PRESSED=!1,this.COMMAND_PRESSED=!1;break;case"keydown":this.SHIFT_PRESSED=t.shiftKey,this.KEY_PRESSED=t.key,this.KEY_JUST_PRESSED=t.key,this.COMMAND_PRESSED=91==t.keyCode;break;case"keyup":this.SHIFT_PRESSED=!1,this.KEY_PRESSED=null,this.COMMAND_PRESSED=!1}this._emit(t.type,t),this.cycleActive&&(new Date).getTime()>this._LAST_TIME+33&&this._onCycle()},MetaCanvas.prototype._onResize=function(t){let e=this.W,n=this.H;if(void 0===this.dimensions&&this._adjustCanvas(),this.onResize!==noOperation){var r=this._containerDimensions();r.width===e&&r.height===n||this.onResize(t)}},MetaCanvas.prototype._containerDimensions=function(){return this.container?{width:this.container.clientWidth,height:this.container.clientHeight}:{width:0,height:0}},MetaCanvas.prototype._adjustCanvas=function(t){if(void 0!==t)this.W=t.width,this.H=t.height;else{var e=this._containerDimensions();this.W=e.width,this.H=e.height}this.cX=Math.floor(.5*this.W),this.cY=Math.floor(.5*this.H),this.canvas.setAttribute("width",this.W),this.canvas.setAttribute("height",this.H),t&&null!=t.x&&this.canvas.setAttribute("x",t.x),t&&null!=t.y&&this.canvas.setAttribute("y",t.y)},MetaCanvas.prototype._startCycle=function(){this.cycleActive=!0,0===this._cycleInterval?setTimeout(this._onCycle.bind(this),10):(clearInterval(this._setIntervalId),this._setIntervalId=setInterval(this._onCycle.bind(this),this._cycleInterval))},MetaCanvas.prototype._stopCycle=function(t){clearInterval(this._setIntervalId),this.cycleActive=!1,this._setIntervalId=void 0,t&&t()},MetaCanvas.prototype.setDimensions=function(t,e,n,r){let o,i,s,l;null!=n&&null!=r?(o=t,i=e,s=n,l=r):(o=0,i=0,s=t,l=e),this.W=s,this.H=l,this.cX=.5*s,this.cY=.5*l,this.canvas.width=s,this.canvas.height=l,this.canvas.style.left=o+"px",this.canvas.style.top=i+"px",this.canvas.style.position="absolute",this._startCycle()},MetaCanvas.prototype.cycleFor=function(t){0===t?(this._setIntervalId&&clearTimeout(this._setTimeOutId),this._startCycle()):1==t?(this._stopCycle(),this._onCycle()):(this._setIntervalId?clearTimeout(this._setTimeOutId):this._startCycle(),this._stopAfter(t))},MetaCanvas.prototype._stopAfter=function(t,e){let n=this;this._setTimeOutId=setTimeout((function(){n._stopCycle(),e&&e()}),t)},MetaCanvas.prototype._onCycle=function(){if(0===this._alphaRefresh?null!=this.backGroundColorRGB?(this.context.fillStyle="rgb("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+")",this.context.fillRect(0,0,this.W,this.H)):this.context.clearRect(0,0,this.W,this.H):(this.context.fillStyle="rgba("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+","+this._alphaRefresh+")",this.context.fillRect(0,0,this.W,this.H)),this.setCursor("default"),this.MOUSE_DOWN=this.NF_DOWN==this.nF,this.MOUSE_UP=this.NF_UP==this.nF,this.MOUSE_UP_FAST=!this.MOUSE_UP_FAST&&this.MOUSE_UP&&this.nF-this.NF_DOWN<this.N_FRAMES_MOUSE_UP_FAST,this.DX_MOUSE=this.mX-this.PREV_mX,this.DY_MOUSE=this.mY-this.PREV_mY,this.MOUSE_MOVED=0!==this.DX_MOUSE||0!==this.DY_MOUSE,this.MOUSE_PRESSED?(this.T_MOUSE_PRESSED=(new Date).getTime()-this._tLastMouseDown,this.DX_MOUSE_PRESSED=this.DX_MOUSE,this.DY_MOUSE_PRESSED=this.DY_MOUSE,this.DX_MOUSE_DRAGGED=this.mX-this.mX_DOWN,this.DY_MOUSE_DRAGGED=this.mY-this.mY_DOWN,this.DRAGGABLE&&(this.x0+=this.DX_MOUSE_PRESSED,this.y0+=this.DY_MOUSE_PRESSED)):(this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0),this.ZOOMABLE){let t=1+.3*this.WHEEL_CHANGE;(this.ZOOM*t>=this.MAX_ZOOM||this.ZOOM*t<=this.MIN_ZOOM)&&(t=1),this.ZOOM*=t,this.ZOOM=Math.max(Math.min(this.ZOOM,this.MAX_ZOOM),this.MIN_ZOOM),this.x0=(this.x0-this.mX)*t+this.mX,this.y0=(this.y0-this.mY)*t+this.mY}this.cycle(),this.WHEEL_CHANGE=0,this.PREV_mX=this.mX,this.PREV_mY=this.mY,this.nF++,this.KEY_JUST_PRESSED=null,this._LAST_TIME=(new Date).getTime()},MetaCanvas.prototype._emit=function(t,e){switch(t){case"mousewheel":case"DOMMouseScroll":t="mousewheel",e||(e=window.event),e.wheelDelta?this.WHEEL_CHANGE=e.wheelDelta/120:e.detail&&(this.WHEEL_CHANGE=-e.detail/3),e.value=this.WHEEL_CHANGE}let n=this._listeners[t].length;for(var r=0;r<n;r++){var o=this._listeners[t][r];o.call(o.__context,e)}},MetaCanvas.prototype.getCycleInterval=function(){return this._cycleInterval},MetaCanvas.prototype.setCycleInterval=function(t){this._cycleInterval=t,this.cycleActive&&this._startCycle()},MetaCanvas.prototype.start=function(){return this._startCycle()},MetaCanvas.prototype.stop=function(){return this._stopCycle()},MetaCanvas.prototype.cycleOnMouseMovement=function(t){let e=this;this.cycleOnMouseMovementListener&&this._LISTENERS_ADDED&&t<=1&&(this.canvas.removeEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousewheel",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.removeEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!1),t>1&&(this.cycleOnMouseMovementListener=function(){e.cycleFor(t)},this._LISTENERS_ADDED||(this.canvas.addEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("mousewheel",this.cycleOnMouseMovementListener,{passive:!1}),this.canvas.addEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),document.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!0)),e.cycleFor(t)},MetaCanvas.prototype.on=function(t,e,n){e.__context=n,this._listeners[t].push(e)},MetaCanvas.prototype.off=function(t,e){let n=this._listeners[t].indexOf(e);n>-1&&this._listeners[t].splice(n,1)},MetaCanvas.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.W,this.H)},MetaCanvas.prototype.setBackgroundColor=function(t){"number"==typeof t?t=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":Array.isArray(t)&&(t=RGBtoHEX(t[0],t[1],t[2])),this.backGroundColor=t,this.backGroundColorRGB=colorStringToRGB(this.backGroundColor)},MetaCanvas.prototype.setBackgroundAlpha=function(t){this._alphaRefresh=t},MetaCanvas.prototype.fRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.fillRect(t,e,n,r)},MetaCanvas.prototype.sRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.strokeRect(t,e,n,r)},MetaCanvas.prototype.fsRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.fillRect(t,e,n,r),this.context.strokeRect(t,e,n,r)},MetaCanvas.prototype.fArc=function(t,e,n,r,o,i=!0){this.context.beginPath(),this.context.arc(t,e,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sArc=function(t,e,n,r,o,i=!0){this.context.beginPath(),this.context.arc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fArcSection=function(t,e,n,r,o,i){this.context.beginPath(),this.context.moveTo(t+n*Math.cos(o),e+n*Math.sin(o)),this.context.arc(t,e,r,o,i),this.context.lineTo(t+n*Math.cos(i),e+n*Math.sin(i)),this.context.arc(t,e,n,i,o,!0),this.context.fill()},MetaCanvas.prototype.fCircle=function(t,e,n){this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.fill()},MetaCanvas.prototype.sCircle=function(t,e,n){this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke()},MetaCanvas.prototype.fsCircle=function(t,e,n){this.fCircle(t,e,n),this.context.stroke()},MetaCanvas.prototype.fEllipse=function(t,e,n,r){let o=.5522848,i=n*o,s=r*o,l=t+n,a=e+r;this.context.beginPath(),this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,l,e-s,l,e),this.context.bezierCurveTo(l,e+s,t+i,a,t,a),this.context.bezierCurveTo(t-i,a,t-n,e+s,t-n,e),this.context.moveTo(t-n,e),this.context.closePath(),this.context.fill()},MetaCanvas.prototype.sEllipse=function(t,e,n,r){let o=.5522848,i=n*o,s=r*o,l=t+n,a=e+r;this.context.beginPath(),this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,l,e-s,l,e),this.context.bezierCurveTo(l,e+s,t+i,a,t,a),this.context.bezierCurveTo(t-i,a,t-n,e+s,t-n,e),this.context.moveTo(t-n,e),this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsEllipse=function(t,e,n,r){this.fEllipse(t,e,n,r),this.context.stroke()},MetaCanvas.prototype._solidArc=function(t,e,n,r,o,i){this.context.beginPath(),this.context.arc(t,e,o,n,r),this.context.lineTo(t+i*Math.cos(r),e+i*Math.sin(r)),this.context.arc(t,e,i,r,n,!0),this.context.lineTo(t+o*Math.cos(n),e+o*Math.sin(n))},MetaCanvas.prototype.fSolidArc=function(t,e,n,r,o,i){this._solidArc(t,e,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sSolidArc=function(t,e,n,r,o,i){this._solidArc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fsSolidArc=function(t,e,n,r,o,i){this.fSolidArc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.line=function(t,e,n,r){this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(n,r),this.context.stroke()},MetaCanvas.prototype.bezier=function(t,e,n,r,o,i,s,l){this.context.beginPath(),this.context.moveTo(t,e),this.context.bezierCurveTo(n,r,o,i,s,l),this.context.stroke()},MetaCanvas.prototype._lines=function(){if(null!=arguments){var t=arguments[0];this.context.beginPath(),this.context.moveTo(t[0],t[1]);for(var e=2;null!=t[e+1];e+=2)this.context.lineTo(t[e],t[e+1])}},MetaCanvas.prototype._linesM=function(){if(null==arguments)return;var t=arguments[0];let e=new Pol;this.context.beginPath(),this.context.moveTo(t[0],t[1]),e[0]=new P(t[0],t[1]);for(var n=2;null!=t[n+1];n+=2)this.context.lineTo(t[n],t[n+1]),e.push(new P(t[n],t[n+1]));return e.containsPoint(this.mP)},MetaCanvas.prototype.fLines=function(){this._lines(arguments),this.context.fill()},MetaCanvas.prototype.sLines=function(){this._lines(arguments),this.context.stroke()},MetaCanvas.prototype.fsLines=function(){this._lines(arguments),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fsLinesM=function(){let t=this._linesM(arguments);return this.context.fill(),this.context.stroke(),t},MetaCanvas.prototype._polygon=function(t){this.context.beginPath(),this.context.moveTo(t[0].x,t[0].y);for(var e=1;null!=t[e];e++)this.context.lineTo(t[e].x,t[e].y)},MetaCanvas.prototype.fPolygon=function(t){this._polygon(t),this.context.fill()},MetaCanvas.prototype.sPolygon=function(t,e){this._polygon(t),e&&this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsPolygon=function(t,e){this._polygon(t),e&&this.context.closePath(),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.fill()},MetaCanvas.prototype.sEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.stroke()},MetaCanvas.prototype.fsEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.fill(),this.context.stroke()},MetaCanvas.prototype._eqTriangle=function(t,e,n,r){this.context.beginPath(),n=n||0,this.context.moveTo(r*Math.cos(n)+t,r*Math.sin(n)+e),this.context.lineTo(r*Math.cos(n+2.0944)+t,r*Math.sin(n+2.0944)+e),this.context.lineTo(r*Math.cos(n+4.1888)+t,r*Math.sin(n+4.1888)+e),this.context.lineTo(r*Math.cos(n)+t,r*Math.sin(n)+e)},MetaCanvas.prototype.fRectM=function(t,e,n,r,o=0){return this.context.fillRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.sRectM=function(t,e,n,r,o=0){return this.context.strokeRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.fsRectM=function(t,e,n,r,o=0){return this.context.fillRect(t,e,n,r),this.context.strokeRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.fCircleM=function(t,e,n,r=0){return this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.fill(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.sCircleM=function(t,e,n,r=0){return this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.fsCircleM=function(t,e,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke(),this.context.fill(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.lineM=function(t,e,n,r,o=4){return this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(n,r),this.context.stroke(),this._distToSegmentSquared(t,e,n,r)<o*o},MetaCanvas.prototype._distToSegmentSquared=function(t,e,n,r){let o=Math.pow(t-n,2)+Math.pow(e-r,2);if(0===o)return Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2);let i=((this.mX-t)*(n-t)+(this.mY-e)*(r-e))/o;if(i<=0)return Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2);if(i>=1)return Math.pow(n-this.mX,2)+Math.pow(r-this.mY,2);let s=t+i*(n-t),l=e+i*(r-e);return Math.pow(s-this.mX,2)+Math.pow(l-this.mY,2)},MetaCanvas.prototype.bezierM=function(t,e,n,r,o,i,s,l,a){return a=null==a?2:a,this.context.beginPath(),this.context.moveTo(t,e),this.context.bezierCurveTo(n,r,o,i,s,l),this.context.stroke(),!(this.mX<Math.min(t,s,n,o)-a||this.mX>Math.max(t,s,n,o)+a||this.mY<Math.min(e,l,r,i)-a||this.mY>Math.max(e,l,r,i)+a)&&distanceToBezierCurve(t,e,n,r,o,i,s,l,this.mP,!1)<a},MetaCanvas.prototype.drawImage=function(t){if(null!=t)switch(arguments.length){case 1:this.context.drawImage(t);break;case 3:this.context.drawImage(t,arguments[1],arguments[2]);break;case 5:this.context.drawImage(t,arguments[1],arguments[2],arguments[3],arguments[4]);break;case 9:this.context.drawImage(t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}},MetaCanvas.prototype.drawImageCircle=function(t,e,n,r){if(null==t)return;let o,i;t.width>t.height?(o=2*r*t.width/t.height,i=2*r):(o=2*r,i=2*r*t.height/t.width),this.clipCircle(e,n,r),this.drawImage(t,e-.5*o,n-.5*i,o,i),this.restore()},MetaCanvas.prototype.fitImage=function(t,e,n=0){if(null==t||null==e)return;var r=t.width/t.height;let o,i=e.width/e.height,s=r/i;switch(n){case 0:o=r>=i;break;case 1:o=r<i;break;case 2:return void this.context.drawImage(t,e.x+.5*e.width-.5*t.width,e.y+.5*e.height-.5*t.height)}o?this.context.drawImage(t,.5*(t.width-t.width/s),0,t.width/s,t.height,e.x,e.y,e.width,e.height):this.context.drawImage(t,0,.5*(t.height-t.height*s),t.width,t.height*s,e.x,e.y,e.width,e.height)},MetaCanvas.prototype.fill=function(t){if("number"==typeof t)return arguments.length>3?void(this.context.fillStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.fillStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.fillStyle=t},MetaCanvas.prototype.stroke=function(t,e){if("number"==typeof t)return arguments.length>3?void(this.context.strokeStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.strokeStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.strokeStyle=t,e&&(this.context.lineWidth=e)},MetaCanvas.prototype.setLW=function(t){this.context.lineWidth=t},MetaCanvas.prototype.clipRect=function(t,e,n,r){this.context.save(),this.context.beginPath(),"Rec"==t.type&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.moveTo(t,e),this.context.lineTo(t+n,e),this.context.lineTo(t+n,e+r),this.context.lineTo(t,e+r),this.context.clip()},MetaCanvas.prototype.clipCircle=function(t,e,n){this.context.save(),this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi,!1),this.context.closePath(),this.context.clip()},MetaCanvas.prototype.save=function(){this.context.save()},MetaCanvas.prototype.clip=function(){this.context.clip()},MetaCanvas.prototype.restore=function(){this.context.restore()},MetaCanvas.prototype.fText=function(t,e,n){this.context.fillText(t,e,n)},MetaCanvas.prototype.sText=function(t,e,n){this.context.strokeText(t,e,n)},MetaCanvas.prototype.fsText=function(t,e,n){this.context.strokeText(t,e,n),this.context.fillText(t,e,n)},MetaCanvas.prototype.fTextW=function(t,e,n){return this.context.fillText(t,e,n),this.context.measureText(t).width},MetaCanvas.prototype.fsTextW=function(t,e,n){return this.context.strokeText(t,e,n),this.context.fillText(t,e,n),this.context.measureText(t).width},MetaCanvas.prototype.fTextRotated=function(t,e,n,r){this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.fillText(t,0,0),this.context.restore()},MetaCanvas.prototype.fsTextRotated=function(t,e,n,r){this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.strokeText(t,0,0),this.context.fillText(t,0,0),this.context.restore()},MetaCanvas.prototype.fTextArc=function(t,e,n,r,o,i){if(null==t||""===t)return;var s;let l,a,u=Math.sqrt(Math.pow(e-r,2)+Math.pow(n-o,2)),h=Math.atan2(n-o,e-r);i&&(h-=.5*this.getTextW(t)/u);let c=t.split("");for(s=0;null!=c[s];s++)l=r+u*Math.cos(h),a=o+u*Math.sin(h),this.fTextRotated(c[s],l,a,h+HalfPi),h+=this.getTextW(c[s])/u},MetaCanvas.prototype.fTextM=function(t,e,n,r){return r=Number(r||this.fontSize),this.context.fillText(t,e,n),this.mY>n&&this.mY<n+r&&this.mX>e&&this.mX<e+this.context.measureText(t).width},MetaCanvas.prototype.fsTextM=function(t,e,n,r){return r=Number(r||this.fontSize),this.context.strokeText(t,e,n),this.context.fillText(t,e,n),this.mY>n&&this.mY<n+r&&this.mX>e&&this.mX<e+this.context.measureText(t).width},MetaCanvas.prototype.fTextRotatedM=function(t,e,n,r,o){o=o||12,this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.fillText(t,0,0),this.context.restore();var i=this.mX-e;let s=this.mY-n,l=Math.sqrt(i*i+s*s),a=Math.atan2(s,i)-r,u=e+l*Math.cos(a),h=n+l*Math.sin(a);return h>n&&h<n+o&&u>e&&u<e+this.context.measureText(t).width},MetaCanvas.prototype.setTextDefaults=function(t,e,n,r,o,i){this.fontColor=ifDef(t,this.fontColor),this.fontSize=ifDef(String(e),this.fontSize),this.fontName=ifDef(n,this.fontName),this.fontAlign=ifDef(r,this.fontAlign),this.fontBaseline=ifDef(o,this.fontBaseline),this.fontStyle=ifDef(i,this.fontStyle),this.setText()},MetaCanvas.prototype.setText=function(t,e,n,r,o,i){let s=ifDef(t,this.fontColor),l=ifDef(String(e),this.fontSize),a=ifDef(n,this.fontName),u=ifDef(r,this.fontAlign),h=ifDef(o,this.fontBaseline),c=ifDef(i,this.fontStyle);""!==c&&(c+=" "),this.context.fillStyle=s,this.context.font=c+l+"px "+a,this.context.textAlign=u,this.context.textBaseline=h},MetaCanvas.prototype.fTextWidth=function(t,e,n,r,o=12){let i=this._textWidthSectionsInfo(t,r),s=i.sections,l=0;return t=i.newText,s.forEach((r=>{this.context.fillText(t.substr(l,r-l),e,n),l=r,n+=o})),this.context.fillText(t.substr(l),e,n),i.nLines},MetaCanvas.prototype.getFontFamily=function(){return this.fontName},MetaCanvas.prototype.setFontFamily=function(t){this.setText(void 0,void 0,t)},MetaCanvas.prototype.getTextW=function(t){return this.context.measureText(t).width},MetaCanvas.prototype.nLines=function(t,e){return this._textWidthSectionsInfo(t,e).nLines},MetaCanvas.prototype._textWidthSectionsInfo=function(t,e){if(this["sections_"+e+"_"+t])return this["sections_"+e+"_"+t];let n=(String(t)||"").replaceAll(/[\s\n]+/g," ").trim(),r=n.split(" ").filter((t=>""!=t)),o=0,i=[],s=1,l="",a=0;return r.forEach((t=>{this.context.measureText(l+t).width>e&&""!=l&&(s++,o+=l.length+1,i.push(o),a=Math.max(this.context.measureText(l).width,a),l=""),l+=(""==l?"":" ")+t})),a=Math.max(this.context.measureText(l).width,a),this["sections_"+e+"_"+t]={sections:i,nLines:s,maxWidth:a,newText:n},this["sections_"+e+"_"+t]},MetaCanvas.prototype.getPixelColor=function(t,e){let n=this.context.getImageData(t,e,1,1).data;return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},MetaCanvas.prototype.getPixelColorRGBA=function(t,e){return Array.prototype.slice.call(this.context.getImageData(t,e,1,1).data)},MetaCanvas.prototype.captureCanvas=function(t=0,e=0,n,r){null==n&&(n=this.W),null==r&&(r=this.H);let o=new Image;if(null==t)return o.src=this.canvas.toDataURL(),o;var i=document.createElement("canvas");return i.width=n,i.height=r,i.getContext("2d").drawImage(this.canvas,t,e,n,r,0,0,n,r),o.src=i.toDataURL(),o},MetaCanvas.prototype.setCursor=function(t="default"){this.canvas.style.cursor=t},MetaCanvas.prototype.pointer=function(){this.canvas.style.cursor="pointer"},MetaCanvas.prototype.getFrame=function(){return new Rec(0,0,this.W,this.H)},MetaCanvas.prototype._linesInFrame=function(t,e,n){let r,o=Math.min(e.length,n.length);for(this.context.beginPath(),this.context.moveTo(t.projectX(e[0]),t.projectY(n[0])),r=1;r<o;r++)this.context.lineTo(t.projectX(e[r]),t.projectY(n[r]))},MetaCanvas.prototype.sLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.stroke()},MetaCanvas.prototype.fLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.fill()},MetaCanvas.prototype.fsLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.drawSmoothPolygon=function(t,e,n=30){let r,o;if(t.length<2)return null;if(this.context.beginPath(),2==t.length){var i=Math.atan2(t[1].y-t[0].y,t[1].x-t[0].x)-.5*Math.PI,s=n*Math.cos(i),l=n*Math.sin(i);return this.context.moveTo(t[0].x,t[0].y),this.context.bezierCurveTo(t[0].x+s,t[0].y+l,t[1].x+s,t[1].y+l,t[1].x,t[1].y),this.context.bezierCurveTo(t[1].x-s,t[1].y-l,t[0].x-s,t[0].y-l,t[0].x,t[0].y),void this.context.stroke()}let a=t.length,u=t[a-1],h=t[0],c=t[1];r=getSoftenControlPoints(u,h,c,n);let f,p=r[1];this.context.moveTo(h.x,h.y),u=h;let g=a+Number(e);for(o=1;o<g;o++)h=t[o%a],c=t[(o+1)%a],r=getSoftenControlPoints(u,h,c,n),f=r[0],this.context.bezierCurveTo(p.x,p.y,f.x,f.y,h.x,h.y),p=r[1],u=h;this.context.stroke()},MetaCanvas.prototype.drawEllipse=function(t,e,n,r){let o=.5522848,i=n*o,s=r*o,l=t+n,a=e+r;this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,l,e-s,l,e),this.context.bezierCurveTo(l,e+s,t+i,a,t,a),this.context.bezierCurveTo(t-i,a,t-n,e+s,t-n,e),this.context.moveTo(t-n,e)},MetaCanvas.prototype.drawPolygon=function(t,e,n,r){let o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+t[0].x,r+t[0].y),o=1;null!=t[o];o++)this.context.lineTo(n+t[o].x,r+t[o].y);e&&this.context.lineTo(n+t[0].x,r+t[0].y),this.context.stroke()},MetaCanvas.prototype.drawPolygonWithControlPoints=function(t,e,n,r){let o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+t[0].x,r+t[0].y),o=1;null!=t[o];o++)this.context.bezierCurveTo(n+e[2*(o-1)].x,r+e[2*(o-1)].y,n+e[2*o-1].x,r+e[2*o-1].y,n+t[o].x,r+t[o].y);this.context.stroke()},MetaCanvas.prototype.drawBezierPolygon=function(t,e,n){let r;e=e||0,n=n||0;let o,i=Math.floor((t.length-1)/3);for(this.context.moveTo(e+t[0].x,n+t[0].y),o=0;o<i;o++)r=3*o+1,this.context.bezierCurveTo(e+t[r].x,n+t[r].y,e+t[r+1].x,n+t[r+1].y,e+t[r+2].x,n+t[r+2].y)},MetaCanvas.prototype.drawMultiStyleCurve=function(t,e,n,r,o,i,s){let l,a,u,h,c;this.context.save(),this.context.lineJoin=this.context.lineCap="round";let f=new I(r,s),p=new I(n,i);for(l=0;l<t.length-1;l++)a=l/(t.length-2),h=f.getInterpolatedValue(a),c=p.getInterpolatedValue(a),u=interpolateColors(e,o,a),u=addAlpha(u,c),this.context.beginPath(),this.context.moveTo(t[l].x,t[l].y),this.context.lineTo(t[l+1].x,t[l+1].y),this.stroke(u,h),this.context.stroke();this.context.restore()},MetaCanvas.prototype.drawRoundRect=function(t,e,n,r,o){o=o||0;let i=e+r;this.context.moveTo(t+o,e),this.context.lineTo(t+n-o,e),this.context.quadraticCurveTo(t+n,e,t+n,e+o),this.context.lineTo(t+n,e+r-o),this.context.quadraticCurveTo(t+n,i,t+n-o,i),this.context.lineTo(t+o,i),this.context.quadraticCurveTo(t,i,t,i-o),this.context.lineTo(t,e+o),this.context.quadraticCurveTo(t,e,t+o,e)},MetaCanvas.prototype.drawTriangleFromBase=function(t,e,n,r,o){this.context.moveTo(t+.5*n*Math.cos(o+.5*Math.PI),e+.5*n*Math.sin(o+.5*Math.PI)),this.context.lineTo(t+.5*n*Math.cos(o-.5*Math.PI),e+.5*n*Math.sin(o-.5*Math.PI)),this.context.lineTo(t+r*Math.cos(o),e+r*Math.sin(o)),this.context.lineTo(t+.5*n*Math.cos(o+.5*Math.PI),e+.5*n*Math.sin(o+.5*Math.PI))},MetaCanvas.prototype.applyTransformationFunctions=function(t,e,n,r,o){if(null==this._fRect&&(this._line=this.line,this._sLines=function(){this.__lines(arguments),this.context.stroke()},this._fCircle=this.fCircle,this._sCircle=this.sCircle,this._fCircleM=this.fCircleM,this._sCircleM=this.sCircleM,this._fRect=this.fRect,this._sRect=this.sRect,this._fRectM=this.fRectM,this._sRectM=this.sRectM,this.__lines=this._lines,this.__polygon=this._polygon,this._fText=this.fText,this._fTextM=this.fTextM,this._sText=this.sText,this._fsText=this.fsText,this._fsTextM=this.fsTextM,this._clipRect=this.clipRect,this._drawImage=this.drawImage),null==t&&null==e)return this.line=this._line,this.sLines=this._sLines,this.fCircle=this._fCircle,this.sCircle=this._sCircle,this.fCircleM=this._fCircleM,this.sCircleM=this._sCircleM,this.fRect=this._fRect,this.sRect=this._sRect,this.fRectM=this._fRectM,this.sRectM=this._sRectM,this._lines=this.__lines,this._polygon=this.__polygon,this.fText=this._fText,this.fTextM=this._fTextM,this.sText=this._sText,this.fsText=this._fsText,this.fsTextM=this._fsTextM,this.clipRect=this._clipRect,void(this.drawImage=this._drawImage);this.fX=t,this.fY=e,r&&(this.invfX=r),o&&(this.invfY=o),this.sX=function(t){return this.fX(t+.5)-this.fX(t-.5)},this.sY=function(t){return this.fY(t+.5)-this.fY(t-.5)},null==t&&(this.fX=function(t){return t}),null==e&&(this.fY=function(t){return t}),this.line=function(t,e,n,r){this._line(this.fX(t),this.fY(e),this.fX(n),this.fY(r))},this.fRect=function(t,e,n,r){this._fRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.sRect=function(t,e,n,r){this._sRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.fRectM=function(t,e,n,r){return this._fRectM(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.sRectM=function(t,e,n,r){return this._sRectM(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.fCircle=function(t,e,n){this._fCircle(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.sCircle=function(t,e,n){this._sCircle(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.fCircleM=function(t,e,n){return this._fCircleM(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.sCircleM=function(t,e,n){return this._sCircleM(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this._lines=function(){if(null!=arguments){var t=arguments[0];this.context.beginPath(),this.context.moveTo(this.fX(t[0]),this.fY(t[1]));for(var e=2;null!=t[e+1];e+=2)this.context.lineTo(this.fX(t[e]),this.fY(t[e+1]))}},this._polygon=function(t){this.context.beginPath(),this.context.moveTo(this.fX(t[0].x),this.fY(t[0].y));for(var e=1;null!=t[e];e++)this.context.lineTo(this.fX(t[e].x),this.fY(t[e].y))},this.fText=function(t,e,n){this._fText(t,this.fX(e),this.fY(n))},this.fTextM=function(t,e,n){this._fTextM(t,this.fX(e),this.fY(n))},this.sText=function(t,e,n){this._sText(t,this.fX(e),this.fY(n))},this.fsText=function(t,e,n){this._fsText(t,this.fX(e),this.fY(n))},this.fsTextM=function(t,e,n){this._fsTextM(t,this.fX(e),this.fY(n))},this.clipRect=function(t,e,n,r){this._clipRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.drawImage=function(t,e,n,r,o){null==r&&this._drawImage(t,this.fX(e),this.fY(n)),this._drawImage(t,this.fX(e),this.fY(n),this.fX(e+r)-this.fX(e),this.fY(n+o)-this.fY(n))},this._fLines=function(){this.__lines(arguments),this.context.fill()}},MetaCanvas.prototype.resetTransformation=function(){this.applyTransformationFunctions(null,null)},MetaCanvas.prototype.mapRegion=function(t,e){this.applyTransformationFunctions((function(n){return(n-e.x)*t.width/e.width+t.x}),(function(n){return(n-e.y)*t.height/e.height+t.y})),this.invfX=function(n){return(n-t.x)*e.width/t.width+e.x},this.invfY=function(n){return(n-t.y)*e.height/t.height+e.y}},MetaCanvas.prototype.mapCanvas=function(t){this.applyTransformationFunctions((function(e){return(e-t.x)*this.W/t.width}),(function(e){return(e-t.y)*this.H/t.height})),this.invfX=function(e){return e*t.width/this.W+t.x},this.invfY=function(e){return e*t.height/this.H+t.y}},Forces.prototype.forcesForNetwork=function(t,e,n,r,o,i){var s;let l;e=e||0,n=n||new P(0,0),r=null==r?0:r,o=null!=o&&o,this.attractionToCenter=i,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this.nodes=new ndL;let a,u,h,c=t.nodes.length,f=t.relations;if(this.previousNetwork){e=0;var p=1e5,g=-1e5,d=1e5,m=-1e5;for(a=0;a<this.previousNetwork.nodes.length;a++)p=Math.min(p,this.previousNetwork.nodes[a].x),g=Math.max(g,this.previousNetwork.nodes[a].x),d=Math.min(d,this.previousNetwork.nodes[a].y),m=Math.max(m,this.previousNetwork.nodes[a].y);var y=g-p,x=m-d;for(a=0;a<c;a++){var w=t.nodes[a];if(s=this.previousNetwork.nodes.get(w.id))w.x=s.x,w.y=s.y;else{for(u=0;u<w.nodes.length;u++)if(s=this.previousNetwork.nodes.get(w.nodes[u].id)){w.x=s.x+.05*y*(Math.random()-.5),w.y=s.y+.05*x*(Math.random()-.5);break}null==s&&(w.x=p+y*Math.random(),w.y=d+x*Math.random())}}}for(t.nodes.forEach(((t,e)=>{null==t.x&&(t.x||(t.x=100*(Math.random()-.5),t.y=100*(Math.random()-.5)),t.vx=0,t.vy=0,t.ax=0,t.ay=0)})),a=0;a<c;a++)0===e?this.addNode(t.nodes[a],new P(t.nodes[a].x,t.nodes[a].y)):(h=Math.random()*TwoPi,this.addNode(t.nodes[a],new P(n.x+e*Math.cos(h),n.y+e*Math.sin(h))));for(a=0;a<c-1;a++)for(s=t.nodes[a],u=a+1;u<c;u++)if(l=t.nodes[u],f.nodesAreConnected(s,l)){switch(r){case 0:this.equilibriumDistances.push(this.dEqSprings);break;case 1:this.equilibriumDistances.push((1.1-f.getFirstRelationByIds(s.id,l.id,!1).weight)*this.dEqSprings);break;case 2:this.equilibriumDistances.push(Math.sqrt(Math.min(s.nodes.length,l.nodes.length))*this.dEqSprings*.1)}this.addForce(s,l,"Spring"),o&&this.addForce(s,l,"Repulsor",.5*this.dEqRepulsors)}else this.addForce(s,l,"Repulsor",this.dEqRepulsors);this.previousNetwork=t},Forces.prototype.addNode=function(t,e,n){e=null==e?new P(200*Math.random()-100,200*Math.random()-100):e,n=null==n?new P(0,0):n,this.nodes.addNode(t),t.x=e.x,t.y=e.y,t.vx=n.x,t.vy=n.y,t.ax=0,t.ay=0,t.r=1},Forces.prototype.addForce=function(t,e,n,r){this.from.addNode(t),this.to.addNode(e),this.forcesList.push(t.id+"*"+e.id+"*"+n),this.forcesTypeList.push(n),null!=r&&this.equilibriumDistances.push(r)},Forces.prototype.calculate=function(){let t,e,n,r,o,i,s,l,a;for(t=0;null!=this.forcesList[t];t++)if(e=this.from[t],n=this.to[t],r=this.forcesTypeList[t],i=n.x-e.x,s=n.y-e.y,l=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),a=this.equilibriumDistances[t],!("Repulsor"==r&&l>a||"Attractor"==r&&l<a))switch(r){case"Spring":case"Repulsor":case"Attractor":o=this.k*(l-a)/l,e.ax+=o*i,e.ay+=o*s,n.ax-=o*i,n.ay-=o*s;break;case"DirectedSpring":o=this.k*(l-a)/l,n.ax-=o*i,n.ay-=o*s;break;case"DirectedRepulsor":l<a&&(o=this.k*(l-a)/l,n.ax-=o*i,n.ay-=o*s)}},Forces.prototype.applyForces=function(){for(var t,e=0;e<this.nodes.length;e++)null!=(t=this.nodes[e]).fixed_x&&(t.x=.95*t.x+.05*t.fixed_x,t.ax=0,t.vx=0),null!=t.fixed_y&&(t.y=.95*t.y+.05*t.fixed_y,t.ay=0,t.vy=0),null!=t.fixed_x&&null!=t.fixed_y||(t.vx+=t.ax,t.vy+=t.ay,t.vx*=this.friction,t.vy*=this.friction,t.x+=t.vx,t.y+=t.vy,t.ax=0,t.ay=0)},Forces.prototype.calculateAndApplyForces=function(){this.calculate(),this.attractionToCenter&&this.attractionToPoint(new P(500,400),4e-6),this.applyForces()},Forces.prototype.iterate=function(t){for(var e=0;e<t;e++)this.calculate(),this.attractionToCenter&&this.attractionToPoint(new P(500,400),4e-6),this.applyForces()},Forces.prototype.attractionToPoint=function(t,e=1,n){let r,o,i,s,l;for(var a=0;null!=this.nodes[a];a++)r=this.nodes[a],i=t.x-r.x,s=t.y-r.y,l=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),o=null!=n?Math.min(e*l,n):e*l,r.ax+=o*i,r.ay+=o*s},Forces.prototype.avoidOverlapping=function(t=0){var e;let n,r,o,i,s,l,a,u,h,c,f,p,g=.5*t,d=this.nodes.length;for(e=0;null!=this.nodes[e+1];e++){n=this.nodes[(e+this._i0)%d],o=n.x-.5*n.width-g,s=n.x+.5*n.width+g,i=n.y-.5*n.height-g,l=n.y+.5*n.height+g;for(var m=e+1;null!=this.nodes[m];m++)r=this.nodes[(m+this._i0+e)%d],a=r.x-.5*r.width-g,h=r.x+.5*r.width+g,u=r.y-.5*r.height-g,c=r.y+.5*r.height+g,(o>a&&o<h||s>a&&s<h)&&(i>u&&i<c||l>u&&l<c)&&(f=r.x-n.x,p=r.y-n.y,Math.abs(f)>Math.abs(p)?f>0?(n.x-=.5*(s-a),r.x+=.5*(s-a)):(n.x+=.5*(h-o),r.x-=.5*(h-o)):p>0?(n.y-=.5*(l-u),r.y+=.5*(l-u)):(n.y+=.5*(c-i),r.y-=.5*(c-i)))}this._i0++},Forces.prototype.avoidOverlappingRadial=function(t,e){let n,r,o;t=t||0,e=e||1;let i,s,l,a,u,h=this.nodes.length,c=2*t;for(n=0;null!=this.nodes[n+1];n++){r=this.nodes[(n+this._i0)%h];for(var f=n+1;null!=this.nodes[f];f++)o=this.nodes[(f+this._i0+n)%h],i=o.x-r.x,s=o.y-r.y,l=Math.pow(i,2)+Math.pow(s,2),a=Math.pow(r.r+o.r+c,2),l<a&&(a=Math.sqrt(a),l=Math.sqrt(l),u=.5*(a-l)/l,r.x-=e*u*i,r.y-=e*u*s,o.x+=e*u*i,o.y+=e*u*s)}this._i0++},Forces.prototype.deactivateForcesFromNode=function(t){t.vx=t.vy=t.ax=t.ay=0},Forces.prototype._resetAccelerations=function(){let t;for(var e=0;null!=this.nodes[e];e++)t=this.nodes[e],t.ax=0,t.ay=0},Engine3D.prototype.setBasis=function(t){this._basis=t.clone(),this._basisBase=t.clone(),this._provisionalBase=t.clone()},Engine3D.prototype.setAngles=function(t){this._angles=t.clone(),this._freeRotation=!1,this._basis=this.basis3DRotation(this._basisBase,this._angles)},Engine3D.prototype.applyRotation=function(t){this._freeRotation||(this._freeRotation=!0,this.updateAngles(),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()),this._basis[0]=this.point3DRotation(this._provisionalBase[0],new P3D(-t.y,t.x,0)),this._basis[1]=this.point3DRotation(this._provisionalBase[1],new P3D(-t.y,t.x,0)),this._basis[2]=this.point3DRotation(this._provisionalBase[2],new P3D(-t.y,t.x,0)),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()},Engine3D.prototype.projectPoint3D_complete=function(t){return new P3D(1*(this._basis[0].x*t.x+this._basis[1].x*t.y+this._basis[2].x*t.z),1*(this._basis[0].y*t.x+this._basis[1].y*t.y+this._basis[2].y*t.z),1*(this._basis[0].z*t.x+this._basis[1].z*t.y+this._basis[2].z*t.z))},Engine3D.prototype.projectPoint3D=function(t){var e=this.lens/(this.lens+(this._basis[0].z*t.x+this._basis[1].z*t.y+this._basis[2].z*t.z));return new P3D((this._basis[0].x*t.x+this._basis[1].x*t.y+this._basis[2].x*t.z)*e,(this._basis[0].y*t.x+this._basis[1].y*t.y+this._basis[2].y*t.z)*e,e)},Engine3D.prototype.projectCoordinates=function(t,e,n){var r=this.lens/(this.lens+(this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n));return new P3D((this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n)*r,(this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n)*r,r)},Engine3D.prototype.scale=function(t){return this.lens/(this.lens+(this._basis[0].z*t.x+this._basis[1].z*t.y+this._basis[2].z*t.z))},Engine3D.prototype.sortedIndexesByPointsScale=function(t){let e,n=[];for(e=0;null!=t[e];e++)n[e]=[t[e],e];n=n.sort(this._sortingCriteria.bind(this));var r=new nL;for(e=0;null!=t[e];e++)r[e]=n[e][1];return r},Engine3D.prototype.sortListByPointsScale=function(t,e){let n,r=[];for(n=0;null!=t[n];n++)r[n]=[e[n],t[n]];r=r.sort(this._sortingCriteria.bind(this));var o=instanceSameType(t);for(o.name=t,n=0;null!=t[n];n++)o[n]=r[n][1];return o},Engine3D.prototype._sortingCriteria=function(t,e){let n=t[0],r=e[0];return this._basis[0].z*n.x+this._basis[1].z*n.y+this._basis[2].z*n.z<this._basis[0].z*r.x+this._basis[1].z*r.y+this._basis[2].z*r.z?1:-1},Engine3D.prototype.updateAngles=function(){this._angles=this.getEulerAngles()},Engine3D.prototype.getEulerAngles=function(){return new P3D(Math.atan2(-this._basis[1].z,this._basis[2].z),Math.asin(this._basis[0].z),Math.atan2(-this._basis[0].y,this._basis[0].x))},Engine3D.prototype.basis3DRotation=function(t,e){let n=Math.cos(e.x),r=Math.sin(e.x),o=Math.cos(e.y),i=Math.sin(e.y),s=Math.cos(e.z),l=Math.sin(e.z);return new Pol3D(new P3D(t[0].x*s*o+t[0].y*(s*r*i+l*n)+t[0].z*(l*r-s*n*i),-t[0].x*l*o+t[0].y*(s*n-l*r*i)+t[0].z*(l*n*i+s*r),t[0].x*i-t[0].y*r*o+t[0].z*o*n),new P3D(t[1].x*s*o+t[1].y*(s*r*i+l*n)+t[1].z*(l*r-s*n*i),-t[1].x*l*o+t[1].y*(s*n-l*r*i)+t[1].z*(l*n*i+s*r),t[1].x*i-t[1].y*r*o+t[1].z*o*n),new P3D(t[2].x*s*o+t[2].y*(s*r*i+l*n)+t[2].z*(l*r-s*n*i),-t[2].x*l*o+t[2].y*(s*n-l*r*i)+t[2].z*(l*n*i+s*r),t[2].x*i-t[2].y*r*o+t[2].z*o*n))},Engine3D.prototype.point3DRotation=function(t,e){let n=Math.cos(e.x),r=Math.sin(e.x),o=Math.cos(e.y),i=Math.sin(e.y),s=Math.cos(e.z),l=Math.sin(e.z);return new P3D(t.x*s*o+t.y*(s*r*i+l*n)+t.z*(l*r-s*n*i),-t.x*l*o+t.y*(s*n-l*r*i)+t.z*(l*n*i+s*r),t.x*i-t.y*r*o+t.z*o*n)},Engine3D.prototype.line3DCoordinates=function(t,e,n,r,o,i){let s=new Pol;var l=this.lens/(this.lens+(this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n));let a=this.lens/(this.lens+(this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i));if(l>0||a>0){if(l>0&&a>0)return s.push(new P((this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n+this._dx)*l,(this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n)*l)),s.push(new P((this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i+this._dx)*a,(this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i)*a)),s;var u=new P3D(this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n,this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n,this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n),h=new P3D(this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i,this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i,this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i),c=(-this.lens+this._cuttingPlane-u.z)/(h.z-u.z),f=new P3D(u.x+c*(h.x-u.x),u.y+c*(h.y-u.y),-this.lens+this._cuttingPlane),p=this.lens/(this.lens+f.z);return l>0?(s.push(new P((u.x+this._dx)*l,u.y*l)),s.push(new P((f.x+this._dx)*p,f.y*p))):(s.push(new P((f.x+this._dx)*p,f.y*p)),s.push(new P((h.x+this._dx)*a,h.y*a))),s}return null},Engine3D.prototype.line3D=function(t,e){return this.line3DCoordinates(t.x,t.y,t.z,e.x,e.y,e.z)},Engine3D.prototype.quadrilater=function(t,e,n,r){let o=new Pol3D;var i=this.line3D(t,e);let s=this.line3D(e,n),l=this.line3D(n,r),a=this.line3D(r,t);return null!=i&&((null==a||i[0].x!=a[1].x&&i[0].y!=a[1].y)&&o.push(i[0]),o.push(i[1])),null!=s&&((null==i||s[0].x!=i[1].x&&s[0].y!=i[1].y)&&o.push(s[0]),o.push(s[1])),null!=l&&((null==s||l[0].x!=s[1].x&&l[0].y!=s[1].y)&&o.push(l[0]),o.push(l[1])),null!=a&&((null==l||a[0].x!=l[1].x&&a[0].y!=l[1].y)&&o.push(a[0]),o.push(a[1])),o};let interpolateColors=function(t,e,n,r){let o=interpolateColorsRGB(colorStringToRGB(t),colorStringToRGB(e),n,r);return"rgb("+Math.floor(o[0])+","+Math.floor(o[1])+","+Math.floor(o[2])+")"},interpolateColorsRGB=function(t,e,n,r){let o=1-n;return r?[Math.floor(Math.sqrt(o*t[0]*t[0]+n*e[0]*e[0])),Math.floor(Math.sqrt(o*t[1]*t[1]+n*e[1]*e[1])),Math.floor(Math.sqrt(o*t[2]*t[2]+n*e[2]*e[2]))]:[Math.floor(o*t[0]+n*e[0]),Math.floor(o*t[1]+n*e[1]),Math.floor(o*t[2]+n*e[2])]},distanceColorsRGB=function(t,e){let n=Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2]);return Number((n/765).toFixed(4))},addAlpha=function(t,e){e=null==e?1:e;let n=colorStringToRGB(t);return null==n?"black":"rgba("+n[0]+","+n[1]+","+n[2]+","+e+")"},invertColor=function(t){let e=colorStringToRGB(t);return e=invertColorRGB(e[0],e[1],e[2]),RGBtoHEX(e[0],e[1],e[2])},stringToColor=function(t){if(null==t)return;if("null"==t||"undefined"==t)return"#202020";let e=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f","#d62720","#1f77b0","#2ca02a","#ff7f08","#9467ba","#bcbd20","#8c564f","#17bece","#dd4418","#206011","#e377c9","#3330fe","#dd8818","#ff220a","#1f66a9","#8c453f","#2ba01f","#dfc508","#945608","#ff008f","#e37708"],n=0;for(var r=0;r<t.length;r++)n+=t.charCodeAt(r)*(r*r+1);return e[Math.floor(getRandomWithSeed(n)*e.length)]},HEXtoRGB=function(t){return[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]},RGBtoHEX=function(t,e,n){return"#"+toHex(Math.floor(t))+toHex(Math.floor(e))+toHex(Math.floor(n))},RGBArrayToString=function(t){return"rgb("+t[0]+","+t[1]+","+t[2]+")"},colorStringToHEX=function(t){let e=colorStringToRGB(t);return RGBtoHEX(e[0],e[1],e[2])},numberToHex=function(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return e},uinttoRGB=function(t){return new Array(t>>16,(t>>8)-(t>>16<<8),t-(t>>8<<8))},uinttoHEX=function(t){let e=uinttoRGB(t);return RGBToHEX(e[0],e[1],e[2])},RGBtouint=function(t,e,n){return Number(t)<<16|Number(e)<<8|Number(n)},HEXtouint=function(t){let e=HEXtoRGB(t);return RGBtouint(e[0],e[1],e[2])},grayByLevel=function(t){return"rgb("+(t=Math.floor(255*t))+","+t+","+t+")"},HEXtoHSV=function(t){let e=HEXtoRGB(t);return RGBtoHSV(e[0],e[1],e[2])},HSVtoHEX=function(t,e,n){let r=HSVtoRGB(t,e,n);return RGBtoHEX(r[0],r[1],r[2])},HSLtoHEX=function(t,e,n){let r=HSLtoRGB(t,e,n);return RGBtoHEX(r[0],r[1],r[2])},RGBtoHSV=function(t,e,n){var r,o,i,s=Math.min(Math.min(t,e),n),l=Math.max(Math.max(t,e),n);i=l/255;var a=l-s;return 0===a?new Array(0,0,t/255):0===l?(o=0,r=-1,new Array(r,o,i)):(o=a/l,r=t==l?(e-n)/a:e==l?2+(n-t)/a:4+(t-e)/a,(r*=60)<0&&(r+=360),new Array(r,o,i))},HSVtoRGB=function(t,e,n){let r,o,i,s,l,a,u,h;if(t=t||0,n=n||0,0===(e=e||0))return r=o=i=n,[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)];switch(t/=60,s=Math.floor(t),l=t-s,a=n*(1-e),u=n*(1-e*l),h=n*(1-e*(1-l)),s){case 0:r=n,o=h,i=a;break;case 1:r=u,o=n,i=a;break;case 2:r=a,o=n,i=h;break;case 3:r=a,o=u,i=n;break;case 4:r=h,o=a,i=n;break;default:r=n,o=a,i=u}return new Array(Math.floor(255*r),Math.floor(255*o),Math.floor(255*i))},HSLtoRGB=function(t,e,n){let r,o,i;function s(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(0===e)r=o=i=n;else{var l=n<.5?n*(1+e):n+e-n*e,a=2*n-l;r=s(a,l,t/360+1/3),o=s(a,l,t/360),i=s(a,l,t/360-1/3)}return[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)]},invertColorRGB=function(t,e,n){return[255-t,255-e,255-n]},toHex=function(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return e},getRandomColor=function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},colorStringToRGB=function(t,e){if(null==t)return;e=null==e?1:e,"#"==(t=(t=(t=String(t)).replace(/ /g,"")).toLowerCase())[0]&&(t=t.substr(1,6));let n={beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",cyan:"00ffff",fuchsia:"ff00ff",gold:"ffd700",gray:"808080",grey:"808080",green:"008000",magenta:"ff00ff",navy:"000080",pink:"ffc0cb",salmon:"fa8072",silver:"c0c0c0",turquoise:"40e0d0",violet:"ee82ee",white:"ffffff",yellow:"ffff00"};null!=n[t]&&(t=n[t]);let r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1])*e,parseInt(t[2])*e,parseInt(t[3])*e]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,process:function(t){return[parseInt(t[1])*e,parseInt(t[2])*e,parseInt(t[3])*e]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16)*e,parseInt(t[2],16)*e,parseInt(t[3],16)*e]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16)*e,parseInt(t[2]+t[2],16)*e,parseInt(t[3]+t[3],16)*e]}}];for(var o=0;o<r.length;o++){var i=r[o].re,s=r[o].process,l=i.exec(t);if(l)return s(l)}return null},createSortedNumberList=function(t,e,n,r){if(null==t)return null;let o;Array.isArray(t)&&(t=t.length),t=Number(t),e=e||0,n=null==n?1:n;let i=new nL;for(o=0;o<t;o++)i.push(e+o*n);return null!=r&&(i.name=r),i},createNumberListWithinInterval=function(t,e,n,r){if(null==e&&(e=new I(0,1)),1==n)return createSortedNumberList(t,e.x,(e.y-e.x)/t);n=null==n?0:n;let o=null!=r?new _Alea("my",r,"seeds"):NumberOperators_random;var i=new nL;let s,l=e.getAmplitude(),a=Number(e.getMin());if(0===n)for(s=0;s<t;s++)i.push(a+Number(o()*l));return i},createRandomNormalDistribution=function(t,e,n){let r,o=new o;for(r=0;r<t;r++)o.push(normal(e,n));return o},createRandomBetaPERTDistribution=function(t,e,n,r,o,i){e=null==e?0:e,n=null==n?1:n,r=null==r?.5:r,o=null==o?1:o,i&&i(i);let s,l=new l;for(s=0;s<t;s++)l.push(betaPERT(e,n,r,o));return i&&randomSeedPop(),l},createRandomBimodalDistribution=function(t,e,n,r,o,i,s,l){e=null==e?0:e,n=null==n?1:n,r=null==r?.25:r,o=null==o?.75:o,i=null==i?1:i,s=null==s?.5:s,null!=l&&l(l);let a,u=new u;for(a=0;a<t;a++)random()>s?u.push(betaPERT(e,n,r,i)):u.push(betaPERT(e,n,o,i));return l&&randomSeedPop(),u},createRandomNumbers=function(t,e,n,r){n=null==n?-1:n,e=null==e?new I(0,1):e;var o=new nL;let i=e.getAmplitude();for(var s=-1==n?NumberOperators_random:new _Alea("my",n,"seeds"),l=0;l<t;l++)o[l]=null==r?s()*i+e.x:r(s()*i+e.x);return o},createUniformTable=function(t,e,n,r){let o=new T;for(var i=0;i<t;i++)o[i]=createListWithSameElement(e,n),r&&r[i]&&(o[i].name=r[i]);return o.downcast()},dotProduct=function(t,e){let n,r=0,o=Math.min(t.length,e.length);for(n=0;n<o;n++)r+=t[n]*e[n];return r},linearRegression=function(t,e,n){n=null==n||n>2?0:n;let r=new nL;if(null==t||null!=e&&t.length!=e.length||0===t.length)return 0===n?r:new P;null==e&&(e=t,t=createSortedNumberList(t.length,0,1));for(var o=0,i=0,s=0,l=0,a=0,u=t.length,h=0;h<u;h++)o+=t[h],i+=e[h],s+=t[h]*t[h],l+=t[h]*e[h],a+=e[h]*e[h];let c=u*s-o*o,f=0===c?0:(u*l-o*i)/c;if(2==n)return f;var p=i/u-f*o/u;if(1==n)return new P(f,p);let g=Math.pow((u*l-o*i)/Math.sqrt((u*s-o*o)*(u*a-i*i)),2);return r.push(f),r.push(p),r.push(g),r.push(u),r},distance=function(t,e,n){if(null==t||null==e)return;let r,o=0,i=Math.min(t.length,e.length);if("cosine"==(n=(n=null==n?"euclidean":n).toLowerCase()))return 1-cosineSimilarity(t,e);if("manhattan"==n){for(r=0;r<i;r++)o+=Math.abs(t[r]-e[r]);return o}if("euclidean"!=n)throw new Error("Invalid distanceMetric.");for(r=0;r<i;r++)o+=Math.pow(t[r]-e[r],2);return Math.sqrt(o)},cosineSimilarity=function(t,e,n,r){let o=(n=null==n?t.getNorm():n)*(r=null==r?e.getNorm():r);return 0===o?0:dotProduct(t,e)/o},covariance=function(t,e,n){if(null==t||null==e)return;var r=Math.min(t.length,e.length);let o,i,s,l=0;for(i=n&&t.infoObject?t.infoObject.average:null!=t.mean?t.mean:t.getMean(),s=n&&e.infoObject?e.infoObject.average:e.mean?e.mean:e.getMean(),o=0;o<r;o++)l+=(t[o]-i)*(e[o]-s);return l/r},standardDeviationTwoNumberLists=function(t,e){if(null==t||null==e)return;let n,r=0,o=Math.min(t.length,e.length);for(n=0;n<o;n++)r+=Math.pow(t[n]-e[n],2);return r/o},numericCorrelation=function(t,e,n,r){if(null==t||null==e)return;t?.infoObject?.standardDeviation&&(n=t.infoObject.standardDeviation),e?.infoObject?.standardDeviation&&(r=e.infoObject.standardDeviation),t?.standardDeviation&&(n=t.standardDeviation),e?.standardDeviation&&(r=e.standardDeviation),null==n&&(n=t.getStandardDeviation()),null==r&&(r=e.getStandardDeviation());let o=n*r;return 0===o?0:covariance(t,e)/o},slidingWindowCorrelation=function(t,e,n){if(null==t||null==e||t.length!=e.length)return;var r,o,i,s,l;(null==n||isNaN(n)||n<1)&&(n=5),n=Math.round(n);let a=t.length,u=new nL;for(r=0;r<a;r++){for(i=new nL,s=new nL,o=Math.max(0,r-n);o<=r+n;o++)o<0||o>=a||(i.push(t[o]),s.push(e[o]));l=numericCorrelation(i,s),u.push(l)}return u},normalizeToSum=function(t,e,n){if(null==t)return;e=null==e?1:e;let r,o=new nL;if(o.name=t.name,0===t.length)return o;if(0===(n=null==n?t.getSum():n))return t.clone();for(e/=n,r=0;r<t.length;r++)o[r]=e*t[r];return o},normalizeByZScore=function(t,e,n){if(null==t)return;if(0===t.length)return null;var r;e=e||t.getMean();let o=n||t.getStandardDeviation(e);0===o&&(o=1);var i=new nL;for(r=0;r<t.length;r++)i.push((t[r]-e)/o);return i.name=t.name,i},normalizeToMax=function(t,e){if(null==t)return;if(e=null==e?1:e,0===t.length)return null;var n=t.getMax();if(0===n&&0===(n=t.getMin()))return createListWithSameElement(t.length,0);let r=new nL;for(var o=0;null!=t[o];o++)r.push(e*(t[o]/n));return r.name=t.name,r},normalizeToInterval=function(t,e){if(null==t||null==e||0===t.length)return;var n;e=null==e?t.getInterval():e;let r=t.getInterval(),o=r.getAmplitude();if(0===o)return ListGenerators.createListWithSameElement(t.length,e.x,t.name);let i=e.getSignedAmplitude()/o,s=new nL;for(n=0;n<t.length;n++)s.push(e.x+i*(t[n]-r.x));return s.name=t.name,s},trimNumberList=function(t,e,n){return t.trim(e,n)},getAccumulativeSum=function(t){if(null!=t&&0!==t.length){var e=new nL;e[0]=t[0];for(var n=1;n<t.length;n++)e[n]=t[n]+e[n-1];return e}},shorten=function(t,e){if(null==t)return null;if(null==e||e>=t.length)return t;var n=t.length/e;let r,o,i,s,l=new nL,a=Math.floor(n);for(l.name=t.name,o=0;o<e;o++){for(s=Math.floor(o*n),r=0,i=0;i<a;i++)r+=t[s+i];l[o]=r/a}return l},simplify=function(t,e,n){if(null!=t){e=e||0,n=n||0;var r=new nL;if(r.name=t.name,0===e){var o=Math.pow(10,n);t.forEach((function(t){r.push(Math.floor(t/o)*o)}))}return r}},segmentNumberList=function(t,e,n){if(null==t||null==e)return null;var r=0==(n=null==n?0:n)?new t:new sL;r.name="segments "+t.name;for(var o=0;o<t.length;o++){for(var i=!1,s=0;s<e.length;s++)if(t[o]<e[s]){i=!0,r[o]=0==n?s:0==s?"<"+e[s]:e[s-1]+"-"+e[s];break}i||(r[o]=0==n?e.length:">="+e[e.length-1])}return r},averageSmoother=function(t,e,n){if(null==t)return;n=null==n?1:n,e=null==e?.1:e,e=Math.max(Math.min(e,.5),0),e*=.6;let r=t.length;var o=t.clone();let i,s,l,a,u,h,c=t.clone();for(i=0;i<n;i++)for(l=i%2?c:o,a=i%2?o:c,s=0;s<r;s++)h=0,u=0,s-1>=0&&(u++,h+=l[s-1]*e),s+1<r&&(u++,h+=l[s+1]*e),a[s]=h+l[s]*(1-u*e);return a},closestValue=function(t,e,n,r){if(null==t)return;n=null==n||n;var o=Math.abs(t[0]-e);let i,s=0;for(var l=1;l<t.length;l++)if(i=Math.abs(t[l]-e),i<o){if(1==r&&t[l]>e||2==r&&t[l]<e||3==r&&t[l]>=e||4==r&&t[l]<=e)continue;o=i,s=l}return n?t[s]:s},filterNumberListByInterval=function(t,e,n,r,o,i){return null},filterNumberListByNumber=function(t,e,n,r){r=r||!1;let o,i=new nL;if(r)switch(n){case"<":for(o=0;null!=t[o];o++)t[o]<e&&i.push(o);break;case"<=":for(o=0;null!=t[o];o++)t[o]<=e&&i.push(o);break;case">":for(o=0;null!=t[o];o++)t[o]>e&&i.push(o);break;case">=":for(o=0;null!=t[o];o++)t[o]>=e&&i.push(o);break;case"==":for(o=0;null!=t[o];o++)t[o]==e&&i.push(o);break;case"!=":for(o=0;null!=t[o];o++)t[o]!=e&&i.push(o)}else switch(n){case"<":for(o=0;null!=t[o];o++)t[o]<e&&i.push(t[o]);break;case"<=":for(o=0;null!=t[o];o++)t[o]<=e&&i.push(t[o]);break;case">":for(o=0;null!=t[o];o++)t[o]>e&&i.push(t[o]);break;case">=":for(o=0;null!=t[o];o++)t[o]>=e&&i.push(t[o]);break;case"==":for(o=0;null!=t[o];o++)t[o]==e&&i.push(t[o]);break;case"!=":for(o=0;null!=t[o];o++)t[o]!=e&&i.push(t[o])}return i},frameFromTwoNumberLists=function(t,e){if(null==t||null==e)return;let n=t.getInterval(),r=e.getInterval();return new Rec(n.x,r.x,n.getAmplitude(),r.getAmplitude())},rangeCounts=function(t,e,n,r){if(null==t)return;e=null==e?10:e;let o=1==(r=r||0)?[]:createListWithSameElement(e,0);if(null==(n=null==n?t.getInterval():n))return o;let i,s=n.y-n.x,l=t.length,a=new nL;for(var u=0;u<l;u++)i=Math.min(Math.floor(e*(t[u]-n.x)/s),e-1),a[u]=i,0===r&&o[i]++;return 1==r?a:o},simpleCompression=function(t,e){if(null==t)return null;var n;e=null==e||e;let r=new nL;if(r.name=t.name,0===t.length)return r;if(r[0]=t[0],e)for(n=1;n<t.length;n++)r[n]=t[n]-t[n-1]-1;else for(n=1;n<t.length;n++)r[n]=r[n-1]+t[n]+1;return r},regression=function(t,e,n,r){if(null==t||0==t.length)return null;if(null==e&&(e=createSortedNumberList(t.length,1)),"string"!=typeof(n=null==n?"linear":n)||"linear"!=n&&"exponential"!=n&&"logarithmic"!=n&&"power"!=n&&"polynomial"!=n)throw new Error("Invalid method in NumberListOperators.regression: "+n);r=null==r?2:r;let o=[];for(var i=0;i<e.length;i++)o.push([e[i],null==t[i]?null:t[i]]);let s=_Regression(n,o,r,{precision:3});var l=new nL;for(l.name=n+" Regression Series",i=0;i<s.points.length;i++)l.push(s.points[i][1]);var a=nL.toL(s.equation);return a.name="Coefficients",[{type:"nL",name:"Y Results",description:"Y Results are the forecasted values",value:l},{type:"nL",name:"Coefficients",description:"Coefficients of the regression equation",value:a},{type:"String",name:"Equation",description:"Equation in string form",value:s.string},{type:"Number",name:"R^2",description:"R^2 value",value:s.r2},{type:"Function",name:"fnModel",description:"Function that takes input and calculates output based on model",value:s.func}]},getDecimalsInterval=function(t){if(null==t)return null;let e,n,r=new I(0,0);for(e=0;e<t.length;e++)n=decimalPlaces(t[e]),r.adjustToContain(n);return r},setDecimals=function(t,e){if(null==t)return null;let n,r;if(t.isTable){var o=instanceSameType(t);for(o.name=t.name,n=0;n<t.length;n++)"nL"==t[n].type?o.push(setDecimals(t[n],e)):o.push(t[n].clone());return o}let i=new nL;for(i.name=t.name,n=0;n<t.length;n++)r=null==t[n]?null:Number(t[n].toFixed(e)),i.push(r);return i},getDistributionHeights=function(t,e,n){if(null==t)return null;var r,o,i;e=null==e||1!=e?0:e;var s=rangeCounts(t,n=null==n?50:n,null,0),l=rangeCounts(t,n,null,1),a=new t;for(randomSeed(1),r=0;r<t.length;r++)i=s[l[r]],0==e?(o=i-1,s[l[r]]--):o=random()*i,a.push(o);return randomSeedPop(),a},kNearestNeighbours=function(t,e,n,r,o,i,s){if(null==t||null==e||0==t.length)return;n=null==n?1:n,r=null==r?0:r,s=null!=s&&s;let l,a="number"==typeof e;if((o=null!=o&&o)||(t=t.transpose()),a){if(e<0||e>=t.length||Math.floor(e)!=e)throw new Error("Invalid value for second inlet.");l=e,e=t[l]}if(e.length!=t[0].length)throw new Error("The input nl must have the same number of values as columns of the numberTable.");let u=new t;u.push(new e),u.push(new e),u.assignNames("index,distance");for(var h=0;h<t.length;h++)a&&h==l||(u[0].push(h),u[1].push(distance(t[h],e,i)));return u=u.sortRowsByList(1,!s,!0),u=u.sliceRows(0,n-1),0==r?t.getColumns(u[0]):1==r?u[0]:u},skewness=function(t,e){if(null==t)return;let n=t.getMean();if((e=null==e?0:e)>=2)return Math.log2(n/t.getMedian());var r=t.getStandardDeviation();if(0==r)return 0;switch(e){case 0:for(var o=0,i=0;i<t.length;i++)o+=Math.pow(t[i]-n,3);return o/t.length/Math.pow(r,3);case 1:if(0==r)return 0;for(o=0,i=0;i<t.length;i++)o+=Math.pow(t[i]-n,3);var s=o/t.length/Math.pow(r,3),l=t.length;return l*l/((l-1)*(l-2))*s}},TableToObject=function(t,e){if(t){e||(e=t.getNames());for(var n=[],r=0;r<t[0].length;r++){for(var o={},i=0;i<e.length;i++)o[e[i]]=t[i][r];n.push(o)}return{array:n}}},ArrayOfArraysToTable=function(t){if(null===t||!isArray(t))return;var e=t.length;let n,r=new T;for(n=0;n<e;n++)isArray(t[n])&&r.push(L.toL(t[n]).downcast());return r.downcast()},tableToHtml=function(t,e,n,r,o,i,s,l,a,u){if(null==t)return;if(0==t.length)return"";if(!t.isTable&&(t.isList||Array.isArray(t))){var h=new T;h.push(t),t=h}n=null==n?"font-family: arial, sans-serif; border-collapse: collapse; width: 100%;":n,r=null==r?"border:1px solid rgba(200,200,200,.5); text-align: left; padding: 4px;":r,o=null==o?"background-color: #ffffff;":o,i=null==i?"background-color: #f0f0f0;":"same"==i?o:i,e=null==e?t[0].length:Math.min(e,t[0].length),l=null==l||l,u=null==u?"rgba(100,160,255,.5)":u;var c="string"==typeof r?'<td style="'+r+'">':"";let f='<tr style="'+o+'">',p='<tr style="'+i+'">';var g="";let d,m,y;a&&(d=function(t,e,n){0==e&&(e=1);var r='<div style="background-color: #eee; width:100%; border-style: solid; border-width: 1px; border-color:#aaa; display: inline-block;">';return r+='<div style="background-color:'+n+"; width:"+Math.max(0,Math.round(100*t/e))+'%; height: 100%; font-size:14px; color:black;">',r+="&nbsp;"+t+"</div></div>"},buildInformationObjectForTable(t)),g+='<table style="'+n+'">';let x=!1;for(m=0;m<t.length;m++)if(""!=t[m].name&&null!=t[m].name){x=!0;break}if(x){for(g+=f,m=0;m<t.length;m++)r.isList&&(c='<td style="'+r[m]+'">'),g+=c+"<b>"+(""==t[m].name?"Column "+(m+1):t[m].name)+"</b></td>";g+="</tr>"}for(y=0;y<e;y++){for(g+=y%2==1?f:p,m=0;m<t.length;m++){if(s&&null!=s[m]&&null!=s[m][y]&&""!=s[m][y]?g+='<td style="'+s[m][y]+'">':(r.isList&&(c='<td style="'+r[m]+'">'),g+=c),l){var w=null==t[m][y]?"":String(t[m][y]).toLowerCase();if(0==w.indexOf("http")&&(-1!=w.indexOf(".jpg")||-1!=w.indexOf(".jpeg")||-1!=w.indexOf(".png")||-1!=w.indexOf("photo")||-1!=w.indexOf("image"))){g+='<img src="'+t[m][y]+'" width=200>';continue}}"nL"==t[m].type&&("all"==a||a&&-1!=a.indexOf(m))?u&&"cL"==u.type&&u.length==t[0].length?g+=d(t[m][y],t[m].infoObject.max,u[y]):g+=d(t[m][y],t[m].infoObject.max,u):g+=t[m][y],g+="</td>"}g+="</tr>"}return g+="</table>"},tableToList=function(t){if(null==t)return;let e=new L;for(var n=0;n<t.length;n++)e=e.concat(t[n]);return e.downcast()},createColorScaleFromColors=function(t,e){if(null==t)return null;if(1==t.length)(function(e){return t[0]});else if(2==t.length){return t.rgbs=t.getRgbArrays(),function(e){var n=1-e;return"rgb("+Math.floor(n*t.rgbs[0][0]+e*t.rgbs[1][0])+","+Math.floor(n*t.rgbs[0][1]+e*t.rgbs[1][1])+","+Math.floor(n*t.rgbs[0][2]+e*t.rgbs[1][2])+")"}}if(null==e){var n=1/(t.length-1);e=createSortedNumberList(t.length-2,n,n)}return null==t.rgbs&&(t.rgbs=t.getRgbArrays()),(e=e.slice()).unshift(0),e.push(1),function(n){var r,o,i;for(r=0;null!=e[r+1];r++)if(n<=e[r+1])return i=1-(o=(n-e[r])/(e[r+1]-e[r])),"rgb("+Math.floor(i*t.rgbs[r][0]+o*t.rgbs[r+1][0])+","+Math.floor(i*t.rgbs[r][1]+o*t.rgbs[r+1][1])+","+Math.floor(i*t.rgbs[r][2]+o*t.rgbs[r+1][2])+")"}},blackScale=function(){return"black"},grayscale=function(t){let e=interpolateColorsRGB([0,0,0],[255,255,255],t);return RGBtoHEX(e[0],e[1],e[2])},antiGrayscale=function(t){let e=interpolateColorsRGB([255,255,255],[0,0,0],t);return RGBtoHEX(e[0],e[1],e[2])},antiTemperature=function(t){return temperature(1-t)},temperature=function(t){let e="#FFFFFF";return e=t<.2?interpolateColors("#000000",HSVtoHEX(234,1,1),5*t):t>.85?interpolateColors(HSVtoHEX(0,1,1),"#FFFFFF",(t-.85)/.15):HSVtoHEX(Math.round(360*(.65-(t-.2))),1,1),e},lightTemperature=function(t){return temperature(.1+.9*t)},sqrtTemperature=function(t){return temperature(Math.sqrt(t))},sqrt4Temperature=function(t){return temperature(Math.pow(t,.25))},quadraticTemperature=function(t){return temperature(Math.pow(t,2))},cubicTemperature=function(t){return temperature(Math.pow(t,3))},greenToRed=function(t){let e=interpolateColorsRGB([50,255,50],[255,50,50],t);return RGBtoHEX(e[0],e[1],e[2])},greenToBlue=function(t){let e=interpolateColorsRGB([50,255,50],[50,50,255],t);return RGBtoHEX(e[0],e[1],e[2])},grayToOrange=function(t){return"rgb("+Math.floor(100+155*t)+","+Math.floor(100+10*t)+","+Math.floor(100-100*t)+")"},sqrt4GrayToOrange=function(t){return grayToOrange(Math.pow(t,.25))},blueToRed=function(t){return"rgb("+Math.floor(255*t)+",0,"+Math.floor(255*(1-t))+")"},whiteToRed=function(t){let e=Math.floor(255-255*t);return"rgb(255,"+e+","+e+")"},redToBlue=function(t){let e=interpolateColorsRGB([255,0,0],[0,0,255],t);return RGBtoHEX(e[0],e[1],e[2])},greenWhiteRed=function(t){let e=[0,0,0];return e=t<.5?interpolateColorsRGB([50,255,50],[255,255,255],2*t):interpolateColorsRGB([255,255,255],[255,50,50],2*(t-.5)),"rgb("+e[0]+","+e[1]+","+e[2]+")"},blueWhiteRed=function(t){return"rgb("+(t<.5?Math.floor(510*t):255)+","+(t<.5?Math.floor(510*t):Math.floor(510*(1-t)))+","+(t<.5?255:Math.floor(510*(1-t)))+")"},blueBlackRed=function(t){return"rgb("+(t<.5?0:Math.floor(512*(t-.5)))+",0,"+(t<.5?Math.floor(255-512*t):0)+")"},grayBlackOrange=function(t){let e=[0,0,0];return e=t<.5?interpolateColorsRGB([100,100,100],[0,0,0],2*t):interpolateColorsRGB([0,0,0],[255,110,0],2*(t-.5)),"rgb("+e[0]+","+e[1]+","+e[2]+")"},grayWhiteOrange=function(t){let e=[0,0,0];return e=t<.5?interpolateColorsRGB([100,100,100],[255,255,255],2*t):interpolateColorsRGB([255,255,255],[255,110,0],2*(t-.5)),"rgb("+e[0]+","+e[1]+","+e[2]+")"},solar=function(t){let e=interpolateColorsRGB([0,0,0],interpolateColorsRGB([255,0,0],[255,255,0],t),Math.pow(.99*t+.01,.2));return RGBtoHEX(e[0],e[1],e[2])},antiSolar=function(t){return invertColor(solar(t))},get=function(t,e){return t.get(e)},getFirstElements=function(t,e){return null==t&&(e=0,t=[null,null,null,null,null,null,null,null,null,null]),[{type:"Object",name:"first value",description:"first value",value:t[(e=null==e?0:Number(e))+0]},{type:"Object",name:"second value",description:"second value",value:t[e+1]},{type:"Object",name:"third value",description:"third value",value:t[e+2]},{type:"Object",name:"fourth value",description:"fourth value",value:t[e+3]},{type:"Object",name:"fifth value",description:"fifth value",value:t[e+4]},{type:"Object",name:"sixth value",description:"sixth value",value:t[e+5]},{type:"Object",name:"seventh value",description:"seventh value",value:t[e+6]},{type:"Object",name:"eight value",description:"eight value",value:t[e+7]},{type:"Object",name:"ninth value",description:"ninth value",value:t[e+8]},{type:"Object",name:"tenth value",description:"tenth value",value:t[e+9]}]},containSameElements=function(t,e){if(null==t||null==e)return null;var n=t.length;let r;if(n==e.length){for(r=0;r<n;r++)if(t[r]!=e[r])return!1;return!0}},fractionOfSameElements=function(t,e){if(null==t||null==e)return null;var n=Math.max(t.length,e.length);let r,o=0;for(r=0;r<n;r++)t[r]==e[r]&&o++;return 0==n?0:o/n},getCorrespondenceBetweenLists=function(t,e,n,r){if(null==t||null==e)return null;if(t.length!=e.length)throw new Error("The two lists must be the same length");r=null!=r&&r;var o=new L;let i,s=Math.max(t.length,e.length);for(i=0;i<s;i++)t[i]==e[i]?o.push(null==n?t[i]:n):o.push(r);return o.downcast()},getConfusionMatrix=function(t,e){if(null==t||null==e)return null;if(t.length!=e.length)throw new Error("The two lists must be the same length");var n=union(t,e).getWithoutRepetitions().getSorted();let r,o,i={},s="-|-";for(r=0;r<n.length;r++)for(o=0;o<n.length;o++)i[n[r]+s+n[o]]=0;for(r=0;r<t.length;r++)i[t[r]+s+e[r]]++;var l=new T;for(l.name="Confusion Mx",r=0;r<=n.length;r++)for(0==r?(l.push(new sL),l[r].name="Predicted Class"):(l.push(new nL),l[r].name="Actual:"+n[r-1]),o=0;o<n.length;o++)0==r?l[r].push(n[o]):l[r].push(i[n[r-1]+s+n[o]]);return l},indexOf=function(t,e){if(null!=t)return t.indexOf(e)},replaceElement=function(t,e,n){if(null==t||null==e)return null;var r=new L;r.name=t.name;let o,i=t.length;for(o=0;o<i;o++)r[o]=t[o]==e?n:t[o];return r.downcast()},replaceElementAtIndex=function(t,e,n){if(null==t||null==n)return null;if("number"!=typeof(e=null==e?0:e)||e%1!=0||e<0||e>=t.length)throw new Error("Invalid index in replaceElement");var r=t.clone();return r[e]=n,r.downcast()},replaceNullsInList=function(t,e,n,r){if(null==t||null==e)return;if(0===e&&null==n)throw new Error("when mode is 0, must provide a non-null element to replace nulls");var o=t.length;let i,s,l,a,u,h,c=0,f=0,p=new L;switch(e){case 6:return n=t.getWithoutElement(null).getMode(),replaceNullsInList(t,0,n);case 3:for(i=0;i<o;i++)"number"==typeof t[i]&&(c+=t[i],f++);return replaceNullsInList(t,0,n=c/f);case 7:n=(n=t.getWithoutElement(null).getSorted()).length>1&&n.length/2==Math.floor(n.length/2)?.5*(n[n.length/2-1]+n[n.length/2]):n[Math.floor(n.length/2)];case 0:for(i=0;i<o;i++)p[i]=t[i]==r?n:t[i];break;case 1:for(i=0;i<o;i++)if(t[i]!=r){s=t[i];break}for(i=0;i<o;i++)t[i]==r?p[i]=s:p[i]=s=t[i];break;case 2:for(i=o-1;i>=0;i--)if(t[i]!=r){l=t[i];break}for(i=o-1;i>=0;i--)t[i]==r?p[i]=l:p[i]=l=t[i];break;case 4:for(u=0,i=0;i<o;i++)if(t[i]!=r){h=i,p[i]=n=t[i];break}if(n==r)return t;for(i==o&&(h=o);u<o;){for(i=u;i<h;i++)p[i]=n;for(i=h;i<o;i++){if(t[i]==r){u=i;break}p[i]=t[i]}if(i==o)u=h=o;else{for(i=u;i<o;i++)if(t[i]!=r){h=i;break}i==o&&(h=o)}u>=0&&(n=h==o?t[u-1]:.5*(t[u-1]+t[h]))}break;case 5:for(u=0,i=0;i<o;i++)if(t[i]!=r){h=i,p[i]=s=l=t[i];break}if(s==r)return t;for(i==o&&(h=o);u<o;){for(a=(l-s)/(1+h-u),i=u;i<h;i++)p[i]=s+(i-u+1)*a;for(i=h;i<o;i++){if(t[i]==r){u=i;break}p[i]=t[i]}if(i==o)u=h=o;else{for(i=u;i<o;i++)if(t[i]!=r){h=i;break}i==o&&(h=o)}u>0&&(s=t[u-1]),l=h==o?s:t[h]}}return p.name=t.name,p.downcast()},concat=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var t;let e=arguments[0].concat(arguments[1]);for(t=2;t<arguments.length;t++)e=e.concat(arguments[t]);return e},reverse=function(t){if(null!=t)return t.getReversed()},getBooleanDictionaryForList=function(t){if(null==t)return;var e={};let n,r=t.length;for(n=0;n<r;n++)e[t[n]]=!0;return e},getFirstOccurrenceDictionaryForList=function(t){if(null==t)return;var e;let n=t.length;var r={};for(e=0;e<n;e++)r[t[e]]=e;return r},getIndexesDictionary=function(t){if(null==t)return;let e,n={},r=t.length;for(e=0;e<r;e++)null==n[t[e]]&&(n[t[e]]=new nL),n[t[e]].push(e);return n},getIndexesTable=function(t){if(null==t)return;let e=new T;e[0]=new L,e[1]=new nT;let n,r,o,i={};for(o=0;o<t.length;o++)r=t[o],n=i[r],null==n?(e[0].push(r),e[1].push(new nL(o)),i[r]=e[0].length-1):e[1][n].push(o);return e[0]=e[0].downcast(),e},buildDictionaryObjectForDictionary=function(t){if(!(null==t||t.length<2||null==t[0]||null==t[1])){var e={};return t[0].forEach((function(n,r){e[n]=t[1][r]})),e}},mapWithTable=function(t,e,n,r){if(!(null==t||null==e||e.length<2)){var o=buildDictionaryObjectForDictionary(e),i=mapWithObject(t,o,n,r);return i.dictionaryObject=o,i}},mapWithObject=function(t,e,n,r){if(null==t||null==e)return;var o=new L;let i,s=t.length;for(i=0;i<s;i++)o[i]=e[t[i]];if(null!=n||r){var l=t.length;for(i=0;i<l;i++)null==o[i]&&(o[i]=r?t[i]:n)}return o.name=t.name,o.downcast()},sortListByNumberList=function(t,e,n){return null==n&&(n=!0),null==e||0===e.length?t:t.getSortedByList(e,!n,!1,!0)},getRankingsList=function(t,e,n,r){if(null==t)return null;e=null==e||e;var o=createSortedNumberList(t.length);o=o.getSortedByList(t,e,n);let i,s=new nL,l=t.length;for(i=0;i<l;i++)s[o[i]]=i;return r&&(s=s.getNormalized()),s.name=t.name,s},sortListByIndexes=function(t,e){let n=instantiate(_typeOf(t));n.name=t.name;let r,o=t.length;for(r=0;r<o;r++)n.push(t[e[r]]);return n},concatWithoutRepetitions=function(){let t=arguments.length;if(0===t)return;if(1==t)return arguments[0];var e,n;let r,o,i=arguments[0].clone(),s=getBooleanDictionaryForList(i);for(e=1;e<t;e++)for(r=arguments[e],o=r.length,n=0;n<o;n++)s[r[n]]||i.push(r[n]);return i.downcast()},slidingWindowOnList=function(t,e,n,r){r=r||0;let o,i,s,l=new T,a=t.length;switch(n=Math.max(1,n),r){case 0:for(i=0;i<a;i+=n)if(i+e<=a){for(o=new L,s=0;s<e;s++)o.push(t[i+s]);l.push(o.downcast())}break;case 1:for(i=0;i<a;i+=n){for(o=new L,s=0;s<Math.min(e,a-i);s++)o.push(t[i+s]);l.push(o.downcast())}break;case 2:for(i=0;i<a;i+=n){for(o=new L,s=0;s<e;s++)o.push(t[(i+s)%a]);l.push(o.downcast())}}return l.downcast()},getNewListForObjectType=function(t){let e=new L;return e[0]=t,instanceSameType(e.downcast())},union=function(t,e,n,r,o){if(null==t||null==e)return;var i=new L;let s,l,a=t.length,u=e.length,h=null==n?0:n.length,c=null==r?0:r.length,f=null==o?0:o.length;if("ndL"==t.type||"ndL"==e.type){for(i=new ndL,i=t.clone(),s=0;s<u;s++)null==t.get(e[s].id)&&i.addNode(e[s]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var p={};for(s=0;s<a;s++)p[t[s]]=t[s];for(s=0;s<u;s++)p[e[s]]=e[s];for(s=0;s<h;s++)p[n[s]]=n[s];for(s=0;s<c;s++)p[r[s]]=r[s];for(s=0;s<f;s++)p[o[s]]=o[s];for(l in p)i.push(p[l]);return i.downcast()},intersection=function(t,e,n,r,o){if(null==t||null==e)return;if(t.isTable&&e.isTable)return t.getColumns(e.getNames());let i,s=null;Array.isArray(n)||"object"!=typeof n||(s=n,n=null);let l,a,u=t.length,h=e.length;if("ndL"==t.type&&"ndL"==e.type){for(i=new ndL,l=0;l<u;l++)e.get(t[l].id)&&i.addNode(t[l]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var c=null==s?getBooleanDictionaryForList(t):s;let f={},p=null==n?null:getBooleanDictionaryForList(n),g=null==r?null:getBooleanDictionaryForList(r),d=null==o?null:getBooleanDictionaryForList(o);for(i=new L,l=0;l<h;l++)a=e[l],null!=f[a]||!c[a]||null!=p&&!p[a]||null!=g&&!g[a]||null!=d&&!d[a]||(f[a]=!0,i.push(a));return i.downcast()},difference=function(t,e){if(null==t||null==e)return;var n=getBooleanDictionaryForList(e);let r,o={},i=new L,s=t.length;for(t.type,r=0;r<s;r++)n[t[r]]||o[t[r]]||(i.push(t[r]),o[t[r]]=!0);return i.downcast()},symmetricDifference=function(t,e){if(null==t||null==e)return;var n=getBooleanDictionaryForList(t);let r,o=getBooleanDictionaryForList(e),i={},s=new L,l=t.length,a=e.length;for(t.type,r=0;r<l;r++)o[t[r]]||i[t[r]]||(s.push(t[r]),i[t[r]]=!0);for(r=0;r<a;r++)n[e[r]]||i[e[r]]||(s.push(e[r]),i[e[r]]=!0);return s.downcast()},jaccardIndex=function(t,e,n,r){if(null!=t&&null!=e){if(0===t.length&&0===e.length)return 0;n=null==n?0:n;var o=intersection(t,e,r).length;return(o+n)/(t.getWithoutRepetitions().length+e.getWithoutRepetitions().length-o)}},jaccardDistance=function(t,e){return 1-jaccardIndex(t,e)},filterList=function(t,e="=c",n,r,o,i){if(null==t)return;"="==e&&(e="=="),null==r&&(r=t),!0===i&&(i=1);let s,l=t.length;if(2==i){var a=new L;switch(e){case"==":for(s=0;s<l;s++)a.push(r[s]===n);break;case"<":for(s=0;s<l;s++)a.push(r[s]<n);break;case"<=":for(s=0;s<l;s++)a.push(r[s]<=n);break;case">":for(s=0;s<l;s++)a.push(r[s]>n);break;case">=":for(s=0;s<l;s++)a.push(r[s]>=n);break;case"!=":for(s=0;s<l;s++)a.push(r[s]!==n);break;case"contains":for(s=0;s<l;s++)a.push(r[s].includes(n));break;case"between":for(s=0;s<l;s++)a.push(r[s]>=n&&r[s]<=o);break;case"init":for(s=0;s<l;s++)a.push(0===r[s].indexOf(n));break;case"property value":for(s=0;s<l;s++)a.push(r[s][n]==o)}return a}var u=new L;let h=1==i?createSortedNumberList(t.length):t;switch(e){case"==":for(s=0;s<l;s++)r[s]==n&&u.push(h[s]);break;case"<":for(s=0;s<l;s++)r[s]<n&&u.push(h[s]);break;case"<=":for(s=0;s<l;s++)r[s]<=n&&u.push(h[s]);break;case">":for(s=0;s<l;s++)r[s]>n&&u.push(h[s]);break;case">=":for(s=0;s<l;s++)r[s]>=n&&u.push(h[s]);break;case"!=":for(s=0;s<l;s++)r[s]!=n&&u.push(h[s]);break;case"contains":for(s=0;s<l;s++)r[s].includes(n)&&u.push(h[s]);break;case"between":for(s=0;s<l;s++)r[s]>=n&&r[s]<=o&&u.push(h[s]);break;case"init":for(s=0;s<l;s++)0===r[s].indexOf(n)&&u.push(h[s]);break;case"property value":for(s=0;s<l;s++)r[s][n]==o&&u.push(h[s])}return u.downcast()},mapWithFunction=function(t,e,n,r,o,i,s,l,a,u){if(null==t||null==e)return;null==u&&(u=!0),"string"==typeof e&&(u=!1,e=stringToFunction(e));var h=new L;let c,f=t.length;if(u)for(c=0;c<f;c++)h[c]=e.call(this,t[c],c,n,r,i,s,l,a);else for(c=0;c<f;c++){var p=[t[c]];null!=n&&(p[1]=n),null!=r&&(p[2]=r),null!=i&&(p[3]=i),null!=s&&(p[4]=s),null!=l&&(p[5]=l),null!=a&&(p[6]=a),h[c]=e.apply(this,p)}return h.name=o,h.downcast()},mapFunctionsOnList=function(t,e,n,r){if(null==t||null==e)return;var o=new L;let i=Math.min(t.length,e.length);for(var s=0;s<i;s++){var l=e[s];"string"==typeof l&&(l=stringToFunction(l));var a=[t[s]];null!=n&&(a[1]=n),null!=r&&(a[2]=r),o[s]=l.apply(this,a)}return o.downcast()},aggregateList=function(t,e,n,r,o,i){if(null==t||null==e)return null;let s=new T;if(null!=n&&"string"==_typeOf(n)&&(n=ListOperators._aggregationDictionary[n]),18==n&&null==o)throw Error("weightList must be defined to aggregate to a weighted average.");if(null==(r=t.indexesTable)&&(r=getIndexesTable(t),t.indexesTable=r),11==n)return r;if(s[0]=r[0],0===n&&t==e)return s[1]=r[0],s;var l;let a;n=null==n?0:n;let u,h,c,f,p,g=r[1].length;switch(n){case 0:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(e[u[0]]);return s[1]=s[1].downcast(),s;case 1:for(s[1]=new nL,f=0;f<g;f++)u=r[1][f],s[1].push(u.length);return s;case 2:case 3:case 18:case 19:var d,m,y;for(s[1]=new nL,f=0;f<g;f++){u=r[1][f],d=0,m=0,y=0;var x=new nL;for(p=0;p<u.length;p++)h=u[p],d+=e[h],19==n&&x.push(e[h]),18==n&&(m+=e[h]*o[h],y+=o[h]);3==n?d/=u.length:18==n&&(d=0==y?0:m/y),19==n&&(d=x.getMedian()),2!=n||Number.isInteger(d)||(d=Number(parseFloat(d).toPrecision(12))),s[1].push(d)}return s;case 4:var w;for(s[1]=new nL,f=0;f<g;f++){for(u=r[1][f],w=99999999999,p=0;p<u.length;p++)h=u[p],w=Math.min(w,e[h]);s[1].push(w)}return s;case 5:var v;for(s[1]=new nL,f=0;f<g;f++){for(u=r[1][f],v=-99999999999,p=0;p<u.length;p++)h=u[p],v=Math.max(v,e[h]);s[1].push(v)}return s;case 6:var b;for(s=aggregateList(t,e,3,r),f=0;f<g;f++){for(u=r[1][f],d=0,b=s[1][f],p=0;p<u.length;p++)h=u[p],d+=Math.pow(e[h]-b,2);s[1][f]=Math.sqrt(d/u.length)}return s;case 16:case 7:for(s[1]=new T,f=0;f<g;f++){for(u=r[1][f],l=new L,p=0;p<u.length;p++)h=u[p],null!=e[h]&&l.push(e[h]);l=l.downcast(),16==n&&(l=l.getFrequenciesTable(!0)),s[1].push(l)}return 16==n?s:s.downcast();case 8:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(e[u[u.length-1]]);return s[1]=s[1].downcast(),s;case 9:for(s[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getMode());return s[1]=s[1].downcast(),s;case 10:for(s[1]=new L,f=0;f<g;f++)u=r[1][f],s[1].push(e[u[Math.floor(Math.random()*u.length)]]);return s[1]=s[1].downcast(),s;case 11:case 16:break;case 12:for(s[1]=new nL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions().length);return s;case 13:for(s[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions());return s[1]=s[1].downcast(),s;case 14:case 17:var _=14==n?", ":"";for(s[1]=new sL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.join(_));return s;case 15:for(s[1]=new sL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(c.getWithoutRepetitions().join(", "));return s;case 20:for(s[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],s[1].push(i(c));return s[1]=s[1].downcast(),s}return null},subCategoricalAnalysis=function(t,e){if(null==t||null==e)return;var n={};let r,o,i,s=!0;for(i=0;null!=t[i];i++)if(r=t[i],o=n[r],null==o)n[r]=e[i];else if(o!=e[i]){s=!1;break}n={};let l=!0;for(i=0;null!=e[i];i++)if(r=e[i],o=n[r],null==o)n[r]=t[i];else if(o!=t[i]){l=!1;break}return l&&s?1:s?2:l?3:0},getListEntropy=function(t,e,n,r){if(null==t)return;if(t.length<2)return 1==t.length?(t._mostRepresentedValue=t[0],t._biggestProbability=1,null!=e&&(t._P_valueFollowing=t[0]==e?1:0)):null!=e&&(t._P_valueFollowing=0),0;null!=t.infoObject&&(n=t.infoObject.frequenciesTable),null==n&&(n=t.getFrequenciesTable(!0)),t._mostRepresentedValue=n[0][0];let o=t.length;if(t._biggestProbability=n[1][0]/o,1==n[0].length)return t._P_valueFollowing=t[0]==e?1:0,0;let i=0;var s=Math.log(n[0].length);let l,a,u=n[1].length;for(l=0;l<u;l++)a=n[1][l],i-=a/o*Math.log(a/o);if(r>0&&(i*=1/s),2==r){var h=function(t,e){if(1==t)return 0;if(t==e)return 1;var n=e-(t-1);return(1/e*-(t-1)*Math.log(1/e)-n/e*1*Math.log(n/e))/Math.log(t)}(u,t.length);h<1&&(i=(i-h)/(1-h))}if(null!=e){var c=n[0].indexOf(e);t._P_valueFollowing=-1==c?0:n[1][c]/o}return i},getListDiversity=function(t,e,n){if(!((e=null==e?0:e)<0||e>2||null==t)){if(t.length<2)return 0;if(!t.isList){if(!Array.isArray(t))return;t=L.toL(t)}switch(null!=t.infoObject&&(n=t.infoObject.frequenciesTable),null==n&&(n=t.getFrequenciesTable()),e){case 0:for(var r=0,o=t.length*(t.length-1),i=0;i<n[1].length;i++)r+=n[1][i]*(n[1][i]-1);return 1-r/o;case 1:return n[0].length/t.length;case 2:return getListEntropy(t,null,null,1)*n[0].length/t.length}}},getInformationGain=function(t,e,n){if(null==t||null==e||t.length!=e.length)return null;var r=null==e.infoObject?getListEntropy(e):e.infoObject.entropy;let o,i,s=r,l={},a=new T,u=t.length;for(o=0;o<u;o++)i=t[o],null==l[i]&&(l[i]=new L,a.push(l[i])),l[i].push(e[o]);u=a.length;let h=e.length;var c;let f=0;for(o=0;o<u;o++)c=null==a[o].infoObject?getListEntropy(a[o]):a[o].infoObject.entropy,f+=a[o].length/h*c;return s=r-f,n&&(s/=r),s},groupElementsByPropertyValue=function(t,e,n,r,o){if(!t)return;null==r&&(r=0);let i,s,l,a,u,h={},c=new T;for(u=0;u<t.length;u++)s=t[u],i=null==e?s:s[e],void 0===h[i]&&(h[i]=new L,h[i].name=i,h[i].valProperty=i,c.push(h[i])),0===r?h[i].push(s):1==r&&h[i].push(u),(void 0===l||i<l)&&(l=i),(void 0===a||i>a)&&(a=i);if(o){for(u=l;u<a;u++)void 0===h[u]&&(h[u]=new L,h[u].name=u,h[u].valProperty=u,c.push(h[u]))}return n&&(c=c.getSortedByProperty("name")),c},repeatElements=function(t,e){if(!t||!e)return;let n=instanceSameType(t);n.name=t.name;for(var r=0;r<t.length;r++)for(var o=0;o<e[r%e.length];o++)n.push(t[r]);return n},_isCategorical=function(t,e){return e>1&&e<t.length&&(t.length<=20||e/t.length<.8)},buildInformationObjectForList=function(t,e){if(null==t)return;if(1==(e=null==e||e)&&null!=t.infoObject)return t.infoObject;let n,r,o=t.length;var i={isInfoObject:!0,type:t.type,name:t.name,length:o};if(i.frequenciesTable=t.getFrequenciesTable(!0,!0,!0),i.numberDifferentElements=i.frequenciesTable[0].length,i.mostFrequentElement=i.frequenciesTable[0][0],i.isNumeric="nL"==t.type,i.isCategorical=_isCategorical(t,i.numberDifferentElements),i.isLongTexts=!1,i.isDefault=!1,i.isNumericCategorical=i.isNumeric&&i.isCategorical,i.isUnique=i.numberDifferentElements==t.length,i.containsNulls=i.frequenciesTable[0].includes(null)||i.frequenciesTable[0].includes(void 0),i.containsNullsOrEqual=i.containsNulls||i.frequenciesTable[0].includes("")||i.frequenciesTable[0].includes("null"),i.isLongitude=!1,i.isLatitude=!1,i.isSmall=t.length<=100,"nL"==t.type){var s=999999999999,l=-999999999999,a=0,u=0,h=new nL,c=0,f=0,p=-999999999999,g=Math.max(Math.floor(t.length/50),1),d=!0;for(n=0;n<o;n++)r=t[n],s=Math.min(s,r),l=Math.max(l,r),a+=r,f+=r,r%1!=0&&(d=!1),++c==g&&(f/=c,p=Math.max(p,f),h.push(f),f=0,c=0);0!==c&&(f/=c,p=Math.max(p,f),h.push(f)),h=h.factor(1/p);var m=a;for(a/=t.length,n=0;n<o;n++)u+=Math.pow(t[n]-a,2);if(i.min=s,i.max=l,i.average=a,i.sum=m,i.standardDeviation=Math.sqrt(u/o),i.allIntegers=d,i.kind=d?"integer numbers":"numbers",i.allPositive=i.min>=0,i.allNegative=i.min<0,i.histogram=rangeCounts(t,50),t.name){var y=t.name.toLowerCase().trim();i.min>=-90&&i.max<=90&&("lat"==y||"lat."==y||y.match(/latitud.*/i))&&(i.isLatitude=!0),i.min>=-180&&i.max<=180&&("lon"==y||"lon."==y||"long"==y||y.match(/longitud.*/i)||"long."==y||"lng"==y)&&(i.isLongitude=!0)}}if("nL"!=t.type||i.allIntegers){if(i.categoricalColors=i.frequenciesTable[3],"sL"==t.type){var x=t.getLengths();for(i.averageTextLengths=0,i.minTextLength=999999999999999,i.maxTextLength=0,n=0;n<o;n++)i.averageTextLengths+=x[n],x[n]>i.maxTextLength&&(i.maxTextLength=x[n]),x[n]<i.minTextLength&&(i.minTextLength=x[n]);i.averageTextLengths=Number(numberToString(i.averageTextLengths/o,i.averageTextLengths/o<10?1:0)),i.averageTextLengths>40&&(i.isLongTexts=!0)}if(i.isLatitude||i.isLongitude)i.kind="geo coordinate";else if("sL"!=t.type||i.isCategorical)if("sL"!=t.type||i.isCategorical)if("L"==t.type){var w=0;for(n=0;n<i.frequenciesTable[0].length;n++)r=i.frequenciesTable[0][n],(isNaN(parseFloat(r))||!isFinite(r)||Math.floor(r)==r&&r<1e3)&&w++;i.isCategorical&&w/i.numberDifferentElements>.8?i.kind="categories":i.kind="strings"}else"nL"!=t.type?i.kind="categories":"nL"==t.type&&(i.kind="integer numbers",i.numberDifferentElements/t.length<=.2&&i.numberDifferentElements<=30&&(i.kind="categories"));else i.kind="strings";else i.kind="strings"}return i.entropy=i.numberDifferentElements==t.length?1:1==i.numberDifferentElements?0:getListEntropy(t,null,i.frequenciesTable),i.isLabel="sL"!=t.type&&i.isUnique&&i.maxTextLength<100,i.isDefault=!i.isNumeric&&!i.isCategorical&&!i.isLongTexts,t.infoObject=i,i},kCombinations=function(t,e){if(null==t||null==e)return;var n=new T;let r,o,i,s;if(e>t.length||e<=0)return n;if(e==t.length)return n.push(t.clone()),n;if(1==e){for(r=0;r<t.length;r++)n.push(new L(t[r]).downcast());return n}for(r=0;r<t.length-e+1;r++)for(i=t.slice(r,r+1),s=n(L.toL(t.slice(r+1)).downcast(),e-1),o=0;o<s.length;o++)n.push(L.toL(i.concat(s[o])).downcast());return n.downcast()},allSubLists=function(t,e){if(null==t)return null;var n=new T;let r;for(e&&n.push(new L),r=1;r<=t.length;r++)n=T.toL(n.concat(kCombinations(t,r)));return n.downcast()},crossCombineLists=function(t,e,n){if(null==t||null==e)return null;let r,o;n=null==n?" ":n;let i=new sL;for(r=0;r<t.length;r++)for(o=0;o<e.length;o++)i.push(t[r]+n+e[o]);return i},characterizeList=function(t,e,n){if(null==t)return null;if(!t.isList)throw new Error("first inlet must be a list");if(t.isTable){var r=new sL;for(let o=0;o<t.length;o++)r.push(characterizeList(t[o],e,n));return r}if(0==t.length)return"";if(null==t.infoObject&&buildInformationObjectForList(t),e=null==e?0:e,n=null!=n&&n,isNaN(e)||e%1!=0||e<0||e>14)throw new Error("Mode must be an integer between 0 and 14");if([1,2,3,4,9,10].includes(e)&&"nL"!=t.type)throw new Error("This mode only applicable for nL input");var o,i,s,l,a;switch(e){case 0:o=t[0]+(n?"(first)":"");break;case 1:o=t.getSum()+(n?"(sum)":"");break;case 2:var u=getDecimalsInterval(t);o=numberToString(t.infoObject.average,u.y+1)+(n?"(avg)":"");break;case 3:o=t.infoObject.min+(n?"(min)":"");break;case 4:o=t.infoObject.max+(n?"(max)":"");break;case 5:o="sL"!=t.type?t.toStringList().join(", ")+(n?"(all)":""):t.join(", ")+(n?"(all)":"");break;case 6:o=t.infoObject.mostFrequentElement+(n?"(common)":"");break;case 7:o=t.infoObject.numberDifferentElements+(n?"(unique count)":"");break;case 8:o="sL"!=(s=t.infoObject.frequenciesTable[0]).type?s.toStringList().join(",")+(n?"(unique)":""):s.join(", ")+(n?"(unique)":"");break;case 9:o=t.infoObject.min+"-"+t.infoObject.max+(n?"(range)":"");break;case 10:o=t.getMedian()+(n?"(median)":"");break;case 11:for(o="",i=0;i<3&&i<t.length;i++)""!=o&&(o+=", "),o+=String(t[i]);t.length>3&&(o+=", + "+(t.length-3)+" more"),n&&(o+="(short list)");break;case 12:l=t.infoObject.frequenciesTable;var h=0;for(o="",i=0;i<l[0].length;i++)i<5?(""!=o&&(o+=", "),o+=String(l[0][i])+":"+l[1][i]):h+=l[1][i];h>0&&(o+=", Other:"+h),o+=n?"(frequency)":"";break;case 13:for(s="sL"==t.type?t:t.toStringList(),l=(s=getWords(s.join(" "),!1,!0,null,null,null,2)).getFrequenciesTable(!0,!0),o="",i=0;i<5&&i<l[0].length;i++)""!=o&&(o+=", "),a=(a=(100*l[2][i]).toPrecision(2)).includes("e")?parseFloat(a):a,o+=String(l[0][i])+":"+a;o+=n?"(word rate)":"";case 14:o=t.name&&""!=t.name?t.name+": ":"","sL"!=t.type?o+=t.toStringList().getSubList(0,5).join(", ")+(n?"(name:5)":""):o+=t.getSubList(0,5).join(", ")+(n?"(name:5)":"")}return o=o.replace(/\n/g," ")},createDefaultCategoricalColorList=function(t,e,n,r=!1){let o=createCategoricalColors(2,t,null,null,null,null,null,r);return null!=e&&e<=1&&(o=o.addAlpha(e)),n&&(o=o.getInverted()),o},colorsForCategoricalList=function(t,e,n){if(null!=t){if(n){var r=new cL;r.name=t.name+" colors";for(var o=0;o<t.length;o++)r[o]=stringToColor(String(t[o]));return r}return createCategoricalColorListForList(t,e)[0].value}},createCategoricalColorListForList=function(t,e,n,r,o,i,s){if(null==t)return null;o=null==o?0:o;let l,a=t.getWithoutRepetitions();l=e&&o>0?e.getInterpolated(r,o):createCategoricalColors(2,a.length,null,n,r,o,e,s),null!=n&&n<=1&&(l=l.addAlpha(n)),i&&(l=l.getInverted());var u=T.toL([a,l]);let h=buildDictionaryObjectForDictionary(u);var c=mapWithTable(t,u,"black");return[{value:c=cL.toL(c),type:"cL"},{value:a,type:a.type},{value:l,type:"cL"},{value:u,type:"T"},{value:h,type:"Object"}]},createColorListFromColorScale=function(t,e,n){if(null==t)return;var r;n=null==n?0:n,e=null==e?grayToOrange:e;let o=new cL;switch(n){case 0:for(r=0;r<t;r++)o[r]=e(r/(t-1));break;case 1:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),2));break;case 2:for(r=0;r<t;r++)o[r]=e(Math.sqrt(r/(t-1)));break;case 3:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),4));break;case 4:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),.25))}return o},createColorListFromNumberList=function(t,e,n){if(null==t)return null;n=null==n?0:n,e=null==e?grayToOrange:e;var r=new cL;let o,i,s=t.length;switch(n){case 0:o=normalizeToMax(t);break;case 1:break;case 2:o=t}for(i=0;i<s;i++)r[i]=e(o[i]);return r},createSymmetricalColorListFromNumberList=function(t,e,n,r,o,i){if(null==t)return;let s=null==i?t.getInterval():i,l=Math.max(Math.abs(s.x),Math.abs(s.y));n=null==n?"gray":n,r=null==r?"blue":r;var a=colorStringToRGB(e=null==e?"red":e);let u=colorStringToRGB(n),h=colorStringToRGB(r);var c=new cL;let f;for(var p=0;p<t.length;p++)f=Math.abs(t[p])/l,o>0&&(f=Math.sqrt(f)),o>1&&(f=Math.sqrt(f)),null!=i&&t[p]<i.x?c[p]=e:null!=i&&t[p]>i.y?c[p]=r:c[p]=RGBArrayToString(t[p]<0?interpolateColorsRGB(u,a,f):interpolateColorsRGB(u,h,f));return c},createColorListWithSingleColor=function(t,e){let n=new cL;for(var r=0;r<t;r++)n.push(e);return n},createColorListBetweenTwoColors=function(t,e,n){if(t=null==t?8:t,null==e||null==n)return;let r=new cL;for(var o=0;o<t;o++){var i=1==t?e:interpolateColors(e,n,o/(t-1),!0);r.push(i)}return r},createColorListSpectrum=function(t,e,n){t=null==t?8:t,e=null==e?1:e,n=null==n?1:n;let r,o=new cL;for(var i=0;i<t;i++)r=360*i/t,o.push(HSVtoHEX(r,e,n));return o},stringsToColors=function(t,e){if(null!=t){null!=e&&e.isTable&&(e=buildDictionaryObjectForDictionary(e));for(var n=new cL,r=0;r<t.length;r++)n[r]=e?e[String(t[r])]:null,null==n[r]&&(n[r]=stringToColor(String(t[r])));return n}},createCategoricalColors=function(t,e,n,r,o,i=.5,s,l){let a,u;n=null==n?temperature:n;let h=new cL;switch(t){case 0:for(a=0;a<e;a++)h[a]=n(a/(e-1));break;case 1:var c=createRandomNumbers(e,null,0);for(a=0;a<e;a++)h[a]=n(c[a]);break;case 2:var f;for(s=null==s?_HARDCODED_CATEGORICAL_COLORS:s,a=0;a<e;a++)if(h[a]=s[a%s.length],l&&a>=s.length)for(f=Math.floor(a/s.length),u=0;u<f;u++)h[a]=interpolateColors(h[a],"black",.2);break;case 3:h=createColorListSpectrum(e);break;case 4:case 5:var p,g,d=createRandomNumbers(1001,null,0),m=createSortedNumberList(e),y=createRandomNumbers(e,null,0),x=sortListByNumberList(m,y),w=Math.floor(2*e)+100,L=Math.floor(.6*e)+5,v=4==t,b=4==t,T=_evaluationFunction(x,v,b),_=x,M=0;for(a=0;a<w;a++){for(u=0;u<L;u++)p=_sortingVariation(x,d[M],d[M+1]),M=(M+2)%1001,(g=_evaluationFunction(p,v,b))>T&&(_=p,T=g);x=_}if(4==t){var S=createColorListSpectrum(e);for(a=0;a<e;a++)h.push(S[x[a]])}else for(a=0;a<e;a++)h.push(n(1/e+x[a]/(e+1)))}return i>0&&null!=o&&(h=h.getInterpolated(o,i)),null!=r&&(h=h.addAlpha(r)),h},_sortingVariation=function(t,e,n){let r=t.clone(),o=Math.floor(e*r.length),i=Math.floor(n*r.length),s=r[i];return r[i]=r[o],r[o]=s,r},_evaluationFunction=function(t,e,n){let r,o,i,s=0,l=t.length,a=Math.floor(l/2),u=n?4:1;for(var h=1;h<=u;h++)for(i=h*h,r=0;null!=t[r+h];r++)o=Math.abs(t[r+h]-t[r]),e&&o>a&&(o=l-o),s+=Math.sqrt(o/i);return s},createCategoricalColorListDictionaryObject=function(t,e,n,r,o,i){if(null!=t){if(t.isTable){var s,l,a,u,h,c,f=t,p=null==e?_HARDCODED_CATEGORICAL_COLORS:e;for(l=p.clone(),u={},s=0;s<f.length;s++)(c=buildInformationObjectForList(f[s])).isCategorical&&((h=c.numberDifferentElements)>=p.length?a=createCategoricalColorListDictionaryObject(f[s],p,n,r,o,i):(h>l.length&&(l=p.clone()),a=createCategoricalColorListDictionaryObject(f[s],l,n,r,o,i),l=l.getSubList(h,l.length-1)),u=Object.assign(u,a));return u}var g=t.getWithoutRepetitions(),d=createCategoricalColors(2,g.length,null,n,r,o,e);i&&(d=d.getInverted());var m={},y=d.length;for(s=0;s<y;s++)m[g[s]]=d[s];return m}},stringToDate=function(t,e,n){if(null==t)return null;if(n=null==n?"-":n,e=null==e?1:e,e=Number(e),"sL"==t.type||"Array"==_typeOf(t)){var r,o=new dL;for(o.name=t.name,r=0;r<t.length;r++)o.push(stringToDate(t[r],e,n));return o}if(t=String(t),1==e)return"-"!=n&&(t=t.replace(new RegExp(n,"g"),"-")),-1==t.indexOf(".")?parseDate(t):new Date(t);var i;let s=t.split(n);switch(e){case 0:return new Date(Number(s[2]),Number(s[0])-1,Number(s[1]));case 1:return new Date(t);case 2:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[0])-1,Number(s[1]));case 3:return i=(i=Number(s[0]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[2]));case 4:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[0]));case 5:return i=Number(s[2]),new Date(i,Number(s[1])-1,Number(s[0]));case 6:i=Number(t.substr(0,4));var l=Number(t.substr(4,2)),a=Number(t.substr(6,2));return new Date(i,l-1,a)}},dateToString=function(t,e,n){if(null==t)return null;if("dL"==t.type||"Array"==_typeOf(t)){var r,o=new sL;for(o.name=t.name,r=0;r<t.length;r++)o.push(dateToString(t[r],e,n));return o}n=null==n?"-":n,e=null==e?0:e,"string"==typeof t&&(t=new Date(t));let i=t.getFullYear(),s=String(i).substr(2),l=t.getMonth()+1,a=t.getDate();switch(e){case 0:return l+n+a+n+i;case 1:return i+n+l+n+a;case 2:return l+n+a+n+s;case 3:return s+n+l+n+a;case 4:return i+n+l+n+a+" "+(h=t.getHours())+":"+(c=(c=t.getMinutes())<10?"0"+c:c)+":"+(f=(f=t.getSeconds())<10?"0"+f:f);case 5:return a+" "+DateOperators_MONTH_NAMES[l-1]+" "+i;case 6:return u=0==(u=t.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u]+", "+a+" "+DateOperators_MONTH_NAMES[l-1]+" "+i;case 7:return DateOperators_MONTH_NAMES[l-1];case 8:var u;return u=0==(u=t.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u];case 9:return i+n+(l<10?"0"+l:l)+n+(a<10?"0"+a:a);case 10:var h,c,f;return(h=(h=t.getHours())<10?"0"+h:h)+":"+(c=(c=t.getMinutes())<10?"0"+c:c)+":"+(f=(f=t.getSeconds())<10?"0"+f:f);case 11:return(a<10?"0"+a:a)+n+(l<10?"0"+l:l)+n+i}},clearHoursMinutesSeconds=function(t){if(null==t)return null;let e=dateToString(t,1);return stringToDate(e,1)},currentDate=function(t){return new Date},addDaysToDate=function(t,e){if(null==t)return null;e=null==e?0:e,"string"==typeof t&&(t=parseDate(t));let n=new Date(t);return n.setDate(n.getDate()+e),n},addMillisecondsToDate=function(t,e){return new Date(t.getTime()+e)},parseDate=function(t){let e=(t=String(t)).match(/^(\d{4})[\-\.](\d{1,2})[\-\.](\d{1,2})$/);return e&&4==e.length?new Date(e[1],e[2]-1,e[3]):new Date(Date.parse(t))},parseDates=function(t){let e,n=new dL;for(e=0;null!=t[e];e++)n.push(this.parseDate(t[e]));return n},hoursBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToHours},daysBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToDays},weeksBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToWeeks},yearsBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToYears},nDayInYear=function(t){return Math.floor((t.getTime()-new Date(t.getFullYear(),0,1).getTime())*DateOperators_millisecondsToDays)},getDateDaysAgo=function(t){return addDaysToDate(new Date,-t)},getWeekInYear=function(t){if(null==t)return null;let e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+e.getDay()+1)/7)},getNDaysInMonth=function(t,e){return new Date(e,t,0).getDate()},getDecimalDate=function(t){let e;if(null==t)return null;if("string"==typeof t){if(e=new Date(t),isNaN(e))throw new Error("Invalid format for date:"+t)}else e=t;var n=e.getFullYear();t=new Date(n,0,1);let r=new Date(n+1,0,1);return n+(e.getTime()-t.getTime())/(r.getTime()-t.getTime())},convertFromDecimalDate=function(t){if(null==t)return null;if("nL"==t.type){var e=new e;e.name=t.name;for(var n=0;n<t.length;n++)e.push(convertFromDecimalDate(t[n]));return e}let r=Math.floor(t),o=new Date(r,0,1),i=new Date(r+1,0,1),s=o.getTime()+(i.getTime()-o.getTime())*(t-r),l=new Date(Math.round(s));if(isNaN(l))throw new Error("Invalid decimal date value:"+t);return l},extractPropertiesFromDate=function(t,e){if(null==t)return null;if(e=null==e?0:e,isNaN(e)||e%1!=0||e<0||e>15)throw new Error("Invalid output type.");var n,r,o,i;switch(e){case 0:n=t.getFullYear();break;case 1:n=t.getMonth()+1;break;case 2:n=t.getDate();break;case 3:n=t.getDay();break;case 4:n=t.getHours();break;case 5:n=t.getMinutes();break;case 6:n=t.getSeconds();break;case 7:n=getDecimalDate(t);break;case 8:n=nDayInYear(t);break;case 9:r=getDecimalDate(t),n=Math.floor(4*(r-Math.floor(r)))+1;break;case 10:o=t.getHours()+(60*t.getMinutes()+t.getSeconds())/3600,n=Number(o.toFixed(5));break;case 11:for(n=[],i=0;i<7;i++)t.getDay()==i?n.push(1):n.push(0);break;case 12:for(n=[],i=0;i<12;i++)t.getMonth()==i?n.push(1):n.push(0);break;case 13:n=dateToString(t,8);break;case 14:n=dateToString(t,7);break;case 15:n=t.getHours()>=12?"pm":"am"}return n},StringListToNumberList=function(t){let e,n=new nL;for(n.name=t.name,e=0;null!=t[e];e++)n[e]=Number(t[e]);return n},toDateList=function(t,e,n){if(null==t)return;let r,o=new dL;o.name=t.name;let i=t.length;for(r=0;r<i;r++)o.push(stringToDate(t[r],e,n));return o},_y=function(t){return t.getFullYear()},_m=function(t){return t.getMonth()},_d=function(t){return t.getDate()-1},_h=function(t){return t.getHours()},_mn=function(t){return t.getMinutes()},_s=function(t){return t.getSeconds()},_ms=function(t){return t.getMilliseconds()},getDateLists=function(t){let e=new T;for(var n=0;n<t.length;n++)"dL"==t[n].type&&e.push(t[n]);return e},buildSummaryTableFromDates=function(t,e,n,r){if(null==t||"dL"!=t.type)return null;let o="Weekday by Hour Summary",i="Hour";1==(e=null==e?0:e)?(o="Month by Day Summary",i="Day"):2==e&&(o="Sequence",i="Date");let s=new T;null!=t.name?s.name=t.name+" "+o:s.name=o,s.push(new sL),s[0].name=i;let l,a,u,h,c,f,p=window&&window.navigator&&window.navigator.language?window.navigator.language:"en-US",g=new Date(2016,0,17,10,0,0,0);if(2==e){null!=r&&"dI"==r.type||(r=new dI(t.getMin(),t.getMax())),s.push(new u),s[1].name="Value";var d=daysBetweenDates(r.date0,r.date1);for(l=0;l<=d;l++)a=addDaysToDate(r.date0,l),s[0][l]=dateToString(a,1),s[1][l]=0;for(l=0;l<t.length;l++)h=Math.floor(daysBetweenDates(r.date0,t[l])),h<0||h>=s[1].length||(m?s[1][h]+=n[l]:s[1][h]++);return s}var m=n&&n.length==t.length;let y=0==e?7:12,x=0==e?1:30;for(l=0;l<y;l++)if(a=0==l?g:addDaysToDate(g,l*x),u=new u,u.name=a.toLocaleString(p,0==e?{weekday:"long"}:{month:"long"}),s.push(u),0==l)if(0==e)for(h=0;h<24;h++)s[0][h]=0==h?"Midnight":12==h?"Noon":String(h>12?h-12:h);else for(h=0;h<31;h++)s[0][h]=String(h+1);for(c=1;c<=y;c++)for(f=0;f<s[0].length;f++)s[c][f]=0;for(l=0;l<t.length;l++)0==e?(c=t[l].getDay(),f=t[l].getHours()):(c=t[l].getMonth(),f=t[l].getDate()-1),m?s[c+1][f]+=n[l]:s[c+1][f]++;return s},transformDateList=function(t,e,n,r){if(null==t)return null;if("sL"==t.type&&(t=toDateList(t)),null==e&&(e=nL.toL([0,1,2])),"nL"!=e.type&&!(e instanceof Array))throw new Error("Invalid input. Second argument must be a nL.");n=null==n?"":n;let o,i,s,l,a=["year","month","day of month","day of week","hour","minute","second","decimal date","day number of year","quarter","decimal hour","day","month","day name","month name","week number in year","day number"],u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];if("dL"==(r=null==r?"2000-01-01":r).type)r=r.getMin();else if("sL"==r.type)r=(r=toDateList(r)).getMin();else if("string"==typeof r)if("earliest"==r)r=t.getMin();else if(r=parseDate(r),isNaN(r))throw new Error("Invalid format for date:"+r);r=clearHoursMinutesSeconds(r),o=e.includes(13)||e.includes(14)?new T:new nT;for(var c=0;c<e.length;c++){var f=e[c];if(l=o.length,isNaN(f)||f%1!=0||f<0||f>16)throw new Error("Invalid output type.");if(11==f)for(i=0;i<7;i++)o.push(new nL),s=""==n?a[f]:n+" "+a[f],o[l+i].name=s+":"+u[i];else if(12==f)for(i=0;i<12;i++)o.push(new nL),s=""==n?a[f]:n+" "+a[f],o[l+i].name=s+":"+h[i];else 13==f||14==f?o.push(new sL):o.push(new nL),o[l].name=""==n?a[f]:n+" "+a[f];for(var p=0;p<t.length;p++){var g=t[p];switch(f){case 0:o[l].push(g.getFullYear());break;case 1:o[l].push(g.getMonth()+1);break;case 2:o[l].push(g.getDate());break;case 3:o[l].push(g.getDay());break;case 4:o[l].push(g.getHours());break;case 5:o[l].push(g.getMinutes());break;case 6:o[l].push(g.getSeconds());break;case 7:o[l].push(getDecimalDate(g));break;case 8:o[l].push(nDayInYear(g));break;case 9:var d=getDecimalDate(g);d=Math.floor(4*(d-Math.floor(d)))+1,o[l].push(d);break;case 10:var m=g.getHours()+(60*g.getMinutes()+g.getSeconds())/3600;m=Number(m.toFixed(5)),o[l].push(m);break;case 11:for(i=0;i<7;i++)g.getDay()==i?o[l+i].push(1):o[l+i].push(0);break;case 12:for(i=0;i<12;i++)g.getMonth()==i?o[l+i].push(1):o[l+i].push(0);break;case 13:o[l].push(dateToString(g,8));break;case 14:o[l].push(dateToString(g,7));break;case 15:o[l].push(getWeekInYear(g));break;case 16:o[l].push(Math.round(daysBetweenDates(r,clearHoursMinutesSeconds(g))))}}}return o},changeTimeResolution=function(t,e,n,r,o){if(null==t)return;if(n=null==n?100:n,r=null!=r&&r,o=null==o?0:o,(e=null==e?0:e)!=Math.floor(e)||e<0||e>9)throw new Error("Invalid mode value provided in changeTimeResolution");let i=t.type;if("sL"==t.type?t=toDateList(t):"nL"==t.type&&(t=convertFromDecimalDate(t)),"dL"!=t.type)throw new Error("changeTimeResolution input must be a dL, sL containing dates, or a nL of decimal dates");let s,l,a,u,h=encodeDatesAsNumericFeatures(t,[0,1,2,3,4,5,6,7]),c=h[7].getInterval(),f=convertFromDecimalDate(c.x),p=(convertFromDecimalDate(c.y).getTime()-f.getTime())/1e3,g=[315532800,31536e3,7862400,2678400,604800,86400,3600,60,1];if(0==e)for(e=9,e=9;e>=1;e--){if(r)l=changeTimeResolution(t,e).toNumberList().getWithoutRepetitions().length;else l=p/g[e-1];if(l<=n)break}e<1&&(e=1);let d=new dL;d.name=t.name;let m,y,x,w,L,v,b,_=new sL;_.name=null==t.name?"label":t.name+" label";let M=function(t){return t<10?"0"+t:""+t};for(s=0;s<t.length;s++){switch(m=h[0][s],y=h[1][s]-1,x=h[2][s],w=h[4][s],L=h[5][s],v=h[6][s],e){case 1:m=10*Math.floor(m/10),b=String(m),a=new Date(m,0);break;case 2:a=new Date(m,0),b=String(m);break;case 3:var S=" Q"+(Math.floor(y/3)+1);y=3*Math.floor(y/3),a=new Date(m,y),b=String(m)+S;break;case 4:a=new Date(m,y),b=String(m)+"-"+M(y+1)+"-01";break;case 5:u=new Date(m,y,x-h[3][s]),m=u.getFullYear(),y=u.getMonth(),x=u.getDate(),a=new Date(m,y,x),b=String(m)+"-"+M(y+1)+"-"+M(x);break;case 6:a=new Date(m,y,x),b=String(m)+"-"+M(y+1)+"-"+M(x);break;case 7:a=new Date(m,y,x,w),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":00:00";break;case 8:a=new Date(m,y,x,w,L),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":"+M(L)+":00";break;case 9:a=new Date(m,y,x,w,L,v),b=String(m)+"-"+M(y+1)+"-"+M(x)+" "+M(w)+":"+M(L)+":"+M(v)}d.push(a),_.push(b)}if("nL"==i?d=d.toNumberList():"sL"==i&&(d=dateToString(d,1)),0==o)return d;let N=new T;if(N.push(d),N.push(_),1==o)return N;l=p/g[e-1],l=Number.isInteger(l)?l+1:Math.ceil(l);var R={table:N,extra:{numPeriods:l,modeUsed:e,intervalDates:c}};return R.name=t.name+"("+e+")",R},getElementFromTable=function(t,e,n){return null==t[e]?null:t[e][n]},getSubTable=function(t,e,n,r,o){if(null==t)return t;var i=t.length;if(0===i)return null;let s=new T;r<=0&&(r=i-e+r),e=Math.min(e,i-1),r=Math.min(r,i-e);var l,a=t[0].length;if(0===a)return null;let u,h,c,f;for(o<=0&&(o=a-n+o),n=Math.min(n,a-1),o=Math.min(o,a-n),h=e;h<e+r;h++){for(l=t[h],u=new L,u.name=t[h].name,c=n;c<n+o;c++)f=l[c],u.push(f);s.push(u.downcast())}return s.downcast()},sliceColumns=function(t,e,n){return"string"==typeof e&&(e=t.getNames().indexOf(e)),null!=n&&"string"==typeof n&&(n=t.getNames().indexOf(n)),t.getSubList(e,n)},filterTable=function(t,e,n,r,o,i,s,l,a){if(null==t||0===t.length||null==t[0])return;if(t.isList&&!t.isTable){var u=new T;u.push(t),t=u}if(a)return t.getElements(filterList(t.getNames(),e,n,r,o,!0));if(void 0===e&&void 0===n)return s?createSortedNumberList(t[0].length):t;if("!contains"===e&&(void 0===n||""===n))return s?createSortedNumberList(t[0].length):t;null==e&&(e="=c"),"="==e&&(e="=="),e=e.toLowerCase();var h=new nL;let c,f,p,g,d,m,y=t.getLengths().getMax(),x=0,w=t.length,L=_typeOf(n),v=null!=r&&!0===r.isList;if(null!=n&&1==n.isList&&n.length>0){var b;l=null==l?0:l,h=filterTable(t,e,n[0],r,o,i,!0);for(var _=1;_<n.length;_++)p=n[_],b=filterTable(t,e,p,r,o,i,!0),h=1==l?intersection(h,b):union(h,b);return s?h:t.getRows(h)}if(v&&r.length!=y)throw new Error("selected L (in listToCheck position) must have same length as table");if(null!=r&&("string"==typeof r&&(r=t.getNames().indexOf(r)),-1==r))throw new Error("do not find any list with such name");null==n?(L="Null",n=""):"string"==L&&String(n)==String(Number(n))&&""!==n.trim()?(L="number",n=Number(n)):"boolean"==L&&(L="string",n=String(n)),"=c"==e&&(e="string"==L?"contains":"=="),"number"!=L||"between"!=e&&"!between"!=e||(isNaN(o)?e="noop":o=Number(o)),"between"!=e&&"!between"!=e||null!=o||(e="noop"),"fuzzy"!=e&&"fuzzywords"!=e||null!=o||(o=50),null!=r&&(x=r,w=r+1),v&&(x=0,w=1),(null==i||!0!==i&&!1!==i)&&(i=!0),"string"==L&&i&&(n=n.toLowerCase(),o=o?String(o).toLowerCase():o),"=="==e&&i&&(e="==i"),"!="==e&&i&&(e="!=i");var M=String(n);null==o||String(o);var S="string"==L;let N="number"==L;var R;switch(e){case"==":for(c=0;c<y;c++)for(f=x;f<w;f++)if(!("nL"==(R=v?r:t[f]).type&&S||"sL"==R.type&&N)&&(g=R[c],null==g&&(g=""),g==n)){h.push(c);break}break;case"==i":for(c=0;c<y;c++)for(f=x;f<w;f++)if(("nL"!=(R=v?r:t[f]).type||!S)&&(p=null==R[c]?"":R[c],p="sL"==R.type?p:String(p),p=i?p.toLowerCase():p,p==n)){h.push(c);break}break;case"!=":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:t[f][c],null==g&&(g=""),g==n){d=!1;break}d&&h.push(c)}break;case"!=i":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:t[f][c],p=null==g?"":String(g).toLowerCase(),p==n){d=!1;break}d&&h.push(c)}break;case"contains":for(c=0;c<y;c++)for(f=x;f<w;f++)if(("nL"!=(R=v?r:t[f]).type||!S)&&(p="sL"==R.type?R[c]:String(R[c]),p=i?p.toLowerCase():p,p.includes(M))){h.push(c);break}break;case"!contains":for(c=0;c<y;c++){for(d=!0,f=x;f<w;f++)if(g=v?r[c]:t[f][c],p=i?String(g).toLowerCase():String(g),p.includes(M)){d=!1;break}d&&h.push(c)}break;case"init":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:t[f][c],p=i?String(g).toLowerCase():String(g),0===p.indexOf(M)){h.push(c);break}break;case"<":case"<=":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:t[f][c],L==_typeOf(g)){if(p="string"==L?i?String(g).toLowerCase():String(g):Number(g),p<n){h.push(c);break}if(p==n&&"<="==e){h.push(c);break}}break;case">":case">=":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:t[f][c],L==_typeOf(g)){if(p="string"==L?i?String(g).toLowerCase():String(g):Number(g),p>n){h.push(c);break}if(p==n&&">="==e){h.push(c);break}}break;case"between":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:t[f][c],p="string"==L?i?String(g).toLowerCase():String(g):Number(g),"number"==L&&(p=Number(p)),n<=p&&p<=o){h.push(c);break}break;case"!between":for(c=0;c<y;c++)for(f=x;f<w;f++)if(g=v?r[c]:t[f][c],p="string"==L?i?String(g).toLowerCase():String(g):Number(g),"number"==L&&(p=Number(p)),n>p||p>o){h.push(c);break}break;case"unique":var E={};for(c=0;c<y;c++){var O="";for(f=x;f<w;f++)g=v?r[c]:t[f][c],p=i?String(g).toLowerCase():String(g),O=O+"|"+p;null==E[O]&&(E[O]=!0,h.push(c))}break;case"fuzzy":case"fuzzywords":if(""==(n=String(n).trim()))break;o=Number(o);var C,D,P,I=new nT(2);for(c=0;c<y;c++)for(f=x;f<w;f++){for(g=v?r[c]:t[f][c],p=i?String(g).toLowerCase():String(g),C="fuzzywords"==e?p.split(" "):[p],D=0,P=0;P<C.length&&D<o;P++)m=100*(1-getLevenshteinDistance(C[P],n,!0)),D=Math.max(D,m);if(D>=o){I[0].push(c),I[1].push(D);break}}h=(I=I.sortRowsByList(1,!1,!0))[0];break;default:if("function"==typeof e)for(c=0;c<y;c++)for(f=x;f<w;f++)if(e.call(this,t[f][c],n,o,r,t,f,c,i)){h.push(c);break}}if(s)return h;var k=new T;k.name=t.name;let F=t.length;for(f=0;f<F;f++)k.push(t[f].getElements(h,!0));return k.downcast()},filterColumns=function(t,e,n,r,o,i){if(null==t)return;let s=new T;for(var l,a,u=0;u<t.length;u++)if(l=t[u],a=buildInformationObjectForList(l,!0),!(null!=e&&a.numberDifferentElements<e||null!=n&&a.numberDifferentElements/l.length>n||null!=r&&a.entropy<r||null!=o&&a.entropy>o)){switch(i){case 0:if(!a.isNumeric)continue;break;case 1:if("sL"!=l.type)continue;break;case 2:if(!a.isCategorical)continue;break;case 3:if("integer numbers"!=a.kind)continue;break;case 4:if(a.containsNulls)continue;break;case 5:if(l.includes("")||l.includes(" ")||l.includes("  "))continue;break;case 6:if("nL"!=l.type&&!a.isCategorical)continue}s.push(l)}return s.downcast()},getSubTableByElementOnList=function(t,e,n){if(null==t||null==e||null==n)return;var r,o;let i=t.length;e<0&&(e=i+e),e%=i;var s=instanceSameType(t);for(s.name=t.name,r=0;r<i;r++){var l=new L;l.name=t[r].name,s.push(l)}var a=t[e];let u,h=a.length;for(r=0;r<h;r++)if(n==a[r])for(u=s.length,o=0;o<u;o++)s[o].push(t[o][r]);for(i=s.length,r=0;r<i;r++)s[r]=s[r].downcast();return s.downcast()},getSubTableByElementsOnList=function(t,e,n){if(null!=t&&null!=e&&null!=n){var r,o;e<0&&(e=t.length+e),e%=t.length;var i=instanceSameType(t);i.name=t.name,t.forEach((function(t){var e=new L;e.name=t.name,i.push(e)}));var s=t[e],l=getBooleanDictionaryForList(n);for(r=0;null!=s[r];r++)if(l[s[r]])for(o=0;null!=i[o];o++)i[o].push(t[o][r]);return i.forEach((function(t,e){i[e]=t.downcast()})),i.downcast()}},getRandomRows=function(t,e,n,r,o){if(null==t||null==t[0])return null;if(n=null==n||n,null==e&&(e=.5),e<0)return null;let i,s=t[0].length;i=e<=1?Math.round(e*s):Math.round(e);let l=createSortedNumberList(s,0,1);return l=l.getRandomElements(i,n,o),r||(l=l.getSorted()),t.getRows(l)},transpose=function(t,e,n){return null!=t&&t.isTable?t.transpose(e,n):null},replaceElementInTable=function(t,e,n){if(null==t)return;var r=t.length;let o,i,s,l,a;var u=new T;for(i=0;i<r;i++){for(l=t[i],o=l.length,a=new L,u[i]=a,s=0;s<o;s++)a[s]=l[s]==e?n:l[s];a=a.downcast(),a.name=l.name}return u.downcast()},replaceSectionInTable=function(t,e,n,r,o,i){if(null==t)return;var s=null!=n&&n==r;let l,a,u,h=null!=o&&o==i;if(null==n&&(n=0),null==r&&(r=t.length-1),null==o&&(o=0),null==i&&(i=t[0].length-1),"string"!=typeof n&&"string"!=typeof r||(l=t.getNames()),"string"==typeof n&&(n=l.indexOf(n)),"string"==typeof r&&(r=l.indexOf(r)),s&&h)return e.isList&&(e=e[0]),e.isList&&(e=e[0]),replaceCellInTable(t,e,n,o);if(s){var c=new T;for(e.isTable&&(e=e[0]),a=0;a<t.length;a++)if(a==n){for(c[a]=new L,c[a].name=t[a].name,u=0;u<t[a].length;u++)c[a][u]=u<o||u>i?t[a][u]:e[u-o];c[a]=c[a].downcast()}else c[a]=t[a];return c.downcast()}if(h){for(c=new T,e.isTable&&(e=e.getRow(0)),a=0;a<t.length;a++)a<n||a>r?c[a]=t[a]:(c[a]=t[a].clone(),c[a][o]=e[a-n],c[a]=c[a].downcast());return c.downcast()}for(c=new T,r=Math.min(r,n+e.length),i=Math.min(i,o+e[0].length),a=0;a<t.length;a++)if(a<n||a>r)c[a]=t[a];else{for(c[a]=new L,c[a].name=t[a].name,u=0;u<t[a].length;u++)c[a][u]=u<o||u>i?t[a][u]:e[a-n][u-o];c[a]=c[a].downcast()}return c.downcast()},replaceNullsInTable=function(t,e,n,r,o,i){if(null==t)return;null!=r&&(e=null==e?0:e),null!=o&&(n=null==n?0:n),r=null==r&&null!=e?0:r,o=null==o&&null!=n?"-":o;var s=t.length;let l,a,u,h,c,f,p;var g=null!=e&&e.length&&e.isList?e:null;let d=null!=o&&o.length&&o.isList?o:null;var m=new T;if(g){s=Math.min(s,g.length);var y={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,element:0,previous:1,next:2,average:3,"local average":4,interpolate:5,common:6,median:7}}for(a=0;a<s;a++){for(h=t[a],l=h.length,f=!1,p=!1,u=0;u<l;u++)if(h[u]==i)p=!0;else if("number"!=typeof h[u]&&(f=!0,p))break;p?(c=g?replaceNullsInList(h,y[g[a]],d?d[a%s]:o,i):f?replaceNullsInList(h,3==n?6:n,o,i):replaceNullsInList(h,e,r,i),m[a]=c):m[a]=h}return m.downcast()},testClassificationModel=function(t,e,n,r){if(null==t||null==e||null==n)return null;r=r||0;var o=0;return e.forEach((function(e,r){n(t[0][r],t[1][r])!=e&&o++})),o/e.length},getRows=function(t,e){let n,r,o=new T;o.name=t.name;for(var i=0;null!=t[i];i++){n=t[i],r=instanceSameType(n),r.name=n.name;for(var s=0;null!=e[s];s++)r[s]=n[e[s]];o[i]=r.downcast()}return o},sortListsByNumberList=function(t,e,n){null==n&&(n=!0);var r=instantiate(_typeOf(t));r.name=t.name;let o,i=t.length,s=e.clone();for(o=0;o<s.length;o++)s[o]=o;for(s=sortListByNumberList(s,e,n),o=0;o<i;o++){r[o]=t[o].clone();for(var l=0;l<s.length;l++)r[o][l]=t[o][s[l]]}return r},aggregateTable=function(t,e,n,r,o,i,s,l){if(e=e||0,null==t)return;if(null==n&&(n=createSortedNumberList(t.length)),null==r&&(r=createListWithSameElement(t.length,9)),"sL"==n.type&&(n=t.getNames().indexesOfElements(n)),"nL"!=n.type&&Array.isArray(n)&&(n=nL.toL(n)),"string"==typeof e&&(e=t.getNames().indexOf(e)),!t.length||t.length<e||null==n||!n.length||null==r)return;if(null!=s&&3==s.length){var a;n=n.clone(),r=r.clone();for(var u=0;u<t.length;u++)n.includes(u)||(n.push(u),(a=buildInformationObjectForList(t[u])).isNumericCategorical?r.push(s[0]):a.isNumeric?r.push(s[1]):r.push(s[2]))}if(null!=e.length)if(e.length==t[0].length)y=e;else{if(0!=e.length){var h,c,f=t.getColumns(e),p=(f.getTypes(),new sL);for(_=f[0].length,u=0;u<_;u++){for(h=f[0][u],c=1;c<f.length;c++)h+="*__*"+f[c][u];p[u]=h}b=new T.toL([p].concat(t.getElements(n)));var g=new nL,d=new nL;g[0]=0,d[0]=0,null!=o&&(o=o.clone()).unshift("_");for(u=0;u<n.length;u++)g.push(n[u]+1),d.push(r[u]);var m=createSortedNumberList(b.length-1,1);return b=aggregateTable(b,0,m,d,o),b}e=e[0]}var y=null==y?t[e]:y;let x,w,L,v=getIndexesTable(y),b=new T,_=n.length;for(u=0;u<_;u++)L=n[u],w=t[L],x=aggregateList(y,w,u<r.length?r[u]:1,v,i,l)[1],o&&u<o.length?x.name=o[u]:x.name=w.name,b.push(x);return b.downcast()},disAggregateTable=function(t,e,n,r=","){if(null==t||null==n)return;"number"==typeof e&&(e=[e]);var o=null==e?t:t.getColumns(e);let i=t.get(n);var s=new L;s.name=i.name;let l=new T;for(var a=0;a<o.length;a++)l[a]=instanceSameType(o[a]),l[a].name=o[a].name;var u;for(l.push(s),a=0;a<o[0].length;a++){u=sL.toL(String(i[a]).split(r)).trim();for(var h=0;h<u.length;h++){for(var c=0;c<o.length;c++)l[c].push(o[c][a]);s.push(String(Number(u[h]))==u[h]?Number(u[h]):u[h])}}return s=s.downcast(),l},deSegmentTable=function(t,e,n){for(var r=normalizeToSum(e,(n=null==n?10:n)*e.length),o=new T,i=0;i<t.length;i++)o[i]=instanceSameType(t[i]),o[i].name=t[i].name;var s=new nL;o.push(s),s.name="weight per item";var l,a,u=new nL;o.push(u),u.name="count repetitions segment";for(var h=0;h<r.length;h++){l=Math.round(r[h]),a=e[h];for(var c=0;c<l;c++){for(i=0;i<t.length;i++)o[i].push(t[i][h]);s.push(a/l),u.push(l)}}return o},pivotTable=function(t,e,n,r,o,i,s,l,a){if(null==t||!t.length||null==e||null==n||null==r)return;let u=e.isList?e:t.get(e),h=n.isList?n:t.get(n);switch(r=r.isList?r:t.get(r),o=null==o?1:o,s=s||0,i){case 0:case 3:a=null;break;case 1:a=0}var c;let f,p;var g=new T;let d,m;if(1==s){var y={},x={};switch(u.forEach((function(t,e){c=h[e],f=String(t)+""+String(c),null==y[f]&&(y[f]=new nL,x[f]=new L),y[f].push(e),x[f].push(r[e])})),g[0]=new L,g[1]=new L,o){case 0:g[2]=new L;break;case 1:case 2:case 3:g[2]=new nL}for(f in y)switch(p=y[f],g[0].push(u[p[0]]),g[1].push(h[p[0]]),o){case 0:g[2].push(r[p[0]]);break;case 1:g[2].push(p.length);break;case 2:case 3:d=0,p.forEach((function(t){d+=r[t]})),3==o&&(d/=p.length),g[2].push(d)}if(g[0]=g[0].downcast(),g[1]=g[1].downcast(),0===o)g[2]=g[2].downcast();return g[0].name=u.name,g}g[0]=new L;var w={};let v={};var b,_;let M,S;u.forEach((function(t,e){if(c=h[e],M=r[e],null==(_=w[String(t)])&&(g[0].push(t),_=g[0].length-1,w[String(t)]=_),null==(b=v[String(c)])){switch(o){case 0:case 1:case 2:case 3:case 4:case 5:S=new L}g.push(S),S.name=String(c),b=g.length-1,v[String(c)]=b}switch(o){case 0:null==g[b][_]&&(g[b][_]=M);break;case 1:null==g[b][_]&&(g[b][_]=0),g[b][_]++;break;case 2:null==g[b][_]&&(g[b][_]=0),g[b][_]+=M;break;case 3:null==g[b][_]&&(g[b][_]=[0,0]),g[b][_][0]+=M,g[b][_][1]++;break;case 4:null==g[b][_]&&(g[b][_]=M),g[b][_]=Math.min(M,g[b][_]);break;case 5:null==g[b][_]&&(g[b][_]=M),g[b][_]=Math.max(M,g[b][_])}}));var N=!1;switch(o){case 0:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(t,e){null==g[m][e]&&(g[m][e]=a)})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0);break;case 1:case 2:case 4:case 5:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(t,e){null==g[m][e]&&(g[m][e]=a)})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0);break;case 3:for(m=1;m<g.length;m++)null==g[m]&&(g[m]=new L),g[0].forEach((function(t,e){null==g[m][e]?g[m][e]=a:g[m][e]=g[m][e][0]/g[m][e][1]})),g[m]=g[m].downcast(),"L"==g[m].type&&(N=!0)}if(i&&N&&(g=replaceNullsInTable(g,5)),1==l){var R=g.slice(1),E=g.getNames().getSubList(1);"nL"==h.type&&(E=E.toNumberList()),R=L.toL(R).getSortedByList(E);var O=new T;return O[0]=g[0],g=O.concat(R)}return g[0]=g[0].downcast(),g.downcast()},unpivotTable=function(t,e,n){var r,o=t.get(e),i=t.getColumns(n),s=new T;s[0]=new L,s[0].name=o.name,s[1]=new sL,s[1].name="variables",s[2]=new L,s[2].name="value";for(var l=0;l<o.length;l++){r=o[l];for(var a=0;a<i.length;a++)s[0].push(r),s[1].push(i[a].name),s[2].push(i[a][l])}return s[0]=s[0].downcast(),s[2]=s[2].downcast(),s.downcast()},getCountPairsMatrix=function(t,e,n,r,o){if(null==t||t.length<2||null==t[0]||null==t[0][0])return null;var i,s;if(e=null!=e&&e,n=null==n?0:n,0==(r=null==r?0:r))i=t[0].getWithoutRepetitions(),s=t[1].getWithoutRepetitions(),e&&(i=(i=i.concat(s)).getWithoutRepetitions(),s=i);else if(1==r)if(e){var l=(i=t[0].concat(t[1])).getFrequenciesTable(!0);s=i=l[0]}else{l=t[0].getFrequenciesTable(!0);i=l[0],l=t[1].getFrequenciesTable(!0),s=l[0]}else if(2==r){if(e)l=(l=(i=t[0].concat(t[1])).getFrequenciesTable(!0)).sortRowsByList(0,!0),s=i=l[0];else l=(l=t[0].getFrequenciesTable(!0)).sortRowsByList(0,!0),i=l[0],l=(l=t[1].getFrequenciesTable(!0)).sortRowsByList(0,!0),s=l[0]}if(null!=o&&!isNaN(o)&&o>0){var a=createSortedNumberList(o);i.length>o&&(i=i.getElements(a)),s.length>o&&(s=s.getElements(a))}var u,h,c=new nT(s.length);if(s.forEach((function(t,e){c[e].name=String(t),i.forEach((function(t,n){c[e][n]=0}))})),t[0].forEach((function(e,n){var r=t[1][n];h=s.indexOf(r),-1!=(u=i.indexOf(e))&&-1!=h&&c[h][u]++})),0!=n){for(var f=0,p=0;p<c.length;p++)c[p]._max=c[p].getMax(),f=Math.max(f,c[p]._max);if(1==n&&0!=f)for(p=0;p<c.length;p++)for(var g=0;g<c[p].length;g++)d=(f-c[p][g])/f,c[p][g]=Number(d.toFixed(5));else if(2==n&&0!=f){var d;for(p=0;p<c.length;p++)for(g=0;c[p]._max>0&&g<c[p].length;g++)d=(c[p]._max-c[p][g])/c[p]._max,c[p][g]=Number(d.toFixed(5))}else if(3==n){var m;for(g=0;g<c[0].length;g++){m=0;for(p=0;p<c.length;p++)m+=c[p][g];for(p=0;0!=m&&p<c.length;p++)d=c[p][g]/m,c[p][g]=Number(d.toFixed(5))}}}let y=new T;return i.name=t[0].name,y.push(i),c=y.concat(c)},getPairsFrequencyTable=function(t){if(null==t||t.length<2||null==t[0]||null==t[0][0]||t[0].length!=t[1].length)return null;for(var e={},n=0;n<t[0].length;n++){var r=e[t[0][n]];null==r&&(r={sL:new L,c:0,s:t[0][n]},e[t[0][n]]=r),r.sL.push(t[1][n]),r.c++}var o=[];for(r in e)o.push(e[r]);o=o.sort((function(t,e){var n=e.c-t.c;return 0!=n?n:t.s<e.s?1:-1}));var i,s=new T;for(s[0]=instanceSameType(t[0]),s[0].name=""==t[0].name?"L 1":t[0].name,s[1]=instanceSameType(t[1]),s[1].name=""==t[1].name?"L 2":t[1].name,s[2]=new nL,s[2].name="Combination Frequency",n=0;n<o.length;n++){i=(r=o[n]).sL.getFrequenciesTable(!0);for(var l=0;l<i[0].length;l++)s[0].push(r.s),s[1].push(i[0][l]),s[2].push(i[1][l])}return s},concatenateRowElements=function(t,e){if(null==t||!t.isTable)return null;e=null==e?" ":e;let n,r,o,i=new i,s=t.getLengths().getMax(),l=!0;for(r=0;r<s;r++){for(n="",o=0;o<t.length;o++)o>0&&(n+=e),void 0!==t[o][r]&&(n+=String(t[o][r]),0==r&&(o>0&&(i.name+=e),i.name+=String(t[o].name),l=l&&0==String(t[o].name).length));i.push(n)}return l&&(i.name=""),i},filterTableByElementInList=function(t,e,n,r){if(null==t||t.length<=0||null==e)return;if(null==n)return t;if(r=null==r||r,"string"==typeof e){var o=t.getNames().indexOf(e);if(-1==o)throw new Error("The table doesn't contain a list with name "+e);e=o}var i=new T;let s,l,a=t.length,u=t[0].length;for(i.name=t.name,l=0;l<a;l++)i[l]=instanceSameType(t[l]),i[l].name=t[l].name;if(r){for(s=0;s<u;s++)if(t[e][s]==n)for(l=0;l<a;l++)i[l].push(t[l][s])}else for(s=0;s<u;s++)if(t[e][s]!=n)for(l=0;l<a;l++)i[l].push(t[l][s]);for(l=0;l<a;l++)"nL"!=i[l].type&&(i[l]=i[l].downcast());return i},filterTableByElementsInList=function(t,e,n,r){if(null==t||t.length<=0||null==e)return;if(null==n||0===n.length)return t;if(r=null==r||r,"string"==typeof e){var o=t.getNames().indexOf(e);if(-1==o)throw new Error("The table doesn't contain a list with name "+e);e=o}var i=getBooleanDictionaryForList(n),s=new T;let l,a,u=t.length,h=t[0].length;for(s.name=t.name,a=0;a<u;a++)s[a]=new L,s[a].name=t[a].name;if(r){for(l=0;l<h;l++)if(i[t[e][l]])for(a=0;a<u;a++)s[a].push(t[a][l])}else for(l=0;l<h;l++)if(!i[t[e][l]])for(a=0;a<u;a++)s[a].push(t[a][l]);for(a=0;a<u;a++)s[a]=s[a].downcast();return s},selectRows=function(t,e,n,r,o){if(null==t||t.length<=0)return;if(r=null==r||r,o=null!=o&&o,null==e||null==n||null==e.length)return r?t:null;if(Array.isArray(n)||(n=[n]),e.length!=n.length&&1!=e.length)return;var i=new nL;let s=t[0].length,l=1==e.length&&n.length>1,a={};l&&(a=getBooleanDictionaryForList(n));for(var u=0;u<s;u++){for(var h=!0,c=0;c<e.length&&h;c++){if(isNaN(e[c])||e[c]<0||e[c]>=t.length)return;t[e[c]][u]!=n[c]&&(h=!1,l&&a[t[e[c]][u]]&&(h=!0))}h&&i.push(u)}if(o){if(r)return i;var f=createSortedNumberList(t[0].length);return difference(f,i)}return r?t.getRows(i):t.getWithoutRows(i)},joinTables=function(t,e,n,r,o){if(null==t||null==e)return;var i=new T;let s,l;if(n=null==n?0:n,r=null==r?0:r,2==(o=null==o?0:o)){var a=joinTables(e,t,r,n,1),u=[0];for(let t=e.length;t<a.length;t++)u.push(t);for(let t=1;t<e.length;t++)u.push(t);return a.getColumns(u).downcast()}if("string"==typeof n){if(s=t.get(n),null==s)throw Error("the table doesn't contain a list with name "+n);n=t.indexOf(s)}else n<0&&(n+=t.length),s=t[n%=t.length];if("string"==typeof r){if(l=e.get(r),null==l)throw Error("the table doesn't contain a list with name "+r);r=e.indexOf(l)}else r<0&&(r+=e.length),l=e[r%=e.length];var h=getIndexesDictionary(l),c=t.length;let f=e.length;var p,g=s.length;let d;var m,y,x;let w,v=new L;for(v.name=s.name,i[0]=v,x=0;x<c;x++)x!=n&&(w=new L,w.name=t[x].name,w._list0=!0,w._listOnTable=t[x],i.push(w));for(x=0;x<f;x++)x!=r&&(w=new L,w.name=e[x].name,w._list0=!1,w._listOnTable=e[x],i.push(w));for(m=0;m<g;m++)if(d=h[p=s[m]],null!=d)for(y=0;y<d.length;y++)for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?i[x]._listOnTable[m]:i[x]._listOnTable[d[y]]);else if(1==o||3==o)for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?i[x]._listOnTable[m]:null);if(3==o){var b=getBooleanDictionaryForList(s);for(m=0;m<l.length;m++)if(!b[p=l[m]])for(v.push(p),x=1;x<i.length;x++)i[x].push(i[x]._list0?null:i[x]._listOnTable[m])}for(m=0;m<i.length;m++)delete i[m]._list0,delete i[m]._listOnTable,i[m]=i[m].downcast();return i.downcast()},joinMultipleTables=function(t,e,n){if(null==t||null==e)return;if(t.length<2)throw new Error("listOfTables must have at least two tables");if(e.length!=t.length)throw new Error("listOfIndexes must have same length as listOfTables");if(null==t[0])throw new Error("listOfTables[0] is null");if(null==t[1])throw new Error("listOfTables[1] is null");var r=joinTables(t[0],t[1],e[0],e[1],n);let o,i=t.length;for(o=2;o<i;o++)r=joinTables(r,t[o],0,e[o],n);return r},combineLists=function(t,e){if(null==t)return null;e=null==e||e;var n=new T;let r=new T,o=new nL,i=new nL,s=1;for(var l=0;l<t.length;l++)r[l]=new L,n[l]=t[l].getWithoutRepetitions(),o[l]=0,i[l]=n[l].length,s*=i[l];if(e||s>1e5)return s;for(l=0;l<s;l++){for(var a=0;a<t.length;a++)r[a].push(n[a][o[a]]);var u=!0;for(o[a=0]++,u=o[a]>=i[a];u&&a<t.length;)o[a]=0,o[a+1]++,u=o[++a]>=i[a]}for(a=0;a<t.length;a++)r[a]=r[a].downcast();return r.downcast()},completeTable=function(t,e,n){n=void 0===n?0:n;var r,o=new T;let i,s;o.name=t.name;for(var l=0;l<t.length;l++){for(i=null==(r=t[l])?getNewListForObjectType(n):instanceSameType(r),i.name=null==r?"":r.name,s=0;s<e;s++)i[s]=null==r||null==r[s]?n:r[s];o[l]=i}return o},getNumberTableFromTable=function(t){if(null==t||t.length<=0)return null;var e;let n=new nT;for(n.name=t.name,e=0;null!=t[e];e++)"nL"==t[e].type&&n.push(t[e]);return n},getVariablesInformationGain=function(t,e){if(null==t)return null;var n=new nL;return t.forEach((function(t){n.push(getInformationGain(t,e))})),n},splitTableByCategoricList=function(t,e,n){if(null==t||null==e)return null;var r,o=e.isList?e:t.get(e);let i=new L,s={};return o.forEach((function(e,n){null==(r=s[e])&&((r=new T).name=String(e),s[e]=r,i.push(r),t.forEach((function(t,e){r[e]=instanceSameType(t),r[e].name=t.name})),r._element=e),t.forEach((function(e,o){r[o].push(t[o][n])}))})),n?s:i},buildCorrelationsNetwork=function(t,e,n,r,o,i,s,l,a){if(null==t)return null;let u,h;e=null==e||Boolean(e),o=null==o?.9:o,i=Boolean(i),s=null==s?0:s,a=null==a?3:a;let c,f,p,g,d,m,y,x,w,v,b=t.length,T=t[0].length;var _=!1;let M=!1,S=!1;var N=new Net,R=new sL;let E;var O=e?T:b,C=0;let D=0;for(u=0;u<b;u++)E=t[u].type,"nL"==E?(R[u]="numbers",C++):"sL"==E&&t[u].getWithoutRepetitions().length/t[u].length>.8?(R[u]="texts"):(R[u]="categories",D++);var P;if(null!=r&&(w=r.isList?r:t.get(r),null!=w&&(v="cL"===w.type?w:"nL"===w.type?createColorListFromNumberList(w,blueToRed,0):createCategoricalColorListForList(w)[0].value)),null!=l&&(P=new nL,"number"==_typeOf(l)?l<=b&&"nL"!=(P=t[l]).type&&(P=null):l.isList&&"nL"==l.type&&l.length>=O&&(P=l)),null==n||n.isList||(n=t.get(n)),e){for(u=0;u<T;u++){for(g="_"+u,d=null==n?g:n[u],c=new Nd(g,d),c.i=u,c.row=t.getRow(u),c.numbers=new nL,c.categories=new L,c.texts=new sL,null!=v&&(c.color=v[u]),null!=P&&(c.weight=P[u]),h=0;h<b;h++)switch(R[h]){case"numbers":c.numbers.push(c.row[h]),S=!0;break;case"categories":c.categories.push(c.row[h]),_=!0;break;case"texts":c.texts.push(c.row[h]),M=!0}0===s?c.numbers.sd=c.numbers.getStandardDeviation():c.numbers.norm=c.numbers.getNorm(),N.addNode(c)}var I;for(u=0;u<T;u++){for(c=N.nodes[u],I=new nL,h=0;h<T;h++)2!=s&&h<u+1||(f=N.nodes[h],m=S?0===s?numericCorrelation(c.numbers,f.numbers,c.numbers.sd,f.numbers.sd):cosineSimilarity(c.numbers,f.numbers,c.numbers.norm,f.numbers.norm):0,y=_?2*Math.pow(jaccardIndex(c.categories,f.categories),.2)-1:0,x=S&&_?(m*C+y*D)/(C+D):S?m:y,2==s?I.push(u==h?0:x):(i&&Math.abs(x)>o||!i&&x>o)&&(g=u+"_"+h,d=null==n?g:c.name+"_"+f.name,p=new Rel(g,d,c,f,Math.abs(x)-.9*o),p.color=x>0?"blue":"red",p.pearson=m,p.jaccard=y,N.addRelation(p)));if(2==s){var k=N.nodes.getSortedByList(I,!1);for(I=I.getSorted(!1),h=0;h<a;h++)f=k[h],g=u+"_"+f.id,d=null==n?g:c.name+"_"+f.name,p=new Rel(g,d,c,f,I[h]),N.addRelation(p)}}}else if("nT"==t.type){for(u=0;u<b;u++)c=new Nd("list_"+u,null==t[u].name||""==t[u].name?"list_"+u:t[u].name),N.addNode(c),c.i=u,c.numbers=t[u],null!=v&&(c.color=v[u]),null!=P&&(c.weight=P[u]);for(u=0;u<b;u++)for(c=N.nodes[u],h=u+1;h<b;h++)f=N.nodes[h],m=numericCorrelation(c.numbers,f.numbers),x=m,(i&&Math.abs(x)>o||!i&&x>o)&&(g=u+"_"+h,d=c.name+"_"+f.name,p=new Rel(g,d,c,f,Math.abs(x)-.9*o),p.color=x>0?"blue":"red",p.pearson=m,N.addRelation(p))}return N},buildSimpleDecisionTree=function(t,e,n,r,o,i,s,l){if(null==t||null==e)return;let a,u,h=new T;for(var c=e.isList?e:t.get(e),f=0;f<t.length;f++)t[f]!=c&&(a=buildInformationObjectForList(t[f],!0),a.isCategorical?h.push(t[f]):a.isNumeric&&(u=t[f].getQuantiles(3,3),h.push(u)));return a=buildInformationObjectForList(c,!0),buildDecisionTree(h,c,n,r,o,i,s,l)},buildDecisionTree=function(t,e,n,r,o,i,s,l){if(null==t||null==e)return;if(null==l&&(l=blueWhiteRed),"number"==_typeOf(e)){var a=t.getWithoutElementAtIndex(e);e=t.get(e),t=a}r=null==r?.1:r,o=o||10,i=i||.002;var u=createSortedNumberList(e.length);let h=new Tr;return h.supervisedValue=n,null==n&&(h._colorDic=createCategoricalColorListForList(e)[4].value),_buildDecisionTreeNode(h,t,e,0,r,o,i,null,null,n,u,s,l),h.leavesWeights=h.getLeaves().getPropertyValues("weight"),h.sumWeightsLeaves=h.leavesWeights.getSum(),h.supervised=e,h},_buildDecisionTreeNode=function(t,e,n,r,o,i,s,l,a,u,h,c,f){var p=null==u;if(p){var g=n.getFrequenciesTable(!0);u=g[0][0]}var d=getListEntropy(n,u),m=0;let y=0,x=0;d>=o&&(x=getVariablesInformationGain(e,n),x.forEach((function(t,e){t>m&&(m=t,y=e)})));var w=d>=o&&m>s&&n.length>=i&&r<9&&n._P_valueFollowing>0&&n._P_valueFollowing<1;let L=new Nd(t.nodes.getNewId(),(null==a?"":a+":")+(w?e[y].name:"P="+n._biggestProbability+"("+n._mostRepresentedValue+")"));if(t.addNodeToTree(L,l),null==l&&(t.informationGainTable=new T,t.informationGainTable[0]=e.getNames(),x&&(t.informationGainTable[1]=x.clone(),t.informationGainTable=t.informationGainTable.sortRowsByList(x,!1))),L.entropy=d,L.weight=n.length,L.supervised=n,L.supervisedValue=u,L.indexes=L.indexesOnTable=h,L.value=a,L.fromList=null==l?"":l.bestFeatureName,L.mostRepresentedValue=n._mostRepresentedValue,L.biggestProbability=n._biggestProbability,L.valueFollowingProbability=n._P_valueFollowing,L.lift=L.valueFollowingProbability/t.nodes[0].valueFollowingProbability,L.i=t.nodes.length-1,""==L.fromList)L.filter={};else{if(L.filter={column:L.fromList},L.value&&L.value.includes&&L.value.includes("-")){var v=L.value.split("-");String(Number(v[0]))==v[0]&&String(Number(v[1]))==v[1]&&(L.filter.type="range",L.filter.value=[!0,Number(v[0]),!0,Number(v[1])])}null==L.filter.type&&(L.filter.type="in_array",L.filter.value=[L.value])}L.filters=[];var b=function(t){t.parent&&b(t.parent),t.filter.column&&L.filters.push(t.filter)};if(b(L),p){for(var _=new cL,M=0;M<g[0].length;M++)_[M]=t._colorDic[g[0][M]];L._color=L.color=interpolateColors("white",colorsLinearCombination(_,g[1]),L.valueFollowingProbability)}else L._color=L.color=f(1-L.valueFollowingProbability);if(c){var S=document.createElement("canvas");S.width=150,S.height=100;var N=S.getContext("2d");N.clearRect(0,0,150,100),_decisionTreeGenerateColorsMixture(N,150,100,["blue","red"],L.mostRepresentedValue==u?[Math.floor(L.biggestProbability*L.weight),Math.floor((1-L.biggestProbability)*L.weight)]:[Math.floor((1-L.biggestProbability)*L.weight),Math.floor(L.biggestProbability*L.weight)]);var R=new Image;R.src=S.toDataURL(),L.pattern=N.createPattern(R,"repeat")}if(!w)return L.isLeaf=!0,L.label=Math.floor(100*L.valueFollowingProbability)/100,L;L.isLeaf=!1,L.bestFeatureName=e[y].name,L.bestFeatureName=""===L.bestFeatureName?"list "+y:L.bestFeatureName,L.iBestFeature=y,L.informationGain=m,L.label=L.bestFeatureName;var E=e.concat([n,h]);let O,C,D;return splitTableByCategoricList(E,e[y]).forEach((function(e){O=e.getSubList(0,e.length-3),C=e[e.length-2],D=e[e.length-1],_buildDecisionTreeNode(t,O,C,r+1,o,i,s,L,e._element,p?null:u,D,c,f)})),L.to=L.to.getSortedByProperty("valueFollowingProbability",!1),L},_decisionTreeGenerateColorsMixture=function(t,e,n,r,o){let i,s,l,a=createListWithSameElement(o[0],r[0]);for(l=1;null!=r[l];l++)a=a.concat(createListWithSameElement(o[l],r[l]));for(i=0;i<e;i++)for(s=0;s<n;s++)l=4*(i+s*e),t.fillStyle=a.getRandomElement(),t.fillRect(i,s,1,1)},allListsSameLength=function(t){if(null==t)return null;var e=t.length;let n,r=t[0].length;for(n=1;n<e;n++)if(t[n].length!=r)return!1;return!0},getListsWithoutRepetition=function(t){if(null==t)return;var e=t.length;let n,r=new T;for(n=0;n<e;n++)r[n]=t[n].getWithoutRepetitions();return r.downcast()},getNumberOfDifferentElementsOfLists=function(t,e){if(null==t)return;var n=t.length;let r,o=new nL;for(o.name="(proportion)",r=0;r<n;r++)o[r]=t[r].countDifferentElements(),e&&(o[r]/=t[r].length);return o},buildInformationObjectForTable=function(t,e){if(null==t)return;if(1==(e=null==e||e)&&null!=t.infoObject)return t.infoObject;var n=t.length;let r,o,i=999999999999,s=-999999999999,l=0,a=!0;var u={type:t.type,name:t.name,length:n,kind:"mixed",allListsSameLength:!0,allListsSameSize:!0,allListsSameType:!0,allListsSameKind:!0,listsInfoObjects:new L,names:new sL,lengths:new nL,types:new sL,kinds:new sL};for(r=0;r<n;r++)o=buildInformationObjectForList(t[r],e),u.listsInfoObjects[r]=o,o.containsNulls&&(u.containsNulls=!0),u.names[r]=o.name,u.types[r]=o.type,u.kinds[r]=o.kind,u.lengths[r]=o.length,"categories"!=o.kind&&"integer numbers"!=o.kind&&(a=!1),r>0&&(u.lengths[r]!=u.lengths[r-1]&&(u.allListsSameLength=!1),u.types[r]!=u.types[r-1]&&(u.allListsSameType=!1),u.kinds[r]!=u.kinds[r-1]&&(u.allListsSameKind=!1),u.lengths[r]!=u.lengths[r-1]&&(u.allListsSameType=!1)),"nL"==o.type&&(i=Math.min(i,o.min),s=Math.min(s,o.max),l+=o.average);if(0!==l&&(l/=u.length),u.allListsSameLength)u.minLength=u.lengths[0],u.maxLength=u.lengths[0],u.averageLength=u.lengths[0];else{var h=u.lengths.getInterval();u.minLength=h.x,u.maxLength=h.y,u.averageLength=.5*(h.x+h.y)}if(u.allListsSameKind)switch(u.kinds[0]){case"numbers":u.kind="numbers";break;case"integer numbers":u.kind="integer numbers";break;case"texts":u.kind="texts";break;case"categories":u.kind="categories"}else a?u.kind="integers and categories":u.allListsSameType&&"nL"==u.types[0]&&(u.kind="numbers");return t.infoObject=u,u},getCategoricalLists=function(t){buildInformationObjectForTable(t);for(var e=new T,n=0;n<t.length;n++)t[n].infoObject.isCategorical&&e.push(t[n]);return e.downcast()},getTableSimplified=function(t,e,n,r){if(null==t||!(t.length>0))return null;let o;e=e||20;let i=t.length,s=new T;for(s.name=t.name,o=0;o<i;o++)s.push("nL"===t[o].type?t[o].getNumbersSimplified(1==r?6:2,e):t[o].getSimplified(e,n));return s.downcast()},concatTables=function(t,e){if(null!=t&&null!=e&&t.length==e.length){for(var n=new T,r=0;r<t.length;r++)n[r]=t[r].concat(e[r]),n[r].name=t[r].name;return n.downcast()}},concatRows=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var t,e,n,r,o;let i=0;for(t=0;t<arguments.length;t++)if(null!=arguments[t]&&(i=Math.max(i,arguments[t].length),!arguments[t].isTable))return null;for(t=0;t<arguments.length;t++)if(null!=arguments[t]){var s=(n=arguments[t]).getLengths(),l=s.getMax(),a=s.getMin();for(l!=a&&(n=completeTable(n,l,null));n.length<i;)n.push(createListWithSameElement(l,null,""));if(0==t)r=n.clone();else for(e=0;e<r.length;e++)o=r[e].name,r[e]=r[e].concat(n[e]),r[e].name=""!=o?o:n[e].name}return r},concatLists=function(t){if(null!=t){for(var e=t[0],n=1;n<t.length;n++)e=e.concat(t[n]);return e}},unionListsFromTables=function(t){if(null==t)return;var e=t[0].getWithoutRepetitions();let n,r,o,i=t.length;for(n=1;n<i;n++)for(o=t[n].length,r=0;r<o;r++)e.includes(t[n][r])||e.push(t[n][r]);return e},intersectListsFromTables=function(t){if(null==t)return;var e=t[0].getWithoutRepetitions();let n,r=t.length;for(n=1;n<r;n++)e=intersection(e,t[n]);return e},encodeStringLists=function(t,e,n,r){if(null==t)return;e=null==e?0:e,n=null==n?20:n,r=null==r||r;var o=new T;let i,s,l,a,u;for(buildInformationObjectForTable(t,!0),i=0;i<t.length;i++)if(a=!1,u=t[i],"nL"!=u.type){if("sL"!=u.type&&(u=u.toStringList(),buildInformationObjectForList(u)),u.infoObject.numberDifferentElements<2||u.infoObject.numberDifferentElements>n)a=!0;else{for(l=encodeStringsAsNumericFeatures(u,e),s=0;s<l.length;s++)l[s].name=u.name+":"+l[s].name;o=concat(o,l)}a&&!r&&o.push(u.clone())}else o.push(u.clone());return o},translateListsWithDictionary=function(t,e,n,r){if(null!=t&&null!=e){for(var o=new T,i=0;i<t.length;i++)o[i]=mapWithTable(t[i],e,n,r);return o.downcast()}},getModes=function(t,e=!0){if(null==t)return;e||(t=t.transpose());let n=toL(t.map((t=>t.getMode()))).downcast();return n.name="mode",n},getSubTables=function(t,e){if(null==t)return;let n=new L;n.name="subtables";for(var r=0;r<e.length;r++)n.push(t.getColumns(e[r]));return n},mapFunctionOnLists=function(t,e,n,r,o,i,s,l,a){if(null==t)return;let u=new L,h=t.length;for(var c=0;c<h;c++)u.push(mapWithFunction(t[c],e,n,r,null,o,i,s,l,a));return u.downcast()},mapFunctionsOnLists=function(t,e,n,r,o,i,s,l,a){if(null==t)return;let u=new L,h=Math.min(t.length,e.length);for(var c=0;c<h;c++)u.push(mapWithFunction(t[c],e[c],n,r,null,o,i,s,l,a));return u.downcast()},useVariablesDictionary=function(t,e){if(null!=t&&null!=e){for(var n=e.get("name",null,null,!0)||e[0],r=e.get("label",null,null,!0)||e[1],o=e.get("description",null,null,!0)||e[2],i=e.get("category",null,null,!0)||e[3],s=e.get("relevance",null,null,!0)||e[4],l=t.getNames(),a=(getFirstOccurrenceDictionaryForList(l),getFirstOccurrenceDictionaryForList(n)),u=(l.length,0);u<t.length;u++){var h=a[t[u].name];null!=h&&(t[u].label=r[h],t[u].description=o[h],t[u].category=i[h],t[u].relevance=s[h])}return t}},matrixToTwoColumns=function(t){var e=new T;e[0]=new sL,e[0].name=t[0].name,e[1]=new sL,e[1].name="related with";for(var n=1;n<t.length;n++)for(var r=0;r<t[0].length;r++)for(var o=0;o<t[n][r];o++)e[0].push(String(t[0][r])),e[1].push(t[n].name);return e},_preserveOrder=function(t,e){let n=e.getNames(),r=t.getNames().getWithoutElements(n);return t.getColumns(n.concat(r))},concatStrings=function(t,e){return null==e&&(e=""),sL.toL(t.join(e))},join=function(t,e="",n="",r="",o){if(null!=t)return o&&(e="\n"),n+t.join(e)+r},cleanTexts=function(t,e,n,r,o,i,s,l,a){if(null==t)return null;var u=new sL;u.name=t.name;for(var h=0;h<t.length;h++)u[h]=cleanText(t[h],e,n,r,o,i,s,l,a);return u},filterStringListByString=function(t,e,n,r){if(null==t||null==e)return null;var o;let i,s=r?new nL:new sL,l=t.length;for(n&&(i=new RegExp("\\b"+e+"\\b")),o=0;o<l;o++)n?t[o].match(i).length>0&&s.push(r?o:t[o]):-1!=t[o].indexOf(e)&&s.push(r?o:t[o]);return s},replaceStringsInTexts=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;let o,i,s=t.length,l=e.length;for(o=0;o<s;o++)if(r[o]=t[o],null!=r[o])for(i=0;i<l;i++)r[o]=replaceStringInText(r[o],e[i],n);return r},replaceStringInTexts=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;let o,i=t.length;for(o=0;o<i;o++)r[o]=null==t[o]?null:replaceStringInText(t[o],e,n);return r},replaceStringsInTextsByStrings=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;let o,i,s=t.length,l=e.length;for(o=0;o<s;o++)if(r[o]=t[o],null!=r[o])for(i=0;i<l;i++)r[o]=replaceStringInText(r[o],e[i],n[i]);return r},countStringsOccurrencesOnTexts=function(t,e,n){if(null==t||null==e)return null;let r=new nT;var o;let i,s,l,a,u=t.length,h=e.length;for(o=0;o<u;o++){for(s=t[o],a=new RegExp("\\b"+s+"\\b"),l=new nL,l.name=s,i=0;i<h;i++)l[i]=n?countRegexOccurrences(e[i],a):countOccurrences(e[i],s);r[o]=l}return r},getWordsInTextsOccurrencesTable=function(t,e,n=1,r,o=500,i=1e3,s,l=3,a,u=0,h){if(null==t)return;var c,f;let p,g=t.length;1==n&&(n=StringOperators_STOP_WORDS);let d,m=1==e,y=2==e||3==e||4==e;s=s||!0;let x,w={};for(c=0;c<g;c++)for(d=getWordsOccurrencesTable(t[c],n,r,o,l,h),f=0;f<d[0].length;f++)x=w[d[0][f]],null==x&&(x=new nT,x.push(new nL),x.push(new nL),w[d[0][f]]=x),x[0].push(c),x[1].push(d[1][f]);let L=new sL;for(var v in w)w.hasOwnProperty(v)&&(w[v][0].length<u*g?delete w[v]:L.push(v));for(p=createUniformTable(g+1,L.length,0),c=0;c<p.length;c++)0==c?p[c]=createListWithSameElement(L.length,"","words"):p[c].name="text "+(c-1);let b=0;for(var v in w)if(w.hasOwnProperty(v)){for(p[0][b]=v,x=w[v],c=0;c<x[0].length;c++)p[x[0][c]+1][b]+=x[1][c];b++}if(p[0].length>i&&(s=!0),p[0].name="words",y||s||a){var T,_=new nL;_=p[1].clone();var M=createListWithSameElement(p[0].length,0,"idf");for(c=1;c<p.length;c++)for((T=p[c]).name="text "+(c-1),f=0;f<T.length;f++)T[f]>0&&(c>1&&(_[f]+=T[f]),M[f]++);if(y)if(_=createListWithSameElement(p[0].length,0,"total tf-idf"),2==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]/=M[f],_[f]+=T[f];else if(3==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=Math.log(g/M[f]),_[f]+=T[f];else if(4==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=M[f],_[f]+=T[f];a&&(p.push(_),_.name="totals"),s&&(p=p.sortRowsByList(_,!1))}else for(c=1;c<p.length;c++)p[c].name="text "+(c-1);return m&&p.forEach((function(t,e){0!==e&&(p[e]=normalizeToSum(p[e]))})),i>0&&i<p[0].length&&(p=p.sliceRows(0,i-1)),p},createShortTextsNetwork=function(t,e,n,r,o,i,s,l){if(null==t||null==t.length||0===t.length)return;(new Date).getTime();var a=new Net;let u,h,c,f,p,g,d,m=t.join(" *** ").toLowerCase().split(" *** "),y=t.length,x=0;if(null==l||l.isColorList||(l=l.toColorList()),n=n||.2,r=r||0,i){i[0]=i[0].toLowerCase();var w,L=i[1][0]}var v,b;switch(r){case 0:v=function(t){return 1-Math.pow(2*t/(y-1)-1,2)};break;case 1:v=function(t){return 1/(t+1)};break;case 2:v=function(t){return 1-Math.pow(2*Math.pow(t/(y-1),.2)-1,2)};break;default:v=function(t){return 0===t?0:1/t}}for((new Date).getTime(),t.forEach((function(t,n){b=null==s||null==s[n]?"_"+n:s[n],_=new Nd("_"+n,b),a.addNode(_),_.content=t,null!=l&&(_.color=l[n]);var r=getWords(t,!0,e,!1,!1,0,3);for(p=r.length,g=new nL,h=0;null!=r[h];h++){c=r[h];var u=0;m.forEach((function(t,e){n!=e&&(u+=Number(-1!=t.indexOf(c)))})),0!==u?(g[h]=v(u),o&&(g[h]*=1-1/(countOccurrences(m[n],c)+1)),i&&(w=i[0].indexOf(c),g[h]*=-1==w?1:1-Math.pow(i[1][w]/L,.2)),x=Math.max(x,g[h])):(r.splice(h,1),h--)}f=Math.floor(3*Math.log(p+1)),(r=r.getSortedByList(g,!1).slice(0,f)).position={},r.forEach((function(t,e){r.position[t]=e})),g=g.getSorted(!1).slice(0,f),_.wordsTable=new T,_.wordsTable[0]=r,_.wordsTable[1]=g})),(new Date).getTime(),u=0;null!=a.nodes[u+1];u++){var _=a.nodes[u];for(h=u+1;null!=a.nodes[h];h++){var M=a.nodes[h];if(d=0,_.wordsTable[0].forEach((function(t,e){null!=(w=M.wordsTable[0].position[t])&&(d+=_.wordsTable[1][e]*M.wordsTable[1][w])})),d=Math.sqrt(d/x/Math.max(_.wordsTable[0].length,M.wordsTable[0].length)),d>n){var S=new Rel(_.id+"_"+M.id,_.id+"_"+M.id,_,M,d);a.addRelation(S)}}}return a},splitStrings=function(t,e,n,r,o){if(null==t)return null;null==e&&(e=","),null==n&&(n=4),r=null==r||r,o=null==o?"":o;var i=new T;let s,l,a;for(s=0;s<n;s++)i.push(new sL),i[s].name="Level "+(s+1);let u=new nL;for(s=0;s<t.length;s++){var h=splitString(t[s],e);if(null!=h){for(h=h.trim(),l=0;l<n;l++)if(l<h.length?(i[l][s]=h[l],l>=u.length&&u.push(l)):i[l][s]=null,r&&l==n-1&&h.length>n)for(a=l+1;a<h.length;a++)i[l][s]+=e+h[a]}else for(l=0;l<n;l++)i[l][s]=0==l?o:null}return 0==u.length?i=new T:u.length<i.length&&(i=i.getColumns(u)),i},encodeStringsAsNumericFeatures=function(t,e,n,r,o,i){if(null==t)return null;e=null==e?0:e,r=null!=r&&r,o=null!=o&&o,null==i&&(i=3!=e);let s,l,a,u={};"sL"!=t.type&&(t=t.toStringList()),r&&(t=t.toLowerCase()),null==n?s=t.getWithoutRepetitions().getSorted():(s=r?n.toLowerCase():n,s=s.getWithoutRepetitions().getSorted());let h=[];for(var c=0;c<s.length;c++)u[s[c]]=c,h.push(s[c]);let f="";if(o&&(f=""==t.name?"":t.name+":"),l=new nT,0==e||3==e)for(c=0;c<s.length;c++)l.push(new nL),l[c].name=f+s[c];else if(1==e)l.push(new nL),l[0].name=""==t.name?"Code":t.name+" Code";else{var p=(s.length-1>>>0).toString(2).length;for(c=0;c<p;c++)l.push(new nL),l[c].name=f+"Bit "+c}if(0==e||3==e)for(c=0;c<t.length;c++)if(a=u[t[c]],null!=a)for(var g=0;g<l.length;g++)l[g].push(g==a?1:0);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}else if(1==e)for(c=0;c<t.length;c++)if(a=u[t[c]],null!=a)l[0].push(a);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}else for(c=0;c<t.length;c++)if(a=u[t[c]],null!=a){var d=(a>>>0).toString(2),m=l.length-d.length;for(g=0;g<l.length;g++){var y=g-m<0?"0":d.substr(g-m,1);l[g].push(Number(y))}}else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<l.length;g++)l[g].push(0)}return 0==e&&l.length>1&&(l=l.getWithoutElementAtIndex(l.length-1)),l},correlationRatio=function(t,e,n){if(null==e||null==t)return null;if("L"==t.type&&(t=t.toStringList()),"nL"!=e.type)throw new Error("The first list must be a nL");if("sL"!=t.type)throw new Error("The second list must be a sL");if(e.length!=t.length)throw new Error("The two lists must have the same length");0!=(n=null==n?0:n)&&(e=normalizeByZScore(e));var r=new T;r.push(t),r.push(e),r=aggregateTable(r,0,[0,1],[0,7]);let o=e.getVariance()*e.length,i=e.getMean();if(0==o)return 0;let s,l,a=0,u=new e;for(var h=0;h<r[1].length;h++)l=r[1][h].getMean(),u.push(l),s=Math.pow(l-i,2)*r[1][h].length,a+=s;let c=1;if(0!=n){var f=e.getInterval();u=normalizeToInterval(u,f);var p,g=0,d=1/0,m=-1/0;for(h=0;h<u.length;h++)for(var y=h+1;y<u.length;y++)g+=p=Math.abs(u[h]-u[y]),d=Math.min(d,p),m=Math.max(m,p);var x=u.length*(u.length-1)/2;1==n?c=10*d:2==n?c=10*g/x:3==n&&(c=10*m)}return Number((Math.abs(c)*Math.sqrt(a/o)).toFixed(5))},splitByEnter=function(t,e){if(null==t)return null;let n=splitString(t,"\n",null,e);return n.length>1?n:(n=splitString(t,ENTER2,null,e),n.length>1?n:(n=splitString(t,ENTER3,null,e),n.length>1?n:new sL(t)))},replaceStringInText=function(t,e,n){if(null==t||null==e||null==n)return null;if("object"==typeof t)return t;if("[object RegExp]"!=Object.prototype.toString.call(e)){var r=(e=String(e)).match(/\/(.+)\/(.*)/);if(null==r)e=new RegExp(e,"g");else try{e=new RegExp(r[1],r[2])}catch(t){throw t}}return String(t).replace(e,n)},replaceStringsInText=function(t,e,n,r){if(null==t||null==e||null==n)return null;var o=t;let i,s,l=e.length;for(i=0;i<l;i++)s=e[i],r&&"[object RegExp]"!=Object.prototype.toString.call(s)&&(s=new RegExp("\\b"+escapeForRegExp(s)+"\\b","g")),o=replaceStringInText(o,s,Array.isArray(n)?String(n[i]):n);return o},removeTextsBetweenStrings=function(t,e,n,r,o,i){if(null==t||null==e||null==n)return null;var s=function(t){var i=t.indexOf(e),s=t.indexOf(n,i);return-1==i||-1==s?null:t.substr(0,i-(r?e.length:0))+t.substr(s+(o?0:n.length))},l=s(t);l&&(t=l);var a=1;for(i=i>0?i:Number.MAX_SAFE_INTEGER;l&&a<i;)l=s(t=l),a++;return t},getWords=function(t,e=!0,n=!0,r=!0,o=!0,i=0,s=3,l=" "){if(null==t)return null;var a;l=""==l?" ":l;var u=StringOperators_LINK_REGEX;let h,c,f;if("string"!=typeof t&&(t=String(t)),o&&(a=t.match(u)),t=t.toLowerCase().replace(u,""),f=" "==l?t.match(/[A-Za-z_0-9---]+/g):splitString(t,l,null,!0),null==f)return new sL;var p;if(f=sL.toL(f),f=f.getFilteredByFunction((function(t){return""!=t})),o&&null!=a&&(f=f.concat(a))," "==l&&(f=sL.toL(f).replace(/ /g,"")),null!=n){var g=!0;if(!0===n)n=StringOperators_STOP_WORDS,g=!1;else for(g=!1,c=0;c<n.length;c++)if("object"==typeof n[c]){g=!0;break}if(g){p=f.length;var d=n.length;for(h=0;h<p;h++)for(c=0;c<d;c++)if("string"==typeof n[c]){if(n[c]==f[h]){f.splice(h,1),h--,p=f.length;break}}else if(n[c].test(f[h])){f.splice(h,1),h--,p=f.length;break}}else f=f.getWithoutElements(n),p=f.length}if(s>1)for(p=f.length,h=0;h<p;h++)f[h].length<s&&(f.splice(h,1),h--,p=f.length);if(r){if(e)f=f.getFrequenciesTable(!0)[0];else{var m=f.getFrequenciesTable(),y=new sL;for(h=0;h<m[0].length;h++)for(c=0;c<m[1][h];c++)y.push(m[0][h]);f=y}return i>0&&(f=f.splice(0,i)),f}return e&&(f=f.getWithoutRepetitions()),i>0&&(f=f.splice(0,i)),f},getBigrams=function(t,e=!0,n=!0,r=!0,o=3){!0===n&&(n=StringOperators_STOP_WORDS);let i=(t=cleanText(t,!0,!0," ",!0,!0,n,!0,!0)).split(" "),s=new sL,l=i.length-1;for(let t=0;t<l;t++)i[t].length>=o&&i[t+1].length>=o&&s.push(i[t]+" "+i[t+1]);return e&&(s=s.getWithoutRepetitions()),s},substr=function(t,e,n){return null==t?null:(e=e||0,t.substr(e,n))},splitString=function(t,e,n,r){if(null==t)return null;if(null!=n&&!isNaN(n)&&0!=n){var o=t.match(/\w+/g);null==o&&(o=[t]);var i=!0,s=t.length/o.length/2;n>o.length&&(i=!1,s=0);for(var l,a,u,h=new h,c=t;c.length>0;){if(u=Math.max(1,Math.floor(c.length/(n-h.length)-s)),h.length==n-1){h.push(c);break}-1==(a=i?c.substring(u-1).search(/\s/):0)?a=u:a+=u,l=c.substring(0,a),h.push(l),c=c.substring(a)}return r?h.trim():h}return null==e&&(e=","),"string"==typeof e&&(e=e.replace("\\n","\n")),-1==t.indexOf(e)?new h(t):(h=h.toL(t.split(e)),r?h.trim():h)},getFirstTextBetweenStrings=function(t,e,n){if(null==t)return null;let r=t.indexOf(e);if(-1==r)return null;if(""===n||null==n)return t.substr(r+e.length);let o=t.indexOf(n,r+e.length+1);return-1==o?t.substring(r+e.length):t.substr(r+e.length,o-(r+e.length))},getAllTextsBetweenStrings=function(t,e,n){if(-1==t.indexOf(e))return new sL;let r,o,i,s=t.split(e),l=s.length,a=new sL;for(i=1;i<l;i++)r=s[i],n==e?a.push(r):(o=r.indexOf(n),o>=0&&a.push(r.substr(0,o)));return a},textContainsString=function(t,e,n,r){return t=r?e:t.toLowerCase(),e=r?e:e.toLowerCase(),n?t.match(new RegExp("\\b"+e+"\\b")).length>0:-1!=t.indexOf(e)},getParenthesisContents=function(t,e){let n=new sL;for(var r=t,o=getFirstParenthesisContentWithIndexes(t,e),i=0;""!==o.content&&o.index1<r.length-1&&i<t.length;)n.push(o.content),r=r.substr(o.index1+2),o=getFirstParenthesisContentWithIndexes(r,e),i++;return n},getFirstParenthesisContent=function(t,e){return getFirstParenthesisContentWithIndexes(t,e).content},getFirstParenthesisContentWithIndexes=function(t,e){let n=e?"[":"(",r=e?"]":")";var o=e?/\[/g:/\(/g;let i=e?/\]/g:/\)/g;var s=t.indexOf(n);if(-1==s)return{content:"",index0:0,index1:0};var l=t.indexOf(r),a=t.substring(s+1,l),u=a.match(o);let h=a.match(i);var c=(null==u?0:u.length)-(null==h?0:h.length);let f=0;for(;(c>0||-1==l)&&f<t.length;)l=t.indexOf(r,l),a=t.substring(s+1,l+1),l++,u=a.match(o),h=a.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f++;return{content:-1==(l=t.indexOf(r,l))?t.substring(s+1):t.substring(s+1,l),index0:s+1,index1:-1==l?t.length-1:l-1}},placeString=function(t,e,n){return t.substr(0,n)+e+t.substr(n+e.length)},insertString=function(t,e,n){return t.substr(0,n)+e+t.substr(n)},cleanText=function(t,e,n,r,o,i,s,l,a){return null==t?null:t.isList?cleanTexts(t,e,n,r,o,i,s,l,a):(e&&(t=removeEnters(t,r)),n&&(t=removeTabs(t,r)),o&&(t=removePunctuation(t)),i&&(t=t.toLowerCase()),null!=s&&(!0===s&&(s=StringOperators_STOP_WORDS),t=replaceStringsInText(t,s,"",!0)),l&&(t=removeDoubleSpaces(t)),a&&(t=removeAccentsAndDiacritics(t)),t)},removeEnters=function(t,e){return null==t?null:(e=null==e?"":e,t.replace(/(\r|\n)/g,e))},removeTabs=function(t,e){return null==t?null:(e=e||"",t.replace(/\t/g,e))},removePunctuation=function(t,e){return null==t?null:(e=e||"",t.replace(/[:,.;?!\(\)\"\']/gi,e))},removeDoubleSpaces=function(t){if(null==t)return null;let e=t,n=RegExp(/\s\s/g);for(;n.test(e);)e=e.replace(n," ");return e},removeHtmlTags=function(t){let e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText},escapeForRegExp=function(t){return null==t?null:t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},removeLinks=function(t){return(t+=" ").replace(/https*:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g," ").substr(0,t.length-2)},removeQuotes=function(t){return'"'==t.charAt(0)&&(t=t.substr(1)),'"'==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t},removeAccentsAndDiacritics=function(t){let e=t.replace(new RegExp(/[]/g),"a");return e=e.replace(new RegExp(//g),"ae"),e=e.replace(new RegExp(//g),"c"),e=e.replace(new RegExp(/[]/g),"o"),e=e.replace(new RegExp(//g),"oe"),e=e.replace(new RegExp(/[]/g),"u"),e=e.replace(new RegExp(/[]/g),"y"),e=e.replace(new RegExp(/[]/g),"A"),e=e.replace(new RegExp(//g),"AE"),e=e.replace(new RegExp(//g),"c"),e=e.replace(new RegExp(/[]/g),"E"),e=e.replace(new RegExp(/[]/g),"I"),e=e.replace(new RegExp(/[]/g),"e"),e=e.replace(new RegExp(/[]/g),"i"),e=e.replace(new RegExp(//g),"n"),e=e.replace(new RegExp(//g),"N"),e=e.replace(new RegExp(/[]/g),"O"),e=e.replace(new RegExp(//g),"OE"),e=e.replace(new RegExp(/[]/g),"U"),e=e.replace(new RegExp(/[]/g),"Y"),e},getWordsOccurrencesTable=function(t,e,n,r,o,i,s=!1){if(null==t)return;if(0===t.length)return new T(new sL,new nL);1==e&&(e=StringOperators_STOP_WORDS);var l=getWords(t,!1,e,!1,n,null,o,i);let a;return s&&(l=l.concat(getBigrams(t,!1,e,!1,n,null,o))),a=null!=r?l.getFrequenciesTable(!0).sliceRows(0,r-1):l.getFrequenciesTable(!0),a[0].name="Word",a[1].name="Frequency",a},indexesOf=function(t,e,n){let r,o;if(n){var i;for(r=new nL,e=new RegExp("\\b"+e+"\\b"),o=t.search(e),-1!=o&&(t=t.substr(o));-1!=o;)r.push(o),i=o,o=t.search(e),t=t.substr(o+1),o>=0&&(o+=i);return r}if(o=t.indexOf(e),-1==o)return new nL;for(r=new nL(o),o=t.indexOf(e,o+1);-1!=o;)r.push(o),o=t.indexOf(e,o+1);return r},indexesOfString=function(t,e,n){return indexesOf(t,e,n)},repeatString=function(t,e){let n,r="";for(n=0;n<e;n++)r+=t;return r},countStringOccurrences=function(t,e,n){return countOccurrences(t,e,n)},countOccurrences=function(t,e,n){if(n)return countWordOccurrences(t,e);var r=0;let o=t.indexOf(e);for(;-1!=o;)r++,o=t.indexOf(e,o+e.length);return r},countWordOccurrences=function(t,e){let n=new RegExp("\\b"+e+"\\b");return countRegexOccurrences(t,n)},countRegexOccurrences=function(t,e){let n=t.match(e);return null==n?0:n.length},countStringsOccurrences=function(t,e,n){if(null==t||null==e)return;var r;let o=new nL,i=e.length;for(r=0;r<i;r++)o[r]=n?countRegexOccurrences(t,new RegExp("\\b"+e[r]+"\\b")):countOccurrences(t,e[r]);return o},validateEmail=function(t){return StringOperators_MAIL_REGEX.test(t)},validateUrl=function(t){return StringOperators_LINK_REGEX.test(t)},getClosestLevenshtein=function(t,e,n=0){let r=e[0],o=99999;return e.forEach((e=>{let n=getLevenshteinDistance(t,e);n<o&&(o=n,r=e)})),0==n?r:{closest:r,distance:o}},getLevenshteinDistance=function(t,e,n){if(e=null==e?"":e,0===(t=null==t?"":t).length&&0===e.length)return 0;if(0===t.length)return n?1:e.length;if(0===e.length)return n?1:t.length;var r=[];let o,i;for(o=0;o<=e.length;o++)r[o]=[o];for(i=0;i<=t.length;i++)r[0][i]=i;for(o=1;o<=e.length;o++)for(i=1;i<=t.length;i++)e.charAt(o-1)==t.charAt(i-1)?r[o][i]=r[o-1][i-1]:r[o][i]=Math.min(r[o-1][i-1]+1,Math.min(r[o][i-1]+1,r[o-1][i]+1));if(n){var s=r[e.length][t.length]/Math.max(t.length,e.length);return Number(s.toFixed(5))}return r[e.length][t.length]},getNgrams=function(t,e=2,n=2,r,o=0,i=0,s){let l,a,u;n<e&&(n=e),!0===r&&(r=StringOperators_STOP_WORDS),1!=(s=null==s?null==r?1:0:s)&&null==r&&(r=StringOperators_STOP_WORDS),1==s&&(r=null);let h=new sL;if(null==t||"string"!=typeof t)return h;let c=StringOperators_LINK_REGEX,f=(t=t.toLowerCase().replace(c,"")).match(/\w+|[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/g);if(null==f)return h;f=sL.toL(f);var p=/[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/;for(l=0;l<f.length;l++)if(u=f[l],!(r&&-1!=r.indexOf(f[l])||i&&f[l].length<i||1==f[l].length&&f[l].match(p))){for(1==e&&h.push(u),a=l+1;a<f.length&&a<l+n&&(!r||-1==r.indexOf(f[a])||0!=s)&&!(i&&f[a].length<i)&&(1!=f[a].length||!f[a].match(p));a++)if(a>=l+e-1){if(u=u+" "+f[a],2==s&&-1!=r.indexOf(f[a]))continue;if(h.push(u),0!==o&&h.length==o)break}else u=u+" "+f[a];if(0!==o&&h.length==o)break}return h},stringToFunction=function(string){if(null==string)return;var realCode;let myTempraryFunction;if(-1!=string.search(/function\(/))return realCode="myTempraryFunction = "+string,eval(realCode),myTempraryFunction;for(var func,i=0;i<methods.length;i++)if(methods[i].methodName==string){if(methods[i].isPrototype){var funcName=string;func=function(t,e,n,r,o,i,s){return null==t[funcName]?null:t[funcName](e,n,r,o,i,s)}}else func=methods[i].func;break}return null!=func?func:(realCode="myTempraryFunction = function(x){return "+string+"}",eval(realCode),myTempraryFunction)},stringFormat=function(t,e,n,r){if(null==t||null==e||null==n)return null;let o,i;if(r=null==r?0:r,"sL"==t.type||"Array"==_typeOf(t)){var s=new sL;for(s.name=t.name,o=0;o<t.length;o++)s.push(stringFormat(t[o],e,n,r));return s}if(t="string"!=typeof t?String(t):t,e="string"!=typeof e?String(e):e,n="string"!=typeof n?String(n):n,t.length!=e.length){if(0==r)return t;if(1==r)return null;throw new Error("Input string must be same length as the input pattern")}if(new Set(e).size!=e.length)throw new Error("All characters in the input pattern must be unique");var l=n;for(o=0;o<n.length;o++)i=e.indexOf(n[o]),-1!=i&&(l=l.substring(0,o)+t[i]+l.substring(o+1));return l},createListWithSameElement=function(t,e,n){if(null==t)return null;var r,o;switch(Array.isArray(t)&&(t=t.length),_typeOf(e)){case"number":r=new nL;break;case"L":r=new T;break;case"nL":r=new nT;break;case"Rec":r=new recL;break;case"string":r=new sL;break;default:r=new L}for(o=0;o<t;o++)r[o]=e;return null!=n&&(r.name=n),r},createIterationSequence=function(t,e,n){let r=createListWithSameElement(1,e);for(var o=1;o<t;o++)r[o]=n(r[o-1]);return r},createListWithUniqueElements=function(t,e=0,n,r,o=5){let i;var s,l;if(i=""==(n=null==n?"":n)&&1==e?new nL:new sL,null!=r&&(i.name=r),0==e){for(var a=1,u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=u.length;t>Math.pow(h,a);)a++;var c,f=createListWithSameElement(a,0);for(s=0;s<t;s++){for(c="",l=0;l<f.length;l++)c=u[f[l]]+c;for(i.push(n+c),l=0;l<f.length&&(f[l]++,f[l]==h);l++)f[l]=0}}else if(1==e)for(s=0;s<t;s++)""==n?i.push(s+1):i.push(n+(s+1));else if(2==e)for(s=0;s<t;s++)c=StringOperators_WORDLISTS.lorem.getRandomElements(o).join(" "),i.push(c);return i},replaceChomasInTextLine=function(t,e){let n,r,o,i=t.split('"');if(i.length<2)return t;for(e=null==e?",":e,o=new RegExp("\\"+e,"g"),r=0;null!=i[r];r++)n=.5*r!=Math.floor(.5*r),n&&(i[r]=i[r].replace(o,"*CHOMA*"));return t=sL.toL(i).getConcatenated("")},_replaceSpacesInLine=function(t){let e,n,r=t.split('"');if(r.length<2)return t;for(n=0;null!=r[n];n++)e=.5*n!=Math.floor(.5*n),e&&(r[n]=r[n].replace(/ /g,"*SPACE*"));return t=sL.toL(r).getConcatenated('"')},decodeTextNet=function(t){if(null==t)return;if(""===t)return new Net;var e,n;let r,o,i,s,l,a,u,h,c,f,p,g;console.log("\n\n*************////////// decodeTextNet //////////*************");let d,m,y,x,w,L=[],v=[],b=[],T=new Net,_=new sL;T.nodesPropertiesNames=new sL,T.relationsPropertiesNames=new sL,h=t.split(/\n/g),h.forEach((function(t,e){h[e]=t.trim()})),t=h.join("\n");for(var M=0;"\n"==t.charAt(0);)t=t.substr(1),M++;var S,N=t;for(a=N.search(/\n\n./g);-1!=a;)_.push(N.substr(0,a)),N=N.substr(a+2),a=N.search(/\n\n./g);_.push(N),_.forEach((function(t){if(-1==t.indexOf("\n")?(r=t,h=null):(h=t.split(/\n/g),r=h[0]),h&&(h=h.filter((t=>""!=t.trim()))),S=r,"\n"==r||""===r||" "==r||"  "==r);else if(0===r.indexOf("//"))null==b[M]&&(b[M]=[]),b[M].push({type:"comment",iStart:0,iEnd:r.length});else if("relations colors:"==r||"groups colors:"==r||"categories colors:"==r)h&&h.slice(1).forEach((function(t,e){a=t.indexOf(":"),"relations colors:"==S&&-1!=a&&null!=colorStringToRGB(t.split(":")[1])&&(L.push(t),null==b[M+e]&&(b[M+e]=[]),b[M+e].push({type:"relation_color",iStart:0,iEnd:t.length})),"groups colors:"!=S&&"categories colors:"!=S||-1==a||null==colorStringToRGB(t.split(":")[1])||(v.push(t),null==b[M+e]&&(b[M+e]=[]),b[M+e].push({type:"relation_color",iStart:0,iEnd:t.length}))}));else{for(u=99999999,a=r.indexOf(NetworkEncodings_nodeNameSeparators[0]),-1!=a&&(u=a,g=NetworkEncodings_nodeNameSeparators[0]),n=1;n<NetworkEncodings_nodeNameSeparators.length;)a=r.indexOf(NetworkEncodings_nodeNameSeparators[n]),-1!=a&&(u=Math.min(a,u),g=NetworkEncodings_nodeNameSeparators[n]),n++;a=99999999==u?-1:u,l=-1==a?r:r.substr(0,a),l=l.trim(),""!==l&&"---"!=l&&(i=_simplifyForTextNet(l),c=T.nodes.get(i),m=-1==a?r.length:a,null==c?(c=new Nd(i,l),c._nLine=M,T.addNode(c),c.content=-1!=a?r.substr(a+g.length).trim():"",c._lines=h?h.slice(1):new sL,c.position=T.nodes.length-1,c.impact=1,null==b[M]&&(b[M]=[]),b[M].push({type:"node_name",iStart:0,iEnd:m})):(null!=h&&(c._lines=c._lines.concat(h.slice(1))),c.content+=-1!=a?" | "+r.substr(a+g.length).trim():"",null==b[M]&&(b[M]=[]),b[M].push({type:"node_name_repeated",iStart:0,iEnd:m})))}c.content=c._lines.join(" / "),M+=(h?h.length:1)+1}));for(var R=!0;R;){R=!1;t:for(e=0;null!=T.nodes[e];e++)for(c=T.nodes[e],n=0;null!=c._lines[n];n++)if(r=c._lines[n],0===r.indexOf("=")){if(s=_simplifyForTextNet(r.substr(1)),f=T.nodes.get(s),f&&c!=f){R=!0,c._lines=f._lines.concat(f._lines),T.nodes.removeNode(f),T.nodes.ids[f.id]=c;break t}T.nodes.ids[s]=f,c._otherIds||(c._otherIds=[]),c._otherIds.push(s)}}let E=new sL;if(T.nodes.forEach((function(t){M=t._nLine,t._lines.forEach((function(e,r){-1!=e.indexOf("=")||(e.indexOf(":")>0?(o=e.trim(),y=removeAccentsAndDiacritics(o.split(":")[0]).replace(/\s/g,"_"),x=e.split(":")[1].trim(),x==String(Number(x))&&(x=Number(x)),null!=x&&("x"==y&&(y="_x"),"y"==y&&(y="_y"),t[y]=x,"category"==y&&E.pushIfUnique(String(x)),T.nodesPropertiesNames.includes(y)||T.nodesPropertiesNames.push(y))):(o=e,T.nodes.forEach((function(s){if(d=_regexWordForTextNet(s.id),a=o.search(d),-1==a&&s._otherIds)for(n=0;null!=s._otherIds[n]&&(d=_regexWordForTextNet(s._otherIds[n]),a=o.search(d),-1==a);n++);if(-1!=a)if(m=a+o.substr(a).match(d)[0].length,p=T.relations.getFirstRelationBetweenNodes(t,s,!0),null!=p)w=p.node0.name+" "+e,p.content+=" | "+w,null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_repeated_relation",iStart:a,iEnd:m});else{p=T.relations.getFirstRelationBetweenNodes(s,t,!0);var l=e;d=_regexWordForTextNet(t.id),a=l.search(d),-1!=a&&(l=(l=l.substr(a)).replace(d,"").trim()),d=_regexWordForTextNet(s.id),a=l.search(d),l=" "+l.substr(0,a).trim()+" ",i=e,p=new Rel(e,l,t,s),w=p.node0.name+" "+e,0==e.indexOf("- ")?(p.color="red",p.influence=-1):0==e.indexOf("+ ")?(p.color="blue",p.influence=1):p.influence=0,p.content=w,T.addRelation(p),null==b[M+r+1]&&(b[M+r+1]=[]),b[M+r+1].push({type:"node_name_in_relation",iStart:a,iEnd:m})}}))))})),t.positionWeight=Math.pow(T.nodes.length-t.position-1/T.nodes.length,2),t.combinedWeight=t.positionWeight+.1*t.nodes.length})),E.length>0){console.log("categories:",E);let t=createDefaultCategoricalColorList(E.length),e={};E.forEach(((n,r)=>e[n]=interpolateColors(t[r],"white",.8))),T.nodes.forEach((t=>t.color=e[t.category]))}return L.forEach((function(t){a=t.indexOf(":"),t.substr(0,a).split(",").forEach((function(e){var n=t.substr(a+1);T.relations.forEach((function(t){-1!=t.name.indexOf(e)&&(t.color=n)}))}))})),v.forEach((function(t){a=t.indexOf(":"),t.substr(0,a).split(",").forEach((function(e){var n=t.substr(a+1);T.nodes.forEach((function(t){t.group==e&&(t.color=n),t.category==e&&(t.color=n)}))}))})),T.colorSegments=b,T},_simplifyForTextNet=function(t){return("es"==(t=t.toLowerCase()).substr(t.length-2)||"s"==t.charAt(t.length-1))&&(t=t.substr(0,t.length-1)),t.trim()},_regexWordForTextNet=function(t,e){e=null==e||e;try{return new RegExp("(\\b)("+t+"|"+t+"s|"+t+"es)(\\b)",e?"gi":"i")}catch(t){return null}},encodeTextNet=function(t,e,n,r){if(null==t)return;var o="";let i,s;var l;return e=e||", ",n=n||[],r=r||[],t.nodes.forEach((function(t){o+=t.name,t.content&&""!==t.content&&(o+=e+t.content),o+="\n",n.forEach((function(e){null!=t[e]&&(o+=e+":"+String(t[e])+"\n")})),l=new sL,t.toRelations.forEach((function(t){var e=null!=t.content&&""!==t.content||!t.description?t.content:t.description;e&&""!==e?(i=_regexWordForTextNet(t.node1.name),s=e+(null!=i&&-1==e.search(i)?" "+t.node1.name:"")):s="connected with "+t.node1.name,-1==l.indexOf(s)&&(o+=s,o+="\n",l.push(s))})),o+="\n"})),o},modelInfluence=function(t,e,n=1,r=1){if(null==e)return;"string"==typeof e&&(e=t.get(e)),t.nodes.forEach((t=>t.impact=1)),t.relations.forEach((t=>t._impact_hits=0)),e.impact=n;!function(e,n){if(n>15)return;let o,i,s;for(var l=0;l<1e4;l++){let e=t.relations.getRandomElement();if(0==e.influence)continue;let n=e.node0,l=e.node1;i=r*(n.impact-1)**2*(1/(1+.9*e._impact_hits)),o=1+i,s=l.impact,e._impact_hits++,e.influence>0?(n.impact>1?l.impact*=o**2:l.impact/=o,"gras"==n.id&&"otter"==l.id&&console.log("1 grass otter | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",l.impact)):e.influence<0&&(n.impact>1?l.impact/=o:l.impact*=o**2,"gras"==l.id&&"deer"==n.id&&console.log("-1 deer grass | from.impact, impactFactor, prevImpact ---\x3e affected.impact\n",n.impact,o,s,"--\x3e",l.impact)),l.impact=0*l.impact+2/(1+Math.pow(Math.E,-2*(l.impact-1)))*1}}(0,0),t.nodes.forEach((t=>console.log(t.name,t.impact)))},prepareTable=function(t,e){let n=new T;return t.forEach(((t,r)=>{let o;o=e&&e[r]?new e[r]:new L,o.name=t,n.push(o)})),n},NetworkToTable=function(t,e,n,r){if(null==t)return;e=null==e||e,r=null==r?0:r;var o=n?new T:new nT;let i=e?t.nodes.getIds():t.nodes.getNames();var s;i.name="node names",n&&(o[0]=i);let l,a,u=t.nodes.length,h=t.relations.length,c={};var f=n?1:0;for(l=0;l<u;l++)(s=createListWithSameElement(u,0)).name=i[l],o.push(s),c[t.nodes[l].id]=l;for(l=0;l<h;l++)a=t.relations[l],0===r?o[c[a.node0.id]+f][c[a.node1.id]]++:o[c[a.node0.id]+f][c[a.node1.id]]+=a.weight;return o},TableToNetworkPairs=function(t,e,n=0,r=!1,o=0,i,s=","){if(null==t||null==t[0]||null==t[1])return;var l;let a,u,h,c,f,p,g,d,m=new Net;if("nT"==t.type&&t.length>2&&t.length==t[0].length){for(l=t.length,p=0;p<l;p++)h=null==i?null==t[p].name||""==t[p].name?"node_"+p:t[p].name:i[p],h&&(a=new Nd(h,h),m.addNode(a));for(p=0;p<l;p++)for(d=t[p],a=m.nodes[p],g=0;g<l;g++)u=m.nodes[g],d[g]>n&&(f=new Rel(p+"_"+g,p+"_"+g,a,u,d[g]),m.addRelation(f));return m}let y=createSortedNumberList(t[0]);if(y.name="indexes",t[0].join("").includes(s)){let e=toT(t);t.push(y);var x=disAggregateTable(e,e.getWithoutElementAtIndex(0).getNames(),0);x.setNames(e.getNames()),y=x.get("indexes"),t=x=(x=x.getWithoutElement(y)).getColumns(3==x.length?[2,0,1]:[1,0])}if(t[1].join("").includes(s)){let e=toT(t);e.push(y),(x=disAggregateTable(e,e.getWithoutElementAtIndex(1).getNames(),1)).setNames(t.getNames()),y=x.get("indexes"),t=x=(x=x.getWithoutElement(y)).getColumns(3==x.length?[2,0,1]:[1,0])}if(t.length<2)return null;l=null==e?Math.min(t[0].length,t[1].length):Math.min(t[0].length,t[1].length,e.length),null==e&&t.length>2&&"nL"==_typeOf(t[2])&&t[2].length>=l&&(e=t[2]),_typeOf(t[0])==ndL&&(_typeOf(t[1]),NodeList);var w=new ndL;let L;for(p=0;p<l;p++)h=(""+t[0][p]).trim(),c=(""+t[1][p]).trim(),h&&c&&"undefined"!=h&&"undefined"!=c&&(a=m.nodes.get(h),null==a?(a=new Nd(h,h),m.addNode(a),a.color="rgb(255,140,80)",a.kind=t[0].name,a.indexes=new nL):a.weight++,a.indexes.push(y[p]),u=m.nodes.get(c),null==u?(u=new Nd(c,c),m.addNode(u),u.color="rgb(60,180,255)",u.kind=t[1].name,u.indexes=new nL):(u.weight++,"rgb(200,100,0)"==u.color&&(u.color="rgb(100,100,100)")),u.indexes.push(y[p]),null==e?r?(L=h+"_"+c+"_"+p,f=new Rel(L,h+"_"+c,a,u,1),m.addRelation(f)):(L=h+"_"+c+"_",f=w.get(L),null==f||r?(f=new Rel(L,L,a,u,1),w.addNode(f)):f.weight++):e[p]>n&&(f=new Rel(h+"_"+c,h+"_"+c,a,u,e[p]),m.addRelation(f)),i&&(f.content=i[p]));let v=0;if(m.nodes.forEach((t=>{t.indexes=t.indexes.getWithoutRepetitions(),v=Math.max(v,t.weight)})),null==e)if(r)for(p=0;p<w.length;p++)m.addRelation(w[p]);else for(p=0;p<w.length;p++)w[p].weight>n&&m.addRelation(w[p]);if(0)for(p=0;null!=m.nodes[p];p++)m.nodes[p].relations.length<0&&(m.removeNode(m.nodes[p]),p--);return m.nodes.forEach((t=>t.weight/=v)),v=0,m.relations.forEach((t=>{v=Math.max(v,t.weight)})),m.relations.forEach((t=>t.weight/=v)),m},matrixToNetwork=function(t){let e,n,r,o,i=new Net;for(var s=1;s<t.length;s++){e=i.get(t[s].name),null==e&&(e=new Nd(t[s].name,t[s].name),i.addNode(e));for(var l=0;l<t[0].length;l++)t[s][l]>0&&(o=String(t[0][l]),n=i.get(o),null==n&&(n=new Nd(o,o),i.addNode(n)),o=s-1+"_"+l,r=new Rel(o,e.name+"_"+n.name,e,n,t[s][l]),i.addRelation(r))}return i},CSVToTable=function(t,e=!0,n,r,o,i){if(null==t)return null;if(o=null!=o&&o,-1==t.indexOf("\n")&&-1==t.indexOf(",")&&-1==t.indexOf(";"))throw 0===t.indexOf("http:/")||0===t.indexOf("https:/")||0===t.indexOf("fttp:/")||0===t.indexOf("fttps:/")?new Error("The provided string seems to be a url, not a csv<br><br>Use <b>CSVLoader</b> to upload and decode csv files"):new Error("the provided string doesn't seem to be a csv, it contains no enters or chomas");var s,l=2==e;if(l&&(e=!0),null==t)return null;if(""===t)return new T;var a=(t=t.replace(/\$/g,"")).split('"');for(C=1;null!=a[C];C+=2)a[C]=a[C].replace(/\n|\r/g,"*ENTER*");var u=(t=a.join('"')).split(/\n|\r/g);if(1==u.length&&e)throw new Error("CSV contains only one line and firstRowIsHeader is true, a T can't be build");if("auto"==n){var h,c,f=[",",";",":","|","\t","+","-","_"],p=u.slice(0,11).join("\n"),g=0,d=",";for(C=0;C<f.length;C++){try{h=CSVToTable(p,e,f[C])}catch(t){h=null}if(null!=h&&0!=h.length){if(buildInformationObjectForTable(h),c=h.length,e)c-=h.getNames().getElementNumberOfOccurrences("");var m=h.reduce((function(t,e){return t+e.getElementNumberOfOccurrences(null)}),0),y=h.reduce((function(t,e){return t+e.length}),0);c-=0==y?0:m/y,h.infoObject.allListsSameLength||c--,c>g&&(g=c,d=f[C])}}n=d}"\\t"!=(n=null==n||""===n?",":n)&&"tab"!=n||(n="\t");var x=new T;let w=n;if(null==t||""===t||" "==t||0===u.length)return null;var v=0;let b;if(e)if(v=1,l)for(b=replaceChomasInTextLine(u[0],n).split(","),C=0;C<b.length;C++)b[C]=b[C].replace("*CHOMA*",n);else b=u[0].split(w);var _;let M,S,N;var R;for(C=0,R=v;R<u.length;R++)if(!(u[R].length<2)){for(N=replaceChomasInTextLine(u[R],n).split(w),s=0;s<N.length;s++)x[s]=null==x[s]?new L:x[s],e&&0===C&&(x[s].name=(null==b[s]?"":_removeQuotes(b[s])).trim()),M=N[s].replace(/\*CHOMA\*/g,n).replace(/\*ENTER\*/g,"\n"),M=""===M?r:M,null!=M?(M=String(M),S=Number(M.replace(",",".")),"string"==typeof(_=S||0===S&&""!==M?S:M)&&(_=_removeQuotes(_))):_=null,x[s][C]=_;C++}for(C=0;null!=x[C];C++)x[C]=x[C].downcast(),o&&"L"==x[C].type&&(x[C]=toStringList(x[C]));if((x=x.downcast()).name=i,l){for(var E=!0,O=0,C=0;C<x.length;C++)if("nL"==x[C].type&&(O++,String(Number(x[C].name))!=Number(x[C].name))){E=!1;break}if(!E)return x;var D=0,P=0;for(C=0;C<x.length;C++){if("nL"!=x[C].type)if(P++,x[C].includes(x[C].name))D++;else x[C].getWithoutRepetitions().length==x[C].length&&D++}if(P>0&&(D+O)/x.length>.3)for(C=0;C<x.length;C++)x[C].unshift(x[C].name),x[C].name="col "+C}return x},_removeQuotes=function(t){return 0===t.length||'"'!=t.charAt(0)&&"'"!=t.charAt(0)||'"'!=t.charAt(t.length-1)&&"'"!=t.charAt(t.length-1)||(t=t.substr(1,t.length-2)),t},TableToCSV=function(t,e=",",n=!0,r,o){if(null==t)return;let i,s,l,a,u,h=createListWithSameElement(t[0].length,"");for(i=0;null!=t[i];i++)for(l=t[i],a=l.type,u=i!=t.length-1,s=0;s<l.length;s++){if(null!==l[s])if("nL"===a)h[s]+=l[s];else h[s]+=null!=r?String(l[s]).replace(/,/g,r):'"'+l[s]+'"';u&&(h[s]+=e)}var c="";if(n){for(i=0;null!=t[i];i++)l=t[i],c+=null!=r?l.name.replace(/,/g,r):'"'+l.name+'"',i!=t.length-1&&(c+=e);c+="\n"}return(o?t.getTypes().join(e)+"\n":"")+c+h.getConcatenated("\n")},TableToJSONString=function(t,e){if(null==t)return"";let n=t.slice(0),r=t.getNames(),o=t.getTypes(),i=[];for(var s=0;s<t.length;s++)void 0===t[s].containsNulls?i.push(null):i.push(t[s].containsNulls);let l={data:n,name:t.name,type:t.type,handle:t.handle,names:r,types:o,nulls:i};if(void 0!==t.containsNulls&&(l.containsNulls=t.containsNulls),e)return l;try{return JSON.stringify(l)}catch(t){return JSON.stringify({error:"cannot convert."})}},JSONStringToTable=function(t){if(null==t||0==t.length)return new T;let e,n,r;if("object"==typeof t)e=t;else try{e=JSON.parse(t)}catch(t){return null}if(r="nT"==e.type?nT.toL(e.data):T.toL(e.data),r.name=null==e.name?e.name:String(e.name),r.type=e.type,null!=e.handle&&(r.handle=e.handle),null!=e.containsNulls&&(r.containsNulls=e.containsNulls),e.types&&e.types.length>0){for(n=0;n<e.types.length;n++)if(r[n])switch(e.types[n]){case"sL":r[n]=sL.toL(r[n],!1);break;case"nL":r[n]=nL.toL(r[n],!1);break;case"dL":r[n]=dL.toL(r[n],!0);break;case"iL":r[n]=iL.toL(r[n],!1)}}else for(n=0;n<r.length;n++)if(r[n]=r[n].downcast(),"sL"==r[n].type){for(var o=!0,i=0;o&&i<r[n].length;i++)o=!isNaN(r[n][i])&&""!==r[n][i].trim();o&&(r[n]=toNumberList(r[n]))}if(e.names)for(n=0;n<e.names.length;n++)r[n]&&(r[n].name=String(e.names[n]));if(e.nulls)for(n=0;n<e.nulls.length;n++)r[n]&&null!=e.nulls[n]&&(r[n].containsNulls=e.nulls[n]);return r},NumberListToPolygon=function(t){if(0===t.length)return null;let e=new Pol;for(var n=0;null!=t[n+1];n+=2)e.push(new P(t[n],t[n+1]));return e},NumberListToStringList=function(t){let e,n=new sL;for(e=0;null!=t[e];e++)n[e]=String(t[e]);return n.name=t.name,n},ObjectToTable=function(t,e){if(null==t)return null;let n,r,o,i,s,l;if(Array.isArray(t)){if(n=1,!e)for(r in e=[],t[0])t[0].hasOwnProperty(r)&&e.push(r)}else{var a=[];for(r in t)a.push(r);if(1==a.length&&Array.isArray(t[a[0]])){if(n=1,t=t[a[0]],!e)for(r in e=[],t[0])e.push(r)}else n=3,e||(e=a)}let u=new T;for(i=0;i<e.length;i++){var h=e[i];o=new L,u[i]=o,o.name=h}if(1==n)for(i=0;i<t.length;i++){var c=t[i];for(s=0;s<e.length;s++)u[s].push(c[e[s]])}else for(s=0;s<e.length;s++)for(o=t[e[s]],i=0;i<o.length;i++)u[s].push(o[i]);for(i=0;i<u.length;i++){var f=u[i].getTypeOfElements();if(""==f||"Object"==f){var p=!0,g="";for(l=0;l<u[i].length&&p;l++)if(null!==u[i][l]){if("Object"!=_typeOf(u[i][l])){p=!1;break}""==g?g=getObjectStructure(u[i][l]):g!=getObjectStructure(u[i][l])&&(p=!1)}p||(f="")}if("Object"==f){var d=ObjectToTable(u[i]),m=u[i].name;for(l=0;l<d.length;l++)d[l].name=m+"_"+d[l].name;u=T.toL(u.slice(0,i).concat(d).concat(u.slice(i+1))),i--}}for(i=0;i<u.length;i++)u[i]=u[i].downcast();return u=u.downcast(),u},ObjectToList=function(t,e){let n=ObjectToTable(t,e);if(1==n.getLengths.getMax())return n.getRow(0)},objectToString=function(t){try{return JSON.stringify(t)}catch(t){return JSON.stringify({error:"cannot convert."})}},conversor=function(t,e){if(null==t||null==e)return;var n;let r;switch(_typeOf(t)+"_"+e){case"Array_List":return ArrayToList(t);case"NumberTablePolygon":var o=new Pol,i=t.length>1;for(n=0;null!=t[0][n];n++)o[n]=new P(t[0][n],i?t[1][n]:0);return o;case"date_string":return dateToString(t);case"string_date":return stringToDate(t);case"date_number":return t.getTime();case"number_date":return new Date(t);case"List_StringList":case"NumberList_StringList":return NumberListToStringList(t);case"DateList_StringList":return DateListToStringList(t);case"StringList_NumberList":return StringListToNumberList(t);case"Object_string":return JSON.stringify(t,null,"\t");case"string_Object":return JSON.parse(t);case"string_ColorScale":return ColorScales[t];case"string_Table":return CSVToTable(t);case"StringList_DateList":return r=new dL,t.forEach((function(t){r.push(stringToDate(t))})),r.name=t.name,r;case"DateList_NumberList":return t.getTimes();case"Table_Network":return TableToNetworkPairs(t,null,0,!1)}switch(e){case"string":return t.toString();case"number":return Number(t)}return null},ArrayToList=function(t){if(null!=t)return L.toL(t).downcast()},angleFromTwoPoints=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},dot=function(t,e){return t.x*e.x+t.y*e.y},twoPointsInterpolation=function(t,e,n){return new P((1-n)*t.x+n*e.x,(1-n)*t.y+n*e.y)},pointMultiplication=function(t,e){return new P(t.x*e.x-t.y*e.y,t.y*e.x+t.x*e.y)},normalizeTableToMax=function(t,e){if(null==t)return;e=null==e?1:e;var n=new nT;let r,o=e/t.getMax();for(r=0;null!=t[r];r++)n[r]=t[r].factor(o);return n.name=t.name,n},normalizeLists=function(t,e,n){if(null==t||!t.length||!t[0].length)return;n=null==n?"min-max":n;var r=instanceSameType(t);let o;for(r.name=t.name,o=0;null!=t[o];o++)if("nL"==t[o].type)switch(n){case"max":r[o]=normalizeToMax(t[o],e);break;case"sum":r[o]=normalizeToSum(t[o],e);break;case"z-score":r[o]=normalizeByZScore(t[o]);break;default:r[o]=t[o].getNormalized()}else r[o]=t[o].clone();return r},normalizeListsToMax=function(t,e){if(null==t||!t[0].length)return;var n=new nT;let r,o,i=t.length;for(o=0;o<i;o++)r=t[o],n[o]=normalizeToMax(r,e);return n.name=t.name,n},normalizeListsToSum=function(t,e){if(null==t||!t[0].length)return;var n=new nT;let r,o,i=t.length;for(o=0;o<i;o++)r=t[o],n[o]=normalizeToSum(r,e);return n.name=t.name,n},normalizeListsToInterval=function(t,e,n){if(null==t||!t[0].length)return;var r=new nT;let o,i,s=t.length;for(i=0;i<s;i++)o=t[i],r[i]=normalizeToInterval(o,e,n);return r.name=t.name,r},averageSmootherOnLists=function(t,e,n){if(null!=t&&t[0].length){e=e||.5,n=n||1;var r=new nT;return r.name=t.name,t.forEach((function(o,i){r[i]=averageSmoother(t[i],e,n)})),r}},kMeans=function(t,e,n,r,o){if(null==t||null==t[0]||null==e||e<=0||0!==t.getLengths().getInterval().getAmplitude())return null;n=null==n?0:n,r=null==r||r<=0?1e3:r;var i=new nT;let s,l,a,u,h,c,f,p;i.name="k-means clusters";let g,d,m,y,x=new nT,w=t.length,v=t[0].length,b=t.transpose(),T=i.clone();if(e>=b.length)return b;var _,M=function(t,e){var n=e.length;for(s=0;s<n;s++)if(containSameElements(t,e[s]))return!0;return!1};for(l=0;l<e;l++)if(o&&l<o.length)x[l]=b[o[l]].clone();else{for(h=b.getRandomElement(),y=0;M(h,x)&&y<100;)h=b.getRandomElement(),y++;if(100==y){e=l;break}x[l]=h.clone()}for(p=0;p<r;p++){for(l=0;l<e;l++)i[l]=new nL,i[l].name="-means cluster "+l;for(s=0;s<v;s++){for(h=b[s],f=99999999,u=0,l=0;l<e;l++)c=distance(h,x[l]),c<f&&(f=c,u=l);i[u].push(s)}for(s=0;s<i.length;s++)if(0==i[s].length)for(l=0;l<i.length;l++)if(!(l==s||i[l].length<2)){var S=i[l].length-1;i[s].push(i[l][S]),i[l]=i[l].getWithoutElementAtIndex(S);break}if(i.isEqual(T))break;for(T=i.clone(),l=0;l<e;l++){for(d=i[l],g=d.length,x[l]=new nL,x[l].name="k-means mean "+l,m=x[l],h=b[d[0]],a=0;a<w;a++)m[a]=h[a]/g;for(s=1;s<g;s++)for(h=b[d[s]],a=0;a<w;a++)m[a]+=h[a]/g}}let N,R;if(1==n||5==n)for((_=new nL).name="mean index",s=0;s<e;s++)for(N=i[s],R=N.length,l=0;l<R;l++)_[N[l]]=s;var E;if(2==n||5==n){(E=new cL).name="mean color";var O=createDefaultCategoricalColorList(e);for(s=0;s<e;s++)for(N=i[s],R=N.length,l=0;l<R;l++)E[N[l]]=O[s]}var C=new L;if(4==n||5==n)for(s=0;s<e;s++){for(C[s]=new nT,C[s].name="k-means subtable_"+s,N=i[s],R=N.length,l=0;l<R;l++)C[s].push(b[N[l]]);C[s]=C[s].transpose()}switch(n){case 0:return i;case 1:return _;case 2:return E;case 3:return x;case 4:return C;case 5:return{indexes:i,means:x,meanNumber:_,colors:E,subtables:C}}return null},product=function(t,e){if(null==t||null==e)return;let n=t.length,r=t[0].length;if(0===n||0===r||n!=e[0].length||r!=e.length)return;var o=new nT;let i,s,l,a;for(i=0;i<n;i++)for(o[i]=new nL,s=0;s<n;s++){for(a=0,l=0;l<r;l++)a+=t[i][l]*e[l][s];o[i][s]=a}return o},getCovarianceMatrix=function(t){if(null!=t)return product(t,t.transpose()).factor(1/t.length)},generateNumberTable=function(t,e,n,r){t=null==t?0:t,n=null==n?e:n,r=null==r?1:r;var o=new o;let i;switch(t){case 0:i=function(t,e){return t==e?r:0};break;case 1:i=function(t,e){return r};break;case 2:i=function(t,e){return Math.random()*r};break;case 3:i=function(t,e){return t==e?Math.random()*r:0}}for(var s=0;s<e;s++){o[s]=new nL,o[s].name="col_"+s;for(var l=0;l<n;l++)o[s][l]=i(s,l)}return o},identity=function(t){return t},mergeObjects=function(t,e){if(null==t)return null;if(null==e)return t;let n=Object.assign(cloneObject(t),e);return isEqual(t,n)?t:n},cloneObject=function(t){if(null==t)return null;let e;if(t.clone&&"function"==typeof t.clone)return t.clone();try{e=JSON.stringify(t)}catch(n){e=JSON.stringify(serliazeObject(t))}return JSON.parse(e)},serliazeObject=function(t){if(null==t)return null;var e;let n,r;if(t.isTable){for(e=t.toArray(),n=t.length,r=0;r<n;r++)e[r]=serliazeObject(t[r]);return e}return t.isList?t.toArray():t},getInterval=function(t){if(null!=t)return null!=t.getInterval?t.getInterval():void 0},getFrame=function(t,e){let n;if(t.getFrame)return n=t.getFrame(),null!=e&&(n=n.expand(e)),n},getInfo=function(t,e){return null==t?null:(t.isTable?n=buildInformationObjectForTable(t,e):t.isList?n=buildInformationObjectForList(t,e):t.getInfo&&(n=t.getInfo()),null==n?null:(n.objectType=n.type,n.type=null,n));var n},getObjectStructure=function(t){let e=replaceValuesByNull(t);return objectToString(e)},replaceValuesByNull=function(t){let e={};for(var n in t)if(t.hasOwnProperty(n)){if("object"==typeof t[n]&&null!=t[n]){e[n]=replaceValuesByNull(t[n]);continue}e[n]=null}return e},getLength=function(t,e){if(null!=t&&null!=t.length){if((e=null!=e&&e)&&null!=t.length){for(var n=0,r=0;r<t.length;r++)r in t&&n++;return n}return t.length}},includes=function(t,e){if(null!=t)return t.includes(e)},getPropertyValue=function(t,e){if(null==t)return;var n="string"==typeof e?e.split("."):e;let r=t[n[0]],o=1;for(;null!=n[o];){if(null==r)return null;r=r[n[o]],o++}return r},getPropertyValues=function(t,e,n){if(null==t||null==t.length)return;if(t.isList)return t.getPropertyValues(e,n);let r,o=new L;o.name=e;let i=t.length;for(var s=0;s<i;s++)r=getPropertyValue(t[s],e),o[s]=null==r?n:r;return o.downcast()},getPropertyValuesInterval=function(t,e){if(null==t)return;let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;return t.forEach((t=>{null!=t[e]&&(n=Math.min(n,t[e]),r=Math.max(r,t[e]))})),new I(n,r)},getMultiplePropertyValues=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;let t=arguments[0],e=[];for(var n=1;n<arguments.length;n++){var r={name:"value"+(n-1),description:arguments[n]?"The value of property "+arguments[n]:""};r.value=arguments[n]?getPropertyValue(t,arguments[n]):null,r.type=null==r.value?"Object":_typeOf(r.value),e.push(arguments[n]?r:null)}return e.isOutput=!0,e},getName=function(t){if(null!=t)return t.name},isPropertyValue=function(t,e){if(null==t)return!1;for(var n in t)if(t[n]===e)return!0;return!1},getPropertiesNames=function(t){if(null==t)return;let e=sL.toL(Object.getOwnPropertyNames(t));return e.removeElement("__ob__"),e},getPropertiesNamesAndValues=function(t){if(null!=t){var e=new T;return e[0]=getPropertiesNames(t),e[1]=new L,e[0].forEach((function(n,r){e[1][r]=t[n]})),e[1]=e[1].downcast(),e}},setPropertyValue=function(t,e,n,r,o){if(null==t||null==e)return;let i=r?t:cloneObject(t);if(o&&null==n)return i;let s="string"==typeof e?e.split("."):e;for(var l=i,a=0;a<s.length-1;a++)l=l[s[a]]=l[s[a]]||{};return l[s[a]]=n,i},interpolateObjects=function(t,e,n,r){let o,i,s,l=_typeOf(t),a=1-(n=null==n?.5:n);if(l!=_typeOf(e))return n<.5?t:e;switch(l){case"number":return r&&Math.abs(t-e)<=r?e:a*t+n*e;case"I":return r&&Math.abs(t.x-e.x)+Math.abs(t.y-e.y)<=r?e:new I(a*t.x+n*e.x,a*t.y+n*e.y);case"nL":var u=Math.min(t.length,e.length),h=new nL;for(s=0,o=0;o<u;o++)h[o]=a*t[o]+n*e[o],i=Math.pow(e[o]-h[o],2),s+=i;return r&&s<r*r?e:h;case"Pol":u=Math.min(t.length,e.length);var c=new Pol;for(o=0;o<u;o++)c[o]=twoPointsInterpolation(t[o],e[o],n);return c;case"T":case"nT":var f=instanceSameType(e),p=(u=Math.min(t.length,e.length),!0);for(o=0;o<u;o++)f[o]=interpolateObjects(t[o],e[o],n,r),p=p&&f[o]==e[o];return p?e:f}return n<.5?t:e},replaceObject=function(t,e,n){return t==e?n:t},toList=function(t){return L.toL(t).downcast()},floor=function(t){return"number"==typeof t?Math.floor(t):t.floor?t.floor():null},addition=function(){let t,e;if(arguments.length<2){if(1==arguments.length&&null!=arguments[0]&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=addition(t,arguments[0][e]);return t}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnObjectWithList(arguments[0],arguments[1],ObjectOperators.addition);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=!1;i<o&&"string"!=i&&"string"!=o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r),s=!0);var l=o+"_"+i;switch(l){case"boolean_boolean":return n&&r;case"date_string":return s?r+dateToString(n):dateToString(n)+r;case"number_string":case"string_string":case"string_number":case"boolean_number":case"number_number":return n+r;case"PointPoint":return new P(n.x+r.x,n.y+r.y);case"Point3DPoint3D":return new P3D(n.x+r.x,n.y+r.y,n.z+r.z);case"numberPoint":return new P(n.x+r,n.y+r);case"numberPoint3D":return new P3D(n.x+r,n.y+r,n.z+r);case"Interval_number":return new I(n.x+r,n.y+r);case"IntervalPoint":return new P(n.getMin()+r.x,n.getMax()+r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x+r.x,n.y+r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()+r.x,n.getMax()+r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x+r.x,n.y+r.y,n.width+r.width,n.height+r.height);case"date_number":return new Date(n.getTime()+r/DateOperators_millisecondsToDays);case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(addition(n,r.date0),addition(n,r.date1));case"DateInterval_number":return new dI(addition(n.date0,r),addition(n.date1,r));case"DateInterval_Interval":return new dI(addition(n.date0,r.min),addition(n.date1,r.max));case"DateInterval_DateInterval":return new dI(addition(n.date0,r.date0),addition(n.date1,r.date1));case"string_StringList":return r.append(n,!1);case"StringList_string":return r.append(n,!0);default:return null}return n+r}for(t=arguments[0],e=1;e<arguments.length;e++)t=addition(t,arguments[e]);return t},multiplication=function(){let t,e;if(arguments.length<2){if(1==arguments.length&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=multiplication(t,arguments[0][e]);return t}return null}var n=arguments[0];let r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=o+"_"+i;if(2==arguments.length){if(null==arguments[0])return null;if("NumberTable_NumberTable"==s)return product(n,r);if(arguments[0].isList&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.multiplication);switch(i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r)),s=o+"_"+i,s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n*r;case"PointPoint":return pointMultiplication(n,r);case"Point3DPoint3D":return new P3D(n.x*r.x,n.y*r.y,n.z*r.z);case"numberPoint":return new P(n.x*r,n.y*r);case"numberPoint3D":return new P3D(n.x*r,n.y*r,n.z*r);case"Interval_number":return new I(n.getMin()*r,n.getMax()*r);case"IntervalPoint":return new P(n.getMin()*r.x,n.getMax()*r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x*r.x,n.y*r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()*r.x,n.getMax()*r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x*r.x,n.y*r.y,n.width*r.width,n.height*r.height);case"date_number":return new Date(n.getTime()*(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(multiplication(n,r.date0),multiplication(n,r.date1));case"DateInterval_number":return new dI(multiplication(n.date0,r),multiplication(n.date1,r));case"DateInterval_Interval":return new dI(multiplication(n.date0,r.min),multiplication(n.date1,r.max));case"DateInterval_DateInterval":return new dI(multiplication(n.date0,r.date0),multiplication(n.date1,r.date1));default:return null}return n*r}for(t=arguments[0],e=1;e<arguments.length;e++)t=multiplication(t,arguments[e]);return t},division=function(){let t,e;if(arguments.length<2){if(1==arguments.length&&arguments[0]&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=division(t,arguments[0][e]);return t}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.division);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r);i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r));var s=o+"_"+i;switch(s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n/r;case"PointPoint":return new P(n.x/r.x,n.y/r.y);case"Point3DPoint3D":return new P3D(n.x/r.x,n.y/r.y,n.z/r.z);case"numberPoint":return new P(n.x/r,n.y/r);case"numberPoint3D":return new P3D(n.x/r,n.y/r,n.z/r);case"Interval_number":return new I(n.getMin()/r,n.getMax()/r);case"IntervalPoint":return new P(n.getMin()/r.x,n.getMax()/r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x/r.x,n.y/r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()/r.x,n.getMax()/r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x/r.x,n.y/r.y,n.width/r.width,n.height/r.height);case"date_number":return new Date(n.getTime()/(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(division(n,r.date0),division(n,r.date1));case"DateInterval_number":return new dI(division(n.date0,r),division(n.date1,r));case"DateInterval_Interval":return new dI(division(n.date0,r.min),division(n.date1,r.max));case"DateInterval_DateInterval":return new dI(division(n.date0,r.date0),division(n.date1,r.date1));default:return null}return n/r}for(t=arguments[0],e=1;e<arguments.length;e++)t=division(t,arguments[e]);return t},applyFunctionOnInput=function(t,e,n,r,o,i,s){if(null!=t&&null!=e)return"string"==typeof e&&(e=stringToFunction(e)),e.apply(this,[t,n,r,o,i,s])},isEqual=function(t,e){return _recursiveEqual(t,e)},_recursiveEqual=function(t,e){if(t==e)return!0;let n=_typeOf(t);if("string"==n||"number"==n||"boolean"==n||"null"==n)return!1;if(null==t||null==e)return!1;if(Object.keys(t).length!=Object.keys(e).length)return!1;for(var r in t)if(!_recursiveEqual(t[r],e[r]))return!1;return 0!=Object.keys(t).length||null==t.toString||null==e.toString||t.toString()==e.toString()},arrayOfArraysToTable=function(t,e,n){if(null==t)return null;e=null==e||e,n=null==n||n;let r=new T,o=e?1:0;for(var i=0;i<t.length;i++){r[i]=new L,e&&t[i].length>0?r[i].name=String(t[i][0]):r[i].name="_";for(var s=o;s<t[i].length;s++)if(r[i][s-o]=t[i][s],n&&null!==r[i][s-o]){var l=String(r[i][s-o]),a=Number(l.replace(",",".")),u=a||0===a&&""!==l?a:l;"string"==typeof u&&(u=_removeQuotes(u)),r[i][s-o]=u}r[i]=r[i].downcast()}return r.downcast()},operate=function(operation,x,y,factor,mapFunction,name,numIterations){if(numIterations>1){var accumulated=x.isList?new T:new L;accumulated.push(x);for(var i=0;i<numIterations;i++)x=operate(operation,x,y,factor,mapFunction,name),accumulated.push(x);return accumulated.downcast()}if(numIterations<=-1)return operate(operation,operate(operation,x,y,factor,mapFunction,name,numIterations+1),y,factor,mapFunction,name);var f=null!=mapFunction?mapFunction:[_sum,_multiplication,_pow2,_pow3,Math.pow,Math.sqrt,Math.log,_logSum,Math.log2,_log2Sum,_log_y,Math.cos,_cosSum,Math.sin,_sinSum,Math.tan,_tanSum,Math.atan2,Math.floor,Math.round,Math.ceil,Math.abs,_modulo,_subtract,_divide][operation];factor=null==factor?1:factor;var type_x=null==x?"object":x.isTable?"table":x.isList?"list":"object";let type_y=null==y?"object":y.isTable?"table":y.isList?"list":"object";var combinedType=type_x+"_"+type_y;let nL,nT,l;switch("string"==_typeOf(f)&&eval("f = function(x,y){ return "+f+"}"),combinedType){case"object_list":for(nL=new L,nL.name=null==name?y.name:name,i=0;i<y.length;i++)nL[i]=1==factor?f(x,y[i]):factor*f(x,y[i]);return nL.downcast();case"list_object":for(nL=new L,nL.name=null==name?x.name:name,i=0;i<x.length;i++)nL[i]=1==factor?f(x[i],y):factor*f(x[i],y);return nL.downcast();case"list_list":for(nL=new L,nL.name=null==name?y.name:name,l=Math.min(x.length,y.length),i=0;i<l;i++)nL[i]=1==factor?f(x[i],y[i]):factor*f(x[i],y[i]);return nL.downcast();case"object_table":for(nT=new T,nT.name=name,i=0;i<y.length;i++)nT[i]=operate(operation,x,y[i],factor,mapFunction);return nT.downcast();case"table_object":for(nT=new T,nT.name=name,i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y,factor,mapFunction);return nT.downcast();case"list_table":case"table_list":case"table_table":for(nT=new T,nT.name=name,l=Math.min(x.length,y.length),i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y[i],factor,mapFunction);return nT.downcast();default:return 1==factor?f(x,y):factor*f(x,y)}},_sum=function(t,e){return t+e},_multiplication=function(t,e){return t*e},_pow2=function(t){return Math.pow(t,2)},_pow3=function(t){return Math.pow(t,2)},_logSum=function(t,e){return Math.log(t+e)},_log2Sum=function(t,e){return Math.log2(t+e)},_log_y=function(t,e){return Math.log(t)/Math.log(e)},_cosSum=function(t,e){return Math.cos(t+e)},_sinSum=function(t,e){return Math.sin(t+e)},_tanSum=function(t,e){return Math.tan(t+e)},_modulo=function(t,e){return t%e},_subtract=function(t,e){return t-e},_divide=function(t,e){return t/e},numberToString=function(t,e){let n=t.toFixed(e);if(0==e)return n;for(;"0"==n.charAt(n.length-1);)n=n.substring(0,n.length-1);return"."==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},getRandomWithSeed=function(t){return(t=(9301*(t=null==t?1:t)+49297)%233280)/233280},numberFromBinaryPositions=function(t){let e,n=0;for(e=0;null!=t[e];e++)n+=Math.pow(2,t[e]);return n},numberFromBinaryValues=function(t){let e=0,n=t.length;for(var r=0;r<n;r++)e+=1==t[r]?Math.pow(2,n-(r+1)):0;return e},_powersOfTwoDecomposition=function(t,e){var n=new nL;let r;for(;0<t;)r=Math.floor(Math.log(t)/Math.LN2),n[r]=1,t-=Math.pow(2,r);e=Math.max(n.length,null==e?0:e);for(var o=0;o<n.length;o++)n[o]=n[o]?1:0;for(;n.length<e;)n.push(0);return n},toBinary=function(t,e,n=!0){let r=_powersOfTwoDecomposition(t,e);return n||(r=r.getReversed()),r},binaryToNumber=function(t,e=!0){if(null==t)return;let n=e?t.getReversed():t,r=0,o=n.length;for(var i=0;i<o;i++)r+=0==Number(n[i])?0:Math.pow(2,o-(i+1));return r},positionsFromBinaryValues=function(t){let e,n=new nL;for(e=0;null!=t[e];e++)1==t[e]&&n.push(e);return n},_Alea=function(){return function(t){var e=0,n=0,r=0,o=1;0===t.length&&(t=[+new Date]);var i=_Mash();e=i(" "),n=i(" "),r=i(" ");for(var s=0;s<t.length;s++)(e-=i(t[s]))<0&&(e+=1),(n-=i(t[s]))<0&&(n+=1),(r-=i(t[s]))<0&&(r+=1);i=null;var l=function(){var t=2091639*e+2.3283064365386963e-10*o;return e=n,n=r,r=t-(o=0|t)};return l.uint32=function(){return 4294967296*l()},l.fract53=function(){return l()+11102230246251565e-32*(2097152*l()|0)},l.version="Alea 0.9",l.args=t,l}(Array.prototype.slice.call(arguments))},_Mash=function(){let t=4022871197;var e=function(e){e=e.toString();for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e.version="Mash 0.9",e},random=function(){return new _Alea},randomSeed=function(t){NumberOperators_stackRandom.push(NumberOperators_random),NumberOperators_stackRandom.length>100&&NumberOperators_stackRandom.shift(),NumberOperators_random=new _Alea("my",t,"seeds"),NumberOperators_lastNormal=NaN},randomSeedPop=function(){NumberOperators_stackRandom.length>0&&(NumberOperators_random=NumberOperators_stackRandom.pop())},decimalPlaces=function(t){let e=String(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},logistic=function(t,e,n,r){return null==t||isNaN(t)?null:(n=null==n?0:n,r=null==r?1:r,(e=null==e?1:e)/(1+Math.exp(-r*(t-n))))},formatShort=function(t,e){if(null==t)return;if(0==t||t==1/0)return String(t);if(isNaN(t))return t;if(e=null==e||e<1?2:e,String(t).length<=e)return String(t);let n=parseFloat(t.toPrecision(e)),r=Math.floor(Math.log10(n));var o="";return r>=15?(n=parseFloat((n/Math.pow(10,r)).toPrecision(e)),o="e"+r):r>=12?(n/=Math.pow(10,12),o="t"):r>=9?(n/=Math.pow(10,9),o="b"):r>=6?(n/=Math.pow(10,6),o="m"):r>=3?(n/=Math.pow(10,3),o="k"):r<-3&&(n=parseFloat((n/Math.pow(10,r)).toPrecision(e)),o="e"+r),n=parseFloat(n.toPrecision(12)),n+o},numberToPosition=function(t){let e=t%10,n=t%100;return 1==e&&11!=n?t+"st":2==e&&12!=n?t+"nd":3==e&&13!=n?t+"rd":t+"th"},getSoftenControlPoints=function(t,e,n,r){r=r||10;let o=angleFromTwoPoints(t,n);return[new P(e.x-r*Math.cos(o),e.y-r*Math.sin(o)),new P(e.x+r*Math.cos(o),e.y+r*Math.sin(o))]},bezierCurvePoints=function(t,e,n,r,o,i,s,l,a){let u=1-a,h=u*n+a*o,c=u*r+a*i;return new P(a*(u*h+a*(u*o+a*s))+u*(u*(u*t+a*n)+a*h),a*(u*c+a*(u*i+a*l))+u*(u*(u*e+a*r)+a*c))},triangleContainsPoint=function(t,e,n,r){let o=(t.x-r.x)*(e.y-r.y)-(e.x-r.x)*(t.y-r.y),i=(e.x-r.x)*(n.y-r.y)-(n.x-r.x)*(e.y-r.y),s=(n.x-r.x)*(t.y-r.y)-(t.x-r.x)*(n.y-r.y);return o>0&&i>0&&s>0||o>=0&&i>=0&&s>=0},triangleArea=function(t){return Math.abs(t.a.x*(t.b.y-t.c.y)+t.b.x*(t.c.y-t.a.y)+t.c.x*(t.a.y-t.b.y))/2},lineFromTwoPoints=function(t,e){if(t.x==e.x)return new P(1/0,t.x);let n=(e.y-t.y)/(e.x-t.x);return new P(n,t.y-n*t.x)},distancePointToLine=function(t,e){let n,r;0===e.x?(n=1/0,r=t.x):(n=-1/e.x,r=t.y-n*t.x);let o=intersectionLines(e,new P(n,r));return Math.sqrt(Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2))},distancePointToSegment=function(t,e,n){let r,o,i=e.x==n.x?1/0:(n.y-e.y)/(n.x-e.x),s=i==1/0?new P(1/0,e.x):new P(i,e.y-i*e.x);0===s.x?(r=1/0,o=t.x):(r=-1/s.x,o=t.y-r*t.x);let l=intersectionLines(s,new P(r,o));return l.x>=Math.min(e.x,n.x)&&l.x<=Math.max(e.x,n.x)?t.distanceToPoint(l):Math.min(t.distanceToPoint(e),t.distanceToPoint(n))},intersectionLines=function(t,e){if(t.x==e.x)return t.y==e.y?t.x==1/0?new P(t.y,0):new P(0,t.y):null;if(t.x==1/0)return new P(t.y,e.x*t.y+e.y);if(e.x==1/0)return new P(e.y,t.x*e.y+t.y);var n=(e.y-t.y)/(t.x-e.x);return new P(n,t.x*n+t.y)},intersectionLineRectangle=function(t,e,n,r){r=null!=r&&r;let o,i=lineFromTwoPoints(t,e),s=lineFromTwoPoints(n.getTopLeft(),n.getTopRight()),l=lineFromTwoPoints(n.getTopRight(),n.getBottomRight()),a=lineFromTwoPoints(n.getBottomLeft(),n.getBottomRight()),u=lineFromTwoPoints(n.getTopLeft(),n.getBottomLeft()),h=new Pol;if(o=intersectionLines(i,s),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,l),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,a),null!=o&&n.pointIsOnBorder(o)&&h.push(o),o=intersectionLines(i,u),null!=o&&n.pointIsOnBorder(o)&&h.push(o),!r){for(var c=new Pol,f=0;f<h.length;f++)o=h[f],o.x>=Math.min(t.x,e.x)&&o.x<=Math.max(t.x,e.x)&&o.y>=Math.min(t.y,e.y)&&o.y<=Math.max(t.y,e.y)&&c.push(o);h=c}return h},numberTableToPolygon=function(t){if(null==t||t.length<2)return null;var e;let n=Math.min(t[0].length,t[1].length),r=new Pol;for(e=0;e<n;e++)r[e]=new P(t[0][e],t[1][e]);return r},numberTableToColorList=function(t,e){if(null==t)return;if(e=null==e||e,"T"!=t.type&&"nT"!=t.type)throw new Error("Input must be a table");if(t.length<3)throw new Error("T must have at least 3 lists");let n,r,o,i=new i;for(var s=0;s<t[0].length;s++){if(e)n=Math.max(0,Math.min(255,Math.round(t[0][s]))),r=Math.max(0,Math.min(255,Math.round(t[1][s]))),o=Math.max(0,Math.min(255,Math.round(t[2][s])));else{var l=HSVtoRGB(t[0][s],t[1][s],t[2][s]);n=Math.max(0,Math.min(255,Math.round(l[0]))),r=Math.max(0,Math.min(255,Math.round(l[1]))),o=Math.max(0,Math.min(255,Math.round(l[2])))}if(isNaN(n)||isNaN(r)||isNaN(o))throw new Error("Invalid format. T cells must be numbers in range [0,255]");i.push("rgb("+n+","+r+","+o+")")}return i},numberTableToNetwork=function(t,e,n){n=null==n?0:n;var r,o=new Net;let i;var s;let l;var a;let u,h;var c;if(0===e)for(s=0;null!=t[s+1];s++)for(r=t[s],0===s?(a=new Nd(r.name,r.name),o.addNode(a)):a=o.nodes[s],l=s+1;null!=t[l];l++)i=t[l],0===s?(u=new Nd(i.name,i.name),o.addNode(u)):u=o.nodes[l],i=t[l],(c=1/(1+standardDeviationTwoNumberLists(r,i)))>=n&&(h=new Rel(s+"_"+l,a.name+"_"+u.name,a,u,c),o.addRelation(h));return o},buildDendrogramFromPolygon=function(t){let e,n,r,o=new Tr,i=new ndL;var s=new Pol;t.forEach((function(t,n){e=new Nd("point_"+n,"point_"+n),e.weight=1,e.barycenter=t,e.point=t,e.polygon=new Pol(t),o.addNode(e),s.push(e),i.push(e)})),o.nodes=o.nodes.getReversed();for(var l,a=function(t,e){var r=new Nd("("+t.id+","+e.id+")","("+t.id+","+e.id+")");return r.polygon=t.polygon.concat(e.polygon),r.weight=r.polygon.length,n=t.weight+e.weight,r.barycenter=new P((t.weight*t.barycenter.x+e.weight*e.barycenter.x)/n,(t.weight*t.barycenter.y+e.weight*e.barycenter.y)/n),o.addNode(r),o._newCreateRelation(r,t),o._newCreateRelation(r,e),r};s.length>1;)l=_findClosestNodes(s),r=a(s[l[0]],s[l[1]]),r.distance=l.distance,s.splice(l[0],1),s.splice(l[1]-1,1),s.push(r);o.nodes=o.nodes.getReversed();var u=function(t,e){t.level=e+1,t.to.forEach((function(e){u(e,t.level)}))};return u(o.nodes[0],-1),o.leaves=i,o},_findClosestNodes=function(t){let e,n,r,o,i=9999999999;for(e=0;null!=t[e+1];e++)for(n=e+1;null!=t[n];n++)r=Math.pow(t[e].barycenter.x-t[n].barycenter.x,2)+Math.pow(t[e].barycenter.y-t[n].barycenter.y,2),r<i&&(i=r,o=[e,n]);return o.distance=i,o},sortOnXY=function(t){return t.sort((function(t,e){return t.x<e.x||t.x==e.x&&t.y<e.y?-1:1}))},expandFromBarycenter=function(t,e){let n=new Pol,r=t.getBarycenter();for(var o=0;null!=t[o];o++)n[o]=t[o].expandFromPoint(r,e);return n},simplifyPolygon=function(t,e){e=null==e||0===e||void 0===e?1:e;let n,r,o,i,s,l=t.clone(),a=t.length;for(s=0;s<a;s++)n=l[s],r=l[(s+1)%a],o=l[(s+2)%a],i=lineFromTwoPoints(n,o),distancePointToLine(r,i)<e&&(l=l.getWithoutElementAtIndex((s+1)%a),s--),a=l.length;return l},bezierPolygonContainsPoint=function(t,e,n,r){let o=t.getFrame();r.clearContext(),r.context.fillStyle="black",r.context.fillRect(0,0,o.width,o.height),null!=n&&(r.context.strokeStyle="black",r.context.lineWidth=n),r.context.fillStyle="white",r.context.beginPath(),r.drawBezierPolygon(t,-o.x,-o.y),r.context.fill(),null!=n&&r.context.stroke();let i=r.context.getImageData(e.x-o.x,e.y-o.y,1,1).data;return r.clearContext(),i[0]>0},placePointsInsidePolygon=function(t,e,n){let r=new Pol,o=t.getFrame();if(0===(n=n||0)){for(var i;r.length<e;)i=new P(o.x+Math.random()*o.width,o.y+Math.random()*o.height),polygonContainsPoint(t,i)&&r.push(i);return r}},placePointsInsideBezierPolygon=function(t,e,n,r){let o=new Pol,i=t.getFrame();if(0===(n=n||0)){for(var s,l=0;o.length<e&&l<1e3;)s=new P(i.x+Math.random()*i.width,i.y+Math.random()*i.height),l++,bezierPolygonContainsPoint(t,s,r)&&(o.push(s),l=0);return o}},geoCoordinateToDecimal=function(t){return Math.floor(t)+1.66667*(t-Math.floor(t))},geoDistance=function(t,e){let n=Math.pow(Math.sin(.5*(e.y-t.y)*gradToRad),2)+Math.cos(t.y*gradToRad)*Math.cos(e.y*gradToRad)*Math.pow(Math.sin(.5*(e.x-t.x)*gradToRad),2);return GeoOperators_EARTH_DIAMETER*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))},polygonLength=function(t){if(t.length<2)return 0;for(var e=geoDistance(t[0],t[1]),n=2;null!=t[n];n++)e+=geoDistance(t[n-1],t[n]);return e},minRect=function(){if(null==arguments||arguments.length<1)return null;var t;let e=arguments[0].clone();for(e.width=e.getRight(),e.height=e.getBottom(),t=1;null!=arguments[t];t++)e.x=Math.min(e.x,arguments[t].x),e.y=Math.min(e.y,arguments[t].y),e.width=Math.max(arguments[t].getRight(),e.width),e.height=Math.max(arguments[t].getBottom(),e.height);return e.width-=e.x,e.height-=e.y,e},packingRectangles=function(t,e,n=2){let r=function(t,e,n,r,o,i){for(var s,l=0;null!=t[l];l++)if(e+r>(s=t[l]).x-i&&e<s.x+s.width+i&&n+o>s.y-i&&n<s.y+s.height+i)return!0;return!1},o=e.getCenter(),i=e.width/e.height,s=new L;var l=new L;let a,u,h,c,f,p,g,d=0;for(let e=0;e<t.length;e++){if(h=t[e].width,c=t[e].height,0===e)a=o.x-.5*h,u=o.y-.5*c;else{for(f=.1*e,p=0;r(s,a,u,h,c,n);)p+=1,f+=.005*p,a=o.x+i*p*Math.cos(f)-.5*h,u=o.y+p*Math.sin(f)-.5*c;d=Math.max(d,i*p+.5*h)}l[e]=new Rec(a,u,h,c),s.push(l[e])}i=.5*e.width/d;for(let t=0;t<l.length;t++)g=l[t],g.x=o.x+(g.x-o.x)*i,g.y=o.y+(g.y-o.y)*i,g.width*=i,g.height*=i;return l},packingCircles=function(t,e,n){if(null==t||0===t.length)return null;var r=function(t,e,n,r,o){for(var i,s=0;null!=t[s];s++)if(i=t[s],Math.pow(i.x-e,2)+Math.pow(i.y-n,2)<Math.pow(i.z+r+o,2))return!0;return!1};n=null==n?0:n;for(var o,i,s,l=_.normalizeToMax(t).sqrt(),a=new Pol3D,u=0,h=0,c=0,f=0,p=e.getCenter(),g=100*l[0],d=e.width/e.height,m=0;m<l.length;m++){if(o=100*l[m],0===m)c=p.x,f=p.y,i=o;else{for(u=0,h=i+o+n+.1;r(a,c,f,o,n);)u+=.003*(h+=.06),c=p.x+d*h*Math.cos(u),f=p.y+h*Math.sin(u);g=Math.max(g,d*h+100*l[m])}a[m]=new _.P3D(c,f,o)}for(d=.5*e.width/(g+.001),m=0;null!=a[m];m++)(s=a[m]).x=p.x+(s.x-p.x)*d,s.y=p.y+(s.y-p.y)*d,s.z*=d;return a},fillWithRectangles=function(t,e,n,r){switch(null==n&&(n=new Rec(0,0,1,1)),e=e||0){case 0:return squarify(n,t);case 1:var o=t.getInterval();o.min<0&&(t=t.add(-o.min),o=new I(0,o.max-o.min));var i,s,l=t.getSum(),a=new L,u=n.y,h=n.height/l;for(s=0;null!=t[s];s++)i=h*t[s],a.push(new Rec(n.x,u,n.width,i)),u+=i;return a;case 2:(o=t.getInterval()).min<0&&(t=t.add(-o.min),o=new I(0,o.max-o.min)),l=t.getSum(),a=new L;var c,f=n.x,p=n.width/l;for(s=0;null!=t[s];s++)c=p*t[s],a.push(new Rec(f,n.y,c,n.height)),f+=c;return a;case 3:if(t.length<6);else if(6==t.length){var g=new Rec(.44,.36,.16,.45),d=new Rec(.6,.15,.3,.3),m=new Rec(.72,.45,.28,.32),y=new Rec(.38,.04,.22,.32),x=new P(.6,.36);g=expandRectangle(g,Math.sqrt(t[0]),x),d=expandRectangle(d,Math.sqrt(t[1]),x),y=expandRectangle(y,Math.sqrt(t[3]),x),m.x=d.x+.5*d.width,m.y=d.bottom;var w=new P(m.x+.3*m.width,d.bottom);(m=expandRectangle(m,Math.sqrt(t[2]),w)).y+=.2*m.height;var v=new P(.26,.36+Math.max(.3*g.height,.2*y.height)),b=new Rec(.1,v.y-.4,.2,.4),T=new Rec(.22,v.y,.16,.5);b=expandRectangle(b,Math.sqrt(t[4]),v),T=expandRectangle(T,Math.sqrt(t[5]),v);var _=.2*Math.max(y.width,g.width,T.right-v.x,b.right-v.x),M=Math.min(y.x,g.x)-Math.max(b.right,T.right)-_;return T.x+=M,b.x+=M,new L(g,d,m,y,b,T)}case 4:case 5:var S;S=0===(r=r||0)?Math.round(Math.sqrt(t.length)):Math.round(t.length/r);var N=Math.ceil(t.length/S),R=S*N-t.length,E=t.getMean(),O=concat(t,createListWithSameElement(R,E)),C=slidingWindowOnList(O,N,N,0),D=C.getSums(),k=this.fillWithRectangles(D,2,n);for(a=L(),s=0;s<S;s++)a=concat(a,this.fillWithRectangles(C[s],1,k[s]));return a}return null},squarify=function(t,e,n,r){if(null==e)return;if(0===e.length)return new recL;if(1===e.length)return new recL(t);let o,i;r=r||!1,o=(n=n||!1)?e:normalizeToSum(e),r||(i=null==e.positions?o.getSortIndexes():e.positions,o=null==o.sortedWeights?o.getSorted(!1):o.sortedWeights);var s=t.width*t.height;let l,a,u,h,c,f,p,g,d,m=new recL,y=t.clone(),x=new L,w=0,v=new Rec,b=e.length;var T;if(b>2)for(g=w;g<b;g++)if(u=Number.MAX_VALUE,0===o[g])m.push(new Rec(v.x,v.y,0,0));else{for(d=1;d<b&&(l=nL.toL(o.slice(g,g+d)),a=x.slice(),c=(T=l.getSum())*s,v.x=y.x,v.y=y.y,y.width>y.height?(v.width=c/y.height,v.height=y.height):(v.width=y.width,v.height=c/y.width),x=partitionRectangle(v,l,T),h=x.highestRatio,!(u<=h));d++)u=h;if(0===a.length){if(m.push(new Rec(y.x,y.y,y.width,y.height)),m.length==b){if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m}w++}else{if(m=m.concat(a),m.length==b){if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m}w+=a.length,f=a[a.length-1],y.width>y.height?(y.x=f.width+f.x,y.width-=f.width):(y.y=f.height+f.y,y.height-=f.height)}g=w-1}else 2==b?(l=o.clone(),v=t.clone(),m=partitionRectangle(v,l,l.getSum())):m[0]=new Rec(t.x,t.y,t.width,t.height);if(!r){for(p=new L,g=0;null!=m[g];g++)p[i[g]]=m[g];return p}return m},partitionRectangle=function(t,e,n){let r,o,i,s=t.width*t.height,l=new L,a=new Rec(t.x,t.y,t.width,t.height),u=1,h=e.length;for(o=0;o<h;o++)r=e[o]*s/n,t.width>t.height?(i=new Rec(a.x,a.y,r/a.height,a.height),l.push(i),a.x+=r/a.height):(i=new Rec(a.x,a.y,a.width,r/a.width),l.push(i),a.y+=r/a.width),i.ratio=Math.max(i.width,i.height)/Math.min(i.width,i.height),u=Math.max(u,i.ratio);return l.highestRatio=u,l},_getHighestRatio=function(t){let e,n,r=1;for(n=0;n<t.length;n++)e=t[n],r=Math.max(r,e.getRatio());return r},simplifyPolygons=function(t,e,n){let r,o=new polL;for(var i=0;null!=t[i];i++)r=simplifyPolygon(t[i],e),(r.length>0||!n)&&o.push(r);return o},createPolygon=function(t,e,n){let r=new Pol;if(0===e)for(var o=0;o<t;o++)r.push(new P(n.x+n.width*Math.random(),n.y+n.height*Math.random()));return r},twoNumberListsToPolygon=function(t,e){let n=Math.min(t.length,e.length),r=new Pol;for(var o=0;o<n;o++)r[o]=new P(t[o],e[o]);return r},colorListFromColorScale=function(t,e){return t.getColorList.apply(t,[e])},colorListFromColorScaleFunction=function(t,e){let n,r=new cL;for(n=0;n<e;n++)r[n]=t(n/(e-1));return r},colorsLinearCombination=function(t,e){if(null==t||0==t.length)return;if(1==t.length)return t[0];null==e&&(e=createListWithSameElement(t.length,1)),e=normalizeToSum(e);var n=colorStringToRGB(t[0],e[0]);let r;for(var o=1;o<t.length;o++)r=colorStringToRGB(t[o],e[o]),n[0]+=r[0],n[1]+=r[1],n[2]+=r[2];return"rgb("+Math.floor(n[0])+","+Math.floor(n[1])+","+Math.floor(n[2])+")"},polygon3DToColorList=function(t){let e,n=t.length,r=new cL;for(e=0;e<n;e++)r.push(point3DToColor(t[e]));return r},colorListToPolygon3D=function(t){let e,n=t.length,r=new Pol3D;for(e=0;e<n;e++)r.push(colorToPoint3D(t[e]));return r},randomColor=function(t){return t=null==t?1:t,"rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+t+")"},getFlowTable=function(t,e,n){if(null==t)return;e=e||!1;let r,o,i,s,l,a,u=t.length,h=t[0].length,c=new nL,f=new nL,p=new nL,g=-9999999,d=9999999,m=-9999999;for(l=0;l<h;l++){for(o=9999999,i=-9999999,s=0,a=0;a<u;a++){if(r=t[a],r.length!=h)return;i=Math.max(i,r[l]),o=Math.min(o,r[l]),s+=r[l]}c.push(o),f.push(i),p.push(s),d=Math.min(d,o),g=Math.max(g,i),m=Math.max(m,s)}var y=m-d;let x,w,L,v=new nT;var b=n?1:0;if(e&&n)return v=new nT(t.length+1),t[0].forEach((function(){v[0].push(0)})),t.forEach((function(t,e){t.forEach((function(t,n){var r=p[n];v[e+1][n]=t/(0===r?1e-5:r)+v[e][n]}))})),v;for(v=new nT,e?w=Math.max(d,0):(w=d,L=y),l=0;l<u;l++)x=new nL,v.push(x);for(n&&v.push(new nL),l=0;l<h;l++)for(r=t[0],e&&(L=p[l]-w),n&&(v[0][l]=0),0===L&&(L=1e-5),v[b][l]=(r[l]-w)/L,a=1;a<u;a++)r=t[a],v[a+b][l]=(r[l]-w)/L+v[a-1+b][l];return v},getFlowTableIntervals=function(t,e,n,r){if(null==t)return null;var o=getFlowTable(t,e,!0),i=new T;let s,l;var a=o.length;let u=o[0].length;var h,c,f,p,g=new nL;for(s=1;s<a;s++)for(o[s],h=new L,i[s-1]=h,l=0;l<u;l++)h.push(new I(o[s-1][l],o[s][l])),s==a-1&&(g[l]=o[s][l]);if(n)for(l=0;l<u;l++){for(f=new nL,h=i[s],s=0;s<a-1;s++)f.push(i[s][l].getAmplitude());var d=f.getSortIndexes();for(p=e||r?0:.5*(1-g[l]),s=0;s<a-1;s++)(c=i[d[s]][l]).y=p+c.getAmplitude(),c.x=p,p=c.y}else if(!e)for(l=0;l<u;l++)for(s=0;s<a-1;s++)c=i[s][l],r?(i[s][l].x=1-i[s][l].x,i[s][l].y=1-i[s][l].y):i[s][l]=c.add(.5*(1-g[l]));return i},scaleIntervals=function(t,e){if(null==t)return;e=null==e?1:e;var n=new L;let r,o=t.length;for(n.name=t.name,r=0;r<o;r++)n[r]=t[r].getScaled(e);return n},nlsToIntervalList=function(t,e,n){if(null==t||null==e)return;n=null!=n&&n;var r=Math.min(t.length,e.length);let o,i=new iL;for(n&&(e=addition(t,e)),o=0;o<r;o++)i.push(new I(t[o],e[o]));return i},fillTextRectangle=function(t,e,n,r,o,i,s,l,a,u,h){u=null!=u&&u,h=null!=h&&h;let c=textWordWrapReturnLines(t,r,o,i,l,a);h&&(n+=((null==o?600:o)-(null==i?16:i)*c.length)/2);let f=a.context.textAlign;u&&(a.context.textAlign="center",e+=(null==r?100:r)/2);let p=fillTextRectangleWithTextLines(c,e,n,o,i,s,a);return a.context.textAlign=f,p},fillTextRectangleWithTextLines=function(t,e,n,r,o,i,s){r=0===r||null==r?99999:r;for(var l=0;null!=t[l]&&(s.context.fillText(t[l],e,n+l*o),!((l+2)*o>r));l++);return i?t.length*o:t.length},textWordWrapReturnLines=function(t,e,n,r,o,i){e=e||100,n=n||600;var s=0===(r=r||16)?-1:Math.floor(n/r);let l=new sL;if(e<=0)return l.push(t),l;var a=t.split(/\\n|\n/);let u,h,c,f,p,g;for(u=0;u<a.length;u++)if(""!==a[u])if(i.context.measureText(a[u]).width<e&&l.length<s)l.push(a[u]);else{for(h=a[u].split(" "),c=1;h.length>0&&c<=h.length;)if(f=h.slice(0,c).join(" "),p=i.context.measureText(f).width,p>e){if(1==c&&(c=2),g=h.slice(0,c-1).join(" "),""!==g&&l.push(g),l.length==s){if(o){var d=l[l.length-1];i.context.measureText(d+"").width<=e?l[l.length-1]+="":(h=d.split(" "),g=h.slice(0,h.length-1).join(" ")+"",l.push(g))}return l}h=h.splice(c-1),c=1}else c++;c>0&&(g=h.join(" "),""!==g&&l.push(g))}else l.push("");return l.width=1==l.length?p:e,l},getMaxTextWidth=function(t,e){let n=e.getTextW(t[0]);for(var r=1;null!=t[r];r++)n=Math.max(n,e.getTextW(t[r]));return n},stringToObject=function(t){try{return JSON.parse(t)}catch(t){}if(null==t)return null;let e,n=t.split(/\r?\n/),r="[",o=!1;for(var i=0;i<n.length;i++)if(0!=n[i].trim().length){if("{"==n[i]){for(e="";"}"!=n[i]&&i<n.length;)e+=" "+n[i],i++;e+="}"}else e=n[i];e=(o?",\r\n":"\r\n")+e,o=!0,r+=e}r+="\r\n]";try{return JSON.parse(r)}catch(t){return null}},stringToHash=function(t,e,n){if(null==t)return null;e=null==e?4294967295:e,n=null==n?1:n;let r,o,i,s,l,a=2166136261;for(o=0,l=t.length;o<l;++o)i=t.charCodeAt(o),s=65280&i,s&&(a=_fnv_multiply(a^s>>8)),a=_fnv_multiply(a^255&i);a=_fnv_mix(a),r=a%e;let u=1==n?0:_fnv_mix(_fnv_multiply(a)),h=new h;for(o=0;o<n;o++)h.push(r<0?r+e:r),r=(r+u)%e;return 1==n?h[0]:h},_fnv_multiply=function(t){return t+(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)},_fnv_mix=function(t){return t+=t<<13,t^=t>>>7,t+=t<<3,t^=t>>>17,4294967295&(t+=t<<5)},decodeIdentedTree=function(t,e,n){e=null==e?"":e,n=null==n?"\t":n;var r=new Tr,o=splitByEnter(t);let i=o.length;if(0===i||1==i&&(null==o[0]||""===o[0]))return null;var s;let l;var a;let u,h,c;var f;let p,g;for(""!==e&&null!=e&&(g=new Nd(e,e),r.addNodeToTree(g,null)),s=0;s<i;s++){for(u=(a=o[s]).length,l=0;l<u;l++)if(a.charAt(l)!=n){h=a.substr(l);break}f=new Nd(a,h),0===l?null!=g?r.addNodeToTree(f,g):r.addNodeToTree(f,null):(c=l+1-Number(null==g),p=null!=r.getLevel(c-1)&&r.getLevel(c-1).length>0?r.getLevel(c-1)[r.getLevel(c-1).length-1]:null,r.addNodeToTree(f,p))}return r.assignDescentWeightsToNodes(),r},TableToTree=function(t,e,n,r,o,i,s,l){if(null==t)return;if(0===t.length)throw new Error("T has no Lists");if(null===t[0])throw new Error("table[0] is null");if(null!=i&&i.length!=t[0].length)throw new Error("weightsList must have a value for each row in the table");if(null!=s&&s.length!=t[0].length)throw new Error("colors list must have a value for each row in the table");e=null==e?t[0].name:e,r=null==r?0:r,o=null==o||""==o?"rgb(255,255,255)":o,l=null==l?0:l,null!=i&&i.getMin()<0&&(i=normalizeToInterval(i,new I(0,1)));var a=new Tr;let u,h,c;var f=new Nd(e,e);a.addNodeToTree(f,null);var p=t.length;let g,d,m,y,x,w;if(n)if(x=0==r?p-1:0,s){var L=T.toL([t[x],s]);w=buildDictionaryObjectForDictionary(L)}else w=createCategoricalColorListForList(t[x])[4].value;if(1==l){if(2!=t.length)throw new Error("T must have 2 Lists for parent-child mode");var v,b,_,M=difference(t[0].getWithoutRepetitions(),t[1].getWithoutRepetitions());if(0==M.length)throw new Error("Invalid data for a tree. Likely has loops in the relationships.");for(g=0;g<M.length;g++)u=new Nd(String(M[g]),String(M[g])),a.addNodeToTree(u,f);for(;M.length>0;){for(v=new sL,g=0;g<t[0].length;g++)if(-1!=M.indexOfElement(t[0][g])){if(null==(_=a.nodes.get(String(t[0][g])))&&new Error("Invalid data for a tree. Nd "+String(t[0][g])+" not found as parent"),null!=(b=a.nodes.get(String(t[1][g]))))throw new Error("Invalid data for a tree. Nd "+String(t[1][g])+" has multiple parents.");b=new Nd(String(t[1][g]),String(t[1][g])),n&&0==r?b.color=w[String(t[1][g])]:!n||1!=r&&2!=r||(b.color=w[String(t[1][g])]),v.push(String(t[1][g])),a.addNodeToTree(b,_),null!=i&&(b.weight=i[g])}M=v.clone()}}else for(g=0;g<p;g++)if(null!=t[g])for(m=t[g],d=0;d<m.length;d++)y=m[d],null!=y&&(c=_getId(t,g,d),u=a.nodes.get(c),null==u?(u=new Nd(c,String(y)),n&&g==p-1&&0==r?u.color=w[y]:!n||1!=r&&2!=r||(u.color=w[t[0][d]]),0===g?a.addNodeToTree(u,f):(h=a.nodes.get(_getId(t,g-1,d)),a.addNodeToTree(u,h)),u.firstIndexInTable=d,u.indexesInTable=new nL(d),null!=i&&(u.weight=i[d])):(null!=i?u.weight+=i[d]:u.weight++,u.indexesInTable.push(d)));if(n&&2==r)for(g=0;g<a.nodes.length;g++)u=a.nodes[g],0==u.level?u.color=o:u.color=interpolateColors(u.color,o,(u.level-1)/(a.nLevels-1));a.assignDescentWeightsToNodes();var S=function(t){var e;if(0===t.to.length)return t.indexesInTable;for(t.indexesInTable=new nL,e=0;null!=t.to[e];e++)t.indexesInTable=t.indexesInTable.concat(S(t.to[e]));return t.indexesInTable};return S(a.nodes[0]),a},_getId=function(t,e,n){let r=1,o="_"+String(t[0][n]);for(;r<=e;)o+="_"+String(t[r][n]),r++;return o},TreeToTable=function(t,e,n){if(null!=t){e=null==e||e,n=null!=n&&n;var r,o,i=new T,s=t.getLeaves(),l=function(t,e,n){if(0==t)return!1;for(var r=0;r<i[t].length;r++)if(i[t][r]==e&&i[t-1][r]!=n)return!0;return!1};n||(l=function(){return!1});for(var a=0;a<s.length;a++){(r=t.getAncestorsOf(s[a]).reverse()).addNode(s[a]),e||(r=r.slice(1));for(var u=r.length-1;u>=0;u--){for(null==i[u]&&(i[u]=new sL),o=r[u].name;l(u,o,u>0?r[u-1].name:"");)o+="";i[u][a]=o}}return i}},treeToObject=function(t,e){if(null==t||"Tr"!=t.type)return null;let n,r={},o=[r],i=["name","id","level","weight","color"];t.traverse(null,null,(function(t){for(var s in 0==t.level?n=r:(n={},o[t.level].push(n)),t)"type"==s&&0==t.level||(e||i.includes(s))&&"object"!=typeof t[s]&&null!=t[s]&&(n[s]=t[s]);return t.to.length>0&&(n.children=[],o[t.level+1]=n.children),!0}));return r},objectToTree=function(t){if(null==t)return null;let e=new Tr;var n=function(t,e,r){var o=null!=r.name?r.name:"",i=null!=r.id?r.id:"_"+o;null!=t.nodes.get(i)&&(i=t.nodes.getNewId());var s=new Nd(i,o);t.addNodeToTree(s,e);var l=!0;for(var a in r)if("id"!=a&&"name"!=a)if("[object Array]"!=Object.prototype.toString.call(r[a]))s[a]=r[a];else if(l){for(var u=0;u<r[a].length;u++)n(t,s,r[a][u]);l=!1}else s[a]=JSON.parse(JSON.stringify(r[a]))};return n(e,null,t),e},filterNetworkByRelationsWeight=function(t,e=0,n,r,o){let i,s=new _.Net;switch(e){case 0:i=t.relations.getSortedByProperty("weight",!1).slice(0,n);break;case 1:i=t.relations.filter((t=>t.weight>n))}return i.forEach((t=>{let e=s.createNode(t.node0.name),n=s.createNode(t.node1.name);r&&r.forEach((r=>{e[r]=t.node0[r],n[r]=t.node1[r]}));let i=s.createRelation(e,n);o&&o.forEach((e=>{i[e]=t[e]})),i.weight=t.weight,i.color=t.color})),s},filterNodesByMinDegree=function(t,e){let n;for(n=0;null!=t.nodes[n];n++)t.nodes[n].nodes.length<e&&(t.removeNode(t.nodes[n]),n--);return null},degreeBetweenNodes=function(t,e,n){if(null==t||null==e||null==n)return null;if(e==n)return 0;let r,o,i,s=e.nodes,l=1;for(;null==s.get(n.id);){for(r=s.clone(),i=s.length,o=0;o<i;o++)r=concat(r,s[o].nodes);if(r=r.getWithoutRepetitions(),s.length==r.length)return-1;s=r,l++}return l},getNodesBetweenTwoNodes=function(t,e,n){let r,o,i=new ndL,s=t.nodes.length;for(r=0;r<s;r++)o=t.nodes[r],o.id!=e.id&&o.id!=n.id&&null!=e.nodes.get(o.id)&&null!=n.nodes.get(o.id)&&i.addNode(o);return i},getSubNetwork=function(t,e,n,r){let o,i,s,l=new Net;for(var a=0;a<e.length;a++)if(o=new Nd(e[a].id,e[a].name),l.addNode(o),n)for(var u=0;u<n.length;u++)o[n[u]]=e[a][n[u]];for(a=0;a<t.relations.length;a++)if(o=l.nodes.get(t.relations[a].node0.id),i=l.nodes.get(t.relations[a].node1.id),null!=o&&null!=i&&(s=new Rel(t.relations[a].id,t.relations[a].name,o,i,t.relations[a].weight),l.addRelation(s),r))for(u=0;u<r.length;u++)s[r[u]]=t.relations[a][r[u]];return l},shortestPath=function(t,e,n,r){if(null==t||null==e||null==n)return null;var o=spanningTree(t,e,n);let i=new ndL;r&&i.addNode(n);let s=o.nodes.get(n.id);if(null==s)return null;for(;s.parent.id!=e.id;)if(i.addNode(s.parent.node),s=s.parent,null==s)return null;return r&&i.addNode(e),i.getReversed()},shortestPaths=function(t,e,n,r,o){if(null==t||null==e||null==n)return null;var i;let s=new T;if(null!=e.nodes.get(n.id))return s.push(new ndL(e,n)),s;null==o&&(o=spanningTree(t,e,n));var l=o.nLevels;let a=new ndL(n),u=adjacentNodeList(t,a,!1),h=intersection(u,o.getLevel(l-2));var c=new T;let f;for(c.push(getRelationsBetweenNodeLists(t,h,a,!1));l>2;)l--,a=h,h=intersection(adjacentNodeList(t,a,!1),o.getLevel(l-2)),f=getRelationsBetweenNodeLists(t,h,a,!1),c.push(f);for(c=c.getReversed(),i=0;null!=c[0][i];i++)s.push(new ndL(e,c[0][i].getOther(e)));var p,g,d=function(t,e){var n,r=new T,o=t[t.length-1];return e.forEach((function(e){o.relations.get(e.id)&&((n=t.clone()).addNode(e.getOther(o)),r.push(n))})),r};let m,y;if(0==s.length)return s;for(;s[0].length<o.nLevels;){for(p=new T,m=s.length,i=0;i<m;i++)y=s[i],g=d(y,c[y.length-1]),p=p.concat(g);s=p}return s},getRelationsBetweenNodeLists=function(t,e,n,r=!0){if(null==e||null==n)return null;var o=new relL;let i,s,l=t.relations.length;for(s=0;s<l;s++)i=t.relations[s],(null!=e.get(i.node0.id)&&null!=n.get(i.node1.id)||!r&&null!=e.get(i.node1.id)&&null!=n.get(i.node0.id))&&o.addRelation(i);return o},_extendPaths=function(t,e,n){if(t[0].length>=n)return t;var r,o;let i,s;var l=new T;let a,u,h,c=t.length;for(r=0;r<c;r++)for(a=t[r],s=a[a.length-1],i=s.nodes.getWithoutRepetitions(),h=i.length,o=0;o<h;o++)null==a.get(i[o].id)&&(u=a.clone(),u.addNode(i[o]),l.push(u));return _extendPaths(t=l,e,n)},loops=function(t,e=3){if(null==t)return null;let n=function(t,e){if(t.length!=e.length)return!1;if(null==e.get(t[0].id))return!1;for(var n=e.indexOf(t[0]),r=t.length,o=1;null!=t[o];o++)if(t[o]!=e[(o+n)%r])return!1;return!0};var r,o,i,s,l=new T;for(r=0;null!=t.nodes[r];r++){for(s=_getLoopsOnNode(t.nodes[r]),i=0;null!=l[i];i++)for(o=0;null!=s[o];o++)n(s[o],l[i])&&(s.splice(o,1),o--);l=l.concat(s)}return e&&(l=l.getFilteredByPropertyValue("length",e,"greater")),l.sort((function(t,e){return t.length>e.length?-1:1})),l},_getLoopsOnNode=function(t){if(0===t.to.length||0===t.from.length)return[];var e=new T;let n,r,o,i,s=new ndL;for(s.addNode(t),e.push(s),_loopsColumns(t.to,1,e,1),n=1;e[n];n++)for(r=1;null!=e[r];r++)for(o=0;null!=e[r][o];o++)i=e[r][o],delete i.onColumn,0===i.to.length&&(e[r].removeNodeAtIndex(o),o--);let l,a=new T;for(r=1;null!=e[r];r++)for(o=0;null!=e[r][o];o++)i=e[r][o],null!=i.to.get(t.id)&&(l=new ndL(i),a.push(l),_pathsToCentral(e,r,l,a));return a.sort((function(t,e){return t.length>e.length?-1:1})),a},_pathsToCentral=function(t,e,n,r){if(n.finished)return;if(0===e)return void(n.finished=!0);var o;let i,s,l,a=n[0],u=!0;var h=t[e-1].clone();h.addNodes(t[e]);var c=t[e-1].length;for(o=0;null!=h[o];o++)i=h[o],a==i||null!=n.get(i.id)||null!=s&&null!=s.get(i.id)||null!=i.to.get(a.id)&&(u?(s=n.clone(),n.unshift(i),n.ids[i.id]=i,_pathsToCentral(t,o<c?e-1:e,n,r),u=!1):(l=s.clone(),r.push(l),l.unshift(i),l.ids[i.id]=i,_pathsToCentral(t,o<c?e-1:e,l,r)))},_loopsColumns=function(t,e,n){let r;null==n[e]&&(n[e]=new ndL);let o=new ndL;for(var i=0;null!=t[i];i++)r=t[i],r.onColumn||(r.onColumn=!0,n[e].addNode(r),o.addNodes(r.to));for(o=o.getWithoutRepetitions(),i=0;i<o.length;i++)o[i].onColumn&&(o.removeNodeAtIndex(i),i--);o.length>0&&_loopsColumns(o,e+1,n)},spanningTree=function(t,e,n,r){if(null==t)return;if(r>0)return _spanningTree2(e,r,n);e=null==e?t.nodes[0]:e,r=null==r?0:r;var o=new Tr;let i=new Nd(e.id,e.name);var s;let l,a,u,h,c;i.node=e,o.addNodeToTree(i);let f=(s=e.nodes).length;var p=!1;for(h=0;h<f;h++)a=new Nd(s[h].id,s[h].name),a.id!=i.id&&(a.node=s[h],o.addNodeToTree(a,i),null!=n&&a.id==n.id&&(p=!0));if(p)return o;var g=s.clone();g.addNode(e);for(var d=0;;){for(l=0==r?new ndL:s.clone(),h=0;null!=s[h];h++)l.addNodes(s[h].nodes);if(l=l.getWithoutRepetitions(),l.removeElements(g),0===l.length)return o;for(h=0;h<l.length;h++){a=new Nd(l[h].id,l[h].name),a.node=l[h];var m=l[h].nodes;if(null!=m&&0!=m.length){for(var y=0;null!=m[y];y++)if(c=m[y].id,u=s.get(c),null!=u&&a.id!=c){o.addNodeToTree(a,o.nodes.get(c));break}null!=n&&a.id==n.id&&(p=!0)}}if(p&&(p=!0),p)return o;if(s=l,g=g.concat(l),++d>t.nodes)return null}return o},_spanningTree2=function(t,e,n){e=null==e?0:e;var r=new Tr,o=function(t,i){if(!n||t.id!=n.id){var s=r.nodes.get(t.id);if(null==s){var l;switch(s=new Nd(t.id,t.name),r.addNodeToTree(s,i),e){case 0:l=t.nodes;break;case 1:l=t.to;break;case 2:l=t.from}for(var a=0;a<l.length;a++)o(l[a],s)}}};if(Array.isArray(t)){var i=new Nd("root","root");r.addNodeToTree(i),t.forEach((t=>o(t,i)))}else o(t,null);return r},spreads=function(t,e,n=.5,r="sizeReceived",o=!0,i){let s=null==i;i=i||e;let l=s?0:e*n,a=s?e:e*(1-n);if(t[r]=(t[r]||0)+l,t.to.length>0&&e/i>.01){let e=a/t.to.length;t.to.forEach((t=>{spreads(t,e,n,r,o,i)}))}else t[r]+=a},influenceLevels=function(t,e,n=!0){let r,o=new T,i=new T,s=new relL,l=null!=e.length,a=l?e:new ndL;l||a.addNode(e);let u=Math.random();a.forEach((t=>{t.__mark=u,t.__level=-1}));let h=function(t,e,o=0){r.push(t);let i=function(t,e,r){if(0==t.length)return null;let o,i,l=new ndL,a=e==n;return t.forEach((t=>{t.__level=r,o=e?t.toRelations:t.fromRelations,o?.forEach((t=>{i=e?t.node1:t.node0,t._onImpactTo=!0,i.__mark!=u&&(i.__mark=u,a&&s.addRelation(t),l.addNode(i))}))})),l}(t,e,o);if(0!=i.length)return h(i,e,o+1),i};n?(r=o,h(a,!0),r=i,h(a,!1)):(r=o,h(a,!1),r=i,h(a,!0));let c=[];for(let e=0;e<t.nodes.length;e++)t.nodes[e].__mark!=u&&(c.push(t.nodes[e]),t.nodes[e].__level=-1);let f=new relL;for(let e=0;e<t.relations.length;e++)t.relations[e].node1?.__level-t.relations[e].node0?.__level==1&&f.addRelation(t.relations[e]);return{levelsTableMain:o,levelsTableSecondary:i,notImpacted:c,influenceRelations:s,extendedInfluenceRelations:f}},adjacentNodeList=function(t,e,n,r){if(null==t||null==e)return null;var o=n?e.clone():new ndL;let i,s,l,a;if(r){for(i=0;i<e.length;i++)for(s=0;s<e[i].to.length;s++)a=e[i].to[s].id,null==e.get(a)&&null==o.get(a)&&o.addNode(a);return o}for(i=0;i<e.length;i++)for(s=0;null!=e[i].relations[s];s++)l=e[i].relations[s].node0,a=e[i].relations[s].node1,null==e.get(l.id)&&null==o.get(l.id)&&o.addNode(l),null==e.get(a.id)&&null==o.get(a.id)&&o.addNode(a);return o},degreesPartition=function(t,e){let n,r,o,i,s=new ndL(e),l=e.nodes,a=new T(s),u=l.length>0;u&&a.push(l);var h=l.clone();for(h.push(e);u;){for(r=new ndL,o=0;null!=l[o];o++)for(n=l[o].nodes,i=0;i<n.length;i++)h.includes(n[i])||(r.push(n[i]),h.push(n[i]));u=r.length>0,u&&(l=r,a.push(l))}return a},getNodes=function(t){return null==t?null:null!=t.nodes?t.nodes:"Rel"==typeOf(t)?new ndL(t.node0,t.node1):null},buildDendrogram=function(t){if(null==t)return null;var e=new Tr;let n=new ndL;var r;let o,i,s,l,a,u=t.nodes.length;var h=2*t.relations.length/(u*(u-1));for(a=0;a<u;a++)s=new Nd("["+t.nodes[a].id+"]","["+t.nodes[a].id+"]"),s.nodes=new ndL(t.nodes[a]),e.addNode(s),n[a]=s;for(;n.length>1;){for(o=n[(r=_getClosestPair(n,!0,h))[0]],i=n[r[1]],l="["+o.id+"-"+i.id+"]",s=new Nd(l,l),s.weight=r.strength,e.addNode(s),e.createRelation(s,o,l+"-"+o.id),e.createRelation(s,i,l+"-"+i.id),s.node=new Nd(l,l),s.nodes=o.nodes.concat(i.nodes),a=0;a<o.nodes.length;a++)s.node.nodes.addNode(o.nodes[a]),s.node.relations.addRelation(o.relations[a]);for(a=0;a<i.nodes.length;a++)s.node.nodes.addNode(i.nodes[a]),s.node.relations.addRelation(i.relations[a]);n.removeElement(o),n.removeElement(i),n.addNode(s)}for(a=0;a<e.nodes.length;a++)o=e.nodes[a],o.nodes.length>1&&(o.level=Math.max(o.nodes[0].level,o.nodes[1].level)+1);return e},_getClosestPair=function(t,e,n){let r;if(2==t.length){var o=t[0].nodes.indexOf(t[1]);return e?(r=[0,1],r.strength=-1==o?0:t[0].relations[o].weight,r):((t=new ndL(t[0],t[1])).strength=-1==o?0:t[0].relations[o].weight,t)}var i;let s;var l,a;let u=-1;for(i=0;i<t.length-1;i++)for(l=t[i].nodes,s=i+1;s<t.length;s++)(a=_strengthBetweenSets(l,t[s].nodes,n))>u&&(r=[i,s],u=a);return r.strength=u,e?r:((t=new ndL(t[r[0]],t[r[1]])).strength=u,t)},_strengthBetweenSets=function(t,e,n){let r,o,i,s=0;for(r=0;r<t.length;r++)for(i=t[r],o=0;o<i.nodes.length;o++)e.includes(i.nodes[o])&&(s+=i.relations[o].weight);return s/(t.length*e.length*n)},buildNetworkClusters=function(t,e,n,r,o,i){if(null==t)return;var s;let l,a,u,h,c;if(null==e||0===e?s=_buildNetworkClustersLvn(t):(null!=t._dendrogramTree&&(n=t._dendrogramTree),null==n&&(n=buildDendrogram(t)),t._dendrogramTree=n,r=r||.5,s=new T,_iterativeBuildClusters(n.nodes[n.nodes.length-1],s,r)),o)for(l=createDefaultCategoricalColorList(s.length),h=s.length,a=0;a<h;a++)for(c=s[a].length,u=0;u<c;u++)s[a][u].color=l[a];if(1==i){var f=new sL;for(f.name="clusters names",a=0;a<t.nodes.length;a++)t.nodes[a]._index=a;for(a=0;a<s.length;a++)for(c=s[a].length,u=0;u<c;u++)f[s[a][u]._index]="cluster_"+a;return f}return s},_iterativeBuildClusters=function(t,e,n){1!=t.nodes.length?(1==t.nodes[0].nodes.length||t.nodes[0].weight>n?e.push(t.nodes[0].nodes):_iterativeBuildClusters(t.nodes[0],e,n),1==t.nodes[1].nodes.length||t.nodes[1].weight>n?e.push(t.nodes[1].nodes):_iterativeBuildClusters(t.nodes[1],e,n)):e.push(new ndL(t.node))},_buildNetworkClustersLvn=function(t){if(null==t)return t;var e=[];let n;for(n=0;n<t.nodes.length;n++)e.push("n"+t.nodes[n].id);let r=[];for(n=0;n<t.relations.length;n++){var o={source:"n"+t.relations[n].node0.id,target:"n"+t.relations[n].node1.id,weight:t.relations[n].weight};r.push(o)}let i=_jLvn().nodes(e).edges(r)(),s=new T;if(i)for(n=0;n<t.nodes.length;n++){var l=i["n"+t.nodes[n].id];null==s[l]&&(s[l]=new ndL),s[l].addNode(t.nodes[n])}else for(n=0;n<t.nodes.length;n++)s.push(new ndL(t.nodes[n]));return s},getNodesPageRanks=function(t,e,n){return addPageRankToNodes(t,e,n)},addPageRankToNodes=function(t,e=2,n){var r,o,i,s,l,a,u,h=t.nodes.length,c=(1-.85)/h,f=["toPageRank","fromPageRank","allPageRank"][e=0==e?0:1==e?1:e],p=1;for(t.minFromPageRank=t.minToPageRank=99999999,t.maxFromPageRank=t.maxToPageRank=-99999999,o=0;null!=t.nodes[o];o++)(s=t.nodes[o])[f]=1/h;let g;for(r=0;r<300;r++)for(o=0;null!=t.nodes[o];o++){switch(s=t.nodes[o],e){case 0:a=s.to;break;case 1:a=s.from;break;case 2:a=s.nodes}for(s[f]=c,n&&(u=e?s.fromRelations:s.toRelations),i=0;null!=a[i];i++)l=a[i],n&&(p=u[i].weight),s[f]+=.85*p*l[f]/(e?l.to.length:l.from.length);299==r&&(n&&(s[f]=Math.pow(s[f],4)),e?(t.minFromPageRank=Math.min(t.minFromPageRank,s[f]),g=t.maxFromPageRank=Math.max(t.maxFromPageRank,s[f])):(t.minToPageRank=Math.min(t.minToPageRank,s[f]),g=t.maxToPageRank=Math.max(t.maxToPageRank,s[f])))}return t.nodes.forEach((t=>{t[f]/=g,console.log(t[f])})),t.nodes.getPropertyValues(f)},fusionNetworks=function(t,e,n,r){e=null==e?1:e,n=null==n?1:n;var o=new Net;let i,s,l,a,u=new T;var h,c=createDefaultCategoricalColorList(t.length).getInterpolated("black",.17).getInterpolated("white",.55);for(t.forEach((function(t,e){u[e]=new ndL,t.nodes.forEach((function(t){i=o.nodes.get(t.id),null==i?(i=new Nd(t.id,t.name),i.basicId=t.basicId,i.mapId="map_"+e,i.mapsIds=[i.mapId],i.color=null==t.color?t.color:c[e],i.nMaps=1,i.weight=t.weight,i.kind=t.kind,r&&r.forEach((e=>i[e]=t[e])),o.addNode(i),u[e].addNode(i)):(i.nMaps+=1,i.mapsIds.push("map_"+e),i.color=null==i.color?"rgb(200,200,200)":i.color,t.weight&&null==i.weight&&(i.weight=t.weight),t.kind&&null==i.kind&&(i.kind=t.kind),r&&r.forEach((e=>{t[e]&&null==i[e]&&(i[e]=t[e])})))}))})),t.forEach((function(t){t.relations.forEach((function(t){s=new Rel(t.id,t.name,o.nodes.get(t.node0.id),o.nodes.get(t.node1.id)),s.color=t.color,s.content=t.content,s.description=t.description,s.weight=t.weight,o.addRelation(s)}))})),l=0;null!=o.nodes[l];l++)for(h=o.nodes[l],a=l+1;null!=o.nodes[a];a++)h.name==o.nodes[a].name&&(s=new Rel(h.id+"_"+o.nodes[a].id,"same variable",h,o.nodes[a]),s.color="black",s.distanceFactor=e,s.forceWeight=n,o.addRelation(s),s=new Rel(o.nodes[a].id+"_"+h.id,"same variable",o.nodes[a],h),s.color="black",s.distanceFactor=e,s.forceWeight=n,o.addRelation(s),s.node0.nMaps+=1,s.node1.nMaps+=1);for(l=0;null!=o.nodes[l];l++)o.nodes[l].hubWeight=Math.sqrt(o.nodes[l].nMaps-1);return o.mapsCluster=u,o},_jLvn=function(){let t,e,n,r={};function o(t){var e={};return t.forEach((function(t){e[t]=!0})),Object.keys(e)}function i(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function s(t,e){var n=t._assoc_mat[e]?Object.keys(t._assoc_mat[e]):[],r=0;return n.forEach((function(n){var o=t._assoc_mat[e][n]||1;e==n&&(o*=2),r+=o})),r}function l(t,e){return void 0===t._assoc_mat[e]?[]:Object.keys(t._assoc_mat[e])}function a(t,e,n){return t._assoc_mat[e]?t._assoc_mat[e][n]:void 0}function u(t){var e={};return t.forEach((function(t){e[t.source]=e[t.source]||{},e[t.source][t.target]=t.weight,e[t.target]=e[t.target]||{},e[t.target][t.source]=t.weight})),e}function h(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var n in t)e[n]=h(t[n]);return e}function c(t,e,n){e.nodes_to_com={},e.total_weight=0,e.internals={},e.degrees={},e.gdegrees={},e.loops={},e.total_weight=function(t){var e=0;return t.edges.forEach((function(t){e+=t.weight})),e}(t),void 0===n?t.nodes.forEach((function(n,r){e.nodes_to_com[n]=r;var o=s(t,n);o<0||(e.degrees[r]=o,e.gdegrees[n]=o,e.loops[n]=a(t,n,n)||0,e.internals[r]=e.loops[n])})):t.nodes.forEach((function(r){var o=n[r];e.nodes_to_com[r]=o;var i=s(t,r);e.degrees[o]=(e.degrees[o]||0)+i,e.gdegrees[r]=i;var a=0;l(t,r).forEach((function(e){var i=t._assoc_mat[r][e];if(i<=0)throw"Bad graph type, use positive weights";n[e]==o&&(a+=e==r?i:i/2)})),e.internals[o]=(e.internals[o]||0)+a}))}function f(t){var e=t.total_weight,n=0;return o(i(t.nodes_to_com)).forEach((function(r){var o=t.internals[r]||0,i=t.degrees[r]||0;e>0&&(n=n+o/e-Math.pow(i/(2*e),2))})),n}function p(t,e,n){var r={};return l(e,t).forEach((function(o){if(o!=t){var i=e._assoc_mat[t][o]||1,s=n.nodes_to_com[o];r[s]=(r[s]||0)+i}})),r}function g(t,e,n,r){r.nodes_to_com[t]=+e,r.degrees[e]=(r.degrees[e]||0)+(r.gdegrees[t]||0),r.internals[e]=(r.internals[e]||0)+n+(r.loops[t]||0)}function d(t,e,n,r){r.degrees[e]=(r.degrees[e]||0)-(r.gdegrees[t]||0),r.internals[e]=(r.internals[e]||0)-n-(r.loops[t]||0),r.nodes_to_com[t]=-1}function m(t){var e=0,n=h(t),r={};return Object.keys(t).forEach((function(o){var i=t[o],s=void 0===r[i]?-1:r[i];-1==s&&(r[i]=e,s=e,e+=1),n[o]=s})),n}function y(t,e){for(var n=!0,r=0,o=f(e),i=o;n&&-1!=r&&(o=i,n=!1,r+=1,t.nodes.forEach((function(r){var o=e.nodes_to_com[r],i=(e.gdegrees[r]||0)/(2*e.total_weight),s=p(r,t,e);d(r,o,s[o]||0,e);var l=o,a=0;Object.keys(s).forEach((function(t){var n=s[t]-(e.degrees[t]||0)*i;n>a&&(a=n,l=t)})),g(r,l,s[l]||0,e),l!=o&&(n=!0)})),!((i=f(e))-o<1e-7)););}function x(t,e){var n,r,s={nodes:[],edges:[],_assoc_mat:{}},l=i(t);return s.nodes=s.nodes.concat(o(l)),e.edges.forEach((function(e){r=e.weight||1;var o=t[e.source],i=t[e.target];n=a(s,o,i)||0,function(t,e){!function(t,e){t._assoc_mat[e.source]=t._assoc_mat[e.source]||{},t._assoc_mat[e.source][e.target]=e.weight,t._assoc_mat[e.target]=t._assoc_mat[e.target]||{},t._assoc_mat[e.target][e.source]=e.weight}(t,e);var n=t.edges.map((function(t){return t.source+"_"+t.target})).indexOf(e.source+"_"+e.target);-1!=n?t.edges[n].weight=e.weight:t.edges.push(e)}(s,{source:o,target:i,weight:n+r})})),s}var w=function(){var t=function(t,e){if(0===t.edges.length){var n={};return t.nodes.forEach((function(t){n[t]=t})),n}var o={};c(r,o,e);var i=f(o),s=[];y(r,o);var l=f(o),a=m(o.nodes_to_com);s.push(a),i=l;var u=x(a,r);for(c(u,o);y(u,o),!((l=f(o))-i<1e-7);)a=m(o.nodes_to_com),s.push(a),i=l,c(u=x(a,u),o);return s}(r,n);return function(t,e){for(var n=h(t[0]),r=1;r<e+1;r++)Object.keys(n).forEach((function(e){var o=e,i=n[e];n[o]=t[r][i]}));return n}(t,t.length-1)};return w.nodes=function(e){return arguments.length>0&&(t=e),w},w.edges=function(n){if(void 0===t)throw"Please provide the graph nodes first!";if(arguments.length>0){e=n;var o=u(n);r={nodes:t,edges:e,_assoc_mat:o}}return w},w.partition_init=function(t){return arguments.length>0&&(n=t),w},w},getNodesCentralities=function(t,e,n,r){if(null!=t){var o=new nL;0===(e=null==e?0:e)&&addEigenvectorCentralityToNodes(t,n,r),1===e&&addBetweennessCentralityToNodes(t,n,r);for(var i=0;i<t.nodes.length;i++)o[i]=0==e?t.nodes[i].eigenvectorCentrality:t.nodes[i].betweennessCentrality;return o}},addCentralitiesToNodes=function(t,e,n,r){if(null!=t)return 0===(e=null==e?0:e)&&addEigenvectorCentralityToNodes(t,n,r),1===e&&addBetweennessCentralityToNodes(t,n,r),2===e&&addReachToNodes(t,!1),3===e&&addReachToNodes(t,!0),t},_getAdjacencyMap=function(t,e,n,r){if(null==t)return null;e=null!=e&&e,n=null!=n&&n,r=null!=r&&r;for(var o={},i=0;i<t.nodes.length;i++)o[t.nodes[i].id]={};for(i=0;i<t.relations.length;i++){var s=t.relations[i],l=s[n?"node1":"node0"].id,a=s[n?"node0":"node1"].id;o[l][a]=1-.5*s.weight,e||(o[a][l]=o[l][a])}if(r)for(var l in o){var u=[];for(var h in o[l])u.push(o[l][h]);var c=0;for(i=0;i<u.length;i++)c+=u[i];for(var a in o[l])o[l][a]/=c}return o},addEigenvectorCentralityToNodes=function(t,e,n){if(null==t)return t;void 0===e&&(e=!0),void 0===n&&(n=!0);let r={};function o(t){var e=[];for(var n in t)e.push(t[n]);for(var r=0,o=0;o<e.length;o++)r+=e[o];var i=1/(r||1);for(var s in t)t[s]*=i}let i=_getAdjacencyMap(t,null,n);randomSeed(1);let s={};for(var l=0;l<t.nodes.length;l++)s[t.nodes[l].id]=random();o(s),randomSeedPop();for(l=0;l<100;l++){var a=s;for(var u in s={},a)s[u]=0;for(var h in s)for(var c in i[h])s[h]+=.01+a[c]*i[h][c]*(r[p]?r[p]:1);o(s);var f=0;for(var p in s)f+=Math.abs(s[p]-a[p]);if(f<1e-4*t.nodes.length){if(e){var g=[];for(var u in s)g.push(s[u]);var d=Math.max.apply(Math,g)||1;for(var m in s)s[m]/=d}for(var m in s){t.nodes.get(m).eigenvectorCentrality=s[m]}return t}}for(l=0;l<t.nodes.length;l++)t.nodes[l].eigenvectorCentrality=0;return t},addBetweennessCentralityToNodes=function(t,e,n){if(null==t)return t;void 0===e&&(e=!0),void 0===n&&(n=!1);var r=function(){this.init=function(){this.k=[],this.w=[],this.length=0},this.init(),this.push=function(t,e){for(var n=0;n<=this.w.length&&e<(this.w[n]||1/0);)n++;return this.k.splice(n,0,t),this.w.splice(n,0,e),this.length+=1,!0},this.pop=function(){return this.length-=1,this.w.pop(),this.k.pop()}},o=_getAdjacencyMap(t,null,!0);let i,s,l,a={};for(var u=0;u<t.nodes.length;u++)a[t.nodes[u].id]=0;for(u=0;u<t.nodes.length;u++){for(var h=t.nodes[u].id,c=new r,f={},p={},g=0;g<t.nodes.length;g++)p[t.nodes[g].id]=[];var d={id:0};c.push([0,h,h],0);var m=[],y={};for(g=0;g<t.nodes.length;g++)y[t.nodes[g].id]=0;for(y[h]=1;c.length;){var x=c.pop();if(i=x[0],s=x[1],l=x[2],!(l in f))for(var w in f[l]=i,m.push(l),y[l]+=y[s],o[l]){var L=f[l]+o[l][w];w in f||w in d&&!(L<d[w])?L==d[w]&&(p[w].push(l),y[w]=y[w]+y[l]):(d[w]=L,c.push([L,l,w],L),p[w]=[l],y[w]=0)}}var v={};for(g=0;g<t.nodes.length;g++)v[t.nodes[g].id]=0;for(;m.length;){for(w=m.pop(),g=0;g<p[w].length;g++)l=p[w][g],v[l]+=(1+v[w])*y[l]/y[w];w!=h&&(a[w]+=v[w])}}if(e){var b=[];for(var T in a)b.push(a[T]);var _=Math.max.apply(Math,b)||1;for(var h in a)a[h]/=_}for(var h in a){var M=t.nodes.get(h);M.betweennessCentrality=a[h],M.betweennessCentralityDegreeRatio=M.betweennessCentrality/(M.nodes.length+.001)}return t},addReachToNodes=function(t,e=!1){let n=function(t){return t.reach||(t.reach=new L,t.to.forEach((r=>{t.reach=t.reach.concat(n(r,e)),t.reach.push(r),e||(t.reach=t.reach.getWithoutRepetitions())}))),t.reach};t.nodes.forEach((t=>t.reach=null)),t.nodes.forEach((t=>{t.reach||n(t)})),t.nodes.forEach((t=>{console.log(t.name,t.reach.getPropertyValues("name").join(", ")),t.reach=t.reach.length}))},getLeaves=function(t){if(null!=t)return null!=t.getLeaves?t.getLeaves():null},createNetworkFromListAndFunction=function(t,e,n,r,o,i){if(null==t||null==e)return;var s,l;let a,u,h,c=new Net,f=t.length;for(r=null==r?.3:r,s=0;s<f;s++)u=new Nd("n_"+s,null==n?"n_"+s:n[s]),u.element=t[s],u.i=s,c.addNode(u);if(i)for(s=0;s<f;s++)for(u=c.nodes[s],l=s+1;l<f;l++)h=c.nodes[l],a=e(t[s],t[l]),a>r&&(o>0&&(a-=r),2==o&&(a/=1-r),c.addRelation(new Rel(s+"_"+l,s+"_"+l,u,h,a)));else for(s=0;s<f;s++)for(u=c.nodes[s],l=0;l<f;l++)s!=l&&(h=c.nodes[l],a=e(t[s],t[l]),a>r&&(o>0&&(a-=r),2==o&&(a/=1-r),c.addRelation(new Rel(s+"_"+l,s+"_"+l,u,h,a))));return c},createRandomNetwork=function(t,e,n,r,o){if(null==t||null==e)return null;var i,s,l;i=null!=o?function(){return o++,getRandomWithSeed(o)}:Math.random,n=null==n?0:n;let a,u=new Net;for(s=0;s<t;s++)u.addNode(new Nd("n"+s,"n"+s));switch(n){case 0:if(e<1)for(s=0;s<t-1;s++)for(a=u.nodes[s],l=s+1;l<t;l++)i()<e&&u.addRelation(new Rel(s+"_"+l,s+"_"+l,a,u.nodes[l],r?i():1));else for(e=Math.min(e,t*(t-1)*.5);u.relations.length<e;)(s=Math.floor(i()*t))!=(l=Math.floor(i()*t))&&null==u.relations.get(s+"_"+l)&&u.addRelation(new Rel(s+"_"+l,s+"_"+l,u.nodes[s],u.nodes[l],r?i():1));return u;case 1:var h,c,f,p=t*(t-1)*.5;for(s=0;s<p;s++)if(i()<e)for(h=!0;h;)if(a=u.nodes[Math.floor(u.nodes.length*i())],i()<(a.nodes.length+1)/1)for(;h;)c=u.nodes[Math.floor(u.nodes.length*i())],f=a.id+"_"+c.id,null==u.relations.get(f)&&null==u.relations.get(c.id+"_"+a.id)&&i()<(c.nodes.length+1)/1&&(u.addRelation(new Rel(f,f,a,c,r?i():1)),h=!1);return u}},textsToNet=function(t,e,n,r=.8,o=1){let i=transpose(getWordsInTextsOccurrencesTable(t,0,o),!0);return buildCorrelationsNetwork(i,!0,e||t,n,r)},parseNet=function(t,e=.2){let n=new _.Net;if(Array.isArray(t)&&2==t.length){let r=t[0],o=t[1];try{r=JSON.parse(r)}catch(t){}if(!Array.isArray(null==r)){r=[],t[0].split("\n").forEach((t=>{r.push(JSON.parse(t))}))}const i=["nodes","relations","type"];r.forEach((t=>{let e=t.node.labels[0],r=new _.Nd(String(t.node?.id),t.node?.properties?.fullName||t.node?.properties?.title);if(r.category=e,r.color=interpolateColors(stringToColor(e),"white",.7),r.urlImage=t.node?.properties?.savedImg,r.properties=t.node?.properties,r.properties)for(let t in r.properties)i.includes(t)||(r[t]=r.properties[t]);n.addNode(r)}));try{o=JSON.parse(o)}catch(t){}if(!Array.isArray(o)){o=[],t[1].split("\n").forEach((t=>{o.push(JSON.parse(t))}))}o.forEach((t=>{let r=t.rel?.properties?.weight;r<e||null!=n.get(String(t.rel.start.id))&&null!=n.get(String(t.rel.end.id))&&(n.createRelation(t.rel.start.id,t.rel.end.id).weight=r)}))}return n},textToNet=function(t,e="\n\n",n,r,o,i,s,l=!1){if(null==t)return;let a;Array.isArray(t)?(a=t,t=t.join(/\n\n/)):a=null!=o?t.split(o):[t],a=a.filter((t=>""!=t));let u,h={},c=0;a.forEach(((t,n)=>{u=t.split(e),u.forEach(((t,e)=>{let r=getWords(t);s&&(r=r.concat(getBigrams(t))),r.forEach((t=>{let e=h[t];null==e&&(e={word:t,count:0,contexts:[],groups:[],locations:[]},h[t]=e),e.count++,e.groups.push(n),e.locations.push(c)})),c++}))}));let f=new L,p=0;for(let t in h){let e=h[t];f.push(e)}f=f.getSortedByProperty("count",!1).slice(0,n).filter((t=>t.count>1)),f.forEach((t=>{p=Math.max(p,t.count),t.vector=createListWithSameElement(c,0),t.locations.forEach((e=>t.vector[e]++)),t.vector.mean=t.vector.getMean(),t.vector.standardDeviation=t.vector.getStandardDeviation()}));let g=new L,d=r<=1;for(let t=0;t<f.length;t++)for(let e=t+1;e<f.length;e++){let n=f[t],o=f[e],i={pair_id:n.word+"_"+o.word,wordObject0:n,wordObject1:o,weight:numericCorrelation(n.vector,o.vector)};(!d||i.weight>=r)&&g.push(i)}d||(g=g.getSortedByProperty("weight",!1).slice(0,r));let m=new Net;g.forEach((t=>{let e=m.createRelation(t.wordObject0.word,t.wordObject1.word);null==e.node0.count&&(e.node0.count=t.wordObject0.count,e.node0.weight=Math.log(t.wordObject0.count),e.node0.groups=t.wordObject0.groups),null==e.node1.count&&(e.node1.count=t.wordObject1.count,e.node1.weight=Math.log(t.wordObject1.count),e.node1.groups=t.wordObject1.groups),e.content=e.node0.name+"|"+e.node1.name+" "+t.weight,e.weight=t.weight}));let y=a.length,x=createDefaultCategoricalColorList(y,"0.9").getInterpolated("white",.6);m.colorsTable=new T,m.colorsTable[0]=new sL,m.colorsTable[1]=new cL;for(let t=0;t<y;t++)m.colorsTable[0][t]=t,m.colorsTable[1][t]=x[t];return m.nodes.forEach((t=>{t.colorsTable=toL(t.groups).getFrequenciesTable(!0,!0).getColumns([0,2]),2==y&&(t.groupsProportion=(t.groups.filter((t=>0==t)).length-t.groups.filter((t=>1==t)).length)/t.groups.length),t.colorsTable[0]=t.colorsTable[0].map((t=>x[t]))})),l&&(u=t.toLowerCase().split(e),m.relations.forEach((t=>{t.content="",u.forEach((n=>{n.includes(t.node0.name)&&n.includes(t.node1.name)&&(""!=t.content&&(t.content+=e+" /// "),t.content+=n)}))}))),m},textToTree=function(t,e,n="text"){let r=new _.Tr,o=function(t,n,i){if(!t||""==t.trim())return;let s=null==i?"text":t.includes("\n")?t.split("\n")[0]:t.includes(".")?t.split(".")[0]:t.includes(" ")?t.split(" ")[0]:t.substr(0,100),l=new _.Nd(s,s);l.text=t,l.level=n,r.addNodeToTree(l,i),l.weight=t.length;let a=t.split(e[n]);if(console.log(n,s,a.length),a.length<2)return;let u=e[n].toString().includes("(");if(n<3&&(console.log("level:",n),console.log("div:",e[n]),console.log("blocks:",a),console.log("divisors[level]:",e[n]),console.log("captureDivisor:",u)),u){let t,r,i="";for(var h=0;h<a.length;h+=2)console.log("+++",h),t=a[h],t&&""!=t.trim()?(i=h>0?t[h-1]:"",r=t[h],console.log("   ++++++++ level, detectedDivisor:",n,i),n<e.length&&o(h>0?(i+r).trim():t.trim(),n+1,l)):h++}else a.forEach((t=>{t&&""!=t.trim()&&(t=t.trim(),n<e.length&&o(t,n+1,l))}))};return o(t,0),r.nodes[0].name=n,r},imageToTableOfRGBA=function(t,e){if(null==t||t.width<=0)return null;e=null!=e&&e;let n,r,o,i=_getPixelData(t);if(null==i)return null;if(e){n=new T;for(var s=0;s<t.width;s++){n.push(new cL);for(var l=0;l<t.height;l++)n[s].push("")}}else n=createUniformTable(t.width,t.height,[]);for(var a=0;a<i.length;a+=4)r=a/4%t.width,o=Math.floor(a/4/t.width),n[r][o]=e?"rgba("+i[a]+","+i[a+1]+","+i[a+2]+","+i[a+3]/255+")":[i[a],i[a+1],i[a+2],i[a+3]/255];return n},invertImageColors=function(t){if(null==t||t.width<=0)return null;let e=_getPixelData(t);if(null==e)return null;for(var n=0;n<e.length;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2];let r=new ImageData(e,t.width,t.height);return _makeImageFromData(r)},grayscaleImage=function(t){if(null==t||t.width<=0)return null;let e=_getPixelData(t);if(null==e)return null;for(var n=0;n<e.length;n+=4){var r=.2126*e[n]+.7152*e[n+1]+.0722*e[n+2];e[n]=e[n+1]=e[n+2]=r}let o=new ImageData(e,t.width,t.height);return _makeImageFromData(o)},cropImage=function(t,e,n,r,o){if(null==t||t.width<=0)return null;if(t.isList){for(var i=new L,s=0;s<t.length;s++){var l=cropImage(t[s],e,n,r,o);i=i.concat(l)}return i}e=null==e?0:e,n=null==n?0:n,r=null==r?t.width:r,o=null==o?t.height:o;let a=document.createElement("canvas"),u=a.getContext("2d");a.width=t.width,a.height=t.height,u.drawImage(t,0,0);var h=u.getImageData(e,n,r,o);return _makeImageFromData(h)},resizeImage=function(t,e,n,r,o){if(null==t||t.width<=0)return null;r=null==r||0!=r&&1!=r?0:r,o=null==o?"topleft":o;let i=new MetaCanvas({container:null,dimensions:{width:e=null==e||Math.round(e)<=0?200:Math.round(e),height:n=null==n||Math.round(n)<=0?Math.round(e/t.width*t.height):Math.round(n)},noLoop:!0,noStart:!0});var s;if(0==r){var l,a,u,h,c=o;if("topleft"==c.toLowerCase()){var f=_getPixelData(t);c="rgba("+f[0]+","+f[1]+","+f[2]+","+(f[3]/255).toFixed(2)+")"}i.fill(c),i.fRect(0,0,e,n),l=(e-(u=(h=Math.min(n,e*t.height/t.width))*t.width/t.height))/2,a=(n-h)/2,i.drawImage(t,0,0,t.width,t.height,l,a,u,h),s=i.captureCanvas()}else 1==r&&(i.drawImage(t,0,0,t.width,t.height,0,0,e,n),s=i.captureCanvas());return s},getDataURL=function(t,e){if(null==t||t.width<=0)return null;let n=new MetaCanvas({container:null,dimensions:{width:t.width,height:t.height},noLoop:!0,noStart:!0});n.drawImage(t,0,0);let r=n.captureCanvas();return e?'<img src="'+r.src+'">':r.src},_getPixelData=function(t){if(null==t||t.width<=0)return null;let e;try{var n=document.createElement("canvas"),r=n.getContext("2d");n.width=t.width,n.height=t.height,r.drawImage(t,0,0),e=r.getImageData(0,0,t.width,t.height).data}catch(t){throw t}return e},_makeImageFromData=function(t){if(null==t||null==t.width||t.width<=0||t.height<=0)return null;try{var e=document.createElement("canvas"),n=e.getContext("2d");e.width=t.width,e.height=t.height,n.putImageData(t,0,0);var r=document.createElement("img");r.src=e.toDataURL("image/png")}catch(t){throw t}return r},expandSimpleHtml=function(t,e,n){if(null==t||""===t)return"";var r;if(n&&(t=t.replaceAll("\n","<br>")),t.split("<").length!=t.split(">").length)return t;var o=t;if(-1!=o.indexOf("<fs"))for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fs",">"))&&(o=o.replace("<fs"+r+">",'<font style="font-size:'+Number(r)+'px">')),-1==o.indexOf(">")&&(r=null);for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<ff",">"))&&(o=o.replace("<ff"+r+">",'<font face="'+r+'">'));for(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.replace(//,"<br/>")).replace(/<fcBlack>/g,'<font color="#000000">')).replace(/<.White>/g,'<font color="#FFFFFF">')).replace(/<fcRed>/g,'<font color="#FF0000">')).replace(/<fcGreen>/g,'<font color="#00FF00">')).replace(/<fcBlue>/g,'<font color="#0000FF">')).replace(/<fcOrange>/g,'<font color="#FFAA00">')).replace(/<fcCyan>/g,'<font color="#00FFFF">')).replace(/<fcYellow>/g,'<font color="#FFFF00">')).replace(/<fcMagenta>/g,'<font color="#FF00FF">'),r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fcuint",">"))&&(o=o.replace("<fcuint"+r+">",'<font color="'+uinttoHEX(r)+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fccolor",">"))&&(o=o.replace("<fccolor"+r+">",'<font color="'+colorStringToHEX(r)+'">'));for(r="";null!=r;)if(null!=(r=getFirstTextBetweenStrings(o,"<frgb",">"))){var i=r.split(".");o=o.replace("<frgb"+r+">",'<font color="'+RGBtoHEX(Number(i[0]),Number(i[1]),Number(i[2]))+'">')}if(-1!=o.indexOf("<fc"))for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<fc",">"))&&(o=o.replace("<fc"+r+">",'<font color="'+("#"==r[0]?"":"#")+r+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<tl",">"))&&(o=o.replace("<tl"+r+">",'<textformat leftmargin="'+r+'">'));for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<tv",">"))&&(o=o.replace("<tv"+r+">",'<textformat leading="'+r+'">'));let s,l,a;for(r="";null!=r;)null!=(r=getFirstTextBetweenStrings(o,"<e",">"))&&(s=r.split("*")[0],l=r.split("*")[1],a=r.split("*").length>2&&"s"==r.split("*")[2]?"_self":"_blank",o="http://"==s.substr(0,7)||"https://"==s.substr(0,8)?o.replace("<e"+r+">","<u><a href='"+s+"' target='"+a+"'>"+l+"</a></u>"):o.replace("<e"+r+">","<u><a href='javascript:document.clickLink(\""+s+'","'+e+"\")' FastHtml.onclick='event.preventDefault(); clickLink(\""+s+'","'+e+"\"); return false; '>"+l+"</a></u>"));return o=(o=(o=(o=(o=(o=o.replace(/<pl>/g,'<p align="left">')).replace(/<pc>/g,'<p align="center">')).replace(/<pr>/g,'<p align="right">')).replace(/<pj>/g,'<p align="justify">')).replace(/<\/f>/g,"</font>")).replace(/<\/t>/g,"</textformat>")},clickLink=function(t,e){for(var n=0;n<FastHtml_clickLinkFunctionsToCall.length;n++)FastHtml_clickLinkFunctionsToCall[n].call(FastHtml_clickLinkTargetsToCall[n],t,e)},_typeDict={L:L,iL:iL,cL:cL,P:P,P3D:P3D,Pol:Pol,Pol3D:Pol3D,Rec:Rec,T:T,nT:nT,polL:polL,Nd:Nd,sL:sL,ndL:ndL,relL:relL,recL:recL,Rel:Rel,Net:Net,Tr:Tr,dI:dI,dL:dL,nL:nL,I:I,pol3DL:pol3DL,cScale:cScale,MetaCanvas:MetaCanvas,Engine3D:Engine3D,Forces:Forces},TwoPi=6.28318530718;function ifDef(t,e){return null!=t?t:e}function typeOf(t){if(null==t)return null;var e=typeof t;return"object"!==e?e:null!=t.type?t.type:"[object Array]"==Object.prototype.toString.call(t)?"Array":null!=t.getDate?"date":"Object"}var _typeOf=function(t){if(null==t)return null;var e=typeof t;return"object"!==e?e:null!=t.type?t.type:"[object Array]"==Object.prototype.toString.call(t)?"Array":null!=t.getDate?"date":"Object"},noOperation=function(){};function resizeThrottler(t,e){var n;return function(r){n||(n=setTimeout((function(){n=null,t(r)}),e))}}function instantiate(t,e){switch(t){case"number":case"string":return window[t](e);case"date":if(!e||0===e.length)return new Date;if(1==e.length){if(e[0].match(/d*.-d*.-d*Dd*.:d*.:d*/)){var n=e[0].split(" ");return n[0]=n[0].split("-"),n[1]?n[1]=n[1].split(":"):n[1]=new Array(0,0,0),new Date(Date.UTC(n[0][0],Number(n[0][1])-1,n[0][2],n[1][0],n[1][1],n[1][2]))}return"NaN"!=Number(e[0])?new Date(Number(e[0])):new Date(e[0])}return new Date(Date.UTC.apply(null,e));case"boolean":return window[t]("false"!=e&&"0"!=e);case"L":case"T":case"sL":case"nL":case"nT":case"ndL":case"relL":case"Pol":case"Pol3D":case"polL":case"dL":case"cL":case"iL":return _typeDict[t].apply(new _typeDict[t],e);case null:case void 0:case"undefined":return null}var r,o,i;return i=window[t],(o=function(){}).prototype=i.prototype,r=new o,i.apply(r,e),r}function instanceSameType(t,e){return instantiate(typeOf(t),e)}let plasma=createColorScaleFromColors(cL.toL(["rgb(13,8,135)","rgb(125,3,168)","rgb(203,70,121)","rgb(248,148,65)","rgb(240,249,33)"]),[.25,.5,.75]),viridis=createColorScaleFromColors(cL.toL(["rgb(68,1,84)","rgb(59,81,139)","rgb(33,144,141)","rgb(92,200,99)","rgb(253,231,37)"]),[.25,.5,.75]),_HARDCODED_CATEGORICAL_COLORS=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f"],DateOperators_millisecondsToHours=1/36e5,DateOperators_millisecondsToDays=1/864e5,DateOperators_millisecondsToWeeks=1/6048e5,DateOperators_millisecondsToYears=3169e-14,DateOperators_MONTH_NAMES=["january","february","march","april","may","june","july","august","september","october","november","december"],DateOperators_MONTH_NAMES_SHORT=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],DateOperators_MONTH_NDAYS=[31,28,31,30,31,30,31,31,30,31,30,31],DateOperators_WEEK_NAMES=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],StringOperators_ENTER=String.fromCharCode(13),StringOperators_ENTER2=String.fromCharCode(10),StringOperators_ENTER3=String.fromCharCode(8232),StringOperators_SPACE=String.fromCharCode(32),StringOperators_SPACE2=String.fromCharCode(160),StringOperators_TAB=" ",StringOperators_TAB2=String.fromCharCode(9),StringOperators_LINK_REGEX=/(^|\s+)(https*\:\/\/\S+[^\.\s+])/,StringOperators_MAIL_REGEX=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,StringOperators_STOP_WORDS="t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","),StringOperators_WORDLISTS={},NetworkEncodings_nodeNameSeparators=["|",":"," is "," are ",".",","],NumberOperators_stackRandom=[],NumberOperators_random=Math.random,NumberOperators_lastNormal=1,NumberOperators_SG_MAGICCONST=1+Math.log(4.5),NumberOperators_LOG4=Math.log(4),TableEncodings_ENTER=String.fromCharCode(13),TableEncodings_ENTER2=String.fromCharCode(10),TableEncodings_ENTER3=String.fromCharCode(8232),TableEncodings_SPACE=String.fromCharCode(32),TableEncodings_SPACE2=String.fromCharCode(160),TableEncodings_TAB="  ",TableEncodings_TAB2=String.fromCharCode(9),GeoOperators_EARTH_RADIUS=6371009,GeoOperators_EARTH_DIAMETER=2*GeoOperators_EARTH_RADIUS,DrawTexts_POINT_TO_PIXEL=1.3333,DrawTexts_PIXEL_TO_POINT=.75,FastHtml_clickLinkFunctionsToCall=[],FastHtml_clickLinkTargetsToCall=[],FastHtml_target=null,FastHtml_linkFunction=null,_parseData=function(t,e,n){switch(e){case"csv":return toT(t,n);case"json":return JSON.parse(t);default:return t}};exports._parseData=_parseData,exports.loadData=function(t,e,n,r){var o=_parseData,i=new Headers;i.append("Content-Type","text/plain; charset=UTF-8"),fetch(t,i).then((t=>t.text())).then((i=>e({result:o(i,n,r),path:t})))},exports.loadDatas=function(t,e,n,r,o){let i=0,s=t[i],l=new L,a=_parseData,u="string"==typeof r?r:null,h=Array.isArray(r)?r:null,c=function(){fetch(s).then((t=>t.text())).then((r=>{let f=h?h[i]:u,p={result:a(r,f,o),path:s,nFile:i};l.push(p),e?.(p,l),i<t.length-1?(s=t[++i],c()):n?.(l.downcast())}))};c()};let loadImage=function(t,e){if(null!=t){var n=document.createElement("img");n.onload=function(){let r={path:t,result:n};e.call(this,r)},n.onerror=function(){let n={path:t,result:null};e.call(this,n)},n.src=t}},loadImages=function(t,e,n){var r=0,o=t[r],i=new L,s=new iL,l=function(){loadImage(o,(a=>{i.push(a),s.push(a.result),e?.(a,{paths:t.slice(0,s.length),results:s}),r<t.length-1?(o=t[++r],l()):n?.({paths:t,results:s})}))};l()},downloadData=function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),document.body.appendChild(n),n.click()},downloadTable=function(t,e){let n=TableToCSV(t,",",!0);downloadData(n,e)};exports.LOG=function(...t){if(null!=t&&null!=t[0])if(t[0].isTable){var e={};t[0].forEach((t=>{e[t.name]=t.serial()}))}else if(!t[0].isList)return"Net"==t[0].type?(t[0].nodes.forEach((t=>{t.nodes.forEach((t=>t.color?console.log("%c  "+t.name,"color:"+t.color):console.log("  "+t.name)))})),void console.groupEnd()):void("-"!=t[0]?console.log.apply(null,t):console.table("----------------------------------------------"))},exports.passPropertiesObjects=function(t,e,n,r){n.forEach((n=>t.forEach(((t,o)=>{r&&null!=t[n]||(t[n]=e[o][n])}))))},exports.passPropertiesToNodes=function(t,e,n,r=!1){n.forEach((n=>e.nodes.forEach((e=>{let o=t.get(e.id);o&&(r&&null!=o[n]||(o[n]=e[n]))}))))};let toL=function(t){return L.toL(t).downcast()},tosL=function(t){return sL.toL(t)},tonL=function(t){return nL.toL(t)},toT=function(t){if("string"==typeof t)return CSVToTable.apply(null,arguments);t=t[0].isList?t:t.map((t=>t.toL()));return T.toL(t).downcast()},tonT=function(t){return nT.toL(t)},serial=function(t){return t.isTable?t.map((t=>t.slice())):t.isList?t.slice():void 0};Array.prototype.toL=function(){return toL(this)},Array.prototype.tosL=function(){return tosL(this)},Array.prototype.tonL=function(){return tonL(this)},Array.prototype.toT=function(){return toT(this)},Array.prototype.tonT=function(){return tonT(this)},Array.prototype.serial=function(){return serial(this)},exports.toL=toL,exports.tosL=tosL,exports.tonL=tonL,exports.toT=toT,exports.tonT=tonT,exports.serial=serial,L.prototype._filter=Array.prototype.filter,L.prototype.filter=function(...t){return LOG(""),this._filter(t).toL()},L.prototype.pushNew=function(){for(let t=0;t<arguments.length;t++)this.includes(arguments[t])||this.push(arguments[t])},L.prototype.concatNew=function(t){let e=[];return t.forEach((t=>{this.includes(t)||e.push(t)})),this.concat(e)},exports.deepAssign=function(t,e,n=0){for(var r in n++,t)if(null!=e[r])if(e[r]instanceof Array)t[r]=e[r];else{var o=typeof e[r];!("number"==o||"string"==o||"boolean"==o)?exports.deepAssign(t[r],e[r],n):t[r]=e[r]}},exports.expandTags=function(t,e){return e=e??",",t.join(e).getWithoutElement().split(e).tosL().trim()};var TableToNetwork=function(t,e,n,r=!0){let o,i,s=new Net;if(Array.isArray(e)||(e=t.get(e)),e.forEach(((e,n)=>{o=s.createNode(e,e),t.forEach((t=>{"name"!=t.name&&"id"!=t.name&&(i=t.name.replace(" ","_").toLowerCase(),o[i]=t[n])}))})),n){let t;s.nodes.forEach(((e,o)=>{s.nodes.forEach(((i,l)=>{if(o!=l&&(r||!(l<o))&&(t=n(e,i),t)){let n=s.createRelation(e,i,e.name+"_"+i.name);for(let e in t)n[e]=t[e]}}))}))}return s};Net.prototype.createNode=function(t,e){var n=this.nodes.get(t);return n||(n=new Nd(t,e||t),this.addNode(n),n)},Net.prototype.filter=function(t){for(var e=this.nodes.filter((e=>t(e))),n=0;n<this.nodes.length;n++)e.includes(this.nodes[n])||(this.removeNode(this.nodes[n]),n--)},MetaCanvas.prototype.fTexts=function(t,e,n,r=null,o=null){t.forEach(((t,i)=>{r&&(this.fontSize=r[i]),o&&(this.fontColor=o[i]),this.fText(t,e[i],n[i])}))},MetaCanvas.prototype.fCircles=function(t,e,n,r=null){t.forEach(((t,o)=>{r&&this.fill(r[o]),this.fCircle(t,e[o],n[o])}))},MetaCanvas.prototype._setDragZoomTransformation=function(t){this.applyTransformationFunctions((t=>t*this.ZOOM+this.x0),(t=>t*this.ZOOM+this.y0),null,(t=>(t-this.x0)/this.ZOOM),(t=>(t-this.y0)/this.ZOOM))},MetaCanvas.prototype.setDRAGGABLE=function(t){this.DRAGGABLE!=t&&(this.DRAGGABLE=t,t?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.ZOOMABLE?this.x0=this.y0=0:this.resetTransformation())},MetaCanvas.prototype.setZOOMABLE=function(t,e=50,n=.1){this.ZOOMABLE!=t&&(this.ZOOMABLE=t,this.MAX_ZOOM=e,this.MIN_ZOOM=n,t?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.DRAGGABLE?this.ZOOM=1:this.resetTransformation())},exports.buildTagsNetwork=function(t,e=",",n=1){if(null!=t){var r=new Net;if(1==t.length||!t.isTable&&t.isList){var o=t.isTable?t[0]:t,i={};let s,l;o.forEach(((t,n)=>{if(null==t)return;let r=t.split(e);for(let t=0;t<r.length;t++)for(let e=t+1;e<r.length;e++){r[t]<r[e]?(s=r[t],l=r[e]):(s=r[e],l=r[t]);let o=i[s+"_"+l];null==o&&(o=i[s+"_"+l]={count:0,indexes:[],indexesDic:{}}),o.count++,o.indexesDic["_"+n]||(o.indexes.push(n),o.indexesDic["_"+n]=!0)}}));new nL;let a,u,h,c=1,f=1;for(let t in i){let e=i[t].count;if(e>=n){let o=t.split("_");a=r.createNode(o[0]),u=r.createNode(o[1]),null==a.indexes&&(a.indexes=[]),null==u.indexes&&(u.indexes=[]),a.indexes=a.indexes.concat(i[t].indexes),u.indexes=u.indexes.concat(i[t].indexes),a.weight++,u.weight++,c=Math.max(c,a.weight,u.weight),h=r.createRelation(a,u),h.weight=1+e-n,h.count=e,f=Math.max(f,h.weight)}}return r.nodes.forEach((t=>{t.weight=.5+.5*t.weight/c,t.indexes=_.tonL(t.indexes).getWithoutRepetitions()})),r.relations.forEach((t=>t.weight=.2+.8*t.weight/f)),r}var s=t[0];o=t[1];return s.forEach((t=>{var e=new Nd(t,t);r.addNode(e),e.kind=nameActor??"actor",e.color="blue"})),o.forEach(((t,e)=>{if(null!=t){var n=r.nodes[e];t.split(",").toL().trim().forEach((t=>{var e=r.createNode(t,t);e.kind=nameTags??"tag",e.color="red",r.createRelation(n,e)}))}})),r}},exports.expandForBarycenters=function(t,e){if(t){var n=new PolL;return n.name=t.name,t.forEach((t=>n.push(expandForBarycenter(t,e)))),n}},exports.closestPointToLine=function(t,e,n,r,o,i){let s=o-n,l=i-r,a=((t-n)*s+(e-r)*l)/(s**2+l**2);return new _.P(n+s*a,r+l*a)},exports.distanceToLine2=function(t,e,n,r,o,i){let s=this.closestPointToLine(t,e,n,r,o,i);return(s.x-t)**2+(s.y-e)**2},exports.distanceToLine=function(t,e,n,r,o,i){let s=this.closestPointToLine(t,e,n,r,o,i);return Math.sqrt((s.x-t)**2+(s.y-e)**2)},exports.dataDropper=function(t,e,n){if(!t)return;if(!e)return;let r;n?n?.startsWith("DATA")&&(r="https://moebio.protozoo.com/data/"+n.substr(5),n="../data/"+n.substr(5)):r="https://moebio.protozoo.com/dataDropper/"+(n="data/"),""==n||n.endsWith("/")||(n+="/",r+="/"),n+=e,r+=e;var o=new XMLHttpRequest;o.onreadystatechange=function(){console.log("dataDropper | this.readyState: "+this.readyState),4==this.readyState&&console.log("sent")},o.open("POST","https://moebio.protozoo.com/dataDropper/storeData.php",!0);o.send(n+"<***>"+t);return r},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*Math.random())]},random=Math.random,NumberOperators_random=Math.random,exports.L=L,exports.iL=iL,exports.cL=cL,exports.P=P,exports.P3D=P3D,exports.Pol=Pol,exports.Pol3D=Pol3D,exports.Rec=Rec,exports.T=T,exports.nT=nT,exports.polL=polL,exports.Nd=Nd,exports.sL=sL,exports.ndL=ndL,exports.relL=relL,exports.recL=recL,exports.Rel=Rel,exports.Net=Net,exports.Tr=Tr,exports.dI=dI,exports.dL=dL,exports.nL=nL,exports.I=I,exports.pol3DL=pol3DL,exports.cScale=cScale,exports.MetaCanvas=MetaCanvas,exports.Engine3D=Engine3D,exports.Forces=Forces,exports.interpolateColors=interpolateColors,exports.interpolateColorsRGB=interpolateColorsRGB,exports.distanceColorsRGB=distanceColorsRGB,exports.addAlpha=addAlpha,exports.invertColor=invertColor,exports.stringToColor=stringToColor,exports.HEXtoRGB=HEXtoRGB,exports.RGBtoHEX=RGBtoHEX,exports.RGBArrayToString=RGBArrayToString,exports.colorStringToHEX=colorStringToHEX,exports.numberToHex=numberToHex,exports.uinttoRGB=uinttoRGB,exports.uinttoHEX=uinttoHEX,exports.RGBtouint=RGBtouint,exports.HEXtouint=HEXtouint,exports.grayByLevel=grayByLevel,exports.HEXtoHSV=HEXtoHSV,exports.HSVtoHEX=HSVtoHEX,exports.HSLtoHEX=HSLtoHEX,exports.RGBtoHSV=RGBtoHSV,exports.HSVtoRGB=HSVtoRGB,exports.HSLtoRGB=HSLtoRGB,exports.invertColorRGB=invertColorRGB,exports.toHex=toHex,exports.getRandomColor=getRandomColor,exports.colorStringToRGB=colorStringToRGB,exports.createSortedNumberList=createSortedNumberList,exports.createNumberListWithinInterval=createNumberListWithinInterval,exports.createRandomNormalDistribution=createRandomNormalDistribution,exports.createRandomBetaPERTDistribution=createRandomBetaPERTDistribution,exports.createRandomBimodalDistribution=createRandomBimodalDistribution,exports.createRandomNumbers=createRandomNumbers,exports.createUniformTable=createUniformTable,exports.dotProduct=dotProduct,exports.linearRegression=linearRegression,exports.distance=distance,exports.cosineSimilarity=cosineSimilarity,exports.covariance=covariance,exports.standardDeviationTwoNumberLists=standardDeviationTwoNumberLists,exports.numericCorrelation=numericCorrelation,exports.slidingWindowCorrelation=slidingWindowCorrelation,exports.normalizeToSum=normalizeToSum,exports.normalizeByZScore=normalizeByZScore,exports.normalizeToMax=normalizeToMax,exports.normalizeToInterval=normalizeToInterval,exports.trimNumberList=trimNumberList,exports.getAccumulativeSum=getAccumulativeSum,exports.shorten=shorten,exports.simplify=simplify,exports.segmentNumberList=segmentNumberList,exports.averageSmoother=averageSmoother,exports.closestValue=closestValue,exports.filterNumberListByInterval=filterNumberListByInterval,exports.filterNumberListByNumber=filterNumberListByNumber,exports.frameFromTwoNumberLists=frameFromTwoNumberLists,exports.rangeCounts=rangeCounts,exports.simpleCompression=simpleCompression,exports.regression=regression,exports.getDecimalsInterval=getDecimalsInterval,exports.setDecimals=setDecimals,exports.getDistributionHeights=getDistributionHeights,exports.kNearestNeighbours=kNearestNeighbours,exports.skewness=skewness,exports.TableToObject=TableToObject,exports.ArrayOfArraysToTable=ArrayOfArraysToTable,exports.tableToHtml=tableToHtml,exports.tableToList=tableToList,exports.createColorScaleFromColors=createColorScaleFromColors,exports.blackScale=blackScale,exports.grayscale=grayscale,exports.antiGrayscale=antiGrayscale,exports.antiTemperature=antiTemperature,exports.temperature=temperature,exports.lightTemperature=lightTemperature,exports.sqrtTemperature=sqrtTemperature,exports.sqrt4Temperature=sqrt4Temperature,exports.quadraticTemperature=quadraticTemperature,exports.cubicTemperature=cubicTemperature,exports.greenToRed=greenToRed,exports.greenToBlue=greenToBlue,exports.grayToOrange=grayToOrange,exports.sqrt4GrayToOrange=sqrt4GrayToOrange,exports.blueToRed=blueToRed,exports.whiteToRed=whiteToRed,exports.redToBlue=redToBlue,exports.greenWhiteRed=greenWhiteRed,exports.blueWhiteRed=blueWhiteRed,exports.blueBlackRed=blueBlackRed,exports.grayBlackOrange=grayBlackOrange,exports.grayWhiteOrange=grayWhiteOrange,exports.solar=solar,exports.antiSolar=antiSolar,exports.get=get,exports.getFirstElements=getFirstElements,exports.containSameElements=containSameElements,exports.fractionOfSameElements=fractionOfSameElements,exports.getCorrespondenceBetweenLists=getCorrespondenceBetweenLists,exports.getConfusionMatrix=getConfusionMatrix,exports.indexOf=indexOf,exports.replaceElement=replaceElement,exports.replaceElementAtIndex=replaceElementAtIndex,exports.replaceNullsInList=replaceNullsInList,exports.concat=concat,exports.reverse=reverse,exports.getBooleanDictionaryForList=getBooleanDictionaryForList,exports.getFirstOccurrenceDictionaryForList=getFirstOccurrenceDictionaryForList,exports.getIndexesDictionary=getIndexesDictionary,exports.getIndexesTable=getIndexesTable,exports.buildDictionaryObjectForDictionary=buildDictionaryObjectForDictionary,exports.mapWithTable=mapWithTable,exports.mapWithObject=mapWithObject,exports.sortListByNumberList=sortListByNumberList,exports.getRankingsList=getRankingsList,exports.sortListByIndexes=sortListByIndexes,exports.concatWithoutRepetitions=concatWithoutRepetitions,exports.slidingWindowOnList=slidingWindowOnList,exports.getNewListForObjectType=getNewListForObjectType,exports.union=union,exports.intersection=intersection,exports.difference=difference,exports.symmetricDifference=symmetricDifference,exports.jaccardIndex=jaccardIndex,exports.jaccardDistance=jaccardDistance,exports.filterList=filterList,exports.mapWithFunction=mapWithFunction,exports.mapFunctionsOnList=mapFunctionsOnList,exports.aggregateList=aggregateList,exports.subCategoricalAnalysis=subCategoricalAnalysis,exports.getListEntropy=getListEntropy,exports.getListDiversity=getListDiversity,exports.getInformationGain=getInformationGain,exports.groupElementsByPropertyValue=groupElementsByPropertyValue,exports.repeatElements=repeatElements,exports._isCategorical=_isCategorical,exports.buildInformationObjectForList=buildInformationObjectForList,exports.kCombinations=kCombinations,exports.allSubLists=allSubLists,exports.crossCombineLists=crossCombineLists,exports.characterizeList=characterizeList,exports.createDefaultCategoricalColorList=createDefaultCategoricalColorList,exports.colorsForCategoricalList=colorsForCategoricalList,exports.createCategoricalColorListForList=createCategoricalColorListForList,exports.createColorListFromColorScale=createColorListFromColorScale,exports.createColorListFromNumberList=createColorListFromNumberList,exports.createSymmetricalColorListFromNumberList=createSymmetricalColorListFromNumberList,exports.createColorListWithSingleColor=createColorListWithSingleColor,exports.createColorListBetweenTwoColors=createColorListBetweenTwoColors,exports.createColorListSpectrum=createColorListSpectrum,exports.stringsToColors=stringsToColors,exports.createCategoricalColors=createCategoricalColors,exports._sortingVariation=_sortingVariation,exports._evaluationFunction=_evaluationFunction,exports.createCategoricalColorListDictionaryObject=createCategoricalColorListDictionaryObject,exports.stringToDate=stringToDate,exports.dateToString=dateToString,exports.clearHoursMinutesSeconds=clearHoursMinutesSeconds,exports.currentDate=currentDate,exports.addDaysToDate=addDaysToDate,exports.addMillisecondsToDate=addMillisecondsToDate,exports.parseDate=parseDate,exports.parseDates=parseDates,exports.hoursBetweenDates=hoursBetweenDates,exports.daysBetweenDates=daysBetweenDates,exports.weeksBetweenDates=weeksBetweenDates,exports.yearsBetweenDates=yearsBetweenDates,exports.nDayInYear=nDayInYear,exports.getDateDaysAgo=getDateDaysAgo,exports.getWeekInYear=getWeekInYear,exports.getNDaysInMonth=getNDaysInMonth,exports.getDecimalDate=getDecimalDate,exports.convertFromDecimalDate=convertFromDecimalDate,exports.extractPropertiesFromDate=extractPropertiesFromDate,exports.StringListToNumberList=StringListToNumberList,exports.toDateList=toDateList,exports._y=_y,exports._m=_m,exports._d=_d,exports._h=_h,exports._mn=_mn,exports._s=_s,exports._ms=_ms,exports.getDateLists=getDateLists,exports.buildSummaryTableFromDates=buildSummaryTableFromDates,exports.transformDateList=transformDateList,exports.changeTimeResolution=changeTimeResolution,exports.getElementFromTable=getElementFromTable,exports.getSubTable=getSubTable,exports.sliceColumns=sliceColumns,exports.filterTable=filterTable,exports.filterColumns=filterColumns,exports.getSubTableByElementOnList=getSubTableByElementOnList,exports.getSubTableByElementsOnList=getSubTableByElementsOnList,exports.getRandomRows=getRandomRows,exports.transpose=transpose,exports.replaceElementInTable=replaceElementInTable,exports.replaceSectionInTable=replaceSectionInTable,exports.replaceNullsInTable=replaceNullsInTable,exports.testClassificationModel=testClassificationModel,exports.getRows=getRows,exports.sortListsByNumberList=sortListsByNumberList,exports.aggregateTable=aggregateTable,exports.disAggregateTable=disAggregateTable,exports.deSegmentTable=deSegmentTable,exports.pivotTable=pivotTable,exports.unpivotTable=unpivotTable,exports.getCountPairsMatrix=getCountPairsMatrix,exports.getPairsFrequencyTable=getPairsFrequencyTable,exports.concatenateRowElements=concatenateRowElements,exports.filterTableByElementInList=filterTableByElementInList,exports.filterTableByElementsInList=filterTableByElementsInList,exports.selectRows=selectRows,exports.joinTables=joinTables,exports.joinMultipleTables=joinMultipleTables,exports.combineLists=combineLists,exports.completeTable=completeTable,exports.getNumberTableFromTable=getNumberTableFromTable,exports.getVariablesInformationGain=getVariablesInformationGain,exports.splitTableByCategoricList=splitTableByCategoricList,exports.buildCorrelationsNetwork=buildCorrelationsNetwork,exports.buildSimpleDecisionTree=buildSimpleDecisionTree,exports.buildDecisionTree=buildDecisionTree,exports._buildDecisionTreeNode=_buildDecisionTreeNode,exports._decisionTreeGenerateColorsMixture=_decisionTreeGenerateColorsMixture,exports.allListsSameLength=allListsSameLength,exports.getListsWithoutRepetition=getListsWithoutRepetition,exports.getNumberOfDifferentElementsOfLists=getNumberOfDifferentElementsOfLists,exports.buildInformationObjectForTable=buildInformationObjectForTable,exports.getCategoricalLists=getCategoricalLists,exports.getTableSimplified=getTableSimplified,exports.concatTables=concatTables,exports.concatRows=concatRows,exports.concatLists=concatLists,exports.unionListsFromTables=unionListsFromTables,exports.intersectListsFromTables=intersectListsFromTables,exports.encodeStringLists=encodeStringLists,exports.translateListsWithDictionary=translateListsWithDictionary,exports.getModes=getModes,exports.getSubTables=getSubTables,exports.mapFunctionOnLists=mapFunctionOnLists,exports.mapFunctionsOnLists=mapFunctionsOnLists,exports.useVariablesDictionary=useVariablesDictionary,exports.matrixToTwoColumns=matrixToTwoColumns,exports._preserveOrder=_preserveOrder,exports.concatStrings=concatStrings,exports.join=join,exports.cleanTexts=cleanTexts,exports.filterStringListByString=filterStringListByString,exports.replaceStringsInTexts=replaceStringsInTexts,exports.replaceStringInTexts=replaceStringInTexts,exports.replaceStringsInTextsByStrings=replaceStringsInTextsByStrings,exports.countStringsOccurrencesOnTexts=countStringsOccurrencesOnTexts,exports.getWordsInTextsOccurrencesTable=getWordsInTextsOccurrencesTable,exports.createShortTextsNetwork=createShortTextsNetwork,exports.splitStrings=splitStrings,exports.encodeStringsAsNumericFeatures=encodeStringsAsNumericFeatures,exports.correlationRatio=correlationRatio,exports.splitByEnter=splitByEnter,exports.replaceStringInText=replaceStringInText,exports.replaceStringsInText=replaceStringsInText,exports.removeTextsBetweenStrings=removeTextsBetweenStrings,exports.getWords=getWords,exports.getBigrams=getBigrams,exports.substr=substr,exports.splitString=splitString,exports.getFirstTextBetweenStrings=getFirstTextBetweenStrings,exports.getAllTextsBetweenStrings=getAllTextsBetweenStrings,exports.textContainsString=textContainsString,exports.getParenthesisContents=getParenthesisContents,exports.getFirstParenthesisContent=getFirstParenthesisContent,exports.getFirstParenthesisContentWithIndexes=getFirstParenthesisContentWithIndexes,exports.placeString=placeString,exports.insertString=insertString,exports.cleanText=cleanText,exports.removeEnters=removeEnters,exports.removeTabs=removeTabs,exports.removePunctuation=removePunctuation,exports.removeDoubleSpaces=removeDoubleSpaces,exports.removeHtmlTags=removeHtmlTags,exports.escapeForRegExp=escapeForRegExp,exports.removeLinks=removeLinks,exports.removeQuotes=removeQuotes,exports.removeAccentsAndDiacritics=removeAccentsAndDiacritics,exports.getWordsOccurrencesTable=getWordsOccurrencesTable,exports.indexesOf=indexesOf,exports.indexesOfString=indexesOfString,exports.repeatString=repeatString,exports.countStringOccurrences=countStringOccurrences,exports.countOccurrences=countOccurrences,exports.countWordOccurrences=countWordOccurrences,exports.countRegexOccurrences=countRegexOccurrences,exports.countStringsOccurrences=countStringsOccurrences,exports.validateEmail=validateEmail,exports.validateUrl=validateUrl,exports.getLevenshteinDistance=getLevenshteinDistance,exports.getClosestLevenshtein=getClosestLevenshtein,exports.getNgrams=getNgrams,exports.stringToFunction=stringToFunction,exports.stringFormat=stringFormat,exports.createListWithSameElement=createListWithSameElement,exports.createIterationSequence=createIterationSequence,exports.createListWithUniqueElements=createListWithUniqueElements,exports.replaceChomasInTextLine=replaceChomasInTextLine,exports._replaceSpacesInLine=_replaceSpacesInLine,exports.decodeTextNet=decodeTextNet,exports._simplifyForTextNet=_simplifyForTextNet,exports._regexWordForTextNet=_regexWordForTextNet,exports.encodeTextNet=encodeTextNet,exports.modelInfluence=modelInfluence,exports.prepareTable=prepareTable,exports.NetworkToTable=NetworkToTable,exports.TableToNetwork=TableToNetwork,exports.TableToNetworkPairs=TableToNetworkPairs,exports.matrixToNetwork=matrixToNetwork,exports.CSVToTable=CSVToTable,exports._removeQuotes=_removeQuotes,exports.TableToCSV=TableToCSV,exports.TableToJSONString=TableToJSONString,exports.JSONStringToTable=JSONStringToTable,exports.NumberListToPolygon=NumberListToPolygon,exports.NumberListToStringList=NumberListToStringList,exports.ObjectToTable=ObjectToTable,exports.ObjectToList=ObjectToList,exports.objectToString=objectToString,exports.conversor=conversor,exports.ArrayToList=ArrayToList,exports.angleFromTwoPoints=angleFromTwoPoints,exports.dot=dot,exports.twoPointsInterpolation=twoPointsInterpolation,exports.pointMultiplication=pointMultiplication,exports.normalizeTableToMax=normalizeTableToMax,exports.normalizeLists=normalizeLists,exports.normalizeListsToMax=normalizeListsToMax,exports.normalizeListsToSum=normalizeListsToSum,exports.normalizeListsToInterval=normalizeListsToInterval,exports.averageSmootherOnLists=averageSmootherOnLists,exports.kMeans=kMeans,exports.product=product,exports.getCovarianceMatrix=getCovarianceMatrix,exports.generateNumberTable=generateNumberTable,exports.identity=identity,exports.mergeObjects=mergeObjects,exports.cloneObject=cloneObject,exports.serliazeObject=serliazeObject,exports.getInterval=getInterval,exports.getFrame=getFrame,exports.getInfo=getInfo,exports.getObjectStructure=getObjectStructure,exports.replaceValuesByNull=replaceValuesByNull,exports.getLength=getLength,exports.includes=includes,exports.getPropertyValue=getPropertyValue,exports.getPropertyValues=getPropertyValues,exports.getPropertyValuesInterval=getPropertyValuesInterval,exports.getMultiplePropertyValues=getMultiplePropertyValues,exports.getName=getName,exports.isPropertyValue=isPropertyValue,exports.getPropertiesNames=getPropertiesNames,exports.getPropertiesNamesAndValues=getPropertiesNamesAndValues,exports.setPropertyValue=setPropertyValue,exports.interpolateObjects=interpolateObjects,exports.replaceObject=replaceObject,exports.toList=toList,exports.floor=floor,exports.addition=addition,exports.multiplication=multiplication,exports.division=division,exports.applyFunctionOnInput=applyFunctionOnInput,exports.isEqual=isEqual,exports._recursiveEqual=_recursiveEqual,exports.arrayOfArraysToTable=arrayOfArraysToTable,exports.operate=operate,exports._sum=_sum,exports._multiplication=_multiplication,exports._pow2=_pow2,exports._pow3=_pow3,exports._logSum=_logSum,exports._log2Sum=_log2Sum,exports._log_y=_log_y,exports._cosSum=_cosSum,exports._sinSum=_sinSum,exports._tanSum=_tanSum,exports._modulo=_modulo,exports._subtract=_subtract,exports._divide=_divide,exports.numberToString=numberToString,exports.getRandomWithSeed=getRandomWithSeed,exports.numberFromBinaryPositions=numberFromBinaryPositions,exports.numberFromBinaryValues=numberFromBinaryValues,exports._powersOfTwoDecomposition=_powersOfTwoDecomposition,exports.toBinary=toBinary,exports.binaryToNumber=binaryToNumber,exports.positionsFromBinaryValues=positionsFromBinaryValues,exports._Alea=_Alea,exports._Mash=_Mash,exports.random=random,exports.randomSeed=randomSeed,exports.randomSeedPop=randomSeedPop,exports.decimalPlaces=decimalPlaces,exports.logistic=logistic,exports.formatShort=formatShort,exports.numberToPosition=numberToPosition,exports.getSoftenControlPoints=getSoftenControlPoints,exports.bezierCurvePoints=bezierCurvePoints,exports.triangleContainsPoint=triangleContainsPoint,exports.triangleArea=triangleArea,exports.lineFromTwoPoints=lineFromTwoPoints,exports.distancePointToLine=distancePointToLine,exports.distancePointToSegment=distancePointToSegment,exports.intersectionLines=intersectionLines,exports.intersectionLineRectangle=intersectionLineRectangle,exports.numberTableToPolygon=numberTableToPolygon,exports.numberTableToColorList=numberTableToColorList,exports.numberTableToNetwork=numberTableToNetwork,exports.buildDendrogramFromPolygon=buildDendrogramFromPolygon,exports._findClosestNodes=_findClosestNodes,exports.sortOnXY=sortOnXY,exports.expandFromBarycenter=expandFromBarycenter,exports.simplifyPolygon=simplifyPolygon,exports.bezierPolygonContainsPoint=bezierPolygonContainsPoint,exports.placePointsInsidePolygon=placePointsInsidePolygon,exports.placePointsInsideBezierPolygon=placePointsInsideBezierPolygon,exports.geoCoordinateToDecimal=geoCoordinateToDecimal,exports.geoDistance=geoDistance,exports.polygonLength=polygonLength,exports.minRect=minRect,exports.packingCircles=packingCircles,exports.packingRectangles=packingRectangles,exports.fillWithRectangles=fillWithRectangles,exports.squarify=squarify,exports.partitionRectangle=partitionRectangle,exports._getHighestRatio=_getHighestRatio,exports.simplifyPolygons=simplifyPolygons,exports.createPolygon=createPolygon,exports.twoNumberListsToPolygon=twoNumberListsToPolygon,exports.colorListFromColorScale=colorListFromColorScale,exports.colorListFromColorScaleFunction=colorListFromColorScaleFunction,exports.colorsLinearCombination=colorsLinearCombination,exports.polygon3DToColorList=polygon3DToColorList,exports.colorListToPolygon3D=colorListToPolygon3D,exports.randomColor=randomColor,exports.getFlowTable=getFlowTable,exports.getFlowTableIntervals=getFlowTableIntervals,exports.scaleIntervals=scaleIntervals,exports.nlsToIntervalList=nlsToIntervalList,exports.fillTextRectangle=fillTextRectangle,exports.fillTextRectangleWithTextLines=fillTextRectangleWithTextLines,exports.textWordWrapReturnLines=textWordWrapReturnLines,exports.getMaxTextWidth=getMaxTextWidth,exports.stringToObject=stringToObject,exports.stringToHash=stringToHash,exports._fnv_multiply=_fnv_multiply,exports._fnv_mix=_fnv_mix,exports.decodeIdentedTree=decodeIdentedTree,exports.TableToTree=TableToTree,exports._getId=_getId,exports.TreeToTable=TreeToTable,exports.treeToObject=treeToObject,exports.filterNetworkByRelationsWeight=filterNetworkByRelationsWeight,exports.objectToTree=objectToTree,exports.filterNodesByMinDegree=filterNodesByMinDegree,exports.degreeBetweenNodes=degreeBetweenNodes,exports.getNodesBetweenTwoNodes=getNodesBetweenTwoNodes,exports.getSubNetwork=getSubNetwork,exports.shortestPath=shortestPath,exports.shortestPaths=shortestPaths,exports.getRelationsBetweenNodeLists=getRelationsBetweenNodeLists,exports._extendPaths=_extendPaths,exports.loops=loops,exports._getLoopsOnNode=_getLoopsOnNode,exports._pathsToCentral=_pathsToCentral,exports._loopsColumns=_loopsColumns,exports.spanningTree=spanningTree,exports.spreads=spreads,exports.influenceLevels=influenceLevels,exports._spanningTree2=_spanningTree2,exports.adjacentNodeList=adjacentNodeList,exports.degreesPartition=degreesPartition,exports.getNodes=getNodes,exports.buildDendrogram=buildDendrogram,exports._getClosestPair=_getClosestPair,exports._strengthBetweenSets=_strengthBetweenSets,exports.buildNetworkClusters=buildNetworkClusters,exports._iterativeBuildClusters=_iterativeBuildClusters,exports._buildNetworkClustersLvn=_buildNetworkClustersLvn,exports.getNodesPageRanks=getNodesPageRanks,exports.addPageRankToNodes=addPageRankToNodes,exports.fusionNetworks=fusionNetworks,exports._jLvn=_jLvn,exports.getNodesCentralities=getNodesCentralities,exports.addCentralitiesToNodes=addCentralitiesToNodes,exports.addEigenvectorCentralityToNodes=addEigenvectorCentralityToNodes,exports.addBetweennessCentralityToNodes=addBetweennessCentralityToNodes,exports.addReachToNodes=addReachToNodes,exports.getLeaves=getLeaves,exports.createNetworkFromListAndFunction=createNetworkFromListAndFunction,exports.createRandomNetwork=createRandomNetwork,exports.textToNet=textToNet,exports.textToTree=textToTree,exports.textsToNet=textsToNet,exports.parseNet=parseNet,exports.imageToTableOfRGBA=imageToTableOfRGBA,exports.invertImageColors=invertImageColors,exports.grayscaleImage=grayscaleImage,exports.cropImage=cropImage,exports.resizeImage=resizeImage,exports.getDataURL=getDataURL,exports._getPixelData=_getPixelData,exports._makeImageFromData=_makeImageFromData,exports.expandSimpleHtml=expandSimpleHtml,exports.clickLink=clickLink,exports.downloadData=downloadData,exports.downloadTable=downloadTable,exports.loadImage=loadImage,exports.loadImages=loadImages,exports.StringOperators_STOP_WORDS=StringOperators_STOP_WORDS}));