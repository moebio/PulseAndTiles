!function(t,e){"function"==typeof define&&define.amd?define(["exports"],(function(n){e(t._=n)})):"object"==typeof exports&&"string"!=typeof exports.nodeName?e(exports):e(t._={})}("undefined"!=typeof self?self:this,(function(exports){"use strict";function DataType(){Object.apply(this),this.type="DataType"}function L(){DataType.apply(this);var t,e=[],n=arguments.length;for(t=0;t<n;t++)e.push(arguments[t]);return e=L.toL(e)}function iL(){for(var t=[],e=arguments.length,n=0;n<e;n++)t[n]=arguments[n];var r=L.apply(this,t);return r=iL.toL(r)}function cL(){var t,e=[],n=arguments.length;for(t=0;t<n;t++)e[t]=arguments[t];var r=L.apply(this,e);return r=cL.toL(r)}function P(t,e){DataType.apply(this,arguments),this.type="P",this.x=Number(t)||0,this.y=Number(e)||0}function P3D(t,e,n){P.apply(this,arguments),this.type="P3D",this.z=n}function Pol(){var t=L.apply(this,arguments);return t=Pol.toL(t)}function Pol3D(){var t=L.apply(this,arguments);return t=Pol3D.toL(t)}function Rec(t,e,n,r){DataType.apply(this),this.type="Rec",this.x=Number(t)||0,this.y=Number(e)||0,this.width=Number(n)||0,this.height=Number(r)||0}function T(){var t,e=[],n=arguments.length;for(t=0;t<n;t++)e[t]=new L(arguments[t]);var r=L.apply(this,e);return r=T.toL(r)}function nT(){var t=arguments,e=[];if(1==arguments.length)if("number"==typeof t[0])for(var n=0;n<t[0];n++)e.push(new nL);else Array.isArray(t[0])&&(e=i(t[0],1));else if(arguments.length>1)if("number"==typeof t[0]){var r=new nL;for(n=0;n<t.length;n++)r.push(t[n]);e.push(r)}else{var o=Array.prototype.slice.call(t);e=i(o,1)}function i(t,e){var n;if(void 0!==t.type)return"nT"==(n=t.clone()).type?n:"nL"==n.type&&1==e?[n]:"nL"==n.type&&e>1?n:[];n=[];for(var r=0;r<t.length;r++)Array.isArray(t[r])&&(t[r]=i(t[r],++e)),n[r]=t[r];return 0==n.length?[]:"number"==typeof n[0]&&1==e?[n]:n}return e=nT.toL(e)}function polL(){var t=T.apply(this,arguments);return t=polL.toL(t)}function Nd(t,e){this.id=null==t?"":t,this.name=null!=e?e:t,this.type="Nd",this.nodeType=null,this.x=0,this.y=0,this.z=0,this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelationList=new relL,this.from=new ndL,this.fromRelationList=new relL,this.weight=1,this.descentWeight=1,this.level=0,this.parent=null,this.vx=0,this.vy=0,this.vz=0,this.ax=0,this.ay=0,this.az=0}function sL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=String(arguments[e]);var n=L.apply(this,t);return n=sL.toL(n)}function ndL(){var t=ndL.toL([]);if(arguments&&arguments.length>0){var e=Array.prototype.slice.call(arguments);e.forEach((function(e){t.addNode(e)}))}return t}function relL(){var t=ndL.apply(this,arguments);return t.name="",t=relL.toL(t)}function recL(){var t=L.apply(this,arguments);return t=recL.toL(t)}function Rel(t,e,n,r,o,i){Nd.call(this,t,e),this.type="Rel",this.node0=n,this.node1=r,this.weight=null==o?1:o,this.content=null==i?"":i}function Net(){this.type="Net",this.nodes=new ndL,this.relations=new relL}function Tr(){Net.apply(this),this.type="Tr",this.nLevels=0,this._createRelation=this.createRelation,this.createRelation=this._newCreateRelation}function dI(t,e){DataType.apply(this,arguments),this.date0=t,this.date1=e,this.type="dI"}function dL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=Number(arguments[e]);var n=L.apply(this,t);return n=dL.toL(n)}function nL(){for(var t=[],e=arguments.length,n=0;n<e;n++)t[n]=Number(arguments[n]);var r=L.apply(this,t);return r=nL.toL(r)}function I(t,e){DataType.apply(this,arguments),this.x=Number(t),this.y=Number(e),this.type="I"}function pol3DL(){var t=L.apply(this,arguments);return t=pol3DL.toL(t)}function cScale(t){DataType.apply(this,arguments),this.name="",this.type="cScale",this.colorScaleFunction=t||blackScale}function MetaCanvas(t){null==t&&(t={container:document.querySelector("#maindiv"),cycle:function(){},onResize:function(){}}),this.container=t.container,this.container=this.container||document.querySelector("#maindiv"),"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.dimensions=t.dimensions,this.init=t.init||noOperation,this.cycle=t.cycle||noOperation,this.onResize=t.onResize||t.resize||noOperation,this._cycleInterval=void 0===t.cycleInterval?30:t.cycleInterval,t.noLoop&&(this._cycleInterval=0),this._init(!t.noStart)}function Engine3D(t){t=null==t?{}:t,this.lens=null==t.lens?300:t.lens,this._freeRotation=!1,this.setBasis(new Pol3D(new P3D(1,0,0),new P3D(0,1,0),new P3D(0,0,1))),this._cuttingPlane=10,this._dx=0,null!=t.angles&&this.setAngles(t.angles)}function Forces(t){this.k=t&&t.k?t.k:.01,this.dEqSprings=t&&t.dEqSprings?t.dEqSprings:100,this.dEqRepulsors=t&&t.dEqRepulsors?t.dEqRepulsors:500,this.friction=t&&t.friction?t.friction:.8,this.nodes=new ndL,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this._i0=0}DataType.prototype={},DataType.prototype.constructor=DataType,DataType.prototype.setType=function(t){this.type=t},DataType.prototype.getType=function(){return this.type},DataType.prototype.toString=function(){},L.prototype=new DataType,L.prototype.constructor=L,L.toL=function(t,e){if(null!=t){if(e){switch(e){case"number":case"nL":return nL.toL(t,!1);case"string":case"sL":return sL.toL(t,!1);case"Date":case"dL":return dL.toL(t,!1)}t.pushNew=L.prototype.pushNew,t.concatNew=L.prototype.concatNew}return t.type="L",t.name=t.name||"",t.setType=L.prototype.setType,t.toArray=L.prototype.toArray,t._constructor=L,t.downcast=L.prototype.downcast,t.get=L.prototype.get,t.getElements=L.prototype.getElements,t.isEqual=L.prototype.isEqual,t.getTypeOfElements=L.prototype.getTypeOfElements,t.getTypes=L.prototype.getTypes,t.getType=L.prototype.getType,t.getLengths=L.prototype.getLengths,t.getWithoutRepetitions=L.prototype.getWithoutRepetitions,t.getSimplified=L.prototype.getSimplified,t.getFrequenciesTable=L.prototype.getFrequenciesTable,t.allElementsAreEqual=L.prototype.allElementsAreEqual,t.countElement=L.prototype.countElement,t.countOccurrences=L.prototype.countOccurrences,t.countDifferentElements=L.prototype.countDifferentElements,t.getMode=L.prototype.getMode,t.getMin=L.prototype.getMin,t.getMax=L.prototype.getMax,t.indexOfElement=L.prototype.indexOfElement,t.indexesOf=L.prototype.indexesOf,t.indexOfElements=L.prototype.indexOfElements,t.indexesOfElements=L.prototype.indexesOfElements,t.getElementByName=L.prototype.getElementByName,t.getElementsByNames=L.prototype.getElementsByNames,t.getFirstElementByPropertyValue=L.prototype.getFirstElementByPropertyValue,t.add=L.prototype.add,t.getElementNumberOfOccurrences=L.prototype.getElementNumberOfOccurrences,t.getPropertyValues=L.prototype.getPropertyValues,t.getRandomElement=L.prototype.getRandomElement,t.getRandomElements=L.prototype.getRandomElements,t.isSorted=L.prototype.isSorted,t.getSortedByIndexes=L.prototype.getSortedByIndexes,t.getReversed=L.prototype.getReversed,t.getSortedByProperty=L.prototype.getSortedByProperty,t.getSorted=L.prototype.getSorted,t.getSortedByList=L.prototype.getSortedByList,t.getSortedRandom=L.prototype.getSortedRandom,t.getSubList=L.prototype.getSubList,t.getSubListByType=L.prototype.getSubListByType,t.getFilteredByPropertyValue=L.prototype.getFilteredByPropertyValue,t.getFilteredByBooleanList=L.prototype.getFilteredByBooleanList,t.toStringList=L.prototype.toStringList,t.toNumberList=L.prototype.toNumberList,t.toColorList=L.prototype.toColorList,t.clone=L.prototype.clone,t.toString=L.prototype.toString,t.getNames=L.prototype.getNames,t.getLabels=L.prototype.getLabels,t.getDescriptions=L.prototype.getDescriptions,t.getCategories=L.prototype.getCategories,t.applyFunction=L.prototype.applyFunction,t.getWithoutElementAtIndex=L.prototype.getWithoutElementAtIndex,t.getWithoutElement=L.prototype.getWithoutElement,t.getWithoutElements=L.prototype.getWithoutElements,t.getWithoutElementsAtIndexes=L.prototype.getWithoutElementsAtIndexes,t.getFilteredByFunction=L.prototype.getFilteredByFunction,t.insert=L.prototype.insert,t.insertMany=L.prototype.insertMany,t._concat=Array.prototype.concat,t.concat=L.prototype.concat,t.removeElement=L.prototype.removeElement,t.removeElementAtIndex=L.prototype.removeElementAtIndex,t.removeElementsAtIndexes=L.prototype.removeElementsAtIndexes,t.removeElements=L.prototype.removeElements,t.pushIfUnique=L.prototype.pushIfUnique,t.replace=L.prototype.replace,t.setNames=L.prototype.setNames,t.setPropertyValues=L.prototype.setPropertyValues,t._splice=Array.prototype.splice,t.splice=L.prototype.splice,t.isList=!0,t}},iL.prototype=new L,iL.prototype.constructor=iL,iL.toL=function(t){var e=L.toL(t);return e.type="iL",e.getInterval=iL.prototype.getInterval,e.getAmplitudes=iL.prototype.getAmplitudes,e},cL.prototype=new L,cL.prototype.constructor=cL,cL.toL=function(t){var e=L.toL(t);return e.type="cL",e.name=t.name||"",e.getRgbArrays=cL.prototype.getRgbArrays,e.getInterpolated=cL.prototype.getInterpolated,e.getInverted=cL.prototype.getInverted,e.addAlpha=cL.prototype.addAlpha,e},P.prototype=new DataType,P.prototype.constructor=P,P3D.prototype=new P,P3D.prototype.constructor=P3D,Pol.prototype=new L,Pol.prototype.constructor=Pol,Pol.toL=function(t){var e=L.toL(t);return e.type="Pol",e.getFrame=Pol.prototype.getFrame,e.getBarycenter=Pol.prototype.getBarycenter,e.getCenter=Pol.prototype.getCenter,e.add=Pol.prototype.add,e.factor=Pol.prototype.factor,e.getRotated=Pol.prototype.getRotated,e.getClosestPoint=Pol.prototype.getClosestPoint,e.toNumberList=Pol.prototype.toNumberList,e.containsPoint=Pol.prototype.containsPoint,e.touchesPolygon=Pol.prototype.touchesPolygon,e.approach=Pol.prototype.approach,e.clone=Pol.prototype.clone,e},Pol3D.prototype=new L,Pol3D.prototype.constructor=Pol3D,Pol3D.toL=function(t){var e=L.toL(t);return e.type="Pol3D",e.getBarycenter=Pol3D.prototype.getBarycenter,e},Rec.prototype=new DataType,Rec.prototype.constructor=Rec,T.prototype=new L,T.prototype.constructor=T,T.toL=function(t){for(var e=0;e<t.length;e++)Array.isArray(t[e])&&!t[e].isList&&(t[e]=L.toL(t[e]));var n=L.toL(t);return n.type="T",n.applyFunction=T.prototype.applyFunction,n.getListsDowncasted=T.prototype.getListsDowncasted,n.get=T.prototype.get,n.getColumns=T.prototype.getColumns,n.getWithoutColumn=T.prototype.getWithoutColumn,n.getWithoutColumns=T.prototype.getWithoutColumns,n.getRow=T.prototype.getRow,n.getRows=T.prototype.getRows,n.getCell=T.prototype.getCell,n.getLengths=T.prototype.getLengths,n.getListLength=T.prototype.getListLength,n.sliceRows=T.prototype.sliceRows,n.getRows=T.prototype.getRows,n.getWithoutRow=T.prototype.getWithoutRow,n.getWithoutRows=T.prototype.getWithoutRows,n.transpose=T.prototype.transpose,n.sortRowsByList=T.prototype.sortRowsByList,n.sortRowsByLists=T.prototype.sortRowsByLists,n.clone=T.prototype.clone,n.cloneWithEmptyLists=T.prototype.cloneWithEmptyLists,n.appendRows=T.prototype.appendRows,n.insertRow=T.prototype.insertRow,n.trim=T.prototype.trim,n.removeRow=T.prototype.removeRow,n.pushRow=T.prototype.pushRow,n.isTable=!0,n},nT.prototype=new T,nT.prototype.constructor=nT,nT.toL=function(t){var e=T.toL(t);return e.type="nT",e.getSums=nT.prototype.getSums,e.getRowsSums=nT.prototype.getRowsSums,e.getAverages=nT.prototype.getAverages,e.getRowsAverages=nT.prototype.getRowsAverages,e.getIntervals=nT.prototype.getIntervals,e.factor=nT.prototype.factor,e.add=nT.prototype.add,e.getMax=nT.prototype.getMax,e.getMaxValues=nT.prototype.getMaxValues,e.getMaxCell=nT.prototype.getMaxCell,e.getMin=nT.prototype.getMin,e.getMinValues=nT.prototype.getMinValues,e.getMinCell=nT.prototype.getMinCell,e.getInterval=nT.prototype.getInterval,e.getFrame=nT.prototype.getFrame,e},polL.prototype=new T,polL.prototype.constructor=polL,polL.toL=function(t){var e=T.toL(t);return e.type="polL",e.getFrame=polL.prototype.getFrame,e.getBarycenter=polL.prototype.getBarycenter,e.getCenter=polL.prototype.getCenter,e.add=polL.prototype.add,e.factor=polL.prototype.factor,e.getRotated=polL.prototype.getRotated,e.clone=polL.prototype.clone,e},Nd.prototype=new DataType,Nd.prototype.constructor=Nd,sL.prototype=new L,sL.prototype.constructor=sL,sL.toL=function(t,e){e=null==e||e;var n=L.toL(t);if(e)for(var r=0;r<n.length;r++)n[r]=String(n[r]);return n.type="sL",n.getLengths=sL.prototype.getLengths,n.countTags=sL.prototype.countTags,n.includesSubString=sL.prototype.includesSubString,n.indexesOfSubString=sL.prototype.indexesOfSubString,n.toLowerCase=sL.prototype.toLowerCase,n.toUpperCase=sL.prototype.toUpperCase,n.append=sL.prototype.append,n.getSurrounded=sL.prototype.getSurrounded,n.replace=sL.prototype.replace,n.getConcatenated=sL.prototype.getConcatenated,n.trim=sL.prototype.trim,n.clone=sL.prototype.clone,n},ndL.prototype=new L,ndL.prototype.constructor=ndL,ndL.toL=function(t,e){e=null!=e&&e;var n=L.toL(t);if(e)for(var r=n.length,o=0;o<r;o++)n[o]="Nd"==_typeOf(n[o])?n[o]:new Nd(String(n[o]),String(n[o]));return n.type="ndL",n.ids={},Array(),n.addNode=ndL.prototype.addNode,n.addNodes=ndL.prototype.addNodes,n.removeNode=ndL.prototype.removeNode,n.removeNodes=ndL.prototype.removeNodes,n.removeNodeAtIndex=ndL.prototype.removeNodeAtIndex,n.getNodeByName=ndL.prototype.getNodeByName,n.get=ndL.prototype.get,n.getNodesByIds=ndL.prototype.getNodesByIds,n.normalizeWeights=ndL.prototype.normalizeWeights,n.getWeights=ndL.prototype.getWeights,n.getIds=ndL.prototype.getIds,n.getDegrees=ndL.prototype.getDegrees,n.getPolygon=ndL.prototype.getPolygon,n._push=Array.prototype.push,n.push=function(t){undefined.push(t)},n.getWithoutRepetitions=ndL.prototype.getWithoutRepetitions,n.removeElements=ndL.prototype.removeElements,n.clone=ndL.prototype.clone,n},relL.prototype=new ndL,relL.prototype.constructor=relL,relL.toL=function(t){var e=ndL.toL(t);return e.type="relL",e.addRelation=relL.prototype.addRelation,e.removeRelation=relL.prototype.removeRelation,e.getRelationsWithNode=relL.prototype.getRelationsWithNode,e.getFirstRelationBetweenNodes=relL.prototype.getFirstRelationBetweenNodes,e.getFirstRelationByIds=relL.prototype.getFirstRelationByIds,e.getAllRelationsBetweenNodes=relL.prototype.getAllRelationsBetweenNodes,e.getRelatedNodesToNode=relL.prototype.getRelatedNodesToNode,e.nodesAreConnected=relL.prototype.nodesAreConnected,e.getChildrenOfNode=relL.prototype.getChildrenOfNode,e},recL.prototype=new L,recL.prototype.constructor=recL,recL.toL=function(t){var e=L.toL(t);return e.type="recL",e.getFrame=recL.prototype.getFrame,e.add=recL.prototype.add,e.clone=recL.prototype.clone,e.factor=recL.prototype.factor,e.getIntersectionArea=recL.prototype.getIntersectionArea,e.intersectsRectangle=recL.prototype.intersectsRectangle,e},Rel.prototype=new Nd,Rel.prototype.constructor=Rel,Net.prototype=new DataType,Net.prototype.constructor=Net,Tr.prototype=new Net,Tr.prototype.constructor=Tr,dI.prototype=new DataType,dI.prototype.constructor=dI,dL.prototype=new L,dL.prototype.constructor=dL,dL.toL=function(t,e){e=null==e||e;var n=L.toL(t);if(e)for(var r=0;r<n.length;r++)n[r]=new Date(n[r]);return n.type="dL",n.getTimes=dL.prototype.getTimes,n.getYears=dL.prototype.getYears,n.getFullYears=dL.prototype.getFullYears,n.getMin=dL.prototype.getMin,n.getMax=dL.prototype.getMax,n.getInterval=dL.prototype.getInterval,n},nL.prototype=new L,nL.prototype.constructor=nL,nL.toL=function(t,e){e=null==e||e;var n=L.toL(t),r=n.length;if(e)for(var o=0;o<r;o++)n[o]=Number(n[o]);return n.type="nL",n.getMin=nL.prototype.getMin,n.getMax=nL.prototype.getMax,n.getAmplitude=nL.prototype.getAmplitude,n.getIndexOfMin=nL.prototype.getIndexOfMin,n.getIndexOfMax=nL.prototype.getIndexOfMax,n.getSum=nL.prototype.getSum,n.getProduct=nL.prototype.getProduct,n.getInterval=nL.prototype.getInterval,n.getIntervalWithAverage=nL.prototype.getIntervalWithAverage,n.getNumbersSimplified=nL.prototype.getNumbersSimplified,n.getMean=nL.prototype.getMean,n.getNorm=nL.prototype.getNorm,n.getStandardDeviation=nL.prototype.getStandardDeviation,n.getVariance=nL.prototype.getVariance,n.getMedian=nL.prototype.getMedian,n.getQuantiles=nL.prototype.getQuantiles,n.getSorted=nL.prototype.getSorted,n.getSortIndexes=nL.prototype.getSortIndexes,n.cleanNonFinites=nL.prototype.cleanNonFinites,n.getNormalized=nL.prototype.getNormalized,n.getNormalizedToMax=nL.prototype.getNormalizedToMax,n.factor=nL.prototype.factor,n.add=nL.prototype.add,n.subtract=nL.prototype.subtract,n.divide=nL.prototype.divide,n.sqrt=nL.prototype.sqrt,n.pow=nL.prototype.pow,n.log=nL.prototype.log,n.floor=nL.prototype.floor,n.isEqual=nL.prototype.isEqual,n.addRandom=nL.prototype.addRandom,n.trim=nL.prototype.trim,n.getGeometricMean=nL.prototype.getGeometricMean,n.approach=nL.prototype.approach,n.clone=nL.prototype.clone,n},I.prototype=new P,I.prototype.constructor=I,pol3DL.prototype=new L,pol3DL.prototype.constructor=pol3DL,pol3DL.toL=function(t){var e=L.toL(t);return e.type="pol3DL",e.getBarycenter=pol3DL.prototype.getBarycenter,e},cScale.prototype=new DataType,cScale.prototype.constructor=cScale,MetaCanvas.prototype.constructor=MetaCanvas,Engine3D.prototype.constructor=Engine3D,Forces.prototype.constructor=Forces,P.prototype.getNorm=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},P.prototype.getAngle=function(){return Math.atan2(this.y,this.x)},P.prototype.factor=function(t){return t>=0||t<0?new P(this.x*t,this.y*t):null!=t.type&&"P"==t.type?new P(this.x*t.x,this.y*t.y):void 0},P.prototype.normalize=function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x/t,this.y/t)},P.prototype.normalizeToValue=function(t){var e=t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new P(this.x*e,this.y*e)},P.prototype.subtract=function(t){return new P(this.x-t.x,this.y-t.y)},P.prototype.add=function(t){return new P(t.x+this.x,t.y+this.y)},P.prototype.addCoordinates=function(t,e){return new P(t+this.x,e+this.y)},P.prototype.distanceToPoint=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},P.prototype.distanceToPointSquared=function(t){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)},P.prototype.angleToPoint=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},P.prototype.expandFromPoint=function(t,e){return new P(t.x+e*(this.x-t.x),t.y+e*(this.y-t.y))},P.prototype.interpolate=function(t,e){return new P((1-e)*this.x+e*t.x,(1-e)*this.y+e*t.y)},P.prototype.cross=function(t){return this.x*t.y-this.y*t.x},P.prototype.dot=function(t){return this.x*t.x+this.y*t.y},P.prototype.getRotated=function(t,e){return e=null==e?new P:e,new P(Math.cos(t)*(this.x-e.x)-Math.sin(t)*(this.y-e.y)+e.x,Math.sin(t)*(this.x-e.x)+Math.cos(t)*(this.y-e.y)+e.y)},P.prototype.clone=function(){return new P(this.x,this.y)},P.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},L.prototype.downcast=function(){if(0===this.length)return this;var t;switch(this.getTypeOfElements()){case"number":return(t=nL.toL(this,!1)).name=this.name,t;case"string":return(t=sL.toL(this,!1)).name=this.name,t;case"Rec":return this;case"date":return(t=dL.toL(this,!1)).name=this.name,t;case"L":case"dL":case"iL":case"sL":case"T":t=T.toL(this,!1);break;case"Array":t=T.toL(this,!1).getListsDowncasted();break;case"nL":return(t=nT.toL(this,!1)).name=this.name,t;case"P":t=Pol.toL(this,!1);break;case"Pol":t=polL.toL(this,!1);break;case"Nd":t=ndL.toL(this,!1);break;case"Rel":t=relL.toL(this,!1)}var e,n=this.length,r=!1,o=!0;if(null==t||null==t.type&&""==t){for(e=0;e<n;e++)if(null==this[e]&&(r=!0),null==this[e]||!this[e].isList){o=!1;break}o&&(t=T.toL(this,!1))}if(null!=t?t.name=this.name:t=this,o){for(e=0;e<n;e++)if(null==t[e]||t[e].containsNulls){r=!0;break}}else if(!r)for(e=0;e<n;e++)if(null==t[e]){r=!0;break}return t.containsNulls=r,t},L.prototype.get=function(t){if(Array.isArray(t))return this.getElements(t);if("string"==typeof t){t=t.trim();for(var e=!1,n=0;n<this.length;n++)if(this[n].name==t){e=!0,t=n;break}if(!e)return null}else(t=null==t?0:t)<0&&(t+=this.length),t>=this.length&&(t=Math.floor(t)%this.length);return this[t]},L.prototype.getElements=function(t,e){if(null!=t){var n=instanceSameType(this);n.name=this.name;var r,o,i=t.length,s=_typeOf(n),a="sL"==_typeOf(t);for(r=0;r<i;r++)null==(o=a?this.getElementByName(t[r]):this[t[r]<0?t[r]+this.length:t[r]])?(e||!a&&null===this[t[r]])&&n.push(null):"ndL"==s?n.addNode(o):n.push(o);return"L"!=n.type?n:n.downcast()}},L.prototype.toArray=function(){var t=this.slice(0);return t.name=this.name,t.type=this.type,t},L.prototype.isEqual=function(t){if(null==t||this.length!=t.length)return!1;var e,n=this.length;if(this.isTable){for(e=0;e<n;e++)if(!this[e].isEqual(t[e]))return!1;return!0}for(e=0;e<n;e++)if(this[e]!=t[e])return!1;return!0},L.prototype.getLengths=function(){return tonL(this.map((t=>t.length)))},L.prototype.getTypeOfElements=function(){for(var t=_typeOf(this[0]),e=this.length,n=1;n<e;n++)if(_typeOf(this[n])!=t)return"";return t},L.prototype.getTypes=function(){for(var t=new sL,e=this.length,n=0;n<e;n++)t[n]=_typeOf(this[n]);return t},L.prototype.getNames=function(t,e,n){var r=new sL;r.name=n?"labels":"names";var o,i=this.length;t&&this.isTable&&buildInformationObjectForTable(this);for(var s=0;s<i;s++)o=n&&null!=this[s].label?this[s].label:this[s].name,t&&this[s].isList?this[s].infoObject.isCategorical&&this[s].infoObject.isNumeric?r[s]="[#c] "+o:this[s].infoObject.isCategorical?r[s]="[c] "+o:this[s].infoObject.isNumeric?r[s]="[#] "+o:r[s]=o:r[s]=o,e&&(r[s]+=" ("+this[s].countDifferentElements()+")");return r},L.prototype.getLabels=function(t,e){return this.getNames(t,e,!0)},L.prototype.getDescriptions=function(){for(var t=new sL,e=this.length,n=0;n<e;n++)t[n]=this[n].description;return t},L.prototype.getCategories=function(){for(var t=new sL,e=this.length,n=0;n<e;n++)t[n]=this[n].category;return t},L.prototype.getReversed=function(){var t=this.clone();return t.reverse(),t},L.prototype.getSubList=function(){var t,e;if(null!=arguments[0]){if(arguments[0].isList)return this.getElements(arguments[0]);"number"==_typeOf(arguments[0])?t=null!=_typeOf(arguments[1])&&"number"==_typeOf(arguments[1])?new I(arguments[0],arguments[1]):new I(arguments[0],this.length-1):null!=arguments[0].x&&(t=arguments[0]),t.x<0&&(t.x=this.length+t.x),t.y<0&&(t.y=this.length+t.y);var n,r=new I(Math.max(Math.min(Math.floor(t.x),this.length),0),Math.max(Math.min(Math.floor(t.y),this.length-1),0));if(arguments[2]&&(r.y+=arguments[2]),"nL"==this.type)return(n=nL.toL(this.slice(r.x,r.y+1),!1)).name=this.name,n;if("sL"==this.type)return(n=sL.toL(this.slice(r.x,r.y+1),!1)).name=this.name,n;var o=this.type;if(n="L"==o||"T"==o?new L:instantiate(o),"ndL"==o)for(e=r.x;e<=r.y;e++)n.addNode(this[e]);else for(e=r.x;e<=r.y;e++)n.push(this[e]);return n.name=this.name,"L"==o||"T"==o?n.downcast():n}},L.prototype.getSubListByType=function(t){var e=new L;e.name=this.name;for(var n=0;n<this.length;n++)_typeOf(this[n])==t&&e.push(this[n]);return e.downcast()},L.prototype.getElementNumberOfOccurrences=function(t){for(var e=0,n=0,r=this.indexOf(t,n);r>-1;)e++,n=r+1,r=this.indexOf(t,n);return e},L.prototype.clone=function(){var t,e=instanceSameType(this),n=this.length;for(t=0;t<n;t++)e.push(this[t]);return e.name=this.name,e.fnDerived=this.fnDerived,e},L.prototype.getWithoutRepetitions=function(t,e){return toL([...new Set(this)]).downcast()},L.prototype.getSimplified=function(t,e,n){if(t){var r,o=this.getFrequenciesTable(!0,!1,!1,n),i=getFirstOccurrenceDictionaryForList(o[0]),s=this.length;null==e&&(e="other");var a="sL"==this.type?new sL:new L;for(a.name=this.name,r=0;r<s;r++)a.push(i[this[r]]<t-1?this[r]:e);return a}},L.prototype.countElement=function(t){for(var e=0,n=this.length,r=0;r<n;r++)t==this[r]&&e++;return e},L.prototype.countOccurrences=function(){for(var t=new nL,e={},n=this.length,r=0;r<n;r++)null==e[this[r]]&&(e[this[r]]=0),e[this[r]]++;for(r=0;r<n;r++)t[r]=e[this[r]];return t},L.prototype.countDifferentElements=function(){if(this.infoObject)return this.infoObject.numberDifferentElements;for(var t={},e=0,n=0;n<this.length;n++)null==t[this[n]]&&(t[this[n]]=1,e++);return e},L.prototype.getFrequenciesTable=function(t=!0,e,n,r){var o,i,s;if(this.freqTable)a=(o=this.freqTable.getColumns([0,1]))[0],l=o[1];else{o=new T;var a=instanceSameType(this),l=new nL;o[0]=a,o[1]=l,o._indexesDictionary={};var u=this.length;for(i=0;i<u;i++)null==(s=o._indexesDictionary[this[i]])&&(a[s=a.length]=this[i],l[s]=0,o._indexesDictionary[this[i]]=s),r&&i<r.length?l[s]+=r[i]:l[s]++}var h=0;if(t){var c=[];for(i=0;i<l.length;i++)c[i]=[l[i],a[i]],h+=l[i];var f=c.sort((function(t,e){return e[0]-t[0]}));for(o[0]=instanceSameType(a),o[1]=new nL,i=0;i<l.length;i++)o[0][i]=f[i][1],o[1][i]=f[i][0];o._indexesDictionary=null}if(o[0].name=""==this.name?"Element":this.name,o[1].name="Frequency",e&&(0==h&&(h=o[1].getSum()),o[2]=normalizeToSum(o[1],1,h),o[2].name="Occurrences normalized to sum"),n){var p=stringsToColors(o[0]);p.name="Categorical colors",o.push(p)}return this.freqTable=o,o},L.prototype.allElementsAreEqual=function(){var t;if(this.length<2)return!0;var e=this[0],n=this.length;for(t=1;t<n;t++)if(this[t]!=e)return!1;return!0},L.prototype.getMode=function(){for(var t,e={},n=0,r=0;r<this.length&&(null==e[this[r]]&&(e[this[r]]=0),e[this[r]]++,!(e[this[r]]>n&&(n=e[this[r]],t=this[r],n>.5*this.length)));r++);return t},L.prototype.getMin=function(){if(0===this.length)return null;var t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.min(e,this[t]);return e},L.prototype.getMax=function(){if(0===this.length)return null;var t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.max(e,this[t]);return e},L.prototype.add=function(t){if(t.constructor==Number){var e,n=this.length,r=instanceSameType(this);for(e=0;e<n;e++)r.push(this[e]+t);return r}},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*random())]},L.prototype.getRandomElements=function(t,e,n,r){if(null!=t){var o=null!=n?new _Alea("my",n,"seeds"):NumberOperators_random;e=null==e||e,t=Math.min(t,this.length);var i,s=instanceSameType(this);if(r){var a=this;if(e)a=u=this.getWithoutRepetitions();t=Math.min(t,a.length);var l=new T;l.push(createSortedNumberList(a.length,0,1)),l.push(createNumberListWithinInterval(a.length,new I(0,1),0,n)),l=(l=(l=l.sortRowsByList(1)).sliceRows(0,t-1)).sortRowsByList(0),s=a.getElements(l[0])}else if(e){var u=this.getWithoutRepetitions();t=Math.min(t,u.length);for(var h=createNumberListWithinInterval(u.length,new I(0,1),0,n),c=u.getSortedByList(h),f=0;f<t;f++)s.push(c[f])}else for(;s.length<t;)i=this[Math.floor(this.length*o())],s.push(i);return s.name=this.name,s}},L.prototype.getPropertyValues=function(t,e){var n,r=new L;r.name=t;for(var o=this.length,i=0;i<o;i++)n=getPropertyValue(this[i],t),r[i]=null==n?e:n;return r.downcast()},L.prototype.isSorted=function(t){t=null==t||Boolean(t);var e,n=this.length;if(t){for(e=1;e<n;e++)if(this[e]<this[e-1])return!1}else for(e=1;e<n;e++)if(this[e]>this[e-1])return!1;return!0},L.prototype.getSortedByIndexes=function(t){if(null!=t){var e,n=instanceSameType(this);n.name=this.name;var r=this.length;for(e=0;e<r;e++)-1!=t[e]&&n.push(this[t[e]]);return n}},L.prototype.getSortedByProperty=function(t,e,n){if(t.includes("."))return this.getSortedByList(this.getPropertyValues(t),e,null!=n?this.getPropertyValues(t):null);if(e=null==e||e,0==this.length)return this.clone();var r,o=_typeOf(this[0][t]),i="number"!=o&&"date"!=o;return r=n?e?i?function(e,r){return e[t]==r[t]?e[n]>r[n]?1:-1:e[t]>r[t]?1:-1}:function(e,r){return e[t]==r[t]?e[n]-r[n]:e[t]-r[t]}:i?function(e,r){return e[t]==r[t]?r[n]>e[n]?1:-1:r[t]>e[t]?1:-1}:function(e,r){return e[t]==r[t]?r[n]-e[n]:r[t]-e[t]}:e?i?function(e,n){return e[t]>n[t]?1:-1}:function(e,n){return e[t]-n[t]}:i?function(e,n){return n[t]>e[t]?1:-1}:function(e,n){return n[t]-e[t]},this.clone().sort(r)},L.prototype.getSorted=function(t){return this.getSortedByList(this,t)},L.prototype.getSortedByList=function(t,e,n,r){if(null==t)return null;e=null==e||e,r=null!=r&&r;var o,i=[],s=this.length;if(n&&"nL"==t.type)for(o=0;o<s;o++)i[o]=[this[o],t[o]+1e4*Math.random()*Number.MIN_VALUE,o];else if("dL"==t.type)for(o=0;o<s;o++)i[o]=[this[o],t[o].getTime(),o];else for(o=0;o<s;o++)i[o]=[this[o],t[o],o];var a,l=("nL"==t.type||"dL"==t.type)&&!r;a=e?l?function(t,e){return t[1]-e[1]}:r?function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:t[2]-e[2]}:function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}:l?function(t,e){return e[1]-t[1]}:r?function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:t[2]-e[2]}:function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:0},i=i.sort(a);var u=instanceSameType(this);for(u.name=this.name,o=0;o<s;o++)u[o]=i[o][0];return u},L.prototype.getSortedRandom=function(){var t=this.clone();return t.name=this.name,t.sort((function(){return random()-.5})),t},L.prototype.indexOfElement=function(t){var e,n=this.length;for(e=0;e<n;e++)if(this[e]==t)return e;return-1},L.prototype.indexesOf=function(t){for(var e=this.indexOf(t),n=new nL;-1!=e;)n.push(e),e=this.indexOf(t,e+1);return n},L.prototype.indexOfElements=function(t){if(null!=t){for(var e=new nL,n=t.length,r=0;r<n;r++)e[r]=this.indexOf(t[r]);return e}},L.prototype.indexesOfElements=function(t,e){if(null!=t){var n,r,o,i=new nL;this.length;if(n=getFirstOccurrenceDictionaryForList(this),e)for(r=0;r<t.length;r++)o=n[t[r]],i[r]=null==o?-1:o;else for(r=0;r<t.length;r++)null!=(o=n[t[r]])&&i.push(o);return i}},L.prototype.getElementByName=function(t,e){if(null==t)return null;for(var n=this.length,r=0;r<n;r++)if(this[r].name==t)return e?r:this[r];return e?-1:null},L.prototype.getElementsByNames=function(t,e,n,r){if(null!=t){var o,i,s,a,l=e?new nL:new L,u=this.length;for(o=0;o<t.length;o++){for(s=t[o],a=!1,i=0;i<u;i++)if(this[i].name==s){l.push(e?i:this[i]),a=!0;break}n&&!a&&l.push(e?-1:r)}return e?l:l.downcast()}},L.prototype.getFirstElementByPropertyValue=function(t,e){for(var n=this.length,r=0;r<n;r++)if(this[r][t]==e)return this[r];return null},L.prototype.getFilteredByBooleanList=function(t){var e,n=new L;n.name=this.name;var r=this.length;for(e=0;e<r;e++)t[e]&&n.push(this[e]);return n.downcast()},L.prototype.getFilteredByPropertyValue=function(t,e,n){n=null==n?"equal":n;var r,o=new L;o.name="filtered_"+this.name;var i=this.length;switch(n){case"equal":for(r=0;r<i;r++)this[r][t]==e&&o.push(this[r]);break;case"different":for(r=0;r<i;r++)this[r][t]!=e&&o.push(this[r]);break;case"greater":for(r=0;r<i;r++)this[r][t]>e&&o.push(this[r]);break;case"lower":for(r=0;r<i;r++)this[r][t]<e&&o.push(this[r])}return o.downcast()},L.prototype.getWithoutElementsAtIndexes=function(t){var e,n,r=this.length;for(n="L"==this.type?new L:instantiate(_typeOf(this)),t=nL.toL(t.slice(),!1),e=0;e<t.length;e++)t[e]<0&&(t[e]+=this.length);for(e=0;e<r;e++)t.includes(e)||n.push(this[e]);return"L"==this.type?n.downcast():(n.name=this.name,n)},L.prototype.getWithoutElementAtIndex=function(t){var e,n=this.length;t<0&&(t+=n),e="L"==this.type?new L:instanceSameType(this);for(var r=0;r<n;r++)r!=t&&e.push(this[r]);return e.name=this.name,"L"==this.type?e.downcast():e},L.prototype.getWithoutElement=function(t){if(null==t&&(t=null),null!=t&&!this.includes(t))return this;var e,n=new L;n.name=this.name;var r=this.length;for(e=0;e<r;e++)this[e]!=t&&n.push(this[e]);return n.downcast()},L.prototype.getWithoutElements=function(t){var e,n,r=this.length;if(e="L"==this.type?new L:instanceSameType(this),this.isTable)for(n=0;n<r;n++)t.includes(this[n])||e.push(this[n]);else{var o=getBooleanDictionaryForList(t);for(n=0;n<r;n++)o[this[n]]||e.push(this[n])}return e.name=this.name,"L"==this.type?e.downcast():e},L.prototype.getFilteredByFunction=function(t,e){for(var n=instanceSameType(this),r=this.length,o=0;o<r;o++)t(this[o],o,this)&&("ndL"==n.type?n.addNode(this[o]):n.push(this[o]));return n.name=e||this.name,"L"==this.type?n.downcast():n},L.prototype.insert=function(t,e,n){if(n=null==n||n,e=null==e?0:e,null!=t){if("string"==typeof e&&(e=this.getNames().indexOf(e)),-1==e)throw new Error("element with given name not found");var r;if(n)return(r=this.clone()).name=this.name,r[e]=t,r.downcast();(r=new L).name=this.name;for(var o=0;o<this.length+1;o++)r[o]=o<e?this[o]:o==e?t:this[o-1];return r.downcast()}},L.prototype.insertMany=function(t,e,n){if(null==t||null==e)return null;if(n=null==n||n,t.length!=e.length)throw new Error("indexes and elements need to be the same length");if("sL"==e.type&&(e=this.getNames().indexesOfElements(e)),null==e||e.length!=t.length)throw new Error("some elements with given names not found");var r;if(n){var o=Math.min(t.length,e.length);(r=this.clone()).name=this.name;for(var i=0;i<o;i++)r[e[i]]=t[i];return r.downcast()}(r=new L).name=this.name,t=t.getSortedByList(e),e=e.getSorted();for(i=0;i<t.length;i++)r[e[i]+i]=t[i];var s=0;for(i=0;i<this.length;i++){for(;null!=r[s];)s++;r[s]=this[i],s++}return r.downcast()},L.prototype.concat=function(){if(null==arguments[0])return this;if(arguments[0].type==this.type){if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nL"==this.type)return nL.toL(this._concat.apply(this,arguments),!1);if("sL"==this.type)return sL.toL(this._concat.apply(this,arguments),!1);if("dL"==this.type)return dL.toL(this._concat.apply(this,arguments),!1);if("T"==this.type)return T.toL(this._concat.apply(this,arguments),!1);if("nT"==this.type)return nT.toL(this._concat.apply(this,arguments),!1);if("ndL"==this.type){var t,e=this.clone(),n=arguments[0],r=n.length;for(t=0;t<r;t++)e.addNode(n[t]);return e}}return L.toL(this._concat.apply(this,arguments)).downcast()},L.prototype.toNumberList=function(t,e){if("nL"==this.type)return this;e=null==e?0:e;var n,r=new nL,o=this.length,i=!1;if("dL"==this.type)for(""==r.name&&(r.name="decimal date"),n=0;n<o;n++)r[n]=getDecimalDate(this[n]);else for(n=0;n<o;n++)r[n]=0==e?parseFloat(this[n]):Number(this[n]),isNaN(r[n])&&(r[n]=t,null==t&&(i=!0));return i&&(r=L.toL(r)),r.name=this.name,r.downcast()},L.prototype.toStringList=function(){if("sL"==this.type)return this;var t,e=this.length,n=new sL;for(n.name=this.name,t=0;t<e;t++)n[t]=String(this[t]);return n},L.prototype.toColorList=function(t,e){var n;if("cL"==this.type)return this;if("nL"==this.type){let t=this.getInterval();if(t.x<0&&t.y>0){let e=Math.max(t.x,t.y);n=new _.cL,this.forEach((t=>{let r=t?.5-.5*t/e:.5;n.push(_.interpolateColors(_.blueWhiteRed(r),"rgb(255,255,255)",.6))}))}else n=createColorListFromNumberList(this,e);return n.name="colors",n}if(t)return colorsForCategoricalList(this,null,!0);if("sL"==this.type){var r,o=new cL;o.name=this.name;for(var i=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,s=0;s<this.length&&null!=(r=colorStringToRGB(this[s]));s++)i.test(this[s])?o.push(this[s]):o.push("rgb("+r[0]+","+r[1]+","+r[2]+")");if(o.name="colors",null!=r)return o}return(n=colorsForCategoricalList(this)).name="colors",n},L.prototype.removeElements=function(t){var e,n={},r=this.length,o=t.length;for(e=0;e<o;e++)n[t[e]]=!0;for(e=0;e<r;e++)n[this[e]]&&(this.splice(e,1),e--)},L.prototype.removeElement=function(t){var e=this.indexOf(t);-1!=e&&this.splice(e,1)},L.prototype.pushIfUnique=function(t){let e=!this.includes(t);return e&&this.push(t),e},L.prototype.removeElementAtIndex=function(t){this.splice(t,1)},L.prototype.removeElementsAtIndexes=function(t){t=t.sort((function(t,e){return t-e}));for(var e=0;null!=t[e];e++)this.splice(t[e]-e,1)},L.prototype.setNames=function(t,e,n){if(null==t)return this;var r,o;"string"==typeof t&&-1!=t.search(/\n|\r|\,/)&&(t=t.split(/\n|\r|\,/g)),"string"==typeof t&&(t=[t]);var i=null==n?createSortedNumberList(t.length):n;"sL"==i.type&&(i=this.getElementsByNames(i,!0,!0));var s=Math.min(i.length,t.length),a=e?this:this.clone();for(r=0;r<s;r++){if(-1==(o=i[r])&&"sL"==n.type)throw new Error("No element found with name: "+n[r]);if(o<0||o>=this.length)throw new Error("Invalid index: "+o);a[o].name=t[r]}return a},L.prototype.setPropertyValues=function(t,e,n){if(null==t||null==e)return null;Array.isArray(e)||(e=[e]);for(var r=e.length,o=this.length,i=n?this:this.clone(),s=0;s<o;s++)i[s]=setPropertyValue(this[s],t,e[s%r],n);return i},L.prototype.splice=function(){switch(this.type){case"nL":return nL.toL(this._splice.apply(this,arguments));case"sL":return sL.toL(this._splice.apply(this,arguments));case"ndL":return ndL.toL(this._splice.apply(this,arguments));case"dL":return dL.toL(this._splice.apply(this,arguments))}return L.toL(this._splice.apply(this,arguments)).downcast()},iL.prototype.getInterval=function(){if(0===this.length)return null;var t,e=Math.max(this[0].x,this[0].y),n=Math.min(this[0].x,this[0].y),r=this.length;for(t=1;t<r;t++)e=Math.max(e,this[t].x,this[t].y),n=Math.min(n,this[t].x,this[t].y);return new I(n,e)},iL.prototype.getAmplitudes=function(){if(0===this.length)return null;var t,e=new nL;for(t=0;t<this.length;t++)e[t]=this[t].getAmplitude();return e},cL.prototype.getRgbArrays=function(){for(var t=new L,e=this.length,n=0;n<e;n++)t[n]=colorStringToRGB(this[n]);return t},cL.prototype.getInterpolated=function(t,e){for(var n=new cL,r=this.length,o=0;o<r;o++)n[o]=interpolateColors(this[o],t,e);return n.name=this.name,n},cL.prototype.getInverted=function(){for(var t=new cL,e=this.length,n=0;n<e;n++)t[n]=invertColor(this[n]);return t.name=this.name,t},cL.prototype.addAlpha=function(t){for(var e=new cL,n=this.length,r=0;r<n;r++)e[r]=addAlpha(this[r],t);return e.name=this.name,e},P3D.prototype.distanceToPoint3D=function(t){return Math.sqrt(Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2)+Math.pow(Math.abs(this.z-t.z),2))},P3D.prototype.distanceToPointSquared=function(t){return Math.pow(Math.abs(this.x-t.x),2)+Math.pow(Math.abs(this.y-t.y),2)+Math.pow(Math.abs(this.z-t.z),2)},P3D.prototype.getNorm2=function(){return this.x*this.x+this.y*this.y+this.z*this.z},P3D.prototype.getNorm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},P3D.prototype.normalizeToValue=function(t){var e=t/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2));return new P3D(this.x*e,this.y*e,this.z*e)},P3D.prototype.cross=function(t){return new P3D(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},P3D.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},P3D.prototype.angleToPoint=function(t){var e=this.getNorm(),n=t.getNorm();return Math.acos(this.dot(t)/(e*n))},P3D.prototype.add=function(t){return new P3D(t.x+this.x,t.y+this.y,t.z+this.z)},P3D.prototype.subtract=function(t){return new P3D(this.x-t.x,this.y-t.y,this.z-t.z)},P3D.prototype.factor=function(t){return new P3D(this.x*t,this.y*t,this.z*t)},P3D.prototype.interpolate=function(t,e){return new P3D((1-e)*this.x+e*t.x,(1-e)*this.y+e*t.y,(1-e)*this.z+e*t.z)},P3D.prototype.getAngles=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),e=.5*Math.PI-Math.atan2(this.z/t,this.y/t),n=-Math.asin(this.x/t);return e<-Math.PI&&(e+=2*Math.PI),e>Math.PI&&(e-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(e,n,0)},P3D.prototype.getInverseAngles=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),e=-.5*Math.PI+Math.atan2(-this.z/t,-this.y/t),n=Math.asin(-this.x/t);return e<-Math.PI&&(e+=2*Math.PI),e>Math.PI&&(e-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI),n>Math.PI&&(n-=2*Math.PI),new P3D(e,n,0)},P3D.prototype.clone=function(){return new P3D(this.x,this.y,this.z)},P3D.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", z="+this.z+")"},Pol3D.prototype.getBarycenter=function(){for(var t=0,e=0,n=0,r=0;r<this.length;r++)t+=this[r].x,e+=this[r].y,n+=this[r].z;return new P3D(t/this.length,e/this.length,n/this.length)},Rec.prototype.getRight=function(){return this.x+this.width},Rec.prototype.getBottom=function(){return this.y+this.height},Rec.prototype.setRight=function(t){this.width=t-this.x},Rec.prototype.setBottom=function(t){this.height=t-this.y},Rec.prototype.getTopLeft=function(){return new P(this.x,this.y)},Rec.prototype.getTopRight=function(){return new P(this.x+this.width,this.y)},Rec.prototype.getBottomRight=function(){return new P(this.x+this.width,this.y+this.height)},Rec.prototype.getBottomLeft=function(){return new P(this.x,this.y+this.height)},Rec.prototype.getCenter=function(){return new P(this.x+.5*this.width,this.y+.5*this.height)},Rec.prototype.getRandomPoint=function(){return new P(this.x+Math.random()*this.width,this.y+Math.random()*this.height)},Rec.prototype.getIntersection=function(t){if(t.x+t.width<this.x||t.x>this.x+this.width||t.y+t.height<this.y||t.y>this.y+this.height)return null;var e=Math.max(t.x,this.x),n=Math.max(t.y,this.y);return new Rec(e,n,Math.min(t.x+t.width,this.x+this.width)-e,Math.min(t.y+t.height,this.y+this.height)-n)},Rec.prototype.interpolate=function(t,e){var n=1-e;return new Rec(n*this.x+e*t.x,n*this.y+e*t.y,n*this.width+e*t.width,n*this.height+e*t.height)},Rec.prototype.getRatio=function(){return Math.max(this.width,this.height)/Math.min(this.width,this.height)},Rec.prototype.getArea=function(){return this.width*this.height},Rec.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},Rec.prototype.pointIsOnBorder=function(t,e){if(e=null==e?1:e,t.x>=this.x-e&&t.x<=this.x+this.width+e){if(t.y>=this.y-e&&t.y<=this.y+e)return!0;if(t.y>=this.y+this.height-e&&t.y<=this.y+this.height+e)return!0;if(t.y>=this.y-e&&t.y<=this.y+this.height+e&&(t.x<this.x+e||t.x>this.x+this.width-e))return!0}return!1},Rec.prototype.getNormalRectangle=function(){return new Rec(Math.min(this.x,this.x+this.width),Math.min(this.y,this.y+this.height),Math.abs(this.width),Math.abs(this.height))},Rec.prototype.intersectsRectangle=function(t){return this.x+this.width>=t.x&&this.y+this.height>=t.y&&t.x+t.width>=this.x&&t.y+t.height>=this.y},Rec.prototype.containsRectangle=function(t){return t.getRight()<=this.getRight()&&t.x>=this.x&&t.getBottom()<=this.getBottom()&&t.y>=this.y},Rec.prototype.expand=function(t,e){return e=e||new P(this.x+.5*this.width,this.y+.5*this.height),new Rec((this.x-e.x)*t+e.x,(this.y-e.y)*t+e.y,this.width*t,this.height*t)},Rec.prototype.expandHorizontal=function(t,e){return e=e||this.x+.5*this.width,new Rec((this.x-e)*t+e,this.y,this.width*t,this.height)},Rec.prototype.expandVertical=function(t,e){return e=e||this.y+.5*this.height,new Rec(this.x,(this.y-e)*t+e,this.width,this.height*t)},Rec.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},Rec.prototype.clone=function(){return new Rec(this.x,this.y,this.width,this.height)},Rec.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", w="+this.width+", h="+this.height+")"},T.prototype.applyFunction=function(t){var e,n=new T;for(n.name=this.name,e=0;null!=this[e];e++)n[e]=this[e].applyFunction(t);return n.downcast()},T.prototype.getListsDowncasted=function(){return T.toL(this.map((function(t){return t.downcast()})))},T.prototype.get=function(t,e,n,r){var o,i;if(t&&Array.isArray(t))return this.getColumns(t);if("string"==typeof t){for(t=t.trim(),i=!1,o=0;o<this.length;o++)if(this[o].name==t){i=!0,t=o;break}if(!i)return null}else(t=null==t?0:t)<0&&(t+=this.length);var s=this[t];if(null==s){if("number"==typeof t){if(t>this.length)throw new Error("provided indexElementInColumn bigger than list in indexOrNameOfColumn");return null}if("string"!=typeof t)throw new Error("indexOrNameOfColumn should be a number or a string")}if(null==s)return null;if(r)return s.getWithoutRepetitions();if(null==e&&null==n)return s;var a=s.length;null==e&&(e=0),null==n&&(n=a-1),e<0&&(e+=s.length),n<0&&(n+=s.length),n=Math.min(n,a-1);var l=new L;for(l.name=s.name,o=e;o<=n;o++)l.push(s[o]);return l.downcast()},T.prototype.getColumns=function(t,e,n,r,o){if(null!=t){var i;if("string"==_typeOf(t)&&t.includes(",")&&(t=t.split(",")),null!=t.length&&"string"!=_typeOf(t)||(t=[t]),o)return i=this.getWithoutColumns(t),null==e&&null==n||(i=i.sliceRows(e,n)),i.name=this.name,i.downcast();i=new T;var s,a,l=t.length;for(s=0;s<l;s++)null==(a=this.get(t[s],e,n))?r&&i.push(new L):i.push(a);return i.downcast()}},T.prototype.getWithoutColumn=function(t){if(null!=t){var e=t.isList?t:this.get(t);return null==e?this:this.getWithoutElement(e)}},T.prototype.getWithoutColumns=function(t){if(null!=t){var e=this.getColumns(t);return null==e||0==e.length?this:this.getWithoutElements(e)}},T.prototype.getRow=function(t){if((t=null==t?0:t)<0&&(t+=this.length>0?this[0].length:0),!Number.isInteger(Number(t)))return null;var e,n=new L,r=this.length;for(e=0;e<r;e++)n[e]=this[e][t];return n.downcast()},T.prototype.getRows=function(t,e){if(null==t)return e?this:void 0;"I"==t.type&&(t.x<0&&this.length>0&&(t.x+=this[0].length),t.y<0&&this.length>0&&(t.y+=this[0].length),t=createSortedNumberList(Math.floor(t.y-t.x+1),t.x));var n,r,o,i,s=new T,a=this.length,l=t.length;for(r=0;r<a;r++){for(n=instanceSameType(this[r]),o=0;o<l;o++)(i=t[o])<0&&(i+=this[0].length,!0),n[o]=this[r][i];"nL"!=n.type&&(n=n.downcast()),n.name=this[r].name,s[r]=n}return s.name=this.name,s.downcast()},T.prototype.getCell=function(t,e){return this.get(t).get(e)},T.prototype.getListLength=function(t){if(!((t=t||0)>=this.length))return this[t].length},T.prototype.getLengths=function(){for(var t=new nL,e=this.length,n=0;n<e;n++)t[n]=null==this[n]?0:this[n].length;return t},T.prototype.sliceRows=function(t,e){if(null==t)return this;var n;t.x&&(e=t.y,t=t.x),t=null==t?0:t,e=null==e?this[0].length-1:e;var r,o=new T,i=this.length;for(o.name=this.name,n=0;n<i;n++)(r=this[n].getSubList(t,e))&&(r.name=this[n].name),o.push(r);return o.downcast()},T.prototype.getWithoutRow=function(t){var e=new T,n=this.length;if(e.name=this.name,t<0&&(t+=this.length>0?this[0].length:0),!Number.isInteger(Number(t)))return this;for(var r=0;r<n;r++)e[r]=L.toL(this[r].slice(0,t).concat(this[r].slice(t+1))).downcast(),e[r].name=this[r].name;return e.downcast()},T.prototype.getWithoutRows=function(t){var e,n=new T,r=this.length;n.name=this.name,t=nL.toL(t.slice(),!1);for(var o=0;o<t.length;o++)t[o]<0&&(t[o]+=this.length>0?this[0].length:0);var i=getBooleanDictionaryForList(t);for(o=0;o<r;o++){n[o]=instanceSameType(this[o]),e=this[o].length;for(var s=0;s<e;s++)null==i[s]&&n[o].push(this[o][s]);n[o].name=this[o].name}return n.downcast()},T.prototype.sortRowsByList=function(t,e,n){if(null!=t){var r=t.isList?t.clone():this.get(t);if(null!=r){e=null==e||e,n=null!=n&&n;for(var o=instanceSameType(this),i=this.length,s=[],a=0;a<r.length;a++)s[a]=[a,r[a]];var l,u,h=("nL"==r.type||"dL"==r.type)&&!n;for(l=e?h?function(t,e){return t[1]-e[1]}:n?function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:t[0]-e[0]}:function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}:h?function(t,e){return e[1]-t[1]}:n?function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:t[0]-e[0]}:function(t,e){return t[1]<e[1]?1:t[1]>e[1]?-1:0},s=s.sort(l),o.name=this.name,a=0;a<i;a++){(u=instanceSameType(this[a])).name=this[a].name,o[a]=u;for(var c=0;c<r.length;c++)u[c]=this[a][s[c][0]]}return o}}},T.prototype.sortRowsByLists=function(t,e){if(null!=t){if("number"==typeof t)(r=new nL).push(t),t=r;else if("string"==typeof t){(r=new sL).push(t),t=r}if("sL"==t.type){for(var n=this.getNames(),r=new nL,o=0;o<t.length;o++){if(-1==(h=n.indexOf(t[o])))throw new Error("No list with name "+t[o]);r.push(h)}t=r}null==e&&(e=!0),null==e.isList&&(e=createListWithSameElement(t.length,e));var i=new nL;for(o=0;o<e.length;o++)1==e[o]||"true"==e[o]||1==e[o]?i.push(1):i.push(-1);var s=instanceSameType(this),a=this.length,l=[];for(o=0;o<this[0].length;o++)l[o]={i:o,t:this,lists:t,polarity:i};var u;for(l=l.sort((function(t,e){for(var n,r,o,i=0;i<t.lists.length;i++){if(n=t.t[t.lists[i]][t.i],r=e.t[e.lists[i]][e.i],o=i<t.polarity.length?t.polarity[i]:1,n<r)return-1*o;if(n>r)return 1*o;if(i==t.lists.length-1)return t.i-e.i}return 0})),s.name=this.name,o=0;o<a;o++){(u=instanceSameType(this[o])).name=this[o].name,s[o]=u;for(var h=0;h<this[o].length;h++)u[h]=this[o][l[h].i]}return s}},T.prototype.transpose=function(t,e){var n,r,o,i=t?this.getSubList(1):this,s=i.length,a=instantiate(_typeOf(i));if(0===i.length)return a;for(r=0;r<s;r++)for(n=i[r].length,o=0;o<n;o++)0===r&&(a[o]="nT"==this.type?new nL:new L),a[o][r]=i[r][o];if(n=i[0].length,"nT"!=this.type)for(o=0;o<n;o++)a[o]=a[o].downcast();if(t)for(n=this[0].length,o=0;o<n;o++)a[o].name=String(this[0][o]);if(e){var l=new sL,u=t?1:0;for(s=this.length,r=u;r<s;r++)l.push(this[r].name);a._splice(0,0,l),a=a.downcast(),t&&(l.name=this[0].name)}return a},T.prototype.removeRow=function(t){for(var e=0;null!=this[e];e++)this[e].splice(t,1)},T.prototype.pushRow=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;var t=arguments;1==t.length&&t[0].length==this.length&&(t=t[0]);for(var e=0;e<t.length&&e<this.length;e++)this[e].push(t[e])},T.prototype.clone=function(){var t,e=this.length,n=instanceSameType(this);for(n.name=this.name,t=0;t<e;t++)n.push(this[t].clone());return void 0!==this.containsNulls&&(n.containsNulls=this.containsNulls),n},T.prototype.cloneWithEmptyLists=function(){var t,e,n=this.length,r=instanceSameType(this);for(r.name=this.name,t=0;t<n;t++)(e=instanceSameType(this[t])).name=this[t].name,r.push(e);return r},T.prototype.appendRows=function(t){if(null==t)return this;var e,n;for(t==this&&(t=t.clone()),e=0;e<t.length;e++)for(e>=this.length&&(this[e]=instanceSameType(t[e]),this[e].name=t[e].name),n=0;n<t[e].length;n++)this[e].push(t[e][n]);return this},T.prototype.insertRow=function(t,e,n,r){if(null==t)return null;n=null!=n&&n;var o,i,s=(r=null!=r&&r)?this:this.clone();for(o=0;o<s.length&&o<t.length;o++)i="nL"!=s[o].type||isNaN(t[o])?t[o]:Number(t[o]),s[o]=s[o].insert(i,null==e?s[o].length:e,n);return s},T.prototype.trim=function(){return this.reduce(((t,e)=>(t.push("sL"==e.type?e.trim():e),t)),new T).downcast()},polL.prototype.getFrame=function(){if(0===this.length)return null;for(var t=this[0].getFrame(),e=new Rec(t.x,t.y,t.getRight(),t.getBottom()),n=1;null!=this[n];n++)t=this[n].getFrame(),e.x=Math.min(e.x,t.x),e.y=Math.min(e.y,t.y),e.width=Math.max(e.width,t.getRight()),e.height=Math.max(e.height,t.getBottom());return e.width-=e.x,e.height-=e.y,e},polL.prototype.getCenter=function(){var t=this.getFrame();return new P(t.x+.5*t.width,t.y+.5*t.height)},polL.prototype.getBarycenter=function(){var t;if(0===this.length)return null;var e=new P(this[0].x,this[0].y);for(t=1;null!=this[t];t++)e.x+=this[t].getBarycenter().x,e.y+=this[t].getBarycenter().y;return e.x/=this.length,e.y/=this.length,e},polL.prototype.add=function(t){var e;if("P"===_typeOf(t)){var n=new polL;for(e=0;null!=this[e];e++)n[e]=this[e].add(t);return n.name=this.name,n}},polL.prototype.factor=function(t){for(var e=new polL,n=0;null!=this[n];n++)e[n]=this[n].factor(t);return e.name=this.name,e},polL.prototype.getRotated=function(t,e){for(var n=new polL,r=0;null!=this[r];r++)n[r]=this[r].getRotated(t,e);return n.name=this.name,n},polL.prototype.clone=function(){for(var t=new polL,e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},Pol.prototype.getFrame=function(){if(0===this.length)return null;for(var t,e=new Rec(this[0].x,this[0].y,this[0].x,this[0].y),n=1;null!=this[n];n++)t=this[n],e.x=Math.min(e.x,t.x),e.y=Math.min(e.y,t.y),e.width=Math.max(e.width,t.x),e.height=Math.max(e.height,t.y);return e.width-=e.x,e.height-=e.y,e},Pol.prototype.getCenter=function(){var t=this.getFrame();return new P(t.x+.5*t.width,t.y+.5*t.height)},Pol.prototype.getBarycenter=function(t){var e;t=null==t||t;var n=1-Number(t);if(0===this.length)return null;var r=new P(this[0].x,this[0].y);for(e=1;null!=this[e+n];e++)r.x+=this[e].x,r.y+=this[e].y;return r.x/=this.length,r.y/=this.length,r},Pol.prototype.add=function(t){var e;if("P"===_typeOf(t)){var n=new Pol;for(e=0;null!=this[e];e++)n[e]=this[e].add(t);return n.name=this.name,n}},Pol.prototype.factor=function(t){var e,n=new Pol;if(n.name=this.name,t>=0||t<0){for(e=0;null!=this[e];e++)n[e]=new P(this[e].x*t,this[e].y*t);return n}if(null!=t.type&&"P"==t.type){for(e=0;null!=this[e];e++)n[e]=new P(this[e].x*t.x,this[e].y*t.y);return n}return null},Pol.prototype.getRotated=function(t,e){e=null==e?this.getCenter():e;for(var n=new Pol,r=0;null!=this[r];r++)n[r]=new P(Math.cos(t)*(this[r].x-e.x)-Math.sin(t)*(this[r].y-e.y)+e.x,Math.sin(t)*(this[r].x-e.x)+Math.cos(t)*(this[r].y-e.y)+e.y);return n.name=this.name,n},Pol.prototype.getClosestPoint=function(t){for(var e,n=this[0],r=Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2),o=1;null!=this[o];o++)(e=Math.pow(t.x-this[o].x,2)+Math.pow(t.y-this[o].y,2))<r&&(r=e,n=this[o]);return n},Pol.prototype.toNumberList=function(){var t,e=new nL;for(t=0;null!=this[t];t++)e[2*t]=this[t].x,e[2*t+1]=this[t].y;return e},Pol.prototype.containsPoint=function(t){var e,n,r,o;for(o=!1,e=-1,n=(r=this.length)-1;++e<r;n=e)(this[e].y<=t.y&&t.y<this[n].y||this[n].y<=t.y&&t.y<this[e].y)&&t.x<(this[n].x-this[e].x)*(t.y-this[e].y)/(this[n].y-this[e].y)+this[e].x&&(o=!o);return o},Pol.prototype.touchesPolygon=function(t){var e=this.getFrame(),n=t.getFrame();if(e.x>n.x+n.width||e.x+e.width<n.x||e.y>n.y+n.height||e.y+e.height<n.y)return!1;for(var r=0;r<this.length;r++)if(t.containsPoint(this[r]))return!0;return!1},Pol.prototype.approach=function(t,e){var n=1-(e=e||.5);this.forEach((function(r,o){r.x=n*r.x+e*t[o].x,r.y=n*r.y+e*t[o].y}))},Pol.prototype.clone=function(){for(var t=new Pol,e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},Nd.prototype.cleanRelations=function(){this.nodes=new ndL,this.relations=new relL,this.to=new ndL,this.toRelationList=new relL,this.from=new ndL,this.fromRelationList=new relL},Nd.prototype.getDegree=function(){return this.relations.length},Nd.prototype.getParent=function(){return this.parent},Nd.prototype.getLeaves=function(){var t=new ndL,e=function(n){0!==n.to.length?n.to.forEach(e):t.addNode(n)};return e(this),t},Nd.prototype.loadImage=function(t){Loader.loadImage(t,(function(t){this.image=t.result}),this)},Nd.prototype.clone=function(t){var e=new Nd(this.id,this.name);return e.x=this.x,e.y=this.y,e.z=this.z,e.nodeType=this.nodeType,e.weight=this.weight,e.descentWeight=this.descentWeight,t?.forEach((t=>{e[t]=this[t]})),e},sL.prototype.getLengths=function(){var t=new nL;return this.forEach((function(e){t.push(null==e?0:e.length)})),t},sL.prototype.countTags=function(t=","){var e=new nL;return this.forEach((function(n){n.includes(t)?e.push(n.split(t).length):e.push(0)})),e},sL.prototype.includesSubString=function(t){for(var e=0;e<this.length;e++)if(this[e].includes(t))return!0;return!1},sL.prototype.indexesOfSubString=function(t){for(var e=new nL,n=0;n<this.length;n++)this[n].includes(t)&&e.push(n);return e},sL.prototype.append=function(t,e){e=null==e||e;var n=new sL;n.name=this.name;var r,o="sL"==_typeOf(t);if(e)for(r=0;null!=this[r];r++)n[r]=this[r]+(o?t[r]:t);else for(r=0;null!=this[r];r++)n[r]=(o?t[r]:t)+this[r];return n},sL.prototype.getSurrounded=function(t,e){e=null==e?"":e;var n,r=new sL;r.name=this.name;var o=Array.isArray(t),i=Array.isArray(e);for(n=0;null!=this[n];n++)r[n]=(o?t[n]:t)+this[n]+(i?e[n]:e);return r},sL.prototype.replace=function(t,e){if(null==t)return this;var n,r=new sL,o=this.length;for(r.name=this.name,n=0;n<o;n++)r[n]=this[n].replace(t,e);return r},sL.prototype.getConcatenated=function(t){var e;t=null==t?" ":t;var n="",r=this.length;for(e=0;e<r;e++)n+=this[e],e<this.length-1&&(n+=t);return n},sL.prototype.toLowerCase=function(){var t,e=new sL;e.name=this.name;var n=this.length;for(t=0;t<n;t++)e[t]=this[t].toLowerCase();return e},sL.prototype.toUpperCase=function(){var t,e=new sL;e.name=this.name;var n=this.length;for(t=0;t<n;t++)e[t]=this[t].toUpperCase();return e},sL.prototype.trim=function(t){if(this.isTable)return this.trim();if("sL"!=this.type)return null;var e,n=this.length,r=new sL;for(e=0;e<n;e++)r[e]=t?this[e].substring(0,t).trim():this[e].trim();return r.name=this.name,r},sL.prototype.clone=function(){var t=sL.toL(this.slice(),!1);return t.name=this.name,t.fnDerived=this.fnDerived,t},ndL.prototype.removeNodes=function(){var t,e=this.length;for(t=0;t<e;t++)this.ids[this[t].id]=null,this.removeElement(this[t])},ndL.prototype.addNode=function(t){this.ids[t.id]=t,this._push(t)},ndL.prototype.addNodes=function(t){var e;for(e=0;null!=t[e];e++)this.addNode(t[e])},ndL.prototype.removeNode=function(t){this.ids[t.id]=null,this.removeElement(t)},ndL.prototype.removeNodeAtIndex=function(t){this.ids[this[t].id]=null,this.splice(t,1)},ndL.prototype.normalizeWeights=function(){var t,e=-9999999,n=this.length;for(t=0;t<n;t++)e=Math.max(this[t].weight,e);for(t=0;t<n;t++)this[t].weight/=e},ndL.prototype.getNodeByName=function(t){var e,n=this.length;for(e=0;e<n;e++)if(this[e].name==t)return this[e];return null},ndL.prototype.get=function(t){return this.ids[t]},ndL.prototype.getNodesByIds=function(t){for(var e,n=new ndL,r=t.length,o=0;o<r;o++)null!=(e=this.ids[t[o]])&&n.addNode(e);return n},ndL.prototype.getWeights=function(){var t,e=new nL;for(t=0;null!=this[t];t++)e[t]=this[t].weight;return e},ndL.prototype.getIds=function(){for(var t=new sL,e=this.length,n=0;n<e;n++)t[n]=this[n].id;return t},ndL.prototype.getDegrees=function(){for(var t=new nL,e=0;null!=this[e];e++)t[e]=this[e].nodes.length;return t},ndL.prototype.getPolygon=function(t){for(var e=new Pol,n=0;null!=this[n];n++)e[n]=new P(this[n].x+t.cX,this[n].y+t.cY);return e},ndL.prototype.clone=function(){var t,e=new ndL,n=this.length;for(t=0;t<n;t++)e.addNode(this[t]);return e.name=this.name,e},ndL.prototype.getWithoutRepetitions=function(){var t,e=new ndL;for(e.name=this.name,t=0;null!=this[t];t++)null==e.get(this[t].id)&&e.addNode(this[t]);return e},ndL.prototype.removeElements=function(t){var e;for(e=0;null!=this[e];e++)null!=t.get(this[e].id)&&(this.ids[this[e].id]=null,this.splice(e,1),e--)},relL.prototype.addRelation=function(t){this.addNode(t)},relL.prototype.removeRelation=function(t){this.removeNode(t)},relL.prototype.getRelationsWithNode=function(t){var e,n=[];for(e=0;null!=this[e];e++){var r=this[e];r.node0!=t&&r.node1!=t||n.push(r)}return n},relL.prototype.getRelatedNodesToNode=function(t){var e,n=new ndL;for(e=0;e<this.length;e++){var r=this[e];r.node0.id==t.id&&n.push(r.node1),r.node1.id==t.id&&n.push(r.node0)}return n},relL.prototype.getChildrenOfNode=function(t){var e,n=new ndL;for(e=0;e<this.length;e++){var r=this[e];r.node0.id==t.id&&n.addNode(r.node1)}return n},relL.prototype.getAllRelationsBetweenNodes=function(t,e,n){var r;n=null!=n&&n;var o=[];for(r=0;null!=this[r];r++){var i=this[r];(i.node0==t&&i.node1==e||!n&&i.node0==e&&i.node1==t)&&o.push(i)}return o},relL.prototype.nodesAreConnected=function(t,e,n){return null!=t.to.get(e.id)||!n&&null!=e.to.get(t.id)},relL.prototype.getFirstRelationBetweenNodes=function(t,e,n){n=null!=n&&n;for(var r=0;null!=this[r];r++)if(this[r].node0.id==t.id&&this[r].node1.id==e.id||!n&&this[r].node1.id==t.id&&this[r].node0.id==e.id)return this[r];return null},relL.prototype.getFirstRelationByIds=function(t,e,n){var r,o,i=n||!1;for(r=0;null!=this[r];r++)if((o=this[r]).node0.id==t&&o.node1.id==e)return o;if(i)return null;for(r=0;null!=this[r];r++)if((o=this[r]).node0.id==e&&o.node1.id==t)return o;return null},recL.prototype.getFrame=function(){if(0===this.length)return null;var t=this[0].clone();t.width=t.getRight(),t.height=t.getBottom();for(var e=1;null!=this[e];e++)t.x=Math.min(t.x,this[e].x),t.y=Math.min(t.y,this[e].y),t.width=Math.max(this[e].getRight(),t.width),t.height=Math.max(this[e].getBottom(),t.height);return t.width-=t.x,t.height-=t.y,t},recL.prototype.clone=function(){for(var t=new recL,e=0;null!=this[e];e++)t[e]=this[e].clone();return t.name=this.name,t},recL.prototype.add=function(){},recL.prototype.factor=function(){},recL.prototype.getIntersectionArea=function(){for(var t,e,n,r=0,o=0;null!=this[o+1];o++){t=this[o];for(var i=o+1;null!=this[i];i++)e=this[i],r+=null==(n=t.getIntersection(e))?0:n.getArea()}return r},recL.prototype.intersectsRectangle=function(t){if(null==t)return!1;for(var e=0;e<this.length;e++)if(this[e].intersectsRectangle(t))return!0;return!1},Rel.prototype.getOther=function(t){return t==this.node0?this.node1:this.node0},Rel.prototype.clone=function(t,e){var n;return(n=e?new Rel(this.id,this.name,e.nodes.get(this.node0.id),e.nodes.get(this.node1.id)):new Rel(this.id,this.name,this.node0,this.node1)).x=this.x,n.y=this.y,n.z=this.z,n.nodeType=this.nodeType,n.weight=this.weight,n.descentWeight=this.descentWeight,t?.forEach((t=>{n[t]=this[t]})),n},Net.prototype.getNodes=function(){return this.nodes},Net.prototype.getRelations=function(){return this.relations},Net.prototype.getNodesIds=function(){return this.nodes.getIds()},Net.prototype.addNode=function(t){this.nodes.addNode(t)},Net.prototype.getNodeByName=function(t){return this.nodes.getNodeByName(t)},Net.prototype.get=function(t){return this.nodes.get(t)},Net.prototype.createRelation=function(t,e,n,r,o,i){null==n&&(n=t.id+"_"+e.id);var s=this.relations.get(n);return s||(null==i&&(i=t.name+"_"+e.name),s=new Rel(n,i,t,e,r,o),this.addRelation(s),s)},Net.prototype.addRelation=function(t){this.relations.addNode(t),t.node0.nodes.addNode(t.node1),t.node0.relations.addNode(t),t.node0.to.addNode(t.node1),t.node0.toRelationList.addNode(t),t.node1.nodes.addNode(t.node0),t.node1.relations.addNode(t),t.node1.from.addNode(t.node0),t.node1.fromRelationList.addNode(t)},Net.prototype.connect=function(t,e,n,r,o){var i=new Rel(n=n||t.id+"_"+e.id,n,t,e,r=r||1);return this.addRelation(i),i.content=o,i},Net.prototype.removeNode=function(t){this.removeNodeRelations(t),this.nodes.removeNode(t)},Net.prototype.removeNodeRelations=function(t){for(var e=0;null!=t.relations[e];e++)this.removeRelation(t.relations[e]),e--},Net.prototype.removeNodes=function(){this.nodes.deleteNodes(),this.relations.deleteNodes()},Net.prototype.removeRelation=function(t){this.relations.removeElement(t),t.node0.nodes.removeNode(t.node1),t.node0.relations.removeRelation(t),t.node0.to.removeNode(t.node1),t.node0.toRelationList.removeRelation(t),t.node1.nodes.removeNode(t.node0),t.node1.relations.removeRelation(t),t.node1.from.removeNode(t.node0),t.node1.fromRelationList.removeRelation(t)},Net.prototype.removeIsolatedNodes=function(t=1){var e,n=0;for(e=0;null!=this.nodes[e];e++)this.nodes[e].getDegree()<t&&(this.nodes[e]._toRemove=!0);for(e=0;null!=this.nodes[e];e++)this.nodes[e]._toRemove&&(this.removeNode(this.nodes[e]),n++,e--);return n},Net.prototype.lightClone=function(){var t=new Net;return t.nodes=this.nodes,t.relations=this.relations,t},Net.prototype.clone=function(t,e,n,r){var o,i,s=new Net;return null==t&&(t=[]),null==e&&(e=[]),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(e){o=new Nd(n+e.id,r+e.name),""!==n&&(o.basicId=e.id),""!==r&&(o.basicName=e.name),t&&(t.forEach((function(t){null!=e[t]&&(o[t]=e[t])})),o.weight=e.weight,o.color=e.color,o.kind=e.kind),s.addNode(o)})),this.relations.forEach((function(t){i=new Rel(n+t.id,r+t.name,s.nodes.get(n+t.node0.id),s.nodes.get(n+t.node1.id),t.weight),""!==n&&(i.basicId=t.id),""!==r&&(i.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(i[e]=t[e])})),s.addRelation(i)})),s},Tr.prototype.addNodeToTree=function(t,e){if(this.addNode(t),null==e)t.level=0,t.parent=null;else{var n=new Rel(e.id+"_"+t.id,e.id+"_"+t.id,e,t);this.addRelation(n),t.level=e.level+1,t.parent=e,e.weight++}t.weight=1,this.nLevels=Math.max(this.nLevels,t.level+1)},Net.prototype._newCreateRelation=function(t,e,n,r){null==n&&(n=this.relations.getNewId()),this._createRelation(t,e,n,r),e.level=t.level+1,e.parent=t,this.nLevels=Math.max(this.nLevels,e.level+1)},Tr.prototype.addFather=function(t,e){if(null!=e.parent||-1==this.nodes.indexOf(e))return!1;this.addNode(t),e.parent=t,e.level=1,this.nLevels=Math.max(this.nLevels,1),this.createRelation(t,e)},Tr.prototype.getLevel=function(t){t=0===t?0:t;var e=new ndL;e.name="level_"+t;var n,r=this.nodes.length;for(n=0;n<r;n++)this.nodes[n].level==t&&e.addNode(this.nodes[n]);return e},Tr.prototype.getLeaves=function(t){var e,n,r=new ndL;if(r.name="leaves",t){if(0===t.to.length)return r.addNode(t),r;var o=function(t){if(0===t.to.length)r.addNode(t);else for(n=t.to.length,e=0;e<n;e++)o(t.to[e])};for(n=t.to.length,e=0;e<n;e++)o(t.to[e])}else for(n=this.nodes.length,e=0;e<n;e++)0===this.nodes[e].to.length&&r.addNode(this.nodes[e]);return r},Tr.prototype.assignDescentWeightsToNodes=function(){this._assignDescentWeightsToNode(this.nodes[0])},Tr.prototype._assignDescentWeightsToNode=function(t){var e;if(0===t.to.length)return t.descentWeight=t.weight,t.descentWeight;for(t.descentWeight=0,e=0;null!=t.to[e];e++)t.descentWeight+=this._assignDescentWeightsToNode(t.to[e]);return t.weight=t.descentWeight,t.descentWeight},Tr.prototype.getReport=function(){return"Tr contains "+this.nodes.length+" nodes and "+this.relations.length+" relations"},Tr.prototype.traverse=function(t,e,n){if(null!=this&&"Tr"==this.type){if(null==t)if(null==(t=this.getLevel(0)[0]))return;e=null==e?0:e;for(var r,o,i,s,a=[t],l=0,u=new ndL;a.length>0;)if(o=0==e?a.pop():a.shift(),s=!0,n&&(s=n(o,l++,this)),u.addNode(o),s&&0!=(i=this.relations.getChildrenOfNode(o)).length)if(0==e)for(r=i.length-1;r>=0;r--)a.push(i[r]);else for(r=0;r<i.length;r++)a.push(i[r]);return u}},Tr.prototype.getAncestorsOf=function(t){if(null!=this&&"Tr"==this.type){var e,n,r;if("Nd"==t.type)(r=new ndL).addNode(t);else{if("ndL"!=t.type)return;r=t}var o=new ndL;for(n=0;n<r.length;n++)for(e=r[n];null!=e.parent;)o.addNode(e.parent),e=e.parent;return o=o.getWithoutRepetitions()}},Tr.prototype.buildFilteredTree=function(t){if(null!=this&&"Tr"==this.type){if("ndL"!=t.type)throw new Error("Invalid input type for buildFilteredTree");var e,n,r=this.clone(),o=this.getAncestorsOf(t),i=new ndL;for(n=0;n<r.nodes.length;n++)e=r.nodes[n],null==o.get(e.id)&&null==t.get(e.id)&&i.addNode(e);for(n=0;n<i.length;n++)r.removeNode(i[n]);return r}},Tr.prototype.clone=function(t,e,n,r){var o,i,s=new Tr;return s.nLevels=this.nLevels,null==t&&(t=[]),null==e&&(e=[]),t.push("parent"),t.push("level"),t.push("bOpen"),t.push("color"),n=null==n?"":String(n),r=null==r?"":String(r),this.nodes.forEach((function(e){o=new Nd(n+e.id,r+e.name),""!==n&&(o.basicId=e.id),""!==r&&(o.basicName=e.name),t&&t.forEach((function(t){null!=e[t]&&(o[t]=e[t])})),s.addNode(o)})),this.relations.forEach((function(t){i=new Rel(n+t.id,r+t.name,s.nodes.get(n+t.node0.id),s.nodes.get(n+t.node1.id),t.weight),""!==n&&(i.basicId=t.id),""!==r&&(i.basicName=t.name),e&&e.forEach((function(e){null!=t[e]&&(i[e]=t[e])})),s.addRelation(i)})),s},dI.prototype.toString=function(){return"DateInterval["+this.date0+", "+this.date1+"]"},dI.prototype.getMax=function(){return this.date1>this.date0?this.date1:this.date0},dI.prototype.getMin=function(){return this.date0<this.date1?this.date0:this.date1},dI.prototype.getTimesInterval=function(){return new I(this.date0.getTime(),this.date1.getTime())},dI.prototype.getProduct=function(t){if(null!=t){if("I"==t.type){var e=this.date0.getTime(),n=this.date1.getTime()-e;return new dI(new Date(e+t.x*n),new Date(e+t.y*n))}return null}},nT.prototype.getMax=function(){if(0===this.length)return null;var t,e=this[0].getMax();for(t=1;null!=this[t];t++)e=Math.max(this[t].getMax(),e);return e},nT.prototype.getMaxValues=function(){if(0===this.length)return null;var t,e=new nL;for(t=0;null!=this[t];t++)e[t]=this[t].getMax();return e},nT.prototype.getMaxCell=function(){if(0===this.length)return null;var t,e,n,r=createListWithSameElement(2,0);for(n=this[0][0],t=0;t<this.length;t++)for(e=0;e<this[t].length;e++)this[t][e]>n&&(n=this[t][e],r[0]=t,r[1]=e);return r},nT.prototype.getMin=function(){if(0===this.length)return null;var t,e=this[0].getMin();for(t=1;null!=this[t];t++)e=Math.min(this[t].getMin(),e);return e},nT.prototype.getMinValues=function(){if(0===this.length)return null;var t,e=new nL;for(t=0;null!=this[t];t++)e[t]=this[t].getMin();return e},nT.prototype.getMinCell=function(){if(0===this.length)return null;var t,e,n,r=createListWithSameElement(2,0);for(n=this[0][0],t=0;t<this.length;t++)for(e=0;e<this[t].length;e++)this[t][e]<n&&(n=this[t][e],r[0]=t,r[1]=e);return r},nT.prototype.getInterval=function(t){if(0===this.length)return null;for(var e=this[0].getInterval(t),n=this.length,r=1;r<n;r++){var o=this[r].getInterval(t);e.x=Math.min(e.x,o.x),e.y=Math.max(e.y,o.y)}return e},nT.prototype.getFrame=function(){if(!(this.length<2)){var t=this[0].getInterval(),e=this[1].getInterval();return new Rec(t.x,e.x,t.getAmplitude(),e.getAmplitude())}},nT.prototype.getSums=function(){for(var t=new nL,e=this.length,n=0;n<e;n++)t[n]=this[n].getSum();return t},nT.prototype.getRowsSums=function(){for(var t,e=this[0].clone(),n=1;null!=this[n];n++){t=this[n];for(var r=0;null!=t[r];r++)e[r]+=t[r]}return e},nT.prototype.getAverages=function(){for(var t=new nL,e=0;null!=this[e];e++)t[e]=this[e].getMean();return t},nT.prototype.getRowsAverages=function(){var t,e,n,r,o=this.length,i=this[0].clone().factor(1/o);for(e=1;e<o;e++)for(r=(t=this[e]).length,n=0;n<r;n++)i[n]+=t[n]/o;return i},nT.prototype.getIntervals=function(){var t,e,n=this.length,r=new L;for(e=0;e<n;e++)t=this[e],r.push(t.getInterval());return r},nT.prototype.factor=function(t){var e,n,r=new nT,o=this.length;switch(_typeOf(t)){case"number":for(e=0;e<o;e++)n=this[e],r[e]=n.factor(t);break;case"nL":for(e=0;e<o;e++)n=this[e],r[e]=n.factor(t[e])}return r.name=this.name,r},nT.prototype.add=function(t){var e,n,r=new nT,o=this.length;for(n=0;n<o;n++)e=this[n],r[n]=e.add(t);return r.name=this.name,r},dL.prototype.getTimes=function(){var t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getTime());return e},dL.prototype.getYears=function(){var t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getYear());return e},dL.prototype.getFullYears=function(){var t,e=new nL;for(t=0;null!=this[t];t++)e.push(this[t].getFullYear());return e},dL.prototype.getMin=function(){if(0===this.length)return null;var t,e=this[0];for(t=1;null!=this[t];t++)e=e<this[t]?e:this[t];return e},dL.prototype.getMax=function(){if(0===this.length)return null;var t,e=this[0];for(t=1;null!=this[t];t++)e=e>this[t]?e:this[t];return e},dL.prototype.getInterval=function(){if(0===this.length)return null;var t=this[0],e=this[0];for(let n=1;n<this.length;n++)t=Math.min(this[n],t),e=Math.max(this[n],e);return new dI(t,e)},nL.prototype.getMin=function(){if(0===this.length)return null;var t,e=this[0];for(t=1;t<this.length;t++)e=Math.min(e,this[t]);return e},nL.prototype.getMax=function(){if(0===this.length)return null;var t,e=this[0],n=this.length;for(t=1;t<n;t++)e=Math.max(e,this[t]);return e},nL.prototype.getIndexOfMin=function(){if(0===this.length)return null;var t,e=this[0],n=0;for(t=1;t<this.length;t++)this[t]<e&&(e=this[t],n=t);return n},nL.prototype.getIndexOfMax=function(){if(0===this.length)return null;var t,e=this[0],n=0;for(t=1;t<this.length;t++)this[t]>e&&(e=this[t],n=t);return n},nL.prototype.getAmplitude=function(){if(0===this.length)return 0;for(var t=this[0],e=this[0],n=this.length,r=1;r<n;r++)t=Math.min(t,this[r]),e=Math.max(e,this[r]);return e-t},nL.prototype.getSum=function(){if(0===this.length)return 0;var t,e=this[0],n=this.length;for(t=1;t<n;t++)e+=this[t];return e},nL.prototype.getProduct=function(){if(0===this.length)return null;var t,e=this[0],n=this.length;for(t=1;t<n;t++)e*=this[t];return e},nL.prototype.getInterval=function(t){if(0===this.length)return null;t=null!=t&&t;var e,n=-1/0,r=1/0,o=this.length;for(e=0;e<o;e++)t&&isNaN(this[e])||(n=Math.max(n,this[e]),r=Math.min(r,this[e]));return n==-1/0&&r==1/0&&(r=-1/0,n=1/0),new I(r,n)},nL.prototype.getIntervalWithAverage=function(){if(0===this.length)return null;var t,e=this[0],n=this[0],r=this[0],o=this.length;for(t=1;t<o;t++)e=Math.max(e,this[t]),n=Math.min(n,this[t]),r+=this[t];var i=new I(n,e);return i.average=r/o,i},nL.prototype.getNumbersSimplified=function(t,e){var n,r,o,i=this.length;switch(t=t||0,e=e||0,(n=new nL).name=this.name,t){case 0:var s=Math.pow(10,e);this.forEach((function(t){n.push(Math.floor(t/s)*s)}));break;case 6:(n=this.getQuantiles(e,2)).name=this.name;break;case 1:case 2:e=Math.min(e||10,Math.floor(this.length/2));var a,l=this.getQuantiles(e),u=l.length;for(r=0;r<i;r++)if((a=this[r])<l[0])1==t?n.push(0):n.push(l._min);else for(o=0;o<u;o++)if(a>=l[o]&&(o+1==l.length||a<l[o+1])){1==t?n.push(o+1):n.push(l[o]);break}1==t&&(n.name=this.name+" (n quantile)");break;case 3:for(n.name=this.name+" (order of magnitude)",r=0;r<i;r++)n.push(Math.floor(Math.log(this[r])/Math.log(10)));break;case 4:for(n.name=this.name+" (rounded by order of magnitude)",r=0;r<i;r++)n.push(Math.pow(10,Math.floor(Math.log(this[r])/Math.log(10))));break;case 5:for(e=e||1,n.name=this.name+" (significant digits)",r=0;r<i;r++)n.push(Number(this[r].toPrecision(e)))}return n},nL.prototype.toPolygon=nL.prototype.getMean=function(){return this.getSum()/this.length},nL.prototype.getGeometricMean=function(){if(0==this.length)return 0;for(var t=this[0],e=1;e<this.length;e++)t*=this[e];return Math.pow(t,1/this.length)},nL.prototype.getNorm=function(){for(var t=0,e=this.length,n=0;n<e;n++)t+=Math.pow(this[n],2);return Math.sqrt(t)},nL.prototype.getVariance=function(){for(var t=0,e=this.getMean(),n=this.length,r=0;r<n;r++)t+=Math.pow(this[r]-e,2);return t/this.length},nL.prototype.getStandardDeviation=function(){return Math.sqrt(this.getVariance())},nL.prototype.getMedian=function(){var t=this.getSorted(!0),e=(this.length-1)/2,n=Math.floor(e);return e==n?t[e]:.5*t[n]+.5*t[n+1]},nL.prototype.getQuantiles=function(t,e){t=null==t?4:t,e=e||0;var n,r,o,i,s=this.length,a=this.getSorted(!0),l=s/t,u=Math.floor(l),h=l==u,c=new nL;for(c.name=this.name,n=0;n<t-1;n++)c[n]=h?a[(n+1)*l]:.5*a[(n+1)*u]+.5*a[(n+1)*u+1];if(c._sorted=a,c._min=a[0],c._max=a[a.length-1],0===e)return c;for((r=1==e?new nL:new sL).name=this.name,3==e&&(i=2==t?["low","high"]:["low","medium","high"]),n=0;n<s;n++){for(o=0;o<c.length;o++)if(this[n]<c[o]){r[n]=3==e?i[o]:1==e?o:(0==o?c._min:c[o-1])+"-"+c[o];break}null==r[n]&&(r[n]=3==e?i[o]:1==e?c.length:c[c.length-1]+"-"+c._max)}return r._quantiles=c,r},nL.prototype.getSorted=function(t){var e;return(e=(t=null==t||t)?nL.toL(this.slice().sort((function(t,e){return t-e})),!1):nL.toL(this.slice().sort((function(t,e){return e-t})),!1)).name=this.name,e},nL.prototype.getSortIndexes=function(t){null==t&&(t=!0);var e=[],n=new nL,r=this.length;if(0===this.length)return n;for(var o=0;o<r;o++)e.push([o,this[o]]);for(t?e.sort((function(t,e){return t[1]<e[1]?1:-1})):e.sort((function(t,e){return t[1]<e[1]?-1:1})),o=0;null!=e[o];o++)n.push(e[o][0]);return n.name=this.name,n},nL.prototype.cleanNonFinites=function(t){if(null==t&&(t=this.getInterval()),!isFinite(t.x)||!isFinite(t.y)){var e,n,r=new nL,o=new nL,s=new nL,a=new nL;for(a.name=this.name,i=0;i<this.length;i++)isFinite(this[i])?(null==e&&(e=this[i]),null==n&&(n=this[i]),e=Math.min(e,this[i]),n=Math.max(n,this[i]),a[i]=this[i]):this[i]==1/0?o.push(i):this[i]==-1/0?r.push(i):s.push(i);for(null==e&&(e=0),null==n&&(n=0),e--,n++,i=0;i<r.length;i++)a[r[i]]=e;for(i=0;i<o.length;i++)a[o[i]]=n;for(i=0;i<s.length;i++)a[s[i]]=0;return a}return this},nL.prototype.getNormalized=function(t){if(null!=this){if(t=null==t?1:t,0===this.length)return null;var e,n=this.getInterval(),r=this.cleanNonFinites(n);if(this!=r)return r.getNormalized(t);var o,i=n.getAmplitude();if(0===i)return(o=createListWithSameElement(this.length,1)).name=this.name,o.interval=n,o;for(o=new nL,t/=i,e=0;e<this.length;e++)o[e]=t*(this[e]-n.x);return o.name=this.name,o.interval=n,o}},nL.prototype.getNormalizedToMax=function(t){if(null!=this){if(t=null==t?1:t,0===this.length)return null;var e,n=this.getMax(),r=this.cleanNonFinites();if(this!=r)return r.getNormalizedToMax(t);var o=new nL;for(e=0;e<this.length;e++)o[e]=t*this[e]/n;return o.name=this.name,o}},nL.prototype.factor=function(t){var e,n=new nL,r=this.length;if(Array.isArray(t))for(e=0;e<r;e++)n.push(this[e]*t[e%this.length]);else for(e=0;e<r;e++)n.push(this[e]*t);return n.name=this.name,n},nL.prototype.add=function(t){var e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]+t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]+t[e%t.length]}return n.name=this.name,n},nL.prototype.subtract=function(t){var e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]-t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]-t[e%t.length]}return n.name=this.name,n},nL.prototype.divide=function(t){var e,n=new nL,r=_typeOf(t),o=this.length;switch(r){case"number":for(e=0;e<o;e++)n[e]=this[e]/t;break;case"nL":for(e=0;e<o;e++)n[e]=this[e]/t[e%t.length]}return n.name=this.name,n},nL.prototype.sqrt=function(){var t,e=new nL,n=this.length;for(t=0;t<n;t++)e.push(Math.sqrt(this[t]));return e.name=this.name,e},nL.prototype.pow=function(t){var e,n=new nL,r=this.length;for(e=0;e<r;e++)n.push(Math.pow(this[e],t));return n.name=this.name,n},nL.prototype.log=function(t){var e;t=t||0;var n=new nL,r=this.length;for(e=0;e<r;e++)n[e]=Math.log(this[e]+t);return n.name=this.name,n},nL.prototype.floor=function(){var t,e=new nL,n=this.length;for(t=0;t<n;t++)e.push(Math.floor(this[t]));return e.name=this.name,e},nL.prototype.approach=function(t,e){var n,r=1-(e=e||.5),o=this.length;for(n=0;n<o;n++)this[n]=r*this[n]+e*t[n];return!0},nL.prototype.isEqual=function(t){var e=this.length;if(null==t||t.length!=e)return!1;for(var n=0;n<e;n++)if(this[n]!=t[n])return!1;return!0},nL.prototype.addRandom=function(t){var e;null==t&&(t=new I(0,1));var n=new nL,r=this.length,o=t.getAmplitude();for(e=0;e<r;e++)n[e]=this[e]+Math.random()*o+t.x;return n.name=this.name,n},nL.prototype.trim=function(t,e){if(null==t&&null==e)return this;for(var n=new nL,r=0;r<this.length;r++)null!=t&&(n[r]=Math.max(this[r],t)),null!=e&&(n[r]=Math.min(this[r],e));return n.name=this.name,n},nL.prototype.clone=function(){var t=nL.toL(this.slice(),!1);return t.name=this.name,t.fnDerived=this.fnDerived,t},I.prototype.getMin=function(){return Math.min(this.x,this.y)},I.prototype.getMax=function(){return Math.max(this.x,this.y)},I.prototype.getAmplitude=function(){return Math.abs(this.y-this.x)},I.prototype.getSignedAmplitude=function(){return this.y-this.x},I.prototype.getMiddle=function(){return.5*(this.x+this.y)},I.prototype.getRandom=function(){return this.x+(this.y-this.x)*random()},I.prototype.getSign=function(){return this.x==this.y?0:Math.abs(this.y-this.x)/(this.y-this.x)},I.prototype.getScaled=function(t){var e=.5*(this.y-this.x),n=.5*(this.x+this.y);return new I(n-e*t,n+e*t)},I.prototype.getScaledFromProportion=function(t,e){var n=1-e,r=e*(this.y-this.x),o=n*(this.y-this.x),i=n*this.x+e*this.y;return new I(i-r*t,i+o*t)},I.prototype.add=function(t){return new I(this.x+t,this.y+t)},I.prototype.invert=function(){var t=this.x;this.x=this.y,this.y=t},I.prototype.adjustToContain=function(t){t<this.x&&(this.x=t),t>this.y&&(this.y=t)},I.prototype.getInterpolatedValue=function(t){return t*(this.y-this.x)+this.x},I.prototype.getInverseInterpolatedValue=function(t){return(t-this.x)/(this.y-this.x)},I.prototype.getInterpolatedValues=function(t){for(var e=new nL,n=t.length,r=0;r<n;r++)e[r]=this.getInterpolatedValue(t[r]);return e},I.prototype.getInverseInterpolatedValues=function(t){for(var e=new nL,n=t.length,r=0;r<n;r++)e.push(this.getInverseInterpolatedValue(t[r]));return e},I.prototype.intersect=function(t){return new I(Math.max(this.x,t.x),Math.min(this.y,t.y))},I.prototype.unite=function(t){return new I(Math.min(this.x,t.x),Math.max(this.y,t.y))},I.prototype.clone=function(){var t=new I(this.x,this.y);return t.name=name,t},I.prototype.contains=function(t){return this.y>this.x?t>=this.x&&t<=this.y:t>=this.y&&t<=this.y},I.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y},I.prototype.remap=function(t,e){var n=this.getInverseInterpolatedValue(t);return e.getInterpolatedValue(n)},I.prototype.toString=function(){return"Interval[x:"+this.x+"| y:"+this.y+"| amplitude:"+this.getAmplitude()+"]"},pol3DL.prototype.getBarycenter=function(){for(var t,e=0,n=0,r=0,o=0;o<this.length;o++)e+=(t=this[o].getBarycenter()).x,n+=t.y,r+=t.z;return new P3D(e/this.length,n/this.length,r/this.length)},cScale.prototype.getColor=function(t){return this.colorScaleFunction(t)},cScale.prototype.getColorList=function(t){var e,n=new cL;for(e=0;e<t;e++)n.push(this.getColor(e/(t-1)));return n},MetaCanvas.prototype._init=function(t){this.W=1,this.H=1,this.cX=1,this.cY=1,this.mX=0,this.mY=0,this.mP=new P(0,0),this.nF=0,this.MOUSE_DOWN=!1,this.MOUSE_UP=!1,this.MOUSE_UP_FAST=!1,this.WHEEL_CHANGE=0,this.NF_DOWN=void 0,this.NF_UP=void 0,this.MOUSE_PRESSED=void 0,this.MOUSE_IN_DOCUMENT=!0,this.mX_DOWN=void 0,this.mY_DOWN=void 0,this.mX_UP=void 0,this.mY_UP=void 0,this.MOUSE_MOVED=!1,this.PREV_mX=0,this.PREV_mY=0,this.DX_MOUSE=0,this.DY_MOUSE=0,this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0,this.T_MOUSE_PRESSED=0,this.KEY_PRESSED=null,this.KEY_JUST_PRESSED=null,this.SHIFT_PRESSED=!1,this.IS_TOUCH="ontouchstart"in window||navigator.msMaxTouchPoints>0,this.force=0,this.cursorStyle="auto",this.backGroundColor="white",this.backGroundColorRGB=[255,255,255],this.cycleActive=void 0,this._prevMouseX=0,this._prevMouseY=0,this._setIntervalId=void 0,this._setTimeOutId=void 0,this._interactionCancelledFrame=void 0,this._tLastMouseDown=void 0,this._alphaRefresh=0,this.END_CYCLE_DELAY=3e3,this._LISTENERS_ADDED=!1,this.fontColor="#000000",this.fontSize="14",this.fontName="Arial",this.fontAlign="left",this.fontBaseline="top",this.fontStyle="",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("tabindex","10000"),this.canvas.setAttribute("style","outline:none"),this.container&&this.container.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this._adjustCanvas(this.dimensions);var e=this._onMouseOrKeyBoard.bind(this);this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",e,!1),this.canvas.addEventListener("touchend",e,!1),this.canvas.addEventListener("touchmove",e,!1)),this.canvas.addEventListener("mousemove",e,!1),this.canvas.addEventListener("mousedown",e,!1),this.canvas.addEventListener("mouseup",e,!1),this.canvas.addEventListener("mouseenter",e,!1),this.canvas.addEventListener("mouseleave",e,!1),this.canvas.addEventListener("click",e,!1),this.canvas.addEventListener("DOMMouseScroll",e,!1),this.canvas.addEventListener("mousewheel",e,{passive:!1}),this.canvas.addEventListener("keydown",e,!1),this.canvas.addEventListener("keyup",e,!1);var n,r=this._onResize.bind(this);(null!=this.container&&(n=this.container.ownerDocument)?n.defaultView||n.parentWindow:window).addEventListener("resize",resizeThrottler(r,66),!1),parent.addEventListener("resize",resizeThrottler(r,66),!1),this._listeners={mousemove:[],mousedown:[],mouseup:[],mouseenter:[],mouseleave:[],mousewheel:[],click:[],keydown:[],keyup:[]},this.IS_TOUCH&&(this._listeners.touchstart=[],this._listeners.touchend=[],this._listeners.touchmove=[]),this.context.fillStyle="black",this.init(),t&&this._startCycle(),this.memory={}},MetaCanvas.prototype._getRelativeMousePos=function(t){var e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},MetaCanvas.prototype._onMouseOrKeyBoard=function(t){var e;if(this.IS_TOUCH)var n=null!=t.touches&&null!=t.touches[0]?t.touches[0]:t.targetTouches[0];switch(t.type){case"touchmove":this.force=n.force;case"mousemove":e="mousemove"==t.type?this._getRelativeMousePos(t):{x:null==n.clientX?n.pageX:n.clientX,y:(n.clientY,n.clientY)},this.mX=e.x,this.mY=e.y,this.mP.x=this.mX,this.mP.y=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mousedown":case"touchstart":"touchstart"==t.type&&(this.mX=n.clientX,this.mY=n.clientY),this.NF_DOWN=this.nF,this.MOUSE_PRESSED=!0,this.T_MOUSE_PRESSED=0,this._tLastMouseDown=(new Date).getTime(),this.mX_DOWN=this.mX,this.mY_DOWN=this.mY,this.MOUSE_IN_DOCUMENT=!0;break;case"mouseup":case"touchend":this.NF_UP=this.nF,this.MOUSE_PRESSED=!1,this.T_MOUSE_PRESSED=0,this.mX_UP=this.mX,this.mY_UP=this.mY,this.MOUSE_IN_DOCUMENT=!0,this.MOUSE_UP=!0;break;case"mouseenter":this.MOUSE_IN_DOCUMENT=!0;break;case"mouseleave":this.MOUSE_IN_DOCUMENT=!1,this.SHIFT_PRESSED=!1;break;case"keydown":this.SHIFT_PRESSED=t.shiftKey,this.KEY_PRESSED=t.key,this.KEY_JUST_PRESSED=t.key;break;case"keyup":this.SHIFT_PRESSED=!1,this.KEY_PRESSED=null}this._emit(t.type,t),this.cycleActive&&(new Date).getTime()>this._LAST_TIME+33&&this._onCycle()},MetaCanvas.prototype._onResize=function(t){var e=this.W,n=this.H;if(void 0===this.dimensions&&this._adjustCanvas(),this.onResize!==noOperation){var r=this._containerDimensions();r.width===e&&r.height===n||this.onResize(t)}},MetaCanvas.prototype._containerDimensions=function(){return this.container?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0}},MetaCanvas.prototype._adjustCanvas=function(t){if(void 0!==t)this.W=t.width,this.H=t.height;else{var e=this._containerDimensions();this.W=e.width,this.H=e.height}this.cX=Math.floor(.5*this.W),this.cY=Math.floor(.5*this.H),this.canvas.setAttribute("width",this.W),this.canvas.setAttribute("height",this.H),t&&null!=t.x&&this.canvas.setAttribute("x",t.x),t&&null!=t.y&&this.canvas.setAttribute("y",t.y)},MetaCanvas.prototype._startCycle=function(){this.cycleActive=!0,0===this._cycleInterval?setTimeout(this._onCycle.bind(this),10):(clearInterval(this._setIntervalId),this._setIntervalId=setInterval(this._onCycle.bind(this),this._cycleInterval))},MetaCanvas.prototype._stopCycle=function(t){clearInterval(this._setIntervalId),this.cycleActive=!1,this._setIntervalId=void 0,t&&t()},MetaCanvas.prototype.setDimensions=function(t,e,n,r){var o,i,s,a;null!=n&&null!=r?(o=t,i=e,s=n,a=r):(o=0,i=0,s=t,a=e),this.W=s,this.H=a,this.cX=.5*s,this.cY=.5*a,this.canvas.width=s,this.canvas.height=a,this.canvas.style.left=o+"px",this.canvas.style.top=i+"px",this.canvas.style.position="absolute",this._startCycle()},MetaCanvas.prototype.cycleFor=function(t){0===t?(this._setIntervalId&&clearTimeout(this._setTimeOutId),this._startCycle()):1==t?(this._stopCycle(),this._onCycle()):(this._setIntervalId?clearTimeout(this._setTimeOutId):this._startCycle(),this._stopAfter(t))},MetaCanvas.prototype._stopAfter=function(t,e){var n=this;this._setTimeOutId=setTimeout((function(){n._stopCycle(),e&&e()}),t)},MetaCanvas.prototype._onCycle=function(){if(0===this._alphaRefresh?null!=this.backGroundColorRGB?(this.context.fillStyle="rgb("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+")",this.context.fillRect(0,0,this.W,this.H)):this.context.clearRect(0,0,this.W,this.H):(this.context.fillStyle="rgba("+this.backGroundColorRGB[0]+","+this.backGroundColorRGB[1]+","+this.backGroundColorRGB[2]+","+this._alphaRefresh+")",this.context.fillRect(0,0,this.W,this.H)),this.setCursor("default"),this.MOUSE_DOWN=this.NF_DOWN==this.nF,this.MOUSE_UP=this.NF_UP==this.nF,this.MOUSE_UP_FAST=!this.MOUSE_UP_FAST&&this.MOUSE_UP&&this.nF-this.NF_DOWN<9,this.DX_MOUSE=this.mX-this.PREV_mX,this.DY_MOUSE=this.mY-this.PREV_mY,this.MOUSE_MOVED=0!==this.DX_MOUSE||0!==this.DY_MOUSE,this.MOUSE_PRESSED?(this.T_MOUSE_PRESSED=(new Date).getTime()-this._tLastMouseDown,this.DX_MOUSE_PRESSED=this.DX_MOUSE,this.DY_MOUSE_PRESSED=this.DY_MOUSE,this.DX_MOUSE_DRAGGED=this.mX-this.mX_DOWN,this.DY_MOUSE_DRAGGED=this.mY-this.mY_DOWN,this.DRAGGABLE&&(this.x0+=this.DX_MOUSE_PRESSED,this.y0+=this.DY_MOUSE_PRESSED)):(this.DX_MOUSE_PRESSED=0,this.DY_MOUSE_PRESSED=0,this.DX_MOUSE_DRAGGED=0,this.DY_MOUSE_DRAGGED=0),this.ZOOMABLE){let t=1+.3*this.WHEEL_CHANGE;(this.ZOOM*t>=this.MAX_ZOOM||this.ZOOM*t<=this.MIN_ZOOM)&&(t=1),this.ZOOM*=t,this.ZOOM=Math.max(Math.min(this.ZOOM,this.MAX_ZOOM),this.MIN_ZOOM),this.x0=(this.x0-this.mX)*t+this.mX,this.y0=(this.y0-this.mY)*t+this.mY}this.cycle(),this.WHEEL_CHANGE=0,this.PREV_mX=this.mX,this.PREV_mY=this.mY,this.nF++,this.KEY_JUST_PRESSED=null,this._LAST_TIME=(new Date).getTime()},MetaCanvas.prototype._emit=function(t,e){switch(t){case"mousewheel":case"DOMMouseScroll":t="mousewheel",e||(e=window.event),e.wheelDelta?this.WHEEL_CHANGE=e.wheelDelta/120:e.detail&&(this.WHEEL_CHANGE=-e.detail/3),e.value=this.WHEEL_CHANGE}for(var n=this._listeners[t].length,r=0;r<n;r++){var o=this._listeners[t][r];o.call(o.__context,e)}},MetaCanvas.prototype.getCycleInterval=function(){return this._cycleInterval},MetaCanvas.prototype.setCycleInterval=function(t){this._cycleInterval=t,this.cycleActive&&this._startCycle()},MetaCanvas.prototype.start=function(){return this._startCycle()},MetaCanvas.prototype.stop=function(){return this._stopCycle()},MetaCanvas.prototype.cycleOnMouseMovement=function(t){var e=this;this.cycleOnMouseMovementListener&&this._LISTENERS_ADDED&&t<=1&&(this.canvas.removeEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousewheel",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.removeEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.removeEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!1),t>1&&(this.cycleOnMouseMovementListener=function(){e.cycleFor(t)},this._LISTENERS_ADDED||(this.canvas.addEventListener("mousemove",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("mousewheel",this.cycleOnMouseMovementListener,{passive:!1}),this.canvas.addEventListener("mousedown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keydown",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("keyup",this.cycleOnMouseMovementListener,!1),this.IS_TOUCH&&(this.canvas.addEventListener("touchstart",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchend",this.cycleOnMouseMovementListener,!1),this.canvas.addEventListener("touchmove",this.cycleOnMouseMovementListener,!1)),this._LISTENERS_ADDED=!0)),e.cycleFor(t)},MetaCanvas.prototype.on=function(t,e,n){e.__context=n,this._listeners[t].push(e)},MetaCanvas.prototype.off=function(t,e){var n=this._listeners[t].indexOf(e);n>-1&&this._listeners[t].splice(n,1)},MetaCanvas.prototype.clearCanvas=function(){this.context.clearRect(0,0,this.W,this.H)},MetaCanvas.prototype.setBackgroundColor=function(t){"number"==typeof t?t=arguments.length>3?"rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")":"rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")":Array.isArray(t)&&(t=RGBtoHEX(t[0],t[1],t[2])),this.backGroundColor=t,this.backGroundColorRGB=colorStringToRGB(this.backGroundColor)},MetaCanvas.prototype.setBackgroundAlpha=function(t){this._alphaRefresh=t},MetaCanvas.prototype.fRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.fillRect(t,e,n,r)},MetaCanvas.prototype.sRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.strokeRect(t,e,n,r)},MetaCanvas.prototype.fsRect=function(t,e,n,r){"number"!=typeof t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.fillRect(t,e,n,r),this.context.strokeRect(t,e,n,r)},MetaCanvas.prototype.fArc=function(t,e,n,r,o,i){this.context.beginPath(),this.context.arc(t,e,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sArc=function(t,e,n,r,o,i){this.context.beginPath(),this.context.arc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fCircle=function(t,e,n){this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.fill()},MetaCanvas.prototype.sCircle=function(t,e,n){this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke()},MetaCanvas.prototype.fsCircle=function(t,e,n){this.fCircle(t,e,n),this.context.stroke()},MetaCanvas.prototype.fEllipse=function(t,e,n,r){var o=.5522848,i=n*o,s=r*o,a=t+n,l=e+r;this.context.beginPath(),this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,a,e-s,a,e),this.context.bezierCurveTo(a,e+s,t+i,l,t,l),this.context.bezierCurveTo(t-i,l,t-n,e+s,t-n,e),this.context.moveTo(t-n,e),this.context.closePath(),this.context.fill()},MetaCanvas.prototype.sEllipse=function(t,e,n,r){var o=.5522848,i=n*o,s=r*o,a=t+n,l=e+r;this.context.beginPath(),this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,a,e-s,a,e),this.context.bezierCurveTo(a,e+s,t+i,l,t,l),this.context.bezierCurveTo(t-i,l,t-n,e+s,t-n,e),this.context.moveTo(t-n,e),this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsEllipse=function(t,e,n,r){this.fEllipse(t,e,n,r),this.context.stroke()},MetaCanvas.prototype._solidArc=function(t,e,n,r,o,i){this.context.beginPath(),this.context.arc(t,e,o,n,r),this.context.lineTo(t+i*Math.cos(r),e+i*Math.sin(r)),this.context.arc(t,e,i,r,n,!0),this.context.lineTo(t+o*Math.cos(n),e+o*Math.sin(n))},MetaCanvas.prototype.fSolidArc=function(t,e,n,r,o,i){this._solidArc(t,e,n,r,o,i),this.context.fill()},MetaCanvas.prototype.sSolidArc=function(t,e,n,r,o,i){this._solidArc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.fsSolidArc=function(t,e,n,r,o,i){this.fSolidArc(t,e,n,r,o,i),this.context.stroke()},MetaCanvas.prototype.line=function(t,e,n,r){this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(n,r),this.context.stroke()},MetaCanvas.prototype.bezier=function(t,e,n,r,o,i,s,a){this.context.beginPath(),this.context.moveTo(t,e),this.context.bezierCurveTo(n,r,o,i,s,a),this.context.stroke()},MetaCanvas.prototype._lines=function(){if(null!=arguments){var t=arguments[0];this.context.beginPath(),this.context.moveTo(t[0],t[1]);for(var e=2;null!=t[e+1];e+=2)this.context.lineTo(t[e],t[e+1])}},MetaCanvas.prototype._linesM=function(){if(null!=arguments){var t=arguments[0],e=new Pol;this.context.beginPath(),this.context.moveTo(t[0],t[1]),e[0]=new P(t[0],t[1]);for(var n=2;null!=t[n+1];n+=2)this.context.lineTo(t[n],t[n+1]),e.push(new P(t[n],t[n+1]));return e.containsPoint(this.mP)}},MetaCanvas.prototype.fLines=function(){this._lines(arguments),this.context.fill()},MetaCanvas.prototype.sLines=function(){this._lines(arguments),this.context.stroke()},MetaCanvas.prototype.fsLines=function(){this._lines(arguments),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fsLinesM=function(){var t=this._linesM(arguments);return this.context.fill(),this.context.stroke(),t},MetaCanvas.prototype._polygon=function(t){this.context.beginPath(),this.context.moveTo(t[0].x,t[0].y);for(var e=1;null!=t[e];e++)this.context.lineTo(t[e].x,t[e].y)},MetaCanvas.prototype.fPolygon=function(t){this._polygon(t),this.context.fill()},MetaCanvas.prototype.sPolygon=function(t,e){this._polygon(t),e&&this.context.closePath(),this.context.stroke()},MetaCanvas.prototype.fsPolygon=function(t,e){this._polygon(t),e&&this.context.closePath(),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.fEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.fill()},MetaCanvas.prototype.sEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.stroke()},MetaCanvas.prototype.fsEqTriangle=function(t,e,n,r){this._eqTriangle(t,e,n,r),this.context.fill(),this.context.stroke()},MetaCanvas.prototype._eqTriangle=function(t,e,n,r){this.context.beginPath(),n=n||0,this.context.moveTo(r*Math.cos(n)+t,r*Math.sin(n)+e),this.context.lineTo(r*Math.cos(n+2.0944)+t,r*Math.sin(n+2.0944)+e),this.context.lineTo(r*Math.cos(n+4.1888)+t,r*Math.sin(n+4.1888)+e),this.context.lineTo(r*Math.cos(n)+t,r*Math.sin(n)+e)},MetaCanvas.prototype.fRectM=function(t,e,n,r,o){return o=null==o?0:o,this.context.fillRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.sRectM=function(t,e,n,r,o){return o=null==o?0:o,this.context.strokeRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.fsRectM=function(t,e,n,r,o){return o=null==o?0:o,this.context.fillRect(t,e,n,r),this.context.strokeRect(t,e,n,r),this.mY>e-o&&this.mY<e+r+o&&this.mX>t-o&&this.mX<t+n+o},MetaCanvas.prototype.fCircleM=function(t,e,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.fill(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.sCircleM=function(t,e,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.fsCircleM=function(t,e,n,r){return r=null==r?0:r,this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi),this.context.stroke(),this.context.fill(),Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2)<Math.pow(n+r,2)},MetaCanvas.prototype.lineM=function(t,e,n,r,o=4){return this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(n,r),this.context.stroke(),this._distToSegmentSquared(t,e,n,r)<o*o},MetaCanvas.prototype._distToSegmentSquared=function(t,e,n,r){var o=Math.pow(t-n,2)+Math.pow(e-r,2);if(0===o)return Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2);var i=((this.mX-t)*(n-t)+(this.mY-e)*(r-e))/o;if(i<=0)return Math.pow(t-this.mX,2)+Math.pow(e-this.mY,2);if(i>=1)return Math.pow(n-this.mX,2)+Math.pow(r-this.mY,2);var s=t+i*(n-t),a=e+i*(r-e);return Math.pow(s-this.mX,2)+Math.pow(a-this.mY,2)},MetaCanvas.prototype.bezierM=function(t,e,n,r,o,i,s,a,l){return l=null==l?2:l,this.context.beginPath(),this.context.moveTo(t,e),this.context.bezierCurveTo(n,r,o,i,s,a),this.context.stroke(),!(this.mX<Math.min(t,s,n,o)-l||this.mX>Math.max(t,s,n,o)+l||this.mY<Math.min(e,a,r,i)-l||this.mY>Math.max(e,a,r,i)+l)&&distanceToBezierCurve(t,e,n,r,o,i,s,a,this.mP,!1)<l},MetaCanvas.prototype.drawImage=function(t){if(null!=t)switch(arguments.length){case 1:this.context.drawImage(t);break;case 3:this.context.drawImage(t,arguments[1],arguments[2]);break;case 5:this.context.drawImage(t,arguments[1],arguments[2],arguments[3],arguments[4]);break;case 9:this.context.drawImage(t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}},MetaCanvas.prototype.fitImage=function(t,e,n){if(null!=t&&null!=e){null==n&&(n=0);var r,o=t.width/t.height,i=e.width/e.height,s=o/i;switch(n){case 0:r=o>=i;break;case 1:r=o<i;break;case 2:return void this.context.drawImage(t,e.x+.5*e.width-.5*t.width,e.y+.5*e.height-.5*t.height)}r?this.context.drawImage(t,.5*(t.width-t.width/s),0,t.width/s,t.height,e.x,e.y,e.width,e.height):this.context.drawImage(t,0,.5*(t.height-t.height*s),t.width,t.height*s,e.x,e.y,e.width,e.height)}},MetaCanvas.prototype.fill=function(t){if("number"==typeof t)return arguments.length>3?void(this.context.fillStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.fillStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.fillStyle=t},MetaCanvas.prototype.stroke=function(t,e){if("number"==typeof t)return arguments.length>3?void(this.context.strokeStyle="rgba("+arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]+")"):void(this.context.strokeStyle="rgb("+arguments[0]+","+arguments[1]+","+arguments[2]+")");this.context.strokeStyle=t,e&&(this.context.lineWidth=e)},MetaCanvas.prototype.setLW=function(t){this.context.lineWidth=t},MetaCanvas.prototype.clipCircle=function(t,e,n){this.context.save(),this.context.beginPath(),this.context.arc(t,e,n,0,TwoPi,!1),this.context.closePath(),this.context.clip()},MetaCanvas.prototype.clipRect=function(t,e,n,r){this.context.save(),this.context.beginPath(),"Rec"==t.type&&(e=t.y,n=t.width,r=t.height,t=t.x),this.context.moveTo(t,e),this.context.lineTo(t+n,e),this.context.lineTo(t+n,e+r),this.context.lineTo(t,e+r),this.context.clip()},MetaCanvas.prototype.save=function(){this.context.save()},MetaCanvas.prototype.clip=function(){this.context.clip()},MetaCanvas.prototype.restore=function(){this.context.restore()},MetaCanvas.prototype.fText=function(t,e,n){this.context.fillText(t,e,n)},MetaCanvas.prototype.sText=function(t,e,n){this.context.strokeText(t,e,n)},MetaCanvas.prototype.fsText=function(t,e,n){this.context.strokeText(t,e,n),this.context.fillText(t,e,n)},MetaCanvas.prototype.fTextW=function(t,e,n){return this.context.fillText(t,e,n),this.context.measureText(t).width},MetaCanvas.prototype.fsTextW=function(t,e,n){return this.context.strokeText(t,e,n),this.context.fillText(t,e,n),this.context.measureText(t).width},MetaCanvas.prototype.fTextRotated=function(t,e,n,r){this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.fillText(t,0,0),this.context.restore()},MetaCanvas.prototype.fsTextRotated=function(t,e,n,r){this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.strokeText(t,0,0),this.context.fillText(t,0,0),this.context.restore()},MetaCanvas.prototype.fTextArc=function(t,e,n,r,o,i){if(null!=t&&""!==t){var s,a,l,u=Math.sqrt(Math.pow(e-r,2)+Math.pow(n-o,2)),h=Math.atan2(n-o,e-r);i&&(h-=.5*this.getTextW(t)/u);var c=t.split("");for(s=0;null!=c[s];s++)a=r+u*Math.cos(h),l=o+u*Math.sin(h),this.fTextRotated(c[s],a,l,h+HalfPi),h+=this.getTextW(c[s])/u}},MetaCanvas.prototype.fTextM=function(t,e,n,r){return r=Number(r||this.fontSize),this.context.fillText(t,e,n),this.mY>n&&this.mY<n+r&&this.mX>e&&this.mX<e+this.context.measureText(t).width},MetaCanvas.prototype.fsTextM=function(t,e,n,r){return r=Number(r||this.fontSize),this.context.strokeText(t,e,n),this.context.fillText(t,e,n),this.mY>n&&this.mY<n+r&&this.mX>e&&this.mX<e+this.context.measureText(t).width},MetaCanvas.prototype.fTextRotatedM=function(t,e,n,r,o){o=o||12,this.context.save(),this.context.translate(e,n),this.context.rotate(r),this.context.fillText(t,0,0),this.context.restore();var i=this.mX-e,s=this.mY-n,a=Math.sqrt(i*i+s*s),l=Math.atan2(s,i)-r,u=e+a*Math.cos(l),h=n+a*Math.sin(l);return h>n&&h<n+o&&u>e&&u<e+this.context.measureText(t).width},MetaCanvas.prototype.setTextDefaults=function(t,e,n,r,o,i){this.fontColor=ifDef(t,this.fontColor),this.fontSize=ifDef(String(e),this.fontSize),this.fontName=ifDef(n,this.fontName),this.fontAlign=ifDef(r,this.fontAlign),this.fontBaseline=ifDef(o,this.fontBaseline),this.fontStyle=ifDef(i,this.fontStyle),this.setText()},MetaCanvas.prototype.setText=function(t,e,n,r,o,i){var s=ifDef(t,this.fontColor),a=ifDef(String(e),this.fontSize),l=ifDef(n,this.fontName),u=ifDef(r,this.fontAlign),h=ifDef(o,this.fontBaseline),c=ifDef(i,this.fontStyle);""!==c&&(c+=" "),this.context.fillStyle=s,this.context.font=c+a+"px "+l,this.context.textAlign=u,this.context.textBaseline=h},MetaCanvas.prototype.fTextWidth=function(t,e,n,r,o=12){let i=this._textWidthSectionsInfo(t,r),s=i.sections,a=0;return s.forEach((r=>{this.context.fillText(t.substr(a,r-a),e,n),a=r,n+=o})),this.context.fillText(t.substr(a),e,n),i.nLines},MetaCanvas.prototype.getFontFamily=function(){return this.fontName},MetaCanvas.prototype.setFontFamily=function(t){this.setText(void 0,void 0,t)},MetaCanvas.prototype.getTextW=function(t){return this.context.measureText(t).width},MetaCanvas.prototype.nLines=function(t,e){return this._textWidthSectionsInfo(t,e).nLines},MetaCanvas.prototype._textWidthSectionsInfo=function(t,e){if(this["sections_"+e+"_"+t])return this["sections_"+e+"_"+t];let n=t.split(/\s/),r=0,o=[],i=1,s="";return n.forEach((t=>{this.context.measureText(s+t).width>e&&(i++,r+=s.length+1,o.push(r),s=""),s+=(""==s?"":" ")+t})),this["sections_"+e+"_"+t]={sections:o,nLines:i},this["sections_"+e+"_"+t]},MetaCanvas.prototype.getPixelColor=function(t,e){var n=this.context.getImageData(t,e,1,1).data;return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},MetaCanvas.prototype.getPixelColorRGBA=function(t,e){return Array.prototype.slice.call(this.context.getImageData(t,e,1,1).data)},MetaCanvas.prototype.captureCanvas=function(t,e,n,r){var o=new Image;if(null==t)return o.src=this.canvas.toDataURL(),o;var i=document.createElement("canvas");return i.width=n,i.height=r,i.getContext("2d").drawImage(this.canvas,t,e,n,r,0,0,n,r),o.src=i.toDataURL(),o},MetaCanvas.prototype.setCursor=function(t="default"){this.canvas.style.cursor=t},MetaCanvas.prototype.getFrame=function(){return new Rec(0,0,this.W,this.H)},MetaCanvas.prototype._linesInFrame=function(t,e,n){var r,o=Math.min(e.length,n.length);for(this.context.beginPath(),this.context.moveTo(t.projectX(e[0]),t.projectY(n[0])),r=1;r<o;r++)this.context.lineTo(t.projectX(e[r]),t.projectY(n[r]))},MetaCanvas.prototype.sLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.stroke()},MetaCanvas.prototype.fLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.fill()},MetaCanvas.prototype.fsLinesInFrame=function(t,e,n){this._linesInFrame(t,e,n),this.context.fill(),this.context.stroke()},MetaCanvas.prototype.drawSmoothPolygon=function(t,e,n){var r,o;if(n=null==n?30:n,t.length<2)return null;if(this.context.beginPath(),2==t.length){var i=Math.atan2(t[1].y-t[0].y,t[1].x-t[0].x)-.5*Math.PI,s=n*Math.cos(i),a=n*Math.sin(i);return this.context.moveTo(t[0].x,t[0].y),this.context.bezierCurveTo(t[0].x+s,t[0].y+a,t[1].x+s,t[1].y+a,t[1].x,t[1].y),this.context.bezierCurveTo(t[1].x-s,t[1].y-a,t[0].x-s,t[0].y-a,t[0].x,t[0].y),void this.context.stroke()}var l,u=t.length,h=t[u-1],c=t[0],f=t[1],p=(r=getSoftenControlPoints(h,c,f,n))[1];this.context.moveTo(c.x,c.y),h=c;var g=u+Number(e);for(o=1;o<g;o++)c=t[o%u],f=t[(o+1)%u],l=(r=getSoftenControlPoints(h,c,f,n))[0],this.context.bezierCurveTo(p.x,p.y,l.x,l.y,c.x,c.y),p=r[1],h=c;this.context.stroke()},MetaCanvas.prototype.drawEllipse=function(t,e,n,r){var o=.5522848,i=n*o,s=r*o,a=t+n,l=e+r;this.context.moveTo(t-n,e),this.context.bezierCurveTo(t-n,e-s,t-i,e-r,t,e-r),this.context.bezierCurveTo(t+i,e-r,a,e-s,a,e),this.context.bezierCurveTo(a,e+s,t+i,l,t,l),this.context.bezierCurveTo(t-i,l,t-n,e+s,t-n,e),this.context.moveTo(t-n,e)},MetaCanvas.prototype.drawPolygon=function(t,e,n,r){var o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+t[0].x,r+t[0].y),o=1;null!=t[o];o++)this.context.lineTo(n+t[o].x,r+t[o].y);e&&this.context.lineTo(n+t[0].x,r+t[0].y),this.context.stroke()},MetaCanvas.prototype.drawPolygonWithControlPoints=function(t,e,n,r){var o;for(n=n||0,r=r||0,this.context.beginPath(),this.context.moveTo(n+t[0].x,r+t[0].y),o=1;null!=t[o];o++)this.context.bezierCurveTo(n+e[2*(o-1)].x,r+e[2*(o-1)].y,n+e[2*o-1].x,r+e[2*o-1].y,n+t[o].x,r+t[o].y);this.context.stroke()},MetaCanvas.prototype.drawBezierPolygon=function(t,e,n){var r;e=e||0,n=n||0;var o,i=Math.floor((t.length-1)/3);for(this.context.moveTo(e+t[0].x,n+t[0].y),o=0;o<i;o++)r=3*o+1,this.context.bezierCurveTo(e+t[r].x,n+t[r].y,e+t[r+1].x,n+t[r+1].y,e+t[r+2].x,n+t[r+2].y)},MetaCanvas.prototype.drawMultiStyleCurve=function(t,e,n,r,o,i,s){var a,l,u,h,c;this.context.save(),this.context.lineJoin=this.context.lineCap="round";var f=new I(r,s),p=new I(n,i);for(a=0;a<t.length-1;a++)l=a/(t.length-2),h=f.getInterpolatedValue(l),c=p.getInterpolatedValue(l),u=interpolateColors(e,o,l),u=addAlpha(u,c),this.context.beginPath(),this.context.moveTo(t[a].x,t[a].y),this.context.lineTo(t[a+1].x,t[a+1].y),this.stroke(u,h),this.context.stroke();this.context.restore()},MetaCanvas.prototype.drawRoundRect=function(t,e,n,r,o){o=o||0;var i=e+r;this.context.moveTo(t+o,e),this.context.lineTo(t+n-o,e),this.context.quadraticCurveTo(t+n,e,t+n,e+o),this.context.lineTo(t+n,e+r-o),this.context.quadraticCurveTo(t+n,i,t+n-o,i),this.context.lineTo(t+o,i),this.context.quadraticCurveTo(t,i,t,i-o),this.context.lineTo(t,e+o),this.context.quadraticCurveTo(t,e,t+o,e)},MetaCanvas.prototype.drawTriangleFromBase=function(t,e,n,r,o){this.context.moveTo(t+.5*n*Math.cos(o+.5*Math.PI),e+.5*n*Math.sin(o+.5*Math.PI)),this.context.lineTo(t+.5*n*Math.cos(o-.5*Math.PI),e+.5*n*Math.sin(o-.5*Math.PI)),this.context.lineTo(t+r*Math.cos(o),e+r*Math.sin(o)),this.context.lineTo(t+.5*n*Math.cos(o+.5*Math.PI),e+.5*n*Math.sin(o+.5*Math.PI))},MetaCanvas.prototype.applyTransformationFunctions=function(t,e,n){if(null==this._fRect&&(this._line=this.line,this._sLines=function(){this.__lines(arguments),this.context.stroke()},this._fCircle=this.fCircle,this._sCircle=this.sCircle,this._fCircleM=this.fCircleM,this._sCircleM=this.sCircleM,this._fRect=this.fRect,this._sRect=this.sRect,this._fRectM=this.fRectM,this._sRectM=this.sRectM,this.__lines=this._lines,this.__polygon=this._polygon,this._fText=this.fText,this._fTextM=this.fTextM,this._sText=this.sText,this._fsText=this.fsText,this._fsTextM=this.fsTextM,this._clipRect=this.clipRect,this._drawImage=this.drawImage),null==t&&null==e)return this.line=this._line,this.sLines=this._sLines,this.fCircle=this._fCircle,this.sCircle=this._sCircle,this.fCircleM=this._fCircleM,this.sCircleM=this._sCircleM,this.fRect=this._fRect,this.sRect=this._sRect,this.fRectM=this._fRectM,this.sRectM=this._sRectM,this._lines=this.__lines,this._polygon=this.__polygon,this.fText=this._fText,this.fTextM=this._fTextM,this.sText=this._sText,this.fsText=this._fsText,this.fsTextM=this._fsTextM,this.clipRect=this._clipRect,void(this.drawImage=this._drawImage);this.fX=t,this.fY=e,this.sX=function(t){return this.fX(t+.5)-this.fX(t-.5)},this.sY=function(t){return this.fY(t+.5)-this.fY(t-.5)},null==t&&(this.fX=function(t){return t}),null==e&&(this.fY=function(t){return t}),this.line=function(t,e,n,r){this._line(this.fX(t),this.fY(e),this.fX(n),this.fY(r))},this.fRect=function(t,e,n,r){this._fRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.sRect=function(t,e,n,r){this._sRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.fRectM=function(t,e,n,r){return this._fRectM(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.sRectM=function(t,e,n,r){return this._sRectM(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.fCircle=function(t,e,n){this._fCircle(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.sCircle=function(t,e,n){this._sCircle(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.fCircleM=function(t,e,n){return this._fCircleM(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this.sCircleM=function(t,e,n){return this._sCircleM(this.fX(t),this.fY(e),Math.abs(this.fX(t+n)-this.fX(t)))},this._lines=function(){if(null!=arguments){var t=arguments[0];this.context.beginPath(),this.context.moveTo(this.fX(t[0]),this.fY(t[1]));for(var e=2;null!=t[e+1];e+=2)this.context.lineTo(this.fX(t[e]),this.fY(t[e+1]))}},this._polygon=function(t){this.context.beginPath(),this.context.moveTo(this.fX(t[0].x),this.fY(t[0].y));for(var e=1;null!=t[e];e++)this.context.lineTo(this.fX(t[e].x),this.fY(t[e].y))},this.fText=function(t,e,n){this._fText(t,this.fX(e),this.fY(n))},this.fTextM=function(t,e,n){this._fTextM(t,this.fX(e),this.fY(n))},this.sText=function(t,e,n){this._sText(t,this.fX(e),this.fY(n))},this.fsText=function(t,e,n){this._fsText(t,this.fX(e),this.fY(n))},this.fsTextM=function(t,e,n){this._fsTextM(t,this.fX(e),this.fY(n))},this.clipRect=function(t,e,n,r){this._clipRect(this.fX(t),this.fY(e),this.fX(t+n)-this.fX(t),this.fY(e+r)-this.fY(e))},this.drawImage=function(t,e,n,r,o){null==r&&this._drawImage(t,this.fX(e),this.fY(n)),this._drawImage(t,this.fX(e),this.fY(n),this.fX(e+r)-this.fX(e),this.fY(n+o)-this.fY(n))},this._fLines=function(){this.__lines(arguments),this.context.fill()}},MetaCanvas.prototype.resetTransformation=function(){this.applyTransformationFunctions(null,null)},MetaCanvas.prototype.mapRegion=function(t,e){this.applyTransformationFunctions((function(n){return(n-e.x)*t.width/e.width+t.x}),(function(n){return(n-e.y)*t.height/e.height+t.y})),this.invfX=function(n){return(n-t.x)*e.width/t.width+e.x},this.invfY=function(n){return(n-t.y)*e.height/t.height+e.y}},MetaCanvas.prototype.mapCanvas=function(t){this.applyTransformationFunctions((function(e){return(e-t.x)*this.W/t.width}),(function(e){return(e-t.y)*this.H/t.height})),this.invfX=function(e){return e*t.width/this.W+t.x},this.invfY=function(e){return e*t.height/this.H+t.y}},Forces.prototype.forcesForNetwork=function(t,e,n,r,o){var i,s;e=e||0,n=n||new P(0,0),r=null==r?0:r,o=null!=o&&o,this.forcesList=new L,this.equilibriumDistances=new nL,this.forcesTypeList=new L,this.from=new ndL,this.to=new ndL,this.nodes=new ndL;var a,l,u=t.nodes.length,h=t.relations;if(this.previousNetwork){e=0;for(var c=1e5,f=-1e5,p=1e5,g=-1e5,d=0;d<this.previousNetwork.nodes.length;d++)c=Math.min(c,this.previousNetwork.nodes[d].x),f=Math.max(f,this.previousNetwork.nodes[d].x),p=Math.min(p,this.previousNetwork.nodes[d].y),g=Math.max(g,this.previousNetwork.nodes[d].y);var m=f-c,y=g-p;for(d=0;d<u;d++){var v=t.nodes[d];if(i=this.previousNetwork.nodes.get(v.id))v.x=i.x,v.y=i.y;else{for(a=0;a<v.nodes.length;a++)if(i=this.previousNetwork.nodes.get(v.nodes[a].id)){v.x=i.x+.05*m*(Math.random()-.5),v.y=i.y+.05*y*(Math.random()-.5);break}null==i&&(v.x=c+m*Math.random(),v.y=p+y*Math.random())}}}for(t.nodes.forEach(((t,e)=>{null==t.x&&(t.x||(t.x=100*(Math.random()-.5),t.y=100*(Math.random()-.5)),t.vx=0,t.vy=0,t.ax=0,t.ay=0)})),d=0;d<u;d++)0===e?this.addNode(t.nodes[d],new P(t.nodes[d].x,t.nodes[d].y)):(l=Math.random()*TwoPi,this.addNode(t.nodes[d],new P(n.x+e*Math.cos(l),n.y+e*Math.sin(l))));for(d=0;d<u-1;d++)for(i=t.nodes[d],a=d+1;a<u;a++)if(s=t.nodes[a],h.nodesAreConnected(i,s)){switch(r){case 0:this.equilibriumDistances.push(this.dEqSprings);break;case 1:this.equilibriumDistances.push((1.1-h.getFirstRelationByIds(i.id,s.id,!1).weight)*this.dEqSprings);break;case 2:this.equilibriumDistances.push(Math.sqrt(Math.min(i.nodes.length,s.nodes.length))*this.dEqSprings*.1)}this.addForce(i,s,"Spring"),o&&this.addForce(i,s,"Repulsor",.5*this.dEqRepulsors)}else this.addForce(i,s,"Repulsor",this.dEqRepulsors);this.previousNetwork=t},Forces.prototype.addNode=function(t,e,n){e=null==e?new P(200*Math.random()-100,200*Math.random()-100):e,n=null==n?new P(0,0):n,this.nodes.addNode(t),t.x=e.x,t.y=e.y,t.vx=n.x,t.vy=n.y,t.ax=0,t.ay=0,t.r=1},Forces.prototype.addForce=function(t,e,n,r){this.from.addNode(t),this.to.addNode(e),this.forcesList.push(t.id+"*"+e.id+"*"+n),this.forcesTypeList.push(n),null!=r&&this.equilibriumDistances.push(r)},Forces.prototype.calculate=function(){var t,e,n,r,o,i,s,a,l;for(t=0;null!=this.forcesList[t];t++)if(e=this.from[t],n=this.to[t],r=this.forcesTypeList[t],i=n.x-e.x,s=n.y-e.y,a=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),l=this.equilibriumDistances[t],!("Repulsor"==r&&a>l||"Attractor"==r&&a<l))switch(r){case"Spring":case"Repulsor":case"Attractor":o=this.k*(a-l)/a,e.ax+=o*i,e.ay+=o*s,n.ax-=o*i,n.ay-=o*s;break;case"DirectedSpring":o=this.k*(a-l)/a,n.ax-=o*i,n.ay-=o*s;break;case"DirectedRepulsor":a<l&&(o=this.k*(a-l)/a,n.ax-=o*i,n.ay-=o*s)}},Forces.prototype.applyForces=function(){for(var t,e=0;e<this.nodes.length;e++)(t=this.nodes[e]).fixed_x?(t.x=.95*t.x+.05*t.fixed_x,t.y=.95*t.y+.05*t.fixed_y):(t.vx+=t.ax,t.vy+=t.ay,t.vx*=this.friction,t.vy*=this.friction,t.x+=t.vx,t.y+=t.vy,t.ax=0,t.ay=0)},Forces.prototype.calculateAndApplyForces=function(t){this.calculate(),this.applyForces()},Forces.prototype.iterate=function(t){for(var e=0;e<t;e++)this.calculate(),this.applyForces()},Forces.prototype.attractionToPoint=function(t,e,n){var r,o,i,s,a;e=null==e?1:e;for(var l=0;null!=this.nodes[l];l++)r=this.nodes[l],i=t.x-r.x,s=t.y-r.y,a=Math.pow(i,2)+Math.pow(s,2),o=null!=n?Math.min(e/a,n):e/a,r.ax+=o*i,r.ay+=o*s},Forces.prototype.avoidOverlapping=function(t=0){var e,n,r,o,i,s,a,l,u,h,c,f,p,g=.5*t,d=this.nodes.length;for(e=0;null!=this.nodes[e+1];e++){o=(n=this.nodes[(e+this._i0)%d]).x-.5*n.width-g,s=n.x+.5*n.width+g,i=n.y-.5*n.height-g,a=n.y+.5*n.height+g;for(var m=e+1;null!=this.nodes[m];m++)l=(r=this.nodes[(m+this._i0+e)%d]).x-.5*r.width-g,h=r.x+.5*r.width+g,u=r.y-.5*r.height-g,c=r.y+.5*r.height+g,(o>l&&o<h||s>l&&s<h)&&(i>u&&i<c||a>u&&a<c)&&(f=r.x-n.x,p=r.y-n.y,Math.abs(f)>Math.abs(p)?f>0?(n.x-=.5*(s-l),r.x+=.5*(s-l)):(n.x+=.5*(h-o),r.x-=.5*(h-o)):p>0?(n.y-=.5*(a-u),r.y+=.5*(a-u)):(n.y+=.5*(c-i),r.y-=.5*(c-i)))}this._i0++},Forces.prototype.avoidOverlappingRadial=function(t,e){var n,r,o;t=t||0,e=e||1;var i,s,a,l,u,h=this.nodes.length,c=2*t;for(n=0;null!=this.nodes[n+1];n++){r=this.nodes[(n+this._i0)%h];for(var f=n+1;null!=this.nodes[f];f++)i=(o=this.nodes[(f+this._i0+n)%h]).x-r.x,s=o.y-r.y,(a=Math.pow(i,2)+Math.pow(s,2))<(l=Math.pow(r.r+o.r+c,2))&&(u=.5*((l=Math.sqrt(l))-(a=Math.sqrt(a)))/a,r.x-=e*u*i,r.y-=e*u*s,o.x+=e*u*i,o.y+=e*u*s)}this._i0++},Forces.prototype.deactivateForcesFromNode=function(t){t.vx=t.vy=t.ax=t.ay=0},Forces.prototype._resetAccelerations=function(){for(var t,e=0;null!=this.nodes[e];e++)(t=this.nodes[e]).ax=0,t.ay=0},Engine3D.prototype.setBasis=function(t){this._basis=t.clone(),this._basisBase=t.clone(),this._provisionalBase=t.clone()},Engine3D.prototype.setAngles=function(t){this._angles=t.clone(),this._freeRotation=!1,this._basis=this.basis3DRotation(this._basisBase,this._angles)},Engine3D.prototype.applyRotation=function(t){this._freeRotation||(this._freeRotation=!0,this.updateAngles(),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()),this._basis[0]=this.point3DRotation(this._provisionalBase[0],new P3D(-t.y,t.x,0)),this._basis[1]=this.point3DRotation(this._provisionalBase[1],new P3D(-t.y,t.x,0)),this._basis[2]=this.point3DRotation(this._provisionalBase[2],new P3D(-t.y,t.x,0)),this._provisionalBase[0]=this._basis[0].clone(),this._provisionalBase[1]=this._basis[1].clone(),this._provisionalBase[2]=this._basis[2].clone()},Engine3D.prototype.projectPoint3D=function(t){var e=this.lens/(this.lens+(this._basis[0].z*t.x+this._basis[1].z*t.y+this._basis[2].z*t.z));return new P3D((this._basis[0].x*t.x+this._basis[1].x*t.y+this._basis[2].x*t.z)*e,(this._basis[0].y*t.x+this._basis[1].y*t.y+this._basis[2].y*t.z)*e,e)},Engine3D.prototype.projectCoordinates=function(t,e,n){var r=this.lens/(this.lens+(this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n));return new P3D((this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n)*r,(this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n)*r,r)},Engine3D.prototype.scale=function(t){return this.lens/(this.lens+(this._basis[0].z*t.x+this._basis[1].z*t.y+this._basis[2].z*t.z))},Engine3D.prototype.sortedIndexesByPointsScale=function(t){var e,n=[];for(e=0;null!=t[e];e++)n[e]=[t[e],e];n=n.sort(this._sortingCriteria.bind(this));var r=new nL;for(e=0;null!=t[e];e++)r[e]=n[e][1];return r},Engine3D.prototype.sortListByPointsScale=function(t,e){var n,r=[];for(n=0;null!=t[n];n++)r[n]=[e[n],t[n]];r=r.sort(this._sortingCriteria.bind(this));var o=instanceSameType(t);for(o.name=t,n=0;null!=t[n];n++)o[n]=r[n][1];return o},Engine3D.prototype._sortingCriteria=function(t,e){var n=t[0],r=e[0];return this._basis[0].z*n.x+this._basis[1].z*n.y+this._basis[2].z*n.z<this._basis[0].z*r.x+this._basis[1].z*r.y+this._basis[2].z*r.z?1:-1},Engine3D.prototype.updateAngles=function(){this._angles=this.getEulerAngles()},Engine3D.prototype.getEulerAngles=function(){return new P3D(Math.atan2(-this._basis[1].z,this._basis[2].z),Math.asin(this._basis[0].z),Math.atan2(-this._basis[0].y,this._basis[0].x))},Engine3D.prototype.basis3DRotation=function(t,e){var n=Math.cos(e.x),r=Math.sin(e.x),o=Math.cos(e.y),i=Math.sin(e.y),s=Math.cos(e.z),a=Math.sin(e.z);return new Pol3D(new P3D(t[0].x*s*o+t[0].y*(s*r*i+a*n)+t[0].z*(a*r-s*n*i),-t[0].x*a*o+t[0].y*(s*n-a*r*i)+t[0].z*(a*n*i+s*r),t[0].x*i-t[0].y*r*o+t[0].z*o*n),new P3D(t[1].x*s*o+t[1].y*(s*r*i+a*n)+t[1].z*(a*r-s*n*i),-t[1].x*a*o+t[1].y*(s*n-a*r*i)+t[1].z*(a*n*i+s*r),t[1].x*i-t[1].y*r*o+t[1].z*o*n),new P3D(t[2].x*s*o+t[2].y*(s*r*i+a*n)+t[2].z*(a*r-s*n*i),-t[2].x*a*o+t[2].y*(s*n-a*r*i)+t[2].z*(a*n*i+s*r),t[2].x*i-t[2].y*r*o+t[2].z*o*n))},Engine3D.prototype.point3DRotation=function(t,e){var n=Math.cos(e.x),r=Math.sin(e.x),o=Math.cos(e.y),i=Math.sin(e.y),s=Math.cos(e.z),a=Math.sin(e.z);return new P3D(t.x*s*o+t.y*(s*r*i+a*n)+t.z*(a*r-s*n*i),-t.x*a*o+t.y*(s*n-a*r*i)+t.z*(a*n*i+s*r),t.x*i-t.y*r*o+t.z*o*n)},Engine3D.prototype.line3DCoordinates=function(t,e,n,r,o,i){var s=new Pol,a=this.lens/(this.lens+(this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n)),l=this.lens/(this.lens+(this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i));if(a>0||l>0){if(a>0&&l>0)return s.push(new P((this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n+this._dx)*a,(this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n)*a)),s.push(new P((this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i+this._dx)*l,(this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i)*l)),s;var u=new P3D(this._basis[0].x*t+this._basis[1].x*e+this._basis[2].x*n,this._basis[0].y*t+this._basis[1].y*e+this._basis[2].y*n,this._basis[0].z*t+this._basis[1].z*e+this._basis[2].z*n),h=new P3D(this._basis[0].x*r+this._basis[1].x*o+this._basis[2].x*i,this._basis[0].y*r+this._basis[1].y*o+this._basis[2].y*i,this._basis[0].z*r+this._basis[1].z*o+this._basis[2].z*i),c=(-this.lens+this._cuttingPlane-u.z)/(h.z-u.z),f=new P3D(u.x+c*(h.x-u.x),u.y+c*(h.y-u.y),-this.lens+this._cuttingPlane),p=this.lens/(this.lens+f.z);return a>0?(s.push(new P((u.x+this._dx)*a,u.y*a)),s.push(new P((f.x+this._dx)*p,f.y*p))):(s.push(new P((f.x+this._dx)*p,f.y*p)),s.push(new P((h.x+this._dx)*l,h.y*l))),s}return null},Engine3D.prototype.line3D=function(t,e){return this.line3DCoordinates(t.x,t.y,t.z,e.x,e.y,e.z)},Engine3D.prototype.quadrilater=function(t,e,n,r){var o=new Pol3D,i=this.line3D(t,e),s=this.line3D(e,n),a=this.line3D(n,r),l=this.line3D(r,t);return null!=i&&((null==l||i[0].x!=l[1].x&&i[0].y!=l[1].y)&&o.push(i[0]),o.push(i[1])),null!=s&&((null==i||s[0].x!=i[1].x&&s[0].y!=i[1].y)&&o.push(s[0]),o.push(s[1])),null!=a&&((null==s||a[0].x!=s[1].x&&a[0].y!=s[1].y)&&o.push(a[0]),o.push(a[1])),null!=l&&((null==a||l[0].x!=a[1].x&&l[0].y!=a[1].y)&&o.push(l[0]),o.push(l[1])),o};var interpolateColors=function(t,e,n,r){var o=interpolateColorsRGB(colorStringToRGB(t),colorStringToRGB(e),n,r);return"rgb("+Math.floor(o[0])+","+Math.floor(o[1])+","+Math.floor(o[2])+")"},interpolateColorsRGB=function(t,e,n,r){var o=1-n;return r?[Math.floor(Math.sqrt(o*t[0]*t[0]+n*e[0]*e[0])),Math.floor(Math.sqrt(o*t[1]*t[1]+n*e[1]*e[1])),Math.floor(Math.sqrt(o*t[2]*t[2]+n*e[2]*e[2]))]:[Math.floor(o*t[0]+n*e[0]),Math.floor(o*t[1]+n*e[1]),Math.floor(o*t[2]+n*e[2])]},distanceColorsRGB=function(t,e){var n=Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2]);return Number((n/765).toFixed(4))},addAlpha=function(t,e){e=null==e?1:e;var n=colorStringToRGB(t);return null==n?"black":"rgba("+n[0]+","+n[1]+","+n[2]+","+e+")"},invertColor=function(t){var e=colorStringToRGB(t);return e=invertColorRGB(e[0],e[1],e[2]),RGBtoHEX(e[0],e[1],e[2])},stringToColor=function(t){if(null!=t){if("null"==t||"undefined"==t)return"#202020";for(var e=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f","#d62720","#1f77b0","#2ca02a","#ff7f08","#9467ba","#bcbd20","#8c564f","#17bece","#dd4418","#206011","#e377c9","#3330fe","#dd8818","#ff220a","#1f66a9","#8c453f","#2ba01f","#dfc508","#945608","#ff008f","#e37708"],n=0,r=0;r<t.length;r++)n+=t.charCodeAt(r)*(r*r+1);return e[Math.floor(getRandomWithSeed(n)*e.length)]}},HEXtoRGB=function(t){return[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]},RGBtoHEX=function(t,e,n){return"#"+toHex(Math.floor(t))+toHex(Math.floor(e))+toHex(Math.floor(n))},RGBArrayToString=function(t){return"rgb("+t[0]+","+t[1]+","+t[2]+")"},colorStringToHEX=function(t){var e=colorStringToRGB(t);return RGBtoHEX(e[0],e[1],e[2])},numberToHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},uinttoRGB=function(t){return new Array(t>>16,(t>>8)-(t>>16<<8),t-(t>>8<<8))},uinttoHEX=function(t){var e=uinttoRGB(t);return RGBToHEX(e[0],e[1],e[2])},RGBtouint=function(t,e,n){return Number(t)<<16|Number(e)<<8|Number(n)},HEXtouint=function(t){var e=HEXtoRGB(t);return RGBtouint(e[0],e[1],e[2])},grayByLevel=function(t){return"rgb("+(t=Math.floor(255*t))+","+t+","+t+")"},HEXtoHSV=function(t){var e=HEXtoRGB(t);return RGBtoHSV(e[0],e[1],e[2])},HSVtoHEX=function(t,e,n){var r=HSVtoRGB(t,e,n);return RGBtoHEX(r[0],r[1],r[2])},HSLtoHEX=function(t,e,n){var r=HSLtoRGB(t,e,n);return RGBtoHEX(r[0],r[1],r[2])},RGBtoHSV=function(t,e,n){var r,o,i,s=Math.min(Math.min(t,e),n),a=Math.max(Math.max(t,e),n);i=a/255;var l=a-s;return 0===l?new Array(0,0,t/255):0===a?(o=0,r=-1,new Array(r,o,i)):(o=l/a,r=t==a?(e-n)/l:e==a?2+(n-t)/l:4+(t-e)/l,(r*=60)<0&&(r+=360),new Array(r,o,i))},HSVtoRGB=function(t,e,n){var r,o,i,s,a,l,u,h;if(t=t||0,n=n||0,0===(e=e||0))return r=o=i=n,[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)];switch(l=n*(1-e),u=n*(1-e*(a=(t/=60)-(s=Math.floor(t)))),h=n*(1-e*(1-a)),s){case 0:r=n,o=h,i=l;break;case 1:r=u,o=n,i=l;break;case 2:r=l,o=n,i=h;break;case 3:r=l,o=u,i=n;break;case 4:r=h,o=l,i=n;break;default:r=n,o=l,i=u}return new Array(Math.floor(255*r),Math.floor(255*o),Math.floor(255*i))},HSLtoRGB=function(t,e,n){var r,o,i;function s(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(0===e)r=o=i=n;else{var a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=s(l,a,t/360+1/3),o=s(l,a,t/360),i=s(l,a,t/360-1/3)}return[Math.floor(255*r),Math.floor(255*o),Math.floor(255*i)]},invertColorRGB=function(t,e,n){return[255-t,255-e,255-n]},toHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},getRandomColor=function(){return"rgb("+String(Math.floor(256*Math.random()))+","+String(Math.floor(256*Math.random()))+","+String(Math.floor(256*Math.random()))+")"},colorStringToRGB=function(t,e){if(null!=t){e=null==e?1:e,"#"==(t=(t=(t=String(t)).replace(/ /g,"")).toLowerCase())[0]&&(t=t.substr(1,6));var n={beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",cyan:"00ffff",fuchsia:"ff00ff",gold:"ffd700",gray:"808080",grey:"808080",green:"008000",magenta:"ff00ff",navy:"000080",pink:"ffc0cb",salmon:"fa8072",silver:"c0c0c0",turquoise:"40e0d0",violet:"ee82ee",white:"ffffff",yellow:"ffff00"};null!=n[t]&&(t=n[t]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1])*e,parseInt(t[2])*e,parseInt(t[3])*e]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),[\.0123456789]+\)$/,process:function(t){return[parseInt(t[1])*e,parseInt(t[2])*e,parseInt(t[3])*e]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(t){return[parseInt(t[1],16)*e,parseInt(t[2],16)*e,parseInt(t[3],16)*e]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(t){return[parseInt(t[1]+t[1],16)*e,parseInt(t[2]+t[2],16)*e,parseInt(t[3]+t[3],16)*e]}}],o=0;o<r.length;o++){var i=r[o].re,s=r[o].process,a=i.exec(t);if(a)return s(a)}return null}},createSortedNumberList=function(t,e,n,r){if(null==t)return null;var o;Array.isArray(t)&&(t=t.length),t=Number(t),e=e||0,n=null==n?1:n;var i=new nL;for(o=0;o<t;o++)i.push(e+o*n);return null!=r&&(i.name=r),i},createNumberListWithinInterval=function(t,e,n,r){if(null==e&&(e=new I(0,1)),1==n)return createSortedNumberList(t,e.x,(e.y-e.x)/t);n=null==n?0:n;var o,i=null!=r?new _Alea("my",r,"seeds"):NumberOperators_random,s=new nL,a=e.getAmplitude(),l=Number(e.getMin());if(0===n)for(o=0;o<t;o++)s.push(l+Number(i()*a));return s},createRandomNormalDistribution=function(t,e,n){var r,o=new o;for(r=0;r<t;r++)o.push(normal(e,n));return o},createRandomBetaPERTDistribution=function(t,e,n,r,o,i){e=null==e?0:e,n=null==n?1:n,r=null==r?.5:r,o=null==o?1:o,i&&i(i);var s,a=new a;for(s=0;s<t;s++)a.push(betaPERT(e,n,r,o));return i&&randomSeedPop(),a},createRandomBimodalDistribution=function(t,e,n,r,o,i,s,a){e=null==e?0:e,n=null==n?1:n,r=null==r?.25:r,o=null==o?.75:o,i=null==i?1:i,s=null==s?.5:s,null!=a&&a(a);var l,u=new u;for(l=0;l<t;l++)random()>s?u.push(betaPERT(e,n,r,i)):u.push(betaPERT(e,n,o,i));return a&&randomSeedPop(),u},createRandomNumbers=function(t,e,n,r){n=null==n?-1:n,e=null==e?new I(0,1):e;for(var o=new nL,i=e.getAmplitude(),s=-1==n?NumberOperators_random:new _Alea("my",n,"seeds"),a=0;a<t;a++)o[a]=null==r?s()*i+e.x:r(s()*i+e.x);return o},createUniformTable=function(t,e,n,r){for(var o=new T,i=0;i<t;i++)o[i]=createListWithSameElement(e,n),r&&r[i]&&(o[i].name=r[i]);return o.downcast()},dotProduct=function(t,e){var n,r=0,o=Math.min(t.length,e.length);for(n=0;n<o;n++)r+=t[n]*e[n];return r},linearRegression=function(t,e,n){n=null==n||n>2?0:n;var r=new nL;if(null==t||null!=e&&t.length!=e.length||0===t.length)return 0===n?r:new P;null==e&&(e=t,t=createSortedNumberList(t.length,0,1));for(var o=0,i=0,s=0,a=0,l=0,u=t.length,h=0;h<u;h++)o+=t[h],i+=e[h],s+=t[h]*t[h],a+=t[h]*e[h],l+=e[h]*e[h];var c=u*s-o*o,f=0===c?0:(u*a-o*i)/c;if(2==n)return f;var p=i/u-f*o/u;if(1==n)return new P(f,p);var g=Math.pow((u*a-o*i)/Math.sqrt((u*s-o*o)*(u*l-i*i)),2);return r.push(f),r.push(p),r.push(g),r.push(u),r},distance=function(t,e,n){if(null!=t&&null!=e){var r,o=0,i=Math.min(t.length,e.length);if("cosine"==(n=(n=null==n?"euclidean":n).toLowerCase()))return 1-cosineSimilarity(t,e);if("manhattan"==n){for(r=0;r<i;r++)o+=Math.abs(t[r]-e[r]);return o}if("euclidean"!=n)throw new Error("Invalid distanceMetric.");for(r=0;r<i;r++)o+=Math.pow(t[r]-e[r],2);return Math.sqrt(o)}},cosineSimilarity=function(t,e,n,r){var o=(n=null==n?t.getNorm():n)*(r=null==r?e.getNorm():r);return 0===o?0:dotProduct(t,e)/o},covariance=function(t,e,n){if(null!=t&&null!=e){var r,o,i,s=Math.min(t.length,e.length),a=0;for(o=n&&t.infoObject?t.infoObject.average:t.getMean(),i=n&&e.infoObject?e.infoObject.average:e.getMean(),r=0;r<s;r++)a+=(t[r]-o)*(e[r]-i);return a/s}},standardDeviationTwoNumberLists=function(t,e){if(null!=t&&null!=e){var n,r=0,o=Math.min(t.length,e.length);for(n=0;n<o;n++)r+=Math.pow(t[n]-e[n],2);return r/o}},numericCorrelation=function(t,e,n,r,o){if(null!=t&&null!=e){null==n&&o&&t.infoObject&&(n=t.infoObject.standardDeviation),null==r&&o&&e.infoObject&&(r=e.infoObject.standardDeviation),null==n&&(n=t.getStandardDeviation()),null==r&&(r=e.getStandardDeviation());var i=n*r;return 0===i?0:covariance(t,e,o)/i}},slidingWindowCorrelation=function(t,e,n){if(null!=t&&null!=e&&t.length==e.length){var r,o,i,s,a;(null==n||isNaN(n)||n<1)&&(n=5),n=Math.round(n);var l=t.length,u=new nL;for(r=0;r<l;r++){for(i=new nL,s=new nL,o=Math.max(0,r-n);o<=r+n;o++)o<0||o>=l||(i.push(t[o]),s.push(e[o]));a=numericCorrelation(i,s),u.push(a)}return u}},normalizeToSum=function(t,e,n){if(null!=t){e=null==e?1:e;var r,o=new nL;if(o.name=t.name,0===t.length)return o;if(0===(n=null==n?t.getSum():n))return t.clone();for(e/=n,r=0;r<t.length;r++)o[r]=e*t[r];return o}},normalizeByZScore=function(t){if(null!=t){if(0===t.length)return null;var e,n=t.getMean(),r=t.getStandardDeviation();0===r&&(r=1);var o=new nL;for(e=0;e<t.length;e++)o.push((t[e]-n)/r);return o.name=t.name,o}},normalizeToMax=function(t,e){if(null!=t){if(e=null==e?1:e,0===t.length)return null;var n=t.getMax();if(0===n&&0===(n=t.getMin()))return createListWithSameElement(t.length,0);for(var r=new nL,o=0;null!=t[o];o++)r.push(e*(t[o]/n));return r.name=t.name,r}},normalizeToInterval=function(t,e){if(null!=t&&null!=e&&0!==t.length){var n,r=t.getInterval(),o=r.getAmplitude();if(0===o)return ListGenerators.createListWithSameElement(t.length,e.x,t.name);var i=e.getSignedAmplitude()/o,s=new nL;for(n=0;n<t.length;n++)s.push(e.x+i*(t[n]-r.x));return s.name=t.name,s}},trimNumberList=function(t,e,n){return t.trim(e,n)},getAccumulativeSum=function(t){if(null!=t&&0!==t.length){var e=new nL;e[0]=t[0];for(var n=1;n<t.length;n++)e[n]=t[n]+e[n-1];return e}},shorten=function(t,e){if(null==t)return null;if(null==e||e>=t.length)return t;var n,r,o,i,s=t.length/e,a=new nL,l=Math.floor(s);for(a.name=t.name,r=0;r<e;r++){for(i=Math.floor(r*s),n=0,o=0;o<l;o++)n+=t[i+o];a[r]=n/l}return a},simplify=function(t,e,n){if(null!=t){e=e||0,n=n||0;var r=new nL;if(r.name=t.name,0===e){var o=Math.pow(10,n);t.forEach((function(t){r.push(Math.floor(t/o)*o)}))}return r}},segmentNumberList=function(t,e,n){if(null==t||null==e)return null;var r=0==(n=null==n?0:n)?new t:new sL;r.name="segments "+t.name;for(var o=0;o<t.length;o++){for(var i=!1,s=0;s<e.length;s++)if(t[o]<e[s]){i=!0,r[o]=0==n?s:0==s?"<"+e[s]:e[s-1]+"-"+e[s];break}i||(r[o]=0==n?e.length:">="+e[e.length-1])}return r},averageSmoother=function(t,e,n){if(null!=t){n=null==n?1:n,e=null==e?.1:e,e=Math.max(Math.min(e,.5),0),e*=.6;var r,o,i,s,a,l,u=t.length,h=t.clone(),c=t.clone();for(r=0;r<n;r++)for(i=r%2?c:h,s=r%2?h:c,o=0;o<u;o++)l=0,a=0,o-1>=0&&(a++,l+=i[o-1]*e),o+1<u&&(a++,l+=i[o+1]*e),s[o]=l+i[o]*(1-a*e);return s}},closestValue=function(t,e,n,r){if(null!=t){n=null==n||n;for(var o,i=Math.abs(t[0]-e),s=0,a=1;a<t.length;a++)if((o=Math.abs(t[a]-e))<i){if(1==r&&t[a]>e||2==r&&t[a]<e||3==r&&t[a]>=e||4==r&&t[a]<=e)continue;i=o,s=a}return n?t[s]:s}},filterNumberListByInterval=function(t,e,n,r,o,i){return null},filterNumberListByNumber=function(t,e,n,r){r=r||!1;var o,i=new nL;if(r)switch(n){case"<":for(o=0;null!=t[o];o++)t[o]<e&&i.push(o);break;case"<=":for(o=0;null!=t[o];o++)t[o]<=e&&i.push(o);break;case">":for(o=0;null!=t[o];o++)t[o]>e&&i.push(o);break;case">=":for(o=0;null!=t[o];o++)t[o]>=e&&i.push(o);break;case"==":for(o=0;null!=t[o];o++)t[o]==e&&i.push(o);break;case"!=":for(o=0;null!=t[o];o++)t[o]!=e&&i.push(o)}else switch(n){case"<":for(o=0;null!=t[o];o++)t[o]<e&&i.push(t[o]);break;case"<=":for(o=0;null!=t[o];o++)t[o]<=e&&i.push(t[o]);break;case">":for(o=0;null!=t[o];o++)t[o]>e&&i.push(t[o]);break;case">=":for(o=0;null!=t[o];o++)t[o]>=e&&i.push(t[o]);break;case"==":for(o=0;null!=t[o];o++)t[o]==e&&i.push(t[o]);break;case"!=":for(o=0;null!=t[o];o++)t[o]!=e&&i.push(t[o])}return i},frameFromTwoNumberLists=function(t,e){if(null!=t&&null!=e){var n=t.getInterval(),r=e.getInterval();return new Rec(n.x,r.x,n.getAmplitude(),r.getAmplitude())}},rangeCounts=function(t,e,n,r){if(null!=t){e=null==e?10:e;var o=1==(r=r||0)?[]:createListWithSameElement(e,0);if(null==(n=null==n?t.getInterval():n))return o;for(var i,s=n.y-n.x,a=t.length,l=new nL,u=0;u<a;u++)i=Math.min(Math.floor(e*(t[u]-n.x)/s),e-1),l[u]=i,0===r&&o[i]++;return 1==r?l:o}},simpleCompression=function(t,e){if(null==t)return null;var n;e=null==e||e;var r=new nL;if(r.name=t.name,0===t.length)return r;if(r[0]=t[0],e)for(n=1;n<t.length;n++)r[n]=t[n]-t[n-1]-1;else for(n=1;n<t.length;n++)r[n]=r[n-1]+t[n]+1;return r},regression=function(t,e,n,r){if(null==t||0==t.length)return null;if(null==e&&(e=createSortedNumberList(t.length,1)),"string"!=typeof(n=null==n?"linear":n)||"linear"!=n&&"exponential"!=n&&"logarithmic"!=n&&"power"!=n&&"polynomial"!=n)throw new Error("Invalid method in NumberListOperators.regression: "+n);r=null==r?2:r;for(var o=[],i=0;i<e.length;i++)o.push([e[i],null==t[i]?null:t[i]]);var s=_Regression(n,o,r,{precision:3}),a=new nL;for(a.name=n+" Regression Series",i=0;i<s.points.length;i++)a.push(s.points[i][1]);var l=nL.toL(s.equation);return l.name="Coefficients",[{type:"nL",name:"Y Results",description:"Y Results are the forecasted values",value:a},{type:"nL",name:"Coefficients",description:"Coefficients of the regression equation",value:l},{type:"String",name:"Equation",description:"Equation in string form",value:s.string},{type:"Number",name:"R^2",description:"R^2 value",value:s.r2},{type:"Function",name:"fnModel",description:"Function that takes input and calculates output based on model",value:s.func}]},getDecimalsInterval=function(t){if(null==t)return null;var e,n,r=new I(0,0);for(e=0;e<t.length;e++)n=decimalPlaces(t[e]),r.adjustToContain(n);return r},setDecimals=function(t,e){if(null==t)return null;var n,r;if(t.isTable){var o=instanceSameType(t);for(o.name=t.name,n=0;n<t.length;n++)"nL"==t[n].type?o.push(setDecimals(t[n],e)):o.push(t[n].clone());return o}var i=new nL;for(i.name=t.name,n=0;n<t.length;n++)r=null==t[n]?null:Number(t[n].toFixed(e)),i.push(r);return i},getDistributionHeights=function(t,e,n){if(null==t)return null;var r,o,i;e=null==e||1!=e?0:e;var s=rangeCounts(t,n=null==n?50:n,null,0),a=rangeCounts(t,n,null,1),l=new t;for(randomSeed(1),r=0;r<t.length;r++)i=s[a[r]],0==e?(o=i-1,s[a[r]]--):o=random()*i,l.push(o);return randomSeedPop(),l},kNearestNeighbours=function(t,e,n,r,o,i,s){if(null!=t&&null!=e&&0!=t.length){n=null==n?1:n,r=null==r?0:r,s=null!=s&&s;var a,l="number"==typeof e;if((o=null!=o&&o)||(t=t.transpose()),l){if(e<0||e>=t.length||Math.floor(e)!=e)throw new Error("Invalid value for second inlet.");e=t[a=e]}if(e.length!=t[0].length)throw new Error("The input nl must have the same number of values as columns of the numberTable.");var u=new t;u.push(new e),u.push(new e),u.assignNames("index,distance");for(var h=0;h<t.length;h++)l&&h==a||(u[0].push(h),u[1].push(distance(t[h],e,i)));return u=(u=u.sortRowsByList(1,!s,!0)).sliceRows(0,n-1),0==r?t.getColumns(u[0]):1==r?u[0]:u}},skewness=function(t,e){if(null!=t){var n=t.getMean();if((e=null==e?0:e)>=2)return Math.log2(n/t.getMedian());var r=t.getStandardDeviation();if(0==r)return 0;switch(e){case 0:for(var o=0,i=0;i<t.length;i++)o+=Math.pow(t[i]-n,3);return o/t.length/Math.pow(r,3);case 1:if(0==r)return 0;for(o=0,i=0;i<t.length;i++)o+=Math.pow(t[i]-n,3);var s=o/t.length/Math.pow(r,3),a=t.length;return a*a/((a-1)*(a-2))*s}}},TableToObject=function(t,e){if(t){e||(e=t.getNames());for(var n=[],r=0;r<t[0].length;r++){for(var o={},i=0;i<e.length;i++)o[e[i]]=t[i][r];n.push(o)}return{array:n}}},ArrayOfArraysToTable=function(t){if(null!==t&&isArray(t)){var e,n=t.length,r=new T;for(e=0;e<n;e++)isArray(t[e])&&r.push(L.toL(t[e]).downcast());return r.downcast()}},tableToHtml=function(t,e,n,r,o,i,s,a,l,u){if(null!=t){if(0==t.length)return"";if(!t.isTable&&(t.isList||Array.isArray(t))){var h=new T;h.push(t),t=h}n=null==n?"font-family: arial, sans-serif; border-collapse: collapse; width: 100%;":n,r=null==r?"border:1px solid rgba(200,200,200,.5); text-align: left; padding: 4px;":r,o=null==o?"background-color: #ffffff;":o,i=null==i?"background-color: #f0f0f0;":"same"==i?o:i,e=null==e?t[0].length:Math.min(e,t[0].length),a=null==a||a,u=null==u?"rgba(100,160,255,.5)":u;var c,f,p,g="string"==typeof r?'<td style="'+r+'">':"",d='<tr style="'+o+'">',m='<tr style="'+i+'">',y="";l&&(c=function(t,e,n){0==e&&(e=1);var r='<div style="background-color: #eee; width:100%; border-style: solid; border-width: 1px; border-color:#aaa; display: inline-block;">';return r+='<div style="background-color:'+n+"; width:"+Math.max(0,Math.round(100*t/e))+'%; height: 100%; font-size:14px; color:black;">',r+="&nbsp;"+t+"</div></div>"},buildInformationObjectForTable(t)),y+='<table style="'+n+'">';var v=!1;for(f=0;f<t.length;f++)if(""!=t[f].name&&null!=t[f].name){v=!0;break}if(v){for(y+=d,f=0;f<t.length;f++)r.isList&&(g='<td style="'+r[f]+'">'),y+=g+"<b>"+(""==t[f].name?"Column "+(f+1):t[f].name)+"</b></td>";y+="</tr>"}for(p=0;p<e;p++){for(y+=p%2==1?d:m,f=0;f<t.length;f++){if(s&&null!=s[f]&&null!=s[f][p]&&""!=s[f][p]?y+='<td style="'+s[f][p]+'">':(r.isList&&(g='<td style="'+r[f]+'">'),y+=g),a){var L=null==t[f][p]?"":String(t[f][p]).toLowerCase();if(0==L.indexOf("http")&&(-1!=L.indexOf(".jpg")||-1!=L.indexOf(".jpeg")||-1!=L.indexOf(".png")||-1!=L.indexOf("photo")||-1!=L.indexOf("image"))){y+='<img src="'+t[f][p]+'" width=200>';continue}}"nL"==t[f].type&&("all"==l||l&&-1!=l.indexOf(f))?u&&"cL"==u.type&&u.length==t[0].length?y+=c(t[f][p],t[f].infoObject.max,u[p]):y+=c(t[f][p],t[f].infoObject.max,u):y+=t[f][p],y+="</td>"}y+="</tr>"}return y+="</table>"}},tableToList=function(t){if(null!=t){for(var e=new L,n=0;n<t.length;n++)e=e.concat(t[n]);return e.downcast()}},createColorScaleFromColors=function(t,e){if(null==t)return null;if(1==t.length)(function(e){return t[0]});else if(2==t.length){return t.rgbs=t.getRgbArrays(),function(e){var n=1-e;return"rgb("+Math.floor(n*t.rgbs[0][0]+e*t.rgbs[1][0])+","+Math.floor(n*t.rgbs[0][1]+e*t.rgbs[1][1])+","+Math.floor(n*t.rgbs[0][2]+e*t.rgbs[1][2])+")"}}if(null==e){var n=1/(t.length-1);e=createSortedNumberList(t.length-2,n,n)}return null==t.rgbs&&(t.rgbs=t.getRgbArrays()),(e=e.slice()).unshift(0),e.push(1),function(n){var r,o,i;for(r=0;null!=e[r+1];r++)if(n<=e[r+1])return i=1-(o=(n-e[r])/(e[r+1]-e[r])),"rgb("+Math.floor(i*t.rgbs[r][0]+o*t.rgbs[r+1][0])+","+Math.floor(i*t.rgbs[r][1]+o*t.rgbs[r+1][1])+","+Math.floor(i*t.rgbs[r][2]+o*t.rgbs[r+1][2])+")"}},blackScale=function(){return"black"},grayscale=function(t){var e=interpolateColorsRGB([0,0,0],[255,255,255],t);return RGBtoHEX(e[0],e[1],e[2])},antiGrayscale=function(t){var e=interpolateColorsRGB([255,255,255],[0,0,0],t);return RGBtoHEX(e[0],e[1],e[2])},antiTemperature=function(t){return temperature(1-t)},temperature=function(t){return t<.2?interpolateColors("#000000",HSVtoHEX(234,1,1),5*t):t>.85?interpolateColors(HSVtoHEX(0,1,1),"#FFFFFF",(t-.85)/.15):HSVtoHEX(Math.round(360*(.65-(t-.2))),1,1)},lightTemperature=function(t){return temperature(.1+.9*t)},sqrtTemperature=function(t){return temperature(Math.sqrt(t))},sqrt4Temperature=function(t){return temperature(Math.pow(t,.25))},quadraticTemperature=function(t){return temperature(Math.pow(t,2))},cubicTemperature=function(t){return temperature(Math.pow(t,3))},greenToRed=function(t){var e=interpolateColorsRGB([50,255,50],[255,50,50],t);return RGBtoHEX(e[0],e[1],e[2])},greenToBlue=function(t){var e=interpolateColorsRGB([50,255,50],[50,50,255],t);return RGBtoHEX(e[0],e[1],e[2])},grayToOrange=function(t){return"rgb("+Math.floor(100+155*t)+","+Math.floor(100+10*t)+","+Math.floor(100-100*t)+")"},sqrt4GrayToOrange=function(t){return grayToOrange(Math.pow(t,.25))},blueToRed=function(t){return"rgb("+Math.floor(255*t)+",0,"+Math.floor(255*(1-t))+")"},whiteToRed=function(t){var e=Math.floor(255-255*t);return"rgb(255,"+e+","+e+")"},redToBlue=function(t){var e=interpolateColorsRGB([255,0,0],[0,0,255],t);return RGBtoHEX(e[0],e[1],e[2])},greenWhiteRed=function(t){var e=[0,0,0];return"rgb("+(e=t<.5?interpolateColorsRGB([50,255,50],[255,255,255],2*t):interpolateColorsRGB([255,255,255],[255,50,50],2*(t-.5)))[0]+","+e[1]+","+e[2]+")"},blueWhiteRed=function(t){return"rgb("+(t<.5?Math.floor(510*t):255)+","+(t<.5?Math.floor(510*t):Math.floor(510*(1-t)))+","+(t<.5?255:Math.floor(510*(1-t)))+")"},blueBlackRed=function(t){return"rgb("+(t<.5?0:Math.floor(512*(t-.5)))+",0,"+(t<.5?Math.floor(255-512*t):0)+")"},grayBlackOrange=function(t){var e=[0,0,0];return"rgb("+(e=t<.5?interpolateColorsRGB([100,100,100],[0,0,0],2*t):interpolateColorsRGB([0,0,0],[255,110,0],2*(t-.5)))[0]+","+e[1]+","+e[2]+")"},grayWhiteOrange=function(t){var e=[0,0,0];return"rgb("+(e=t<.5?interpolateColorsRGB([100,100,100],[255,255,255],2*t):interpolateColorsRGB([255,255,255],[255,110,0],2*(t-.5)))[0]+","+e[1]+","+e[2]+")"},solar=function(t){var e=interpolateColorsRGB([0,0,0],interpolateColorsRGB([255,0,0],[255,255,0],t),Math.pow(.99*t+.01,.2));return RGBtoHEX(e[0],e[1],e[2])},antiSolar=function(t){return invertColor(solar(t))},get=function(t,e){return t.get(e)},getFirstElements=function(t,e){return null==t&&(e=0,t=[null,null,null,null,null,null,null,null,null,null]),[{type:"Object",name:"first value",description:"first value",value:t[(e=null==e?0:Number(e))+0]},{type:"Object",name:"second value",description:"second value",value:t[e+1]},{type:"Object",name:"third value",description:"third value",value:t[e+2]},{type:"Object",name:"fourth value",description:"fourth value",value:t[e+3]},{type:"Object",name:"fifth value",description:"fifth value",value:t[e+4]},{type:"Object",name:"sixth value",description:"sixth value",value:t[e+5]},{type:"Object",name:"seventh value",description:"seventh value",value:t[e+6]},{type:"Object",name:"eight value",description:"eight value",value:t[e+7]},{type:"Object",name:"ninth value",description:"ninth value",value:t[e+8]},{type:"Object",name:"tenth value",description:"tenth value",value:t[e+9]}]},containSameElements=function(t,e){if(null==t||null==e)return null;var n,r=t.length;if(r==e.length){for(n=0;n<r;n++)if(t[n]!=e[n])return!1;return!0}},fractionOfSameElements=function(t,e){if(null==t||null==e)return null;var n,r=Math.max(t.length,e.length),o=0;for(n=0;n<r;n++)t[n]==e[n]&&o++;return 0==r?0:o/r},getCorrespondenceBetweenLists=function(t,e,n,r){if(null==t||null==e)return null;if(t.length!=e.length)throw new Error("The two lists must be the same length");r=null!=r&&r;var o,i=new L,s=Math.max(t.length,e.length);for(o=0;o<s;o++)t[o]==e[o]?i.push(null==n?t[o]:n):i.push(r);return i.downcast()},getConfusionMatrix=function(t,e){if(null==t||null==e)return null;if(t.length!=e.length)throw new Error("The two lists must be the same length");var n,r,o=union(t,e).getWithoutRepetitions().getSorted(),i={},s="-|-";for(n=0;n<o.length;n++)for(r=0;r<o.length;r++)i[o[n]+s+o[r]]=0;for(n=0;n<t.length;n++)i[t[n]+s+e[n]]++;var a=new T;for(a.name="Confusion Mx",n=0;n<=o.length;n++)for(0==n?(a.push(new sL),a[n].name="Predicted Class"):(a.push(new nL),a[n].name="Actual:"+o[n-1]),r=0;r<o.length;r++)0==n?a[n].push(o[r]):a[n].push(i[o[n-1]+s+o[r]]);return a},indexOf=function(t,e){if(null!=t)return t.indexOf(e)},replaceElement=function(t,e,n){if(null==t||null==e)return null;var r=new L;r.name=t.name;var o,i=t.length;for(o=0;o<i;o++)r[o]=t[o]==e?n:t[o];return r.downcast()},replaceElementAtIndex=function(t,e,n){if(null==t||null==n)return null;if("number"!=typeof(e=null==e?0:e)||e%1!=0||e<0||e>=t.length)throw new Error("Invalid index in replaceElement");var r=t.clone();return r[e]=n,r.downcast()},replaceNullsInList=function(t,e,n,r){if(null!=t&&null!=e){if(0===e&&null==n)throw new Error("when mode is 0, must provide a non-null element to replace nulls");var o,i,s,a,l,u,h=t.length,c=0,f=0,p=new L;switch(e){case 6:return n=t.getWithoutElement(null).getMode(),replaceNullsInList(t,0,n);case 3:for(o=0;o<h;o++)"number"==typeof t[o]&&(c+=t[o],f++);return replaceNullsInList(t,0,n=c/f);case 7:n=(n=t.getWithoutElement(null).getSorted()).length>1&&n.length/2==Math.floor(n.length/2)?.5*(n[n.length/2-1]+n[n.length/2]):n[Math.floor(n.length/2)];case 0:for(o=0;o<h;o++)p[o]=t[o]==r?n:t[o];break;case 1:for(o=0;o<h;o++)if(t[o]!=r){i=t[o];break}for(o=0;o<h;o++)t[o]==r?p[o]=i:p[o]=i=t[o];break;case 2:for(o=h-1;o>=0;o--)if(t[o]!=r){s=t[o];break}for(o=h-1;o>=0;o--)t[o]==r?p[o]=s:p[o]=s=t[o];break;case 4:for(l=0,o=0;o<h;o++)if(t[o]!=r){u=o,p[o]=n=t[o];break}if(n==r)return t;for(o==h&&(u=h);l<h;){for(o=l;o<u;o++)p[o]=n;for(o=u;o<h;o++){if(t[o]==r){l=o;break}p[o]=t[o]}if(o==h)l=u=h;else{for(o=l;o<h;o++)if(t[o]!=r){u=o;break}o==h&&(u=h)}l>=0&&(n=u==h?t[l-1]:.5*(t[l-1]+t[u]))}break;case 5:for(l=0,o=0;o<h;o++)if(t[o]!=r){u=o,p[o]=i=s=t[o];break}if(i==r)return t;for(o==h&&(u=h);l<h;){for(a=(s-i)/(1+u-l),o=l;o<u;o++)p[o]=i+(o-l+1)*a;for(o=u;o<h;o++){if(t[o]==r){l=o;break}p[o]=t[o]}if(o==h)l=u=h;else{for(o=l;o<h;o++)if(t[o]!=r){u=o;break}o==h&&(u=h)}l>0&&(i=t[l-1]),s=u==h?i:t[u]}}return p.name=t.name,p.downcast()}},concat=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var t,e=arguments[0].concat(arguments[1]);for(t=2;t<arguments.length;t++)e=e.concat(arguments[t]);return e},reverse=function(t){if(null!=t)return t.getReversed()},getBooleanDictionaryForList=function(t){if(null!=t){var e,n={},r=t.length;for(e=0;e<r;e++)n[t[e]]=!0;return n}},getFirstOccurrenceDictionaryForList=function(t){if(null!=t){var e,n=t.length,r={};for(e=0;e<n;e++)r[t[e]]=e;return r}},getIndexesDictionary=function(t){if(null!=t){var e,n={},r=t.length;for(e=0;e<r;e++)null==n[t[e]]&&(n[t[e]]=new nL),n[t[e]].push(e);return n}},getIndexesTable=function(t){if(null!=t){var e=new T;e[0]=new L,e[1]=new nT;var n,r,o,i={};for(o=0;o<t.length;o++)null==(n=i[r=t[o]])?(e[0].push(r),e[1].push(new nL(o)),i[r]=e[0].length-1):e[1][n].push(o);return e[0]=e[0].downcast(),e}},buildDictionaryObjectForDictionary=function(t){if(!(null==t||t.length<2||null==t[0]||null==t[1])){var e={};return t[0].forEach((function(n,r){e[n]=t[1][r]})),e}},mapWithTable=function(t,e,n,r){if(!(null==t||null==e||e.length<2)){var o=buildDictionaryObjectForDictionary(e),i=mapWithObject(t,o,n,r);return i.dictionaryObject=o,i}},mapWithObject=function(t,e,n,r){if(null!=t&&null!=e){var o,i=new L,s=t.length;for(o=0;o<s;o++)i[o]=e[t[o]];if(null!=n||r){var a=t.length;for(o=0;o<a;o++)null==i[o]&&(i[o]=r?t[o]:n)}return i.name=t.name,i.downcast()}},sortListByNumberList=function(t,e,n){return null==n&&(n=!0),null==e||0===e.length?t:t.getSortedByList(e,!n,!1,!0)},getRankingsList=function(t,e,n,r){if(null==t)return null;e=null==e||e;var o=createSortedNumberList(t.length);o=o.getSortedByList(t,e,n);var i,s=new nL,a=t.length;for(i=0;i<a;i++)s[o[i]]=i;return r&&(s=s.getNormalized()),s.name=t.name,s},sortListByIndexes=function(t,e){var n=instantiate(_typeOf(t));n.name=t.name;var r,o=t.length;for(r=0;r<o;r++)n.push(t[e[r]]);return n},concatWithoutRepetitions=function(){var t=arguments.length;if(0!==t){if(1==t)return arguments[0];var e,n,r,o,i=arguments[0].clone(),s=getBooleanDictionaryForList(i);for(e=1;e<t;e++)for(o=(r=arguments[e]).length,n=0;n<o;n++)s[r[n]]||i.push(r[n]);return i.downcast()}},slidingWindowOnList=function(t,e,n,r){r=r||0;var o,i,s,a=new T,l=t.length;switch(n=Math.max(1,n),r){case 0:for(i=0;i<l;i+=n)if(i+e<=l){for(o=new L,s=0;s<e;s++)o.push(t[i+s]);a.push(o.downcast())}break;case 1:for(i=0;i<l;i+=n){for(o=new L,s=0;s<Math.min(e,l-i);s++)o.push(t[i+s]);a.push(o.downcast())}break;case 2:for(i=0;i<l;i+=n){for(o=new L,s=0;s<e;s++)o.push(t[(i+s)%l]);a.push(o.downcast())}}return a.downcast()},getNewListForObjectType=function(t){var e=new L;return e[0]=t,instanceSameType(e.downcast())},union=function(t,e,n,r,o){if(null!=t&&null!=e){var i,s,a=new L,l=t.length,u=e.length,h=null==n?0:n.length,c=null==r?0:r.length,f=null==o?0:o.length;if("ndL"==t.type||"ndL"==e.type){for(a=new ndL,a=t.clone(),i=0;i<u;i++)null==t.get(e[i].id)&&a.addNode(e[i]);return n&&(a=a(a,n)),r&&(a=a(a,r)),o&&(a=a(a,o)),a}var p={};for(i=0;i<l;i++)p[t[i]]=t[i];for(i=0;i<u;i++)p[e[i]]=e[i];for(i=0;i<h;i++)p[n[i]]=n[i];for(i=0;i<c;i++)p[r[i]]=r[i];for(i=0;i<f;i++)p[o[i]]=o[i];for(s in p)a.push(p[s]);return a.downcast()}},intersection=function(t,e,n,r,o){if(null!=t&&null!=e){if(t.isTable&&e.isTable)return t.getColumns(e.getNames());var i,s=null;Array.isArray(n)||"object"!=typeof n||(s=n,n=null);var a,l,u=t.length,h=e.length;if("ndL"==t.type&&"ndL"==e.type){for(i=new ndL,a=0;a<u;a++)e.get(t[a].id)&&i.addNode(t[a]);return n&&(i=i(i,n)),r&&(i=i(i,r)),o&&(i=i(i,o)),i}var c=null==s?getBooleanDictionaryForList(t):s,f={},p=null==n?null:getBooleanDictionaryForList(n),g=null==r?null:getBooleanDictionaryForList(r),d=null==o?null:getBooleanDictionaryForList(o);for(i=new L,a=0;a<h;a++)null!=f[l=e[a]]||!c[l]||null!=p&&!p[l]||null!=g&&!g[l]||null!=d&&!d[l]||(f[l]=!0,i.push(l));return i.downcast()}},difference=function(t,e){if(null!=t&&null!=e){var n,r=getBooleanDictionaryForList(e),o={},i=new L,s=t.length;for(t.type,n=0;n<s;n++)r[t[n]]||o[t[n]]||(i.push(t[n]),o[t[n]]=!0);return i.downcast()}},symmetricDifference=function(t,e){if(null!=t&&null!=e){var n,r=getBooleanDictionaryForList(t),o=getBooleanDictionaryForList(e),i={},s=new L,a=t.length,l=e.length;for(t.type,n=0;n<a;n++)o[t[n]]||i[t[n]]||(s.push(t[n]),i[t[n]]=!0);for(n=0;n<l;n++)r[e[n]]||i[e[n]]||(s.push(e[n]),i[e[n]]=!0);return s.downcast()}},jaccardIndex=function(t,e,n,r){if(null!=t&&null!=e){if(0===t.length&&0===e.length)return 0;n=null==n?0:n;var o=intersection(t,e,r).length;return(o+n)/(t.getWithoutRepetitions().length+e.getWithoutRepetitions().length-o)}},jaccardDistance=function(t,e){return 1-jaccardIndex(t,e)},filterList=function(t,e="=c",n,r,o,i){if(null!=t){"="==e&&(e="=="),null==r&&(r=t),!0===i&&(i=1);var s,a=t.length;if(2==i){var l=new L;switch(e){case"==":for(s=0;s<a;s++)l.push(r[s]===n);break;case"<":for(s=0;s<a;s++)l.push(r[s]<n);break;case"<=":for(s=0;s<a;s++)l.push(r[s]<=n);break;case">":for(s=0;s<a;s++)l.push(r[s]>n);break;case">=":for(s=0;s<a;s++)l.push(r[s]>=n);break;case"!=":for(s=0;s<a;s++)l.push(r[s]!==n);break;case"contains":for(s=0;s<a;s++)l.push(r[s].includes(n));break;case"between":for(s=0;s<a;s++)l.push(r[s]>=n&&r[s]<=o);break;case"init":for(s=0;s<a;s++)l.push(0===r[s].indexOf(n));break;case"property value":for(s=0;s<a;s++)l.push(r[s][n]==o)}return l}var u=new L,h=1==i?createSortedNumberList(t.length):t;switch(e){case"==":for(s=0;s<a;s++)r[s]==n&&u.push(h[s]);break;case"<":for(s=0;s<a;s++)r[s]<n&&u.push(h[s]);break;case"<=":for(s=0;s<a;s++)r[s]<=n&&u.push(h[s]);break;case">":for(s=0;s<a;s++)r[s]>n&&u.push(h[s]);break;case">=":for(s=0;s<a;s++)r[s]>=n&&u.push(h[s]);break;case"!=":for(s=0;s<a;s++)r[s]!=n&&u.push(h[s]);break;case"contains":for(s=0;s<a;s++)r[s].includes(n)&&u.push(h[s]);break;case"between":for(s=0;s<a;s++)r[s]>=n&&r[s]<=o&&u.push(h[s]);break;case"init":for(s=0;s<a;s++)0===r[s].indexOf(n)&&u.push(h[s]);break;case"property value":for(s=0;s<a;s++)r[s][n]==o&&u.push(h[s])}return u.downcast()}},mapWithFunction=function(t,e,n,r,o,i,s,a,l,u){if(null!=t&&null!=e){null==u&&(u=!0),"string"==typeof e&&(u=!1,e=stringToFunction(e));var h,c=new L,f=t.length;if(u)for(h=0;h<f;h++)c[h]=e.call(this,t[h],h,n,r,i,s,a,l);else for(h=0;h<f;h++){var p=[t[h]];null!=n&&(p[1]=n),null!=r&&(p[2]=r),null!=i&&(p[3]=i),null!=s&&(p[4]=s),null!=a&&(p[5]=a),null!=l&&(p[6]=l),c[h]=e.apply(this,p)}return c.name=o,c.downcast()}},mapFunctionsOnList=function(t,e,n,r){if(null!=t&&null!=e){for(var o=new L,i=Math.min(t.length,e.length),s=0;s<i;s++){var a=e[s];"string"==typeof a&&(a=stringToFunction(a));var l=[t[s]];null!=n&&(l[1]=n),null!=r&&(l[2]=r),o[s]=a.apply(this,l)}return o.downcast()}},aggregateList=function(t,e,n,r,o,i){if(null==t||null==e)return null;var s,a,l=new T;if(null!=n&&"string"==_typeOf(n)&&(n=ListOperators._aggregationDictionary[n]),18==n&&null==o)throw Error("weightList must be defined to aggregate to a weighted average.");if(null==(r=t.indexesTable)&&(r=getIndexesTable(t),t.indexesTable=r),11==n)return r;if(l[0]=r[0],0===n&&t==e)return l[1]=r[0],l;n=null==n?0:n;var u,h,c,f,p,g=r[1].length;switch(n){case 0:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(e[u[0]]);return l[1]=l[1].downcast(),l;case 1:for(l[1]=new nL,f=0;f<g;f++)u=r[1][f],l[1].push(u.length);return l;case 2:case 3:case 18:case 19:var d,m,y;for(l[1]=new nL,f=0;f<g;f++){u=r[1][f],d=0,m=0,y=0;var v=new nL;for(p=0;p<u.length;p++)d+=e[h=u[p]],19==n&&v.push(e[h]),18==n&&(m+=e[h]*o[h],y+=o[h]);3==n?d/=u.length:18==n&&(d=0==y?0:m/y),19==n&&(d=v.getMedian()),2!=n||Number.isInteger(d)||(d=Number(parseFloat(d).toPrecision(12))),l[1].push(d)}return l;case 4:var w;for(l[1]=new nL,f=0;f<g;f++){for(u=r[1][f],w=99999999999,p=0;p<u.length;p++)h=u[p],w=Math.min(w,e[h]);l[1].push(w)}return l;case 5:var x;for(l[1]=new nL,f=0;f<g;f++){for(u=r[1][f],x=-99999999999,p=0;p<u.length;p++)h=u[p],x=Math.max(x,e[h]);l[1].push(x)}return l;case 6:var b;for(l=aggregateList(t,e,3,r),f=0;f<g;f++){for(u=r[1][f],d=0,b=l[1][f],p=0;p<u.length;p++)h=u[p],d+=Math.pow(e[h]-b,2);l[1][f]=Math.sqrt(d/u.length)}return l;case 16:case 7:for(l[1]=new T,f=0;f<g;f++){for(u=r[1][f],s=new L,p=0;p<u.length;p++)null!=e[h=u[p]]&&s.push(e[h]);s=s.downcast(),16==n&&(s=s.getFrequenciesTable(!0)),l[1].push(s)}return 16==n?l:l.downcast();case 8:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(e[u[u.length-1]]);return l[1]=l[1].downcast(),l;case 9:for(l[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getMode());return l[1]=l[1].downcast(),l;case 10:for(l[1]=new L,f=0;f<g;f++)u=r[1][f],l[1].push(e[u[Math.floor(Math.random()*u.length)]]);return l[1]=l[1].downcast(),l;case 11:case 16:break;case 12:for(l[1]=new nL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions().length);return l;case 13:for(l[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions());return l[1]=l[1].downcast(),l;case 14:case 17:var M=14==n?", ":"";for(l[1]=new sL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.join(M));return l;case 15:for(l[1]=new sL,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(c.getWithoutRepetitions().join(", "));return l;case 20:for(l[1]=new L,a=aggregateList(t,e,7,r),f=0;f<a[1].length;f++)c=a[1][f],l[1].push(i(c));return l[1]=l[1].downcast(),l}return null},subCategoricalAnalysis=function(t,e){if(null!=t&&null!=e){var n,r,o,i={},s=!0;for(o=0;null!=t[o];o++)if(null==(r=i[n=t[o]]))i[n]=e[o];else if(r!=e[o]){s=!1;break}i={};var a=!0;for(o=0;null!=e[o];o++)if(null==(r=i[n=e[o]]))i[n]=t[o];else if(r!=t[o]){a=!1;break}return a&&s?1:s?2:a?3:0}},getListEntropy=function(t,e,n,r){if(null!=t){if(t.length<2)return 1==t.length?(t._mostRepresentedValue=t[0],t._biggestProbability=1,null!=e&&(t._P_valueFollowing=t[0]==e?1:0)):null!=e&&(t._P_valueFollowing=0),0;null!=t.infoObject&&(n=t.infoObject.frequenciesTable),null==n&&(n=t.getFrequenciesTable(!0)),t._mostRepresentedValue=n[0][0];var o=t.length;if(t._biggestProbability=n[1][0]/o,1==n[0].length)return t._P_valueFollowing=t[0]==e?1:0,0;var i,s,a=0,l=Math.log(n[0].length),u=n[1].length;for(i=0;i<u;i++)a-=(s=n[1][i])/o*Math.log(s/o);if(r>0&&(a*=1/l),2==r){var h=function(t,e){if(1==t)return 0;if(t==e)return 1;var n=e-(t-1);return(1/e*-(t-1)*Math.log(1/e)-n/e*1*Math.log(n/e))/Math.log(t)}(u,t.length);h<1&&(a=(a-h)/(1-h))}if(null!=e){var c=n[0].indexOf(e);t._P_valueFollowing=-1==c?0:n[1][c]/o}return a}},getListDiversity=function(t,e,n){if(!((e=null==e?0:e)<0||e>2||null==t)){if(t.length<2)return 0;if(!t.isList){if(!Array.isArray(t))return;t=L.toL(t)}switch(null!=t.infoObject&&(n=t.infoObject.frequenciesTable),null==n&&(n=t.getFrequenciesTable()),e){case 0:for(var r=0,o=t.length*(t.length-1),i=0;i<n[1].length;i++)r+=n[1][i]*(n[1][i]-1);return 1-r/o;case 1:return n[0].length/t.length;case 2:return getListEntropy(t,null,null,1)*n[0].length/t.length}}},getInformationGain=function(t,e,n){if(null==t||null==e||t.length!=e.length)return null;var r,o,i=null==e.infoObject?getListEntropy(e):e.infoObject.entropy,s=i,a={},l=new T,u=t.length;for(r=0;r<u;r++)null==a[o=t[r]]&&(a[o]=new L,l.push(a[o])),a[o].push(e[r]);u=l.length;var h,c=e.length,f=0;for(r=0;r<u;r++)h=null==l[r].infoObject?getListEntropy(l[r]):l[r].infoObject.entropy,f+=l[r].length/c*h;s=i-f;return n&&(s/=i),s},groupElements=function(t,e,n,r){if(t)return _groupElements_Base(t,null,e,n,r)},groupElementsByPropertyValue=function(t,e,n,r,o){if(t)return _groupElements_Base(t,e,n,r,o)},_groupElements_Base=function(t,e,n,r,o){if(t){null==r&&(r=0);var i,s,a,l,u,h={},c=new T;for(u=0;u<t.length;u++)s=t[u],void 0===h[i=null==e?s:s[e]]&&(h[i]=new L,h[i].name=i,h[i].valProperty=i,c.push(h[i])),0===r?h[i].push(s):1==r&&h[i].push(u),(void 0===a||i<a)&&(a=i),(void 0===l||i>l)&&(l=i);if(o){for(u=a;u<l;u++)void 0===h[u]&&(h[u]=new L,h[u].name=u,h[u].valProperty=u,c.push(h[u]))}return n&&(c=c.getSortedByProperty("name")),c}},repeatElements=function(t,e){if(t&&e){var n=instanceSameType(t);n.name=t.name;for(var r=0;r<t.length;r++)for(var o=0;o<e[r%e.length];o++)n.push(t[r]);return n}},_isCategorical=function(t,e){return e>1&&e<t.length&&(t.length<=20||e/t.length<.8)},buildInformationObjectForList=function(t,e){if(null!=t){if(1==(e=null==e||e)&&null!=t.infoObject)return t.infoObject;var n,r,o=t.length,i={isInfoObject:!0,type:t.type,name:t.name,length:o};if(i.frequenciesTable=t.getFrequenciesTable(!0,!0,!0),i.numberDifferentElements=i.frequenciesTable[0].length,i.mostFrequentElement=i.frequenciesTable[0][0],i.isNumeric="nL"==t.type,i.isCategorical=_isCategorical(t,i.numberDifferentElements),i.isLongTexts=!1,i.isDefault=!1,i.isNumericCategorical=i.isNumeric&&i.isCategorical,i.isUnique=i.numberDifferentElements==t.length,i.containsNulls=i.frequenciesTable[0].includes(null)||i.frequenciesTable[0].includes(void 0),i.containsNullsOrEqual=i.containsNulls||i.frequenciesTable[0].includes("")||i.frequenciesTable[0].includes("null"),i.isLongitude=!1,i.isLatitude=!1,i.isSmall=t.length<=100,"nL"==t.type){var s=999999999999,a=-999999999999,l=0,u=0,h=new nL,c=0,f=0,p=-999999999999,g=Math.max(Math.floor(t.length/50),1),d=!0;for(n=0;n<o;n++)r=t[n],s=Math.min(s,r),a=Math.max(a,r),l+=r,f+=r,r%1!=0&&(d=!1),++c==g&&(f/=c,p=Math.max(p,f),h.push(f),f=0,c=0);0!==c&&(f/=c,p=Math.max(p,f),h.push(f)),h=h.factor(1/p);var m=l;for(l/=t.length,n=0;n<o;n++)u+=Math.pow(t[n]-l,2);if(i.min=s,i.max=a,i.average=l,i.sum=m,i.standardDeviation=Math.sqrt(u/o),i.allIntegers=d,i.kind=d?"integer numbers":"numbers",i.allPositive=i.min>=0,i.allNegative=i.min<0,i.histogram=rangeCounts(t,50),t.name){var y=t.name.toLowerCase().trim();i.min>=-90&&i.max<=90&&("lat"==y||"lat."==y||y.match(/latitud.*/i))&&(i.isLatitude=!0),i.min>=-180&&i.max<=180&&("lon"==y||"lon."==y||"long"==y||y.match(/longitud.*/i)||"long."==y||"lng"==y)&&(i.isLongitude=!0)}}if("nL"!=t.type||i.allIntegers){if(i.categoricalColors=i.frequenciesTable[3],"sL"==t.type){var v=t.getLengths();for(i.averageTextLengths=0,i.minTextLength=999999999999999,i.maxTextLength=0,n=0;n<o;n++)i.averageTextLengths+=v[n],v[n]>i.maxTextLength&&(i.maxTextLength=v[n]),v[n]<i.minTextLength&&(i.minTextLength=v[n]);i.averageTextLengths=Number(numberToString(i.averageTextLengths/o,i.averageTextLengths/o<10?1:0)),i.averageTextLengths>40&&(i.isLongTexts=!0)}if(i.isLatitude||i.isLongitude)i.kind="geo coordinate";else if("sL"!=t.type||i.isCategorical)if("sL"!=t.type||i.isCategorical)if("L"==t.type){var L=0;for(n=0;n<i.frequenciesTable[0].length;n++)r=i.frequenciesTable[0][n],(isNaN(parseFloat(r))||!isFinite(r)||Math.floor(r)==r&&r<1e3)&&L++;i.isCategorical&&L/i.numberDifferentElements>.8?i.kind="categories":i.kind="strings"}else"nL"!=t.type?i.kind="categories":"nL"==t.type&&(i.kind="integer numbers",i.numberDifferentElements/t.length<=.2&&i.numberDifferentElements<=30&&(i.kind="categories"));else i.kind="strings";else i.kind="strings"}return i.entropy=i.numberDifferentElements==t.length?1:1==i.numberDifferentElements?0:getListEntropy(t,null,i.frequenciesTable),i.isLabel="sL"!=t.type&&i.isUnique&&i.maxTextLength<100,i.isDefault=!i.isNumeric&&!i.isCategorical&&!i.isLongTexts,t.infoObject=i,i}},kCombinations=function(t,e){if(null!=t&&null!=e){var n,r,o,i,s=new T;if(e>t.length||e<=0)return s;if(e==t.length)return s.push(t.clone()),s;if(1==e){for(n=0;n<t.length;n++)s.push(new L(t[n]).downcast());return s}for(n=0;n<t.length-e+1;n++)for(o=t.slice(n,n+1),i=s(L.toL(t.slice(n+1)).downcast(),e-1),r=0;r<i.length;r++)s.push(L.toL(o.concat(i[r])).downcast());return s.downcast()}},allSubLists=function(t,e){if(null==t)return null;var n,r=new T;for(e&&r.push(new L),n=1;n<=t.length;n++)r=T.toL(r.concat(kCombinations(t,n)));return r.downcast()},crossCombineLists=function(t,e,n){if(null==t||null==e)return null;var r,o;n=null==n?" ":n;var i=new sL;for(r=0;r<t.length;r++)for(o=0;o<e.length;o++)i.push(t[r]+n+e[o]);return i},characterizeList=function(t,e,n){if(null==t)return null;if(!t.isList)throw new Error("first inlet must be a list");if(t.isTable){var r=new sL;for(let o=0;o<t.length;o++)r.push(characterizeList(t[o],e,n));return r}if(0==t.length)return"";if(null==t.infoObject&&buildInformationObjectForList(t),e=null==e?0:e,n=null!=n&&n,isNaN(e)||e%1!=0||e<0||e>14)throw new Error("Mode must be an integer between 0 and 14");if([1,2,3,4,9,10].includes(e)&&"nL"!=t.type)throw new Error("This mode only applicable for nL input");var o,i,s,a,l;switch(e){case 0:o=t[0]+(n?"(first)":"");break;case 1:o=t.getSum()+(n?"(sum)":"");break;case 2:var u=getDecimalsInterval(t);o=numberToString(t.infoObject.average,u.y+1)+(n?"(avg)":"");break;case 3:o=t.infoObject.min+(n?"(min)":"");break;case 4:o=t.infoObject.max+(n?"(max)":"");break;case 5:o="sL"!=t.type?t.toStringList().join(", ")+(n?"(all)":""):t.join(", ")+(n?"(all)":"");break;case 6:o=t.infoObject.mostFrequentElement+(n?"(common)":"");break;case 7:o=t.infoObject.numberDifferentElements+(n?"(unique count)":"");break;case 8:o="sL"!=(s=t.infoObject.frequenciesTable[0]).type?s.toStringList().join(",")+(n?"(unique)":""):s.join(", ")+(n?"(unique)":"");break;case 9:o=t.infoObject.min+"-"+t.infoObject.max+(n?"(range)":"");break;case 10:o=t.getMedian()+(n?"(median)":"");break;case 11:for(o="",i=0;i<3&&i<t.length;i++)""!=o&&(o+=", "),o+=String(t[i]);t.length>3&&(o+=", + "+(t.length-3)+" more"),n&&(o+="(short list)");break;case 12:a=t.infoObject.frequenciesTable;var h=0;for(o="",i=0;i<a[0].length;i++)i<5?(""!=o&&(o+=", "),o+=String(a[0][i])+":"+a[1][i]):h+=a[1][i];h>0&&(o+=", Other:"+h),o+=n?"(frequency)":"";break;case 13:for(s="sL"==t.type?t:t.toStringList(),a=(s=getWords(s.join(" "),!1,!0,null,null,null,2)).getFrequenciesTable(!0,!0),o="",i=0;i<5&&i<a[0].length;i++)""!=o&&(o+=", "),l=(l=(100*a[2][i]).toPrecision(2)).includes("e")?parseFloat(l):l,o+=String(a[0][i])+":"+l;o+=n?"(word rate)":"";case 14:o=t.name&&""!=t.name?t.name+": ":"","sL"!=t.type?o+=t.toStringList().getSubList(0,5).join(", ")+(n?"(name:5)":""):o+=t.getSubList(0,5).join(", ")+(n?"(name:5)":"")}return o=o.replace(/\n/g," ")},createDefaultCategoricalColorList=function(t,e,n,r=!1){var o=createCategoricalColors(2,t,null,null,null,null,null,r);return null!=e&&e<=1&&(o=o.addAlpha(e)),n&&(o=o.getInverted()),o},colorsForCategoricalList=function(t,e,n){if(null!=t){if(n){var r=new cL;r.name=t.name+" colors";for(var o=0;o<t.length;o++)r[o]=stringToColor(String(t[o]));return r}return createCategoricalColorListForList(t,e)[0].value}},createCategoricalColorListForList=function(t,e,n,r,o,i,s){if(null==t)return null;o=null==o?0:o;var a,l=t.getWithoutRepetitions();a=e&&o>0?e.getInterpolated(r,o):createCategoricalColors(2,l.length,null,n,r,o,e,s),null!=n&&n<=1&&(a=a.addAlpha(n)),i&&(a=a.getInverted());var u=T.toL([l,a]),h=buildDictionaryObjectForDictionary(u),c=mapWithTable(t,u,"black");return[{value:c=cL.toL(c),type:"cL"},{value:l,type:l.type},{value:a,type:"cL"},{value:u,type:"T"},{value:h,type:"Object"}]},createColorListFromColorScale=function(t,e,n){if(null!=t){var r;n=null==n?0:n,e=null==e?grayToOrange:e;var o=new cL;switch(n){case 0:for(r=0;r<t;r++)o[r]=e(r/(t-1));break;case 1:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),2));break;case 2:for(r=0;r<t;r++)o[r]=e(Math.sqrt(r/(t-1)));break;case 3:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),4));break;case 4:for(r=0;r<t;r++)o[r]=e(Math.pow(r/(t-1),.25))}return o}},createColorListFromNumberList=function(t,e,n){if(null==t)return null;n=null==n?0:n,e=null==e?grayToOrange:e;var r,o,i=new cL,s=t.length;switch(n){case 0:r=normalizeToMax(t);break;case 1:break;case 2:r=t}for(o=0;o<s;o++)i[o]=e(r[o]);return i},createSymmetricalColorListFromNumberList=function(t,e,n,r,o,i){if(null!=t){var s=null==i?t.getInterval():i,a=Math.max(Math.abs(s.x),Math.abs(s.y));n=null==n?"gray":n,r=null==r?"blue":r;for(var l,u=colorStringToRGB(e=null==e?"red":e),h=colorStringToRGB(n),c=colorStringToRGB(r),f=new cL,p=0;p<t.length;p++)l=Math.abs(t[p])/a,o>0&&(l=Math.sqrt(l)),o>1&&(l=Math.sqrt(l)),null!=i&&t[p]<i.x?f[p]=e:null!=i&&t[p]>i.y?f[p]=r:f[p]=RGBArrayToString(t[p]<0?interpolateColorsRGB(h,u,l):interpolateColorsRGB(h,c,l));return f}},createColorListWithSingleColor=function(t,e){for(var n=new cL,r=0;r<t;r++)n.push(e);return n},createColorListBetweenTwoColors=function(t,e,n){if(t=null==t?8:t,null!=e&&null!=n){for(var r=new cL,o=0;o<t;o++){var i=1==t?e:interpolateColors(e,n,o/(t-1),!0);r.push(i)}return r}},createColorListSpectrum=function(t,e,n){t=null==t?8:t,e=null==e?1:e,n=null==n?1:n;for(var r,o=new cL,i=0;i<t;i++)r=360*i/t,o.push(HSVtoHEX(r,e,n));return o},stringsToColors=function(t,e){if(null!=t){null!=e&&e.isTable&&(e=buildDictionaryObjectForDictionary(e));for(var n=new cL,r=0;r<t.length;r++)n[r]=e?e[String(t[r])]:null,null==n[r]&&(n[r]=stringToColor(String(t[r])));return n}},createCategoricalColors=function(t,e,n,r,o,i=.5,s,a){var l,u;n=null==n?temperature:n;var h=new cL;switch(t){case 0:for(l=0;l<e;l++)h[l]=n(l/(e-1));break;case 1:var c=createRandomNumbers(e,null,0);for(l=0;l<e;l++)h[l]=n(c[l]);break;case 2:var f;for(s=null==s?_HARDCODED_CATEGORICAL_COLORS:s,l=0;l<e;l++)if(h[l]=s[l%s.length],a&&l>=s.length)for(f=Math.floor(l/s.length),u=0;u<f;u++)h[l]=interpolateColors(h[l],"black",.2);break;case 3:h=createColorListSpectrum(e);break;case 4:case 5:var p,g,d=createRandomNumbers(1001,null,0),m=createSortedNumberList(e),y=createRandomNumbers(e,null,0),v=sortListByNumberList(m,y),L=Math.floor(2*e)+100,w=Math.floor(.6*e)+5,x=4==t,b=4==t,T=_evaluationFunction(v,x,b),M=v,_=0;for(l=0;l<L;l++){for(u=0;u<w;u++)p=_sortingVariation(v,d[_],d[_+1]),_=(_+2)%1001,(g=_evaluationFunction(p,x,b))>T&&(M=p,T=g);v=M}if(4==t){var S=createColorListSpectrum(e);for(l=0;l<e;l++)h.push(S[v[l]])}else for(l=0;l<e;l++)h.push(n(1/e+v[l]/(e+1)))}return i>0&&null!=o&&(h=h.getInterpolated(o,i)),null!=r&&(h=h.addAlpha(r)),h},_sortingVariation=function(t,e,n){var r=t.clone(),o=Math.floor(e*r.length),i=Math.floor(n*r.length),s=r[i];return r[i]=r[o],r[o]=s,r},_evaluationFunction=function(t,e,n){for(var r,o,i,s=0,a=t.length,l=Math.floor(a/2),u=n?4:1,h=1;h<=u;h++)for(i=h*h,r=0;null!=t[r+h];r++)o=Math.abs(t[r+h]-t[r]),e&&o>l&&(o=a-o),s+=Math.sqrt(o/i);return s},createCategoricalColorListDictionaryObject=function(t,e,n,r,o,i){if(null!=t){if(t.isTable){var s,a,l,u,h,c=t,f=null==e?_HARDCODED_CATEGORICAL_COLORS:e;for(s=f.clone(),l={},d=0;d<c.length;d++)(h=buildInformationObjectForList(c[d])).isCategorical&&((u=h.numberDifferentElements)>=f.length?a=createCategoricalColorListDictionaryObject(c[d],f,n,r,o,i):(u>s.length&&(s=f.clone()),a=createCategoricalColorListDictionaryObject(c[d],s,n,r,o,i),s=s.getSubList(u,s.length-1)),l=Object.assign(l,a));return l}var p=t.getWithoutRepetitions(),g=createCategoricalColors(2,p.length,null,n,r,o,e);i&&(g=g.getInverted());var d,m={},y=g.length;for(d=0;d<y;d++)m[p[d]]=g[d];return m}},stringToDate=function(t,e,n){if(null==t)return null;if(n=null==n?"-":n,e=null==e?1:e,e=Number(e),"sL"==t.type||"Array"==_typeOf(t)){var r,o=new dL;for(o.name=t.name,r=0;r<t.length;r++)o.push(stringToDate(t[r],e,n));return o}if(t=String(t),1==e)return"-"!=n&&(t=t.replace(new RegExp(n,"g"),"-")),-1==t.indexOf(".")?parseDate(t):new Date(t);var i,s=t.split(n);switch(e){case 0:return new Date(Number(s[2]),Number(s[0])-1,Number(s[1]));case 1:return new Date(t);case 2:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[0])-1,Number(s[1]));case 3:return i=(i=Number(s[0]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[2]));case 4:return i=(i=Number(s[2]))>=0?i+2e3:i+1900,new Date(i,Number(s[1])-1,Number(s[0]));case 5:return i=Number(s[2]),new Date(i,Number(s[1])-1,Number(s[0]));case 6:i=Number(t.substr(0,4));var a=Number(t.substr(4,2)),l=Number(t.substr(6,2));return new Date(i,a-1,l)}},dateToString=function(t,e,n){if(null==t)return null;if("dL"==t.type||"Array"==_typeOf(t)){var r,o=new sL;for(o.name=t.name,r=0;r<t.length;r++)o.push(dateToString(t[r],e,n));return o}n=null==n?"-":n,e=null==e?0:e,"string"==typeof t&&(t=new Date(t));var i=t.getFullYear(),s=String(i).substr(2),a=t.getMonth()+1,l=t.getDate();switch(e){case 0:return a+n+l+n+i;case 1:return i+n+a+n+l;case 2:return a+n+l+n+s;case 3:return s+n+a+n+l;case 4:return i+n+a+n+l+" "+(h=t.getHours())+":"+(c=(c=t.getMinutes())<10?"0"+c:c)+":"+(f=(f=t.getSeconds())<10?"0"+f:f);case 5:return l+" "+DateOperators_MONTH_NAMES[a-1]+" "+i;case 6:return u=0==(u=t.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u]+", "+l+" "+DateOperators_MONTH_NAMES[a-1]+" "+i;case 7:return DateOperators_MONTH_NAMES[a-1];case 8:var u;return u=0==(u=t.getDay())?u=6:u-1,DateOperators_WEEK_NAMES[u];case 9:return i+n+(a<10?"0"+a:a)+n+(l<10?"0"+l:l);case 10:var h,c,f;return(h=(h=t.getHours())<10?"0"+h:h)+":"+(c=(c=t.getMinutes())<10?"0"+c:c)+":"+(f=(f=t.getSeconds())<10?"0"+f:f);case 11:return(l<10?"0"+l:l)+n+(a<10?"0"+a:a)+n+i}},clearHoursMinutesSeconds=function(t){if(null==t)return null;var e=dateToString(t,1);return stringToDate(e,1)},currentDate=function(t){return new Date},addDaysToDate=function(t,e){if(null==t)return null;e=null==e?0:e,"string"==typeof t&&(t=parseDate(t));var n=new Date(t);return n.setDate(n.getDate()+e),n},addMillisecondsToDate=function(t,e){return new Date(t.getTime()+e)},parseDate=function(t){var e=(t=String(t)).match(/^(\d{4})[\-\.](\d{1,2})[\-\.](\d{1,2})$/);return e&&4==e.length?new Date(e[1],e[2]-1,e[3]):new Date(Date.parse(t))},parseDates=function(t){var e,n=new dL;for(e=0;null!=t[e];e++)n.push(this.parseDate(t[e]));return n},hoursBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToHours},daysBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToDays},weeksBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToWeeks},yearsBetweenDates=function(t,e){return(e.getTime()-t.getTime())*DateOperators_millisecondsToYears},nDayInYear=function(t){return Math.floor((t.getTime()-new Date(t.getFullYear(),0,1).getTime())*DateOperators_millisecondsToDays)},getDateDaysAgo=function(t){return addDaysToDate(new Date,-t)},getWeekInYear=function(t){if(null==t)return null;var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+e.getDay()+1)/7)},getNDaysInMonth=function(t,e){return new Date(e,t,0).getDate()},getDecimalDate=function(t){var e;if(null==t)return null;if("string"==typeof t){if(e=new Date(t),isNaN(e))throw new Error("Invalid format for date:"+t)}else e=t;var n=e.getFullYear(),r=(t=new Date(n,0,1),new Date(n+1,0,1));return n+(e.getTime()-t.getTime())/(r.getTime()-t.getTime())},convertFromDecimalDate=function(t){if(null==t)return null;if("nL"==t.type){var e=new e;e.name=t.name;for(var n=0;n<t.length;n++)e.push(convertFromDecimalDate(t[n]));return e}var r=Math.floor(t),o=new Date(r,0,1),i=new Date(r+1,0,1),s=o.getTime()+(i.getTime()-o.getTime())*(t-r),a=new Date(Math.round(s));if(isNaN(a))throw new Error("Invalid decimal date value:"+t);return a},extractPropertiesFromDate=function(t,e){if(null==t)return null;if(e=null==e?0:e,isNaN(e)||e%1!=0||e<0||e>15)throw new Error("Invalid output type.");var n,r,o,i;switch(e){case 0:n=t.getFullYear();break;case 1:n=t.getMonth()+1;break;case 2:n=t.getDate();break;case 3:n=t.getDay();break;case 4:n=t.getHours();break;case 5:n=t.getMinutes();break;case 6:n=t.getSeconds();break;case 7:n=getDecimalDate(t);break;case 8:n=nDayInYear(t);break;case 9:r=getDecimalDate(t),n=Math.floor(4*(r-Math.floor(r)))+1;break;case 10:o=t.getHours()+(60*t.getMinutes()+t.getSeconds())/3600,n=Number(o.toFixed(5));break;case 11:for(n=[],i=0;i<7;i++)t.getDay()==i?n.push(1):n.push(0);break;case 12:for(n=[],i=0;i<12;i++)t.getMonth()==i?n.push(1):n.push(0);break;case 13:n=dateToString(t,8);break;case 14:n=dateToString(t,7);break;case 15:n=t.getHours()>=12?"pm":"am"}return n},StringListToNumberList=function(t){var e,n=new nL;for(n.name=t.name,e=0;null!=t[e];e++)n[e]=Number(t[e]);return n},toDateList=function(t,e,n){if(null!=t){var r,o=new dL;o.name=t.name;var i=t.length;for(r=0;r<i;r++)o.push(stringToDate(t[r],e,n));return o}},_y=function(t){return t.getFullYear()},_m=function(t){return t.getMonth()},_d=function(t){return t.getDate()-1},_h=function(t){return t.getHours()},_mn=function(t){return t.getMinutes()},_s=function(t){return t.getSeconds()},_ms=function(t){return t.getMilliseconds()},getDateLists=function(t){for(var e=new T,n=0;n<t.length;n++)"dL"==t[n].type&&e.push(t[n]);return e},buildSummaryTableFromDates=function(t,e,n,r){if(null==t||"dL"!=t.type)return null;var o="Weekday by Hour Summary",i="Hour";1==(e=null==e?0:e)?(o="Month by Day Summary",i="Day"):2==e&&(o="Sequence",i="Date");var s=new T;null!=t.name?s.name=t.name+" "+o:s.name=o,s.push(new sL),s[0].name=i;var a,l,u,h,c,f,p=window&&window.navigator&&window.navigator.language?window.navigator.language:"en-US",g=new Date(2016,0,17,10,0,0,0);if(2==e){null!=r&&"dI"==r.type||(r=new dI(t.getMin(),t.getMax())),s.push(new u),s[1].name="Value";var d=daysBetweenDates(r.date0,r.date1);for(a=0;a<=d;a++)l=addDaysToDate(r.date0,a),s[0][a]=dateToString(l,1),s[1][a]=0;for(a=0;a<t.length;a++)(h=Math.floor(daysBetweenDates(r.date0,t[a])))<0||h>=s[1].length||(m?s[1][h]+=n[a]:s[1][h]++);return s}var m=n&&n.length==t.length,y=0==e?7:12,v=0==e?1:30;for(a=0;a<y;a++)if(l=0==a?g:addDaysToDate(g,a*v),(u=new u).name=l.toLocaleString(p,0==e?{weekday:"long"}:{month:"long"}),s.push(u),0==a)if(0==e)for(h=0;h<24;h++)s[0][h]=0==h?"Midnight":12==h?"Noon":String(h>12?h-12:h);else for(h=0;h<31;h++)s[0][h]=String(h+1);for(c=1;c<=y;c++)for(f=0;f<s[0].length;f++)s[c][f]=0;for(a=0;a<t.length;a++)0==e?(c=t[a].getDay(),f=t[a].getHours()):(c=t[a].getMonth(),f=t[a].getDate()-1),m?s[c+1][f]+=n[a]:s[c+1][f]++;return s},transformDateList=function(t,e,n,r){if(null==t)return null;if("sL"==t.type&&(t=toDateList(t)),null==e&&(e=nL.toL([0,1,2])),"nL"!=e.type&&!(e instanceof Array))throw new Error("Invalid input. Second argument must be a nL.");n=null==n?"":n;var o,i,s,a,l=["year","month","day of month","day of week","hour","minute","second","decimal date","day number of year","quarter","decimal hour","day","month","day name","month name","week number in year","day number"],u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];if("dL"==(r=null==r?"2000-01-01":r).type)r=r.getMin();else if("sL"==r.type)r=(r=toDateList(r)).getMin();else if("string"==typeof r)if("earliest"==r)r=t.getMin();else if(r=parseDate(r),isNaN(r))throw new Error("Invalid format for date:"+r);r=clearHoursMinutesSeconds(r),o=e.includes(13)||e.includes(14)?new T:new nT;for(var c=0;c<e.length;c++){var f=e[c];if(a=o.length,isNaN(f)||f%1!=0||f<0||f>16)throw new Error("Invalid output type.");if(11==f)for(i=0;i<7;i++)o.push(new nL),s=""==n?l[f]:n+" "+l[f],o[a+i].name=s+":"+u[i];else if(12==f)for(i=0;i<12;i++)o.push(new nL),s=""==n?l[f]:n+" "+l[f],o[a+i].name=s+":"+h[i];else 13==f||14==f?o.push(new sL):o.push(new nL),o[a].name=""==n?l[f]:n+" "+l[f];for(var p=0;p<t.length;p++){var g=t[p];switch(f){case 0:o[a].push(g.getFullYear());break;case 1:o[a].push(g.getMonth()+1);break;case 2:o[a].push(g.getDate());break;case 3:o[a].push(g.getDay());break;case 4:o[a].push(g.getHours());break;case 5:o[a].push(g.getMinutes());break;case 6:o[a].push(g.getSeconds());break;case 7:o[a].push(getDecimalDate(g));break;case 8:o[a].push(nDayInYear(g));break;case 9:var d=getDecimalDate(g);d=Math.floor(4*(d-Math.floor(d)))+1,o[a].push(d);break;case 10:var m=g.getHours()+(60*g.getMinutes()+g.getSeconds())/3600;m=Number(m.toFixed(5)),o[a].push(m);break;case 11:for(i=0;i<7;i++)g.getDay()==i?o[a+i].push(1):o[a+i].push(0);break;case 12:for(i=0;i<12;i++)g.getMonth()==i?o[a+i].push(1):o[a+i].push(0);break;case 13:o[a].push(dateToString(g,8));break;case 14:o[a].push(dateToString(g,7));break;case 15:o[a].push(getWeekInYear(g));break;case 16:o[a].push(Math.round(daysBetweenDates(r,clearHoursMinutesSeconds(g))))}}}return o},changeTimeResolution=function(t,e,n,r,o){if(null!=t){if(n=null==n?100:n,r=null!=r&&r,o=null==o?0:o,(e=null==e?0:e)!=Math.floor(e)||e<0||e>9)throw new Error("Invalid mode value provided in changeTimeResolution");var i=t.type;if("sL"==t.type?t=toDateList(t):"nL"==t.type&&(t=convertFromDecimalDate(t)),"dL"!=t.type)throw new Error("changeTimeResolution input must be a dL, sL containing dates, or a nL of decimal dates");var s,a,l,u,h=encodeDatesAsNumericFeatures(t,[0,1,2,3,4,5,6,7]),c=h[7].getInterval(),f=convertFromDecimalDate(c.x),p=(convertFromDecimalDate(c.y).getTime()-f.getTime())/1e3,g=[315532800,31536e3,7862400,2678400,604800,86400,3600,60,1];if(0==e)for(e=9,e=9;e>=1;e--){if(r)a=changeTimeResolution(t,e).toNumberList().getWithoutRepetitions().length;else a=p/g[e-1];if(a<=n)break}e<1&&(e=1);var d=new dL;d.name=t.name;var m,y,v,L,w,x,b,M=new sL;M.name=null==t.name?"label":t.name+" label";var _=function(t){return t<10?"0"+t:""+t};for(s=0;s<t.length;s++){switch(m=h[0][s],y=h[1][s]-1,v=h[2][s],L=h[4][s],w=h[5][s],x=h[6][s],e){case 1:m=10*Math.floor(m/10),b=String(m),l=new Date(m,0);break;case 2:l=new Date(m,0),b=String(m);break;case 3:var S=" Q"+(Math.floor(y/3)+1);y=3*Math.floor(y/3),l=new Date(m,y),b=String(m)+S;break;case 4:l=new Date(m,y),b=String(m)+"-"+_(y+1)+"-01";break;case 5:m=(u=new Date(m,y,v-h[3][s])).getFullYear(),y=u.getMonth(),v=u.getDate(),l=new Date(m,y,v),b=String(m)+"-"+_(y+1)+"-"+_(v);break;case 6:l=new Date(m,y,v),b=String(m)+"-"+_(y+1)+"-"+_(v);break;case 7:l=new Date(m,y,v,L),b=String(m)+"-"+_(y+1)+"-"+_(v)+" "+_(L)+":00:00";break;case 8:l=new Date(m,y,v,L,w),b=String(m)+"-"+_(y+1)+"-"+_(v)+" "+_(L)+":"+_(w)+":00";break;case 9:l=new Date(m,y,v,L,w,x),b=String(m)+"-"+_(y+1)+"-"+_(v)+" "+_(L)+":"+_(w)+":"+_(x)}d.push(l),M.push(b)}if("nL"==i?d=d.toNumberList():"sL"==i&&(d=dateToString(d,1)),0==o)return d;var N=new T;if(N.push(d),N.push(M),1==o)return N;a=p/g[e-1];var R={table:N,extra:{numPeriods:a=Number.isInteger(a)?a+1:Math.ceil(a),modeUsed:e,intervalDates:c}};return R.name=t.name+"("+e+")",R}},getElementFromTable=function(t,e,n){return null==t[e]?null:t[e][n]},getSubTable=function(t,e,n,r,o){if(null==t)return t;var i=t.length;if(0===i)return null;var s=new T;r<=0&&(r=i-e+r),e=Math.min(e,i-1),r=Math.min(r,i-e);var a,l,u,h,c,f=t[0].length;if(0===f)return null;for(o<=0&&(o=f-n+o),n=Math.min(n,f-1),o=Math.min(o,f-n),u=e;u<e+r;u++){for(a=t[u],(l=new L).name=t[u].name,h=n;h<n+o;h++)c=a[h],l.push(c);s.push(l.downcast())}return s.downcast()},sliceColumns=function(t,e,n){return"string"==typeof e&&(e=t.getNames().indexOf(e)),null!=n&&"string"==typeof n&&(n=t.getNames().indexOf(n)),t.getSubList(e,n)},filterTable=function(t,e,n,r,o,i,s,a,l){if(null!=t&&0!==t.length&&null!=t[0]){if(t.isList&&!t.isTable){var u=new T;u.push(t),t=u}if(l)return t.getElements(filterList(t.getNames(),e,n,r,o,!0));if(void 0===e&&void 0===n)return s?createSortedNumberList(t[0].length):t;if("!contains"===e&&(void 0===n||""===n))return s?createSortedNumberList(t[0].length):t;null==e&&(e="=c"),"="==e&&(e="=="),e=e.toLowerCase();var h,c,f,p,g,d,m=new nL,y=t.getLengths().getMax(),v=0,L=t.length,w=_typeOf(n),x=null!=r&&!0===r.isList;if(null!=n&&1==n.isList&&n.length>0){var b;a=null==a?0:a,m=filterTable(t,e,n[0],r,o,i,!0);for(var M=1;M<n.length;M++)f=n[M],b=filterTable(t,e,f,r,o,i,!0),m=1==a?intersection(m,b):union(m,b);return s?m:t.getRows(m)}if(x&&r.length!=y)throw new Error("selected L (in listToCheck position) must have same length as table");if(null!=r&&("string"==typeof r&&(r=t.getNames().indexOf(r)),-1==r))throw new Error("do not find any list with such name");null==n?(w="Null",n=""):"string"==w&&String(n)==String(Number(n))&&""!==n.trim()?(w="number",n=Number(n)):"boolean"==w&&(w="string",n=String(n)),"=c"==e&&(e="string"==w?"contains":"=="),"number"!=w||"between"!=e&&"!between"!=e||(isNaN(o)?e="noop":o=Number(o)),"between"!=e&&"!between"!=e||null!=o||(e="noop"),"fuzzy"!=e&&"fuzzywords"!=e||null!=o||(o=50),null!=r&&(v=r,L=r+1),x&&(v=0,L=1),(null==i||!0!==i&&!1!==i)&&(i=!0),"string"==w&&i&&(n=n.toLowerCase(),o=o?String(o).toLowerCase():o),"=="==e&&i&&(e="==i"),"!="==e&&i&&(e="!=i");var _,S=String(n),N=(null==o||String(o),"string"==w),R="number"==w;switch(e){case"==":for(h=0;h<y;h++)for(c=v;c<L;c++)if(!("nL"==(_=x?r:t[c]).type&&N||"sL"==_.type&&R)&&(null==(p=_[h])&&(p=""),p==n)){m.push(h);break}break;case"==i":for(h=0;h<y;h++)for(c=v;c<L;c++)if(("nL"!=(_=x?r:t[c]).type||!N)&&(f=null==_[h]?"":_[h],f="sL"==_.type?f:String(f),(f=i?f.toLowerCase():f)==n)){m.push(h);break}break;case"!=":for(h=0;h<y;h++){for(g=!0,c=v;c<L;c++)if(null==(p=x?r[h]:t[c][h])&&(p=""),p==n){g=!1;break}g&&m.push(h)}break;case"!=i":for(h=0;h<y;h++){for(g=!0,c=v;c<L;c++)if((f=null==(p=x?r[h]:t[c][h])?"":String(p).toLowerCase())==n){g=!1;break}g&&m.push(h)}break;case"contains":for(h=0;h<y;h++)for(c=v;c<L;c++)if(("nL"!=(_=x?r:t[c]).type||!N)&&(f="sL"==_.type?_[h]:String(_[h]),(f=i?f.toLowerCase():f).includes(S))){m.push(h);break}break;case"!contains":for(h=0;h<y;h++){for(g=!0,c=v;c<L;c++)if(p=x?r[h]:t[c][h],(f=i?String(p).toLowerCase():String(p)).includes(S)){g=!1;break}g&&m.push(h)}break;case"init":for(h=0;h<y;h++)for(c=v;c<L;c++)if(p=x?r[h]:t[c][h],0===(f=i?String(p).toLowerCase():String(p)).indexOf(S)){m.push(h);break}break;case"<":case"<=":for(h=0;h<y;h++)for(c=v;c<L;c++)if(p=x?r[h]:t[c][h],w==_typeOf(p)){if((f="string"==w?i?String(p).toLowerCase():String(p):Number(p))<n){m.push(h);break}if(f==n&&"<="==e){m.push(h);break}}break;case">":case">=":for(h=0;h<y;h++)for(c=v;c<L;c++)if(p=x?r[h]:t[c][h],w==_typeOf(p)){if((f="string"==w?i?String(p).toLowerCase():String(p):Number(p))>n){m.push(h);break}if(f==n&&">="==e){m.push(h);break}}break;case"between":for(h=0;h<y;h++)for(c=v;c<L;c++)if(p=x?r[h]:t[c][h],f="string"==w?i?String(p).toLowerCase():String(p):Number(p),"number"==w&&(f=Number(f)),n<=f&&f<=o){m.push(h);break}break;case"!between":for(h=0;h<y;h++)for(c=v;c<L;c++)if(p=x?r[h]:t[c][h],f="string"==w?i?String(p).toLowerCase():String(p):Number(p),"number"==w&&(f=Number(f)),n>f||f>o){m.push(h);break}break;case"unique":var E={};for(h=0;h<y;h++){var C="";for(c=v;c<L;c++)p=x?r[h]:t[c][h],C=C+"|"+(f=i?String(p).toLowerCase():String(p));null==E[C]&&(E[C]=!0,m.push(h))}break;case"fuzzy":case"fuzzywords":if(""==(n=String(n).trim()))break;o=Number(o);var D,O,P,I=new nT(2);for(h=0;h<y;h++)for(c=v;c<L;c++){for(p=x?r[h]:t[c][h],f=i?String(p).toLowerCase():String(p),D="fuzzywords"==e?f.split(" "):[f],O=0,P=0;P<D.length&&O<o;P++)d=100*(1-getLevenshteinDistance(D[P],n,!0)),O=Math.max(O,d);if(O>=o){I[0].push(h),I[1].push(O);break}}m=(I=I.sortRowsByList(1,!1,!0))[0];break;default:if("function"==typeof e)for(h=0;h<y;h++)for(c=v;c<L;c++)if(e.call(this,t[c][h],n,o,r,t,c,h,i)){m.push(h);break}}if(s)return m;var k=new T;k.name=t.name;var F=t.length;for(c=0;c<F;c++)k.push(t[c].getElements(m,!0));return k.downcast()}},filterColumns=function(t,e,n,r,o,i){if(null!=t){for(var s,a,l=new T,u=0;u<t.length;u++)if(s=t[u],a=buildInformationObjectForList(s,!0),!(null!=e&&a.numberDifferentElements<e||null!=n&&a.numberDifferentElements/s.length>n||null!=r&&a.entropy<r||null!=o&&a.entropy>o)){switch(i){case 0:if(!a.isNumeric)continue;break;case 1:if("sL"!=s.type)continue;break;case 2:if(!a.isCategorical)continue;break;case 3:if("integer numbers"!=a.kind)continue;break;case 4:if(a.containsNulls)continue;break;case 5:if(s.includes("")||s.includes(" ")||s.includes("  "))continue;break;case 6:if("nL"!=s.type&&!a.isCategorical)continue}l.push(s)}return l.downcast()}},getSubTableByElementOnList=function(t,e,n){if(null!=t&&null!=e&&null!=n){var r,o,i=t.length;e<0&&(e=i+e),e%=i;var s=instanceSameType(t);for(s.name=t.name,r=0;r<i;r++){var a=new L;a.name=t[r].name,s.push(a)}var l,u=t[e],h=u.length;for(r=0;r<h;r++)if(n==u[r])for(l=s.length,o=0;o<l;o++)s[o].push(t[o][r]);for(i=s.length,r=0;r<i;r++)s[r]=s[r].downcast();return s.downcast()}},getSubTableByElementsOnList=function(t,e,n){if(null!=t&&null!=e&&null!=n){var r,o;e<0&&(e=t.length+e),e%=t.length;var i=instanceSameType(t);i.name=t.name,t.forEach((function(t){var e=new L;e.name=t.name,i.push(e)}));var s=t[e],a=getBooleanDictionaryForList(n);for(r=0;null!=s[r];r++)if(a[s[r]])for(o=0;null!=i[o];o++)i[o].push(t[o][r]);return i.forEach((function(t,e){i[e]=t.downcast()})),i.downcast()}},getRandomRows=function(t,e,n,r,o){if(null==t||null==t[0])return null;if(n=null==n||n,null==e&&(e=.5),e<0)return null;var i,s=t[0].length;i=e<=1?Math.round(e*s):Math.round(e);var a=createSortedNumberList(s,0,1);return a=a.getRandomElements(i,n,o),r||(a=a.getSorted()),t.getRows(a)},transpose=function(t,e,n){return null!=t&&t.isTable?t.transpose(e,n):null},replaceElementInTable=function(t,e,n){if(null!=t){var r,o,i,s,a,l=t.length,u=new T;for(o=0;o<l;o++){for(r=(s=t[o]).length,a=new L,u[o]=a,i=0;i<r;i++)a[i]=s[i]==e?n:s[i];(a=a.downcast()).name=s.name}return u.downcast()}},replaceSectionInTable=function(t,e,n,r,o,i){if(null!=t){var s,a,l,u=null!=n&&n==r,h=null!=o&&o==i;if(null==n&&(n=0),null==r&&(r=t.length-1),null==o&&(o=0),null==i&&(i=t[0].length-1),"string"!=typeof n&&"string"!=typeof r||(s=t.getNames()),"string"==typeof n&&(n=s.indexOf(n)),"string"==typeof r&&(r=s.indexOf(r)),u&&h)return e.isList&&(e=e[0]),e.isList&&(e=e[0]),replaceCellInTable(t,e,n,o);if(u){var c=new T;for(e.isTable&&(e=e[0]),a=0;a<t.length;a++)if(a==n){for(c[a]=new L,c[a].name=t[a].name,l=0;l<t[a].length;l++)c[a][l]=l<o||l>i?t[a][l]:e[l-o];c[a]=c[a].downcast()}else c[a]=t[a];return c.downcast()}if(h){for(c=new T,e.isTable&&(e=e.getRow(0)),a=0;a<t.length;a++)a<n||a>r?c[a]=t[a]:(c[a]=t[a].clone(),c[a][o]=e[a-n],c[a]=c[a].downcast());return c.downcast()}for(c=new T,r=Math.min(r,n+e.length),i=Math.min(i,o+e[0].length),a=0;a<t.length;a++)if(a<n||a>r)c[a]=t[a];else{for(c[a]=new L,c[a].name=t[a].name,l=0;l<t[a].length;l++)c[a][l]=l<o||l>i?t[a][l]:e[a-n][l-o];c[a]=c[a].downcast()}return c.downcast()}},replaceNullsInTable=function(t,e,n,r,o,i){if(null!=t){null!=r&&(e=null==e?0:e),null!=o&&(n=null==n?0:n),r=null==r&&null!=e?0:r,o=null==o&&null!=n?"-":o;var s,a,l,u,h,c,f,p=t.length,g=null!=e&&e.length&&e.isList?e:null,d=null!=o&&o.length&&o.isList?o:null,m=new T;if(g){p=Math.min(p,g.length);var y={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,element:0,previous:1,next:2,average:3,"local average":4,interpolate:5,common:6,median:7}}for(a=0;a<p;a++){for(s=(u=t[a]).length,c=!1,f=!1,l=0;l<s;l++)if(u[l]==i)f=!0;else if("number"!=typeof u[l]&&(c=!0,f))break;f?(h=g?replaceNullsInList(u,y[g[a]],d?d[a%p]:o,i):c?replaceNullsInList(u,3==n?6:n,o,i):replaceNullsInList(u,e,r,i),m[a]=h):m[a]=u}return m.downcast()}},testClassificationModel=function(t,e,n,r){if(null==t||null==e||null==n)return null;r=r||0;var o=0;return e.forEach((function(e,r){n(t[0][r],t[1][r])!=e&&o++})),o/e.length},getRows=function(t,e){var n,r,o=new T;o.name=t.name;for(var i=0;null!=t[i];i++){(r=instanceSameType(n=t[i])).name=n.name;for(var s=0;null!=e[s];s++)r[s]=n[e[s]];o[i]=r.downcast()}return o},sortListsByNumberList=function(t,e,n){null==n&&(n=!0);var r=instantiate(_typeOf(t));r.name=t.name;var o,i=t.length,s=e.clone();for(o=0;o<s.length;o++)s[o]=o;for(s=sortListByNumberList(s,e,n),o=0;o<i;o++){r[o]=t[o].clone();for(var a=0;a<s.length;a++)r[o][a]=t[o][s[a]]}return r},aggregateTable=function(t,e,n,r,o,i,s,a){if(e=e||0,null!=t&&(null==n&&(n=createSortedNumberList(t.length)),null==r&&(r=createListWithSameElement(t.length,9)),"sL"==n.type&&(n=t.getNames().indexesOfElements(n)),"nL"!=n.type&&Array.isArray(n)&&(n=nL.toL(n)),"string"==typeof e&&(e=t.getNames().indexOf(e)),t.length&&!(t.length<e)&&null!=n&&n.length&&null!=r)){if(null!=s&&3==s.length){var l;n=n.clone(),r=r.clone();for(var u=0;u<t.length;u++)n.includes(u)||(n.push(u),(l=buildInformationObjectForList(t[u])).isNumericCategorical?r.push(s[0]):l.isNumeric?r.push(s[1]):r.push(s[2]))}if(null!=e.length)if(e.length==t[0].length)L=e;else{if(0!=e.length){var h,c,f=t.getColumns(e),p=(f.getTypes(),new sL);for(b=f[0].length,u=0;u<b;u++){for(h=f[0][u],c=1;c<f.length;c++)h+="*__*"+f[c][u];p[u]=h}x=new T.toL([p].concat(t.getElements(n)));var g=new nL,d=new nL;g[0]=0,d[0]=0,null!=o&&(o=o.clone()).unshift("_");for(u=0;u<n.length;u++)g.push(n[u]+1),d.push(r[u]);var m=createSortedNumberList(x.length-1,1);return x=aggregateTable(x,0,m,d,o)}e=e[0]}var y,v,L=null==L?t[e]:L,w=getIndexesTable(L),x=new T,b=n.length;for(u=0;u<b;u++)v=t[n[u]],y=aggregateList(L,v,u<r.length?r[u]:1,w,i,a)[1],o&&u<o.length?y.name=o[u]:y.name=v.name,x.push(y);return x.downcast()}},disAggregateTable=function(t,e,n,r=","){if(null!=t&&null!=n){"number"==typeof e&&(e=[e]);var o=null==e?t:t.getColumns(e),i=t.get(n),s=new L;s.name=i.name;for(var a,l=new T,u=0;u<o.length;u++)l[u]=instanceSameType(o[u]),l[u].name=o[u].name;for(l.push(s),u=0;u<o[0].length;u++){a=sL.toL(String(i[u]).split(r)).trim();for(var h=0;h<a.length;h++){for(var c=0;c<o.length;c++)l[c].push(o[c][u]);s.push(String(Number(a[h]))==a[h]?Number(a[h]):a[h])}}return s=s.downcast(),l}},deSegmentTable=function(t,e,n){for(var r=normalizeToSum(e,(n=null==n?10:n)*e.length),o=new T,i=0;i<t.length;i++)o[i]=instanceSameType(t[i]),o[i].name=t[i].name;var s=new nL;o.push(s),s.name="weight per item";var a,l,u=new nL;o.push(u),u.name="count repetitions segment";for(var h=0;h<r.length;h++){a=Math.round(r[h]),l=e[h];for(var c=0;c<a;c++){for(i=0;i<t.length;i++)o[i].push(t[i][h]);s.push(l/a),u.push(a)}}return o},pivotTable=function(t,e,n,r,o,i,s,a,l){if(null!=t&&t.length&&null!=e&&null!=n&&null!=r){var u,h,c,f=e.isList?e:t.get(e),p=n.isList?n:t.get(n);switch(r=r.isList?r:t.get(r),o=null==o?1:o,s=s||0,i){case 0:case 3:l=null;break;case 1:l=0}var g,d,m=new T;if(1==s){var y={},v={};switch(f.forEach((function(t,e){u=p[e],h=String(t)+""+String(u),null==y[h]&&(y[h]=new nL,v[h]=new L),y[h].push(e),v[h].push(r[e])})),m[0]=new L,m[1]=new L,o){case 0:m[2]=new L;break;case 1:case 2:case 3:m[2]=new nL}for(h in y)switch(c=y[h],m[0].push(f[c[0]]),m[1].push(p[c[0]]),o){case 0:m[2].push(r[c[0]]);break;case 1:m[2].push(c.length);break;case 2:case 3:g=0,c.forEach((function(t){g+=r[t]})),3==o&&(g/=c.length),m[2].push(g)}if(m[0]=m[0].downcast(),m[1]=m[1].downcast(),0===o)m[2]=m[2].downcast();return m[0].name=f.name,m}m[0]=new L;var w,x,b,M,_={},S={};f.forEach((function(t,e){if(u=p[e],b=r[e],null==(x=_[String(t)])&&(m[0].push(t),x=m[0].length-1,_[String(t)]=x),null==(w=S[String(u)])){switch(o){case 0:case 1:case 2:case 3:case 4:case 5:M=new L}m.push(M),M.name=String(u),w=m.length-1,S[String(u)]=w}switch(o){case 0:null==m[w][x]&&(m[w][x]=b);break;case 1:null==m[w][x]&&(m[w][x]=0),m[w][x]++;break;case 2:null==m[w][x]&&(m[w][x]=0),m[w][x]+=b;break;case 3:null==m[w][x]&&(m[w][x]=[0,0]),m[w][x][0]+=b,m[w][x][1]++;break;case 4:null==m[w][x]&&(m[w][x]=b),m[w][x]=Math.min(b,m[w][x]);break;case 5:null==m[w][x]&&(m[w][x]=b),m[w][x]=Math.max(b,m[w][x])}}));var N=!1;switch(o){case 0:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(t,e){null==m[d][e]&&(m[d][e]=l)})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0);break;case 1:case 2:case 4:case 5:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(t,e){null==m[d][e]&&(m[d][e]=l)})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0);break;case 3:for(d=1;d<m.length;d++)null==m[d]&&(m[d]=new L),m[0].forEach((function(t,e){null==m[d][e]?m[d][e]=l:m[d][e]=m[d][e][0]/m[d][e][1]})),m[d]=m[d].downcast(),"L"==m[d].type&&(N=!0)}if(i&&N&&(m=replaceNullsInTable(m,5)),1==a){var R=m.slice(1),E=m.getNames().getSubList(1);"nL"==p.type&&(E=E.toNumberList()),R=L.toL(R).getSortedByList(E);var C=new T;return C[0]=m[0],m=C.concat(R)}return m[0]=m[0].downcast(),m.downcast()}},unpivotTable=function(t,e,n){var r,o=t.get(e),i=t.getColumns(n),s=new T;s[0]=new L,s[0].name=o.name,s[1]=new sL,s[1].name="variables",s[2]=new L,s[2].name="value";for(var a=0;a<o.length;a++){r=o[a];for(var l=0;l<i.length;l++)s[0].push(r),s[1].push(i[l].name),s[2].push(i[l][a])}return s[0]=s[0].downcast(),s[2]=s[2].downcast(),s.downcast()},getCountPairsMatrix=function(t,e,n,r,o){if(null==t||t.length<2||null==t[0]||null==t[0][0])return null;var i,s;if(e=null!=e&&e,n=null==n?0:n,0==(r=null==r?0:r))i=t[0].getWithoutRepetitions(),s=t[1].getWithoutRepetitions(),e&&(i=(i=i.concat(s)).getWithoutRepetitions(),s=i);else if(1==r)if(e){var a=(i=t[0].concat(t[1])).getFrequenciesTable(!0);s=i=a[0]}else{a=t[0].getFrequenciesTable(!0);i=a[0],a=t[1].getFrequenciesTable(!0),s=a[0]}else if(2==r){if(e)a=(a=(i=t[0].concat(t[1])).getFrequenciesTable(!0)).sortRowsByList(0,!0),s=i=a[0];else a=(a=t[0].getFrequenciesTable(!0)).sortRowsByList(0,!0),i=a[0],a=(a=t[1].getFrequenciesTable(!0)).sortRowsByList(0,!0),s=a[0]}if(null!=o&&!isNaN(o)&&o>0){var l=createSortedNumberList(o);i.length>o&&(i=i.getElements(l)),s.length>o&&(s=s.getElements(l))}var u,h,c=new nT(s.length);if(s.forEach((function(t,e){c[e].name=String(t),i.forEach((function(t,n){c[e][n]=0}))})),t[0].forEach((function(e,n){var r=t[1][n];h=s.indexOf(r),-1!=(u=i.indexOf(e))&&-1!=h&&c[h][u]++})),0!=n){for(var f=0,p=0;p<c.length;p++)c[p]._max=c[p].getMax(),f=Math.max(f,c[p]._max);if(1==n&&0!=f)for(p=0;p<c.length;p++)for(var g=0;g<c[p].length;g++)d=(f-c[p][g])/f,c[p][g]=Number(d.toFixed(5));else if(2==n&&0!=f){var d;for(p=0;p<c.length;p++)for(g=0;c[p]._max>0&&g<c[p].length;g++)d=(c[p]._max-c[p][g])/c[p]._max,c[p][g]=Number(d.toFixed(5))}else if(3==n){var m;for(g=0;g<c[0].length;g++){m=0;for(p=0;p<c.length;p++)m+=c[p][g];for(p=0;0!=m&&p<c.length;p++)d=c[p][g]/m,c[p][g]=Number(d.toFixed(5))}}}var y=new T;return i.name=t[0].name,y.push(i),c=y.concat(c)},getPairsFrequencyTable=function(t){if(null==t||t.length<2||null==t[0]||null==t[0][0]||t[0].length!=t[1].length)return null;for(var e={},n=0;n<t[0].length;n++){var r=e[t[0][n]];null==r&&(r={sL:new L,c:0,s:t[0][n]},e[t[0][n]]=r),r.sL.push(t[1][n]),r.c++}var o=[];for(r in e)o.push(e[r]);o=o.sort((function(t,e){var n=e.c-t.c;return 0!=n?n:t.s<e.s?1:-1}));var i,s=new T;for(s[0]=instanceSameType(t[0]),s[0].name=""==t[0].name?"L 1":t[0].name,s[1]=instanceSameType(t[1]),s[1].name=""==t[1].name?"L 2":t[1].name,s[2]=new nL,s[2].name="Combination Frequency",n=0;n<o.length;n++){i=(r=o[n]).sL.getFrequenciesTable(!0);for(var a=0;a<i[0].length;a++)s[0].push(r.s),s[1].push(i[0][a]),s[2].push(i[1][a])}return s},concatenateRowElements=function(t,e){if(null==t||!t.isTable)return null;e=null==e?" ":e;var n,r,o,i=new i,s=t.getLengths().getMax(),a=!0;for(r=0;r<s;r++){for(n="",o=0;o<t.length;o++)o>0&&(n+=e),void 0!==t[o][r]&&(n+=String(t[o][r]),0==r&&(o>0&&(i.name+=e),i.name+=String(t[o].name),a=a&&0==String(t[o].name).length));i.push(n)}return a&&(i.name=""),i},filterTableByElementInList=function(t,e,n,r){if(!(null==t||t.length<=0||null==e)){if(null==n)return t;if(r=null==r||r,"string"==typeof e){var o=t.getNames().indexOf(e);if(-1==o)throw new Error("The table doesn't contain a list with name "+e);e=o}var i,s,a=new T,l=t.length,u=t[0].length;for(a.name=t.name,s=0;s<l;s++)a[s]=instanceSameType(t[s]),a[s].name=t[s].name;if(r){for(i=0;i<u;i++)if(t[e][i]==n)for(s=0;s<l;s++)a[s].push(t[s][i])}else for(i=0;i<u;i++)if(t[e][i]!=n)for(s=0;s<l;s++)a[s].push(t[s][i]);for(s=0;s<l;s++)"nL"!=a[s].type&&(a[s]=a[s].downcast());return a}},filterTableByElementsInList=function(t,e,n,r){if(!(null==t||t.length<=0||null==e)){if(null==n||0===n.length)return t;if(r=null==r||r,"string"==typeof e){var o=t.getNames().indexOf(e);if(-1==o)throw new Error("The table doesn't contain a list with name "+e);e=o}var i,s,a=getBooleanDictionaryForList(n),l=new T,u=t.length,h=t[0].length;for(l.name=t.name,s=0;s<u;s++)l[s]=new L,l[s].name=t[s].name;if(r){for(i=0;i<h;i++)if(a[t[e][i]])for(s=0;s<u;s++)l[s].push(t[s][i])}else for(i=0;i<h;i++)if(!a[t[e][i]])for(s=0;s<u;s++)l[s].push(t[s][i]);for(s=0;s<u;s++)l[s]=l[s].downcast();return l}},selectRows=function(t,e,n,r,o){if(!(null==t||t.length<=0)){if(r=null==r||r,o=null!=o&&o,null==e||null==n||null==e.length)return r?t:null;if(Array.isArray(n)||(n=[n]),e.length==n.length||1==e.length){var i=new nL,s=t[0].length,a=1==e.length&&n.length>1,l={};a&&(l=getBooleanDictionaryForList(n));for(var u=0;u<s;u++){for(var h=!0,c=0;c<e.length&&h;c++){if(isNaN(e[c])||e[c]<0||e[c]>=t.length)return;t[e[c]][u]!=n[c]&&(h=!1,a&&l[t[e[c]][u]]&&(h=!0))}h&&i.push(u)}if(o){if(r)return i;var f=createSortedNumberList(t[0].length);return difference(f,i)}return r?t.getRows(i):t.getWithoutRows(i)}}},joinTables=function(t,e,n,r,o){if(null!=t&&null!=e){var i,s,a=new T;if(n=null==n?0:n,r=null==r?0:r,2==(o=null==o?0:o)){var l=joinTables(e,t,r,n,1),u=[0];for(let t=e.length;t<l.length;t++)u.push(t);for(let t=1;t<e.length;t++)u.push(t);return l.getColumns(u).downcast()}if("string"==typeof n){if(null==(i=t.get(n)))throw Error("the table doesn't contain a list with name "+n);n=t.indexOf(i)}else n<0&&(n+=t.length),i=t[n%=t.length];if("string"==typeof r){if(null==(s=e.get(r)))throw Error("the table doesn't contain a list with name "+r);r=e.indexOf(s)}else r<0&&(r+=e.length),s=e[r%=e.length];var h,c,f,p,g,d,m=getIndexesDictionary(s),y=t.length,v=e.length,w=i.length,x=new L;for(x.name=i.name,a[0]=x,g=0;g<y;g++)g!=n&&((d=new L).name=t[g].name,d._list0=!0,d._listOnTable=t[g],a.push(d));for(g=0;g<v;g++)g!=r&&((d=new L).name=e[g].name,d._list0=!1,d._listOnTable=e[g],a.push(d));for(f=0;f<w;f++)if(null!=(c=m[h=i[f]]))for(p=0;p<c.length;p++)for(x.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?a[g]._listOnTable[f]:a[g]._listOnTable[c[p]]);else if(1==o||3==o)for(x.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?a[g]._listOnTable[f]:null);if(3==o){var b=getBooleanDictionaryForList(i);for(f=0;f<s.length;f++)if(!b[h=s[f]])for(x.push(h),g=1;g<a.length;g++)a[g].push(a[g]._list0?null:a[g]._listOnTable[f])}for(f=0;f<a.length;f++)delete a[f]._list0,delete a[f]._listOnTable,a[f]=a[f].downcast();return a.downcast()}},joinMultipleTables=function(t,e,n){if(null!=t&&null!=e){if(t.length<2)throw new Error("listOfTables must have at least two tables");if(e.length!=t.length)throw new Error("listOfIndexes must have same length as listOfTables");if(null==t[0])throw new Error("listOfTables[0] is null");if(null==t[1])throw new Error("listOfTables[1] is null");var r,o=joinTables(t[0],t[1],e[0],e[1],n),i=t.length;for(r=2;r<i;r++)o=joinTables(o,t[r],0,e[r],n);return o}},combineLists=function(t,e){if(null==t)return null;e=null==e||e;for(var n=new T,r=new T,o=new nL,i=new nL,s=1,a=0;a<t.length;a++)r[a]=new L,n[a]=t[a].getWithoutRepetitions(),o[a]=0,i[a]=n[a].length,s*=i[a];if(e||s>1e5)return s;for(a=0;a<s;a++){for(var l=0;l<t.length;l++)r[l].push(n[l][o[l]]);var u=!0;for(o[l=0]++,u=o[l]>=i[l];u&&l<t.length;)o[l]=0,o[l+1]++,u=o[++l]>=i[l]}for(l=0;l<t.length;l++)r[l]=r[l].downcast();return r.downcast()},completeTable=function(t,e,n){n=void 0===n?0:n;var r,o,i,s=new T;s.name=t.name;for(var a=0;a<t.length;a++){for((o=null==(r=t[a])?getNewListForObjectType(n):instanceSameType(r)).name=null==r?"":r.name,i=0;i<e;i++)o[i]=null==r||null==r[i]?n:r[i];s[a]=o}return s},getNumberTableFromTable=function(t){if(null==t||t.length<=0)return null;var e,n=new nT;for(n.name=t.name,e=0;null!=t[e];e++)"nL"==t[e].type&&n.push(t[e]);return n},getVariablesInformationGain=function(t,e){if(null==t)return null;var n=new nL;return t.forEach((function(t){n.push(getInformationGain(t,e))})),n},splitTableByCategoricList=function(t,e,n){if(null==t||null==e)return null;var r,o=e.isList?e:t.get(e),i=new L,s={};return o.forEach((function(e,n){null==(r=s[e])&&((r=new T).name=String(e),s[e]=r,i.push(r),t.forEach((function(t,e){r[e]=instanceSameType(t),r[e].name=t.name})),r._element=e),t.forEach((function(e,o){r[o].push(t[o][n])}))})),n?s:i},buildCorrelationsNetwork=function(t,e,n,r,o,i,s,a,l){if(null==t)return null;var u,h;e=null==e||Boolean(e),o=null==o?.9:o,i=Boolean(i),s=null==s?0:s,l=null==l?3:l;var c,f,p,g,d,m,y,v,w,x,b,T=t.length,M=t[0].length,_=!1,S=!1,N=new Net,R=new sL,E=e?M:T,C=0,D=0;for(u=0;u<T;u++)"nL"==(x=t[u].type)?(R[u]="numbers",C++):"sL"==x&&t[u].getWithoutRepetitions().length/t[u].length>.8?(R[u]="texts"):(R[u]="categories",D++);if(null!=r&&null!=(v=r.isList?r:t.get(r))&&(w="cL"===v.type?v:"nL"===v.type?createColorListFromNumberList(v,blueToRed,0):createCategoricalColorListForList(v)[0].value),null!=a&&(b=new nL,"number"==_typeOf(a)?a<=T&&"nL"!=(b=t[a]).type&&(b=null):a.isList&&"nL"==a.type&&a.length>=E&&(b=a)),null==n||n.isList||(n=t.get(n)),e){for(u=0;u<M;u++){for((c=new Nd(g="_"+u,null==n?g:n[u])).i=u,c.row=t.getRow(u),c.numbers=new nL,c.categories=new L,c.texts=new sL,null!=w&&(c.color=w[u]),null!=b&&(c.weight=b[u]),h=0;h<T;h++)switch(R[h]){case"numbers":c.numbers.push(c.row[h]),S=!0;break;case"categories":c.categories.push(c.row[h]),_=!0;break;case"texts":c.texts.push(c.row[h]),!0}0===s?c.numbers.sd=c.numbers.getStandardDeviation():c.numbers.norm=c.numbers.getNorm(),N.addNode(c)}var O;for(u=0;u<M;u++){for(c=N.nodes[u],O=new nL,h=0;h<M;h++)2!=s&&h<u+1||(f=N.nodes[h],d=S?0===s?numericCorrelation(c.numbers,f.numbers,c.numbers.sd,f.numbers.sd):cosineSimilarity(c.numbers,f.numbers,c.numbers.norm,f.numbers.norm):0,m=_?2*Math.pow(jaccardIndex(c.categories,f.categories),.2)-1:0,y=S&&_?(d*C+m*D)/(C+D):S?d:m,2==s?O.push(u==h?0:y):(i&&Math.abs(y)>o||!i&&y>o)&&((p=new Rel(g=u+"_"+h,null==n?g:c.name+"_"+f.name,c,f,Math.abs(y)-.9*o)).color=y>0?"blue":"red",p.pearson=d,p.jaccard=m,N.addRelation(p)));if(2==s){var P=N.nodes.getSortedByList(O,!1);for(O=O.getSorted(!1),h=0;h<l;h++)p=new Rel(g=u+"_"+(f=P[h]).id,null==n?g:c.name+"_"+f.name,c,f,O[h]),N.addRelation(p)}}}else if("nT"==t.type){for(u=0;u<T;u++)c=new Nd("list_"+u,null==t[u].name||""==t[u].name?"list_"+u:t[u].name),N.addNode(c),c.i=u,c.numbers=t[u],null!=w&&(c.color=w[u]),null!=b&&(c.weight=b[u]);for(u=0;u<T;u++)for(c=N.nodes[u],h=u+1;h<T;h++)f=N.nodes[h],y=d=numericCorrelation(c.numbers,f.numbers),(i&&Math.abs(y)>o||!i&&y>o)&&((p=new Rel(g=u+"_"+h,c.name+"_"+f.name,c,f,Math.abs(y)-.9*o)).color=y>0?"blue":"red",p.pearson=d,N.addRelation(p))}return N},buildSimpleDecisionTree=function(t,e,n,r,o,i,s,a){if(null!=t&&null!=e){for(var l,u,h=new T,c=e.isList?e:t.get(e),f=0;f<t.length;f++)t[f]!=c&&((l=buildInformationObjectForList(t[f],!0)).isCategorical?h.push(t[f]):l.isNumeric&&(u=t[f].getQuantiles(3,3),h.push(u)));return l=buildInformationObjectForList(c,!0),buildDecisionTree(h,c,n,r,o,i,s,a)}},buildDecisionTree=function(t,e,n,r,o,i,s,a){if(null!=t&&null!=e){if(null==a&&(a=blueWhiteRed),"number"==_typeOf(e)){var l=t.getWithoutElementAtIndex(e);e=t.get(e),t=l}r=null==r?.1:r,o=o||10,i=i||.002;var u=createSortedNumberList(e.length),h=new Tr;return h.supervisedValue=n,null==n&&(h._colorDic=createCategoricalColorListForList(e)[4].value),_buildDecisionTreeNode(h,t,e,0,r,o,i,null,null,n,u,s,a),h.leavesWeights=h.getLeaves().getPropertyValues("weight"),h.sumWeightsLeaves=h.leavesWeights.getSum(),h.supervised=e,h}},_buildDecisionTreeNode=function(t,e,n,r,o,i,s,a,l,u,h,c,f){var p=null==u;if(p){var g=n.getFrequenciesTable(!0);u=g[0][0]}var d=getListEntropy(n,u),m=0,y=0,v=0;d>=o&&(v=getVariablesInformationGain(e,n)).forEach((function(t,e){t>m&&(m=t,y=e)}));var L=d>=o&&m>s&&n.length>=i&&r<9&&n._P_valueFollowing>0&&n._P_valueFollowing<1,w=new Nd(t.nodes.getNewId(),(null==l?"":l+":")+(L?e[y].name:"P="+n._biggestProbability+"("+n._mostRepresentedValue+")"));if(t.addNodeToTree(w,a),null==a&&(t.informationGainTable=new T,t.informationGainTable[0]=e.getNames(),v&&(t.informationGainTable[1]=v.clone(),t.informationGainTable=t.informationGainTable.sortRowsByList(v,!1))),w.entropy=d,w.weight=n.length,w.supervised=n,w.supervisedValue=u,w.indexes=w.indexesOnTable=h,w.value=l,w.fromList=null==a?"":a.bestFeatureName,w.mostRepresentedValue=n._mostRepresentedValue,w.biggestProbability=n._biggestProbability,w.valueFollowingProbability=n._P_valueFollowing,w.lift=w.valueFollowingProbability/t.nodes[0].valueFollowingProbability,w.i=t.nodes.length-1,""==w.fromList)w.filter={};else{if(w.filter={column:w.fromList},w.value&&w.value.includes&&w.value.includes("-")){var x=w.value.split("-");String(Number(x[0]))==x[0]&&String(Number(x[1]))==x[1]&&(w.filter.type="range",w.filter.value=[!0,Number(x[0]),!0,Number(x[1])])}null==w.filter.type&&(w.filter.type="in_array",w.filter.value=[w.value])}w.filters=[];var b=function(t){t.parent&&b(t.parent),t.filter.column&&w.filters.push(t.filter)};if(b(w),p){for(var M=new cL,_=0;_<g[0].length;_++)M[_]=t._colorDic[g[0][_]];w._color=w.color=interpolateColors("white",colorsLinearCombination(M,g[1]),w.valueFollowingProbability)}else w._color=w.color=f(1-w.valueFollowingProbability);if(c){var S=document.createElement("canvas");S.width=150,S.height=100;var N=S.getContext("2d");N.clearRect(0,0,150,100),_decisionTreeGenerateColorsMixture(N,150,100,["blue","red"],w.mostRepresentedValue==u?[Math.floor(w.biggestProbability*w.weight),Math.floor((1-w.biggestProbability)*w.weight)]:[Math.floor((1-w.biggestProbability)*w.weight),Math.floor(w.biggestProbability*w.weight)]);var R=new Image;R.src=S.toDataURL(),w.pattern=N.createPattern(R,"repeat")}if(!L)return w.isLeaf=!0,w.label=Math.floor(100*w.valueFollowingProbability)/100,w;w.isLeaf=!1,w.bestFeatureName=e[y].name,w.bestFeatureName=""===w.bestFeatureName?"list "+y:w.bestFeatureName,w.iBestFeature=y,w.informationGain=m,w.label=w.bestFeatureName;var E,C,D,O=e.concat([n,h]);return splitTableByCategoricList(O,e[y]).forEach((function(e){E=e.getSubList(0,e.length-3),C=e[e.length-2],D=e[e.length-1],_buildDecisionTreeNode(t,E,C,r+1,o,i,s,w,e._element,p?null:u,D,c,f)})),w.to=w.to.getSortedByProperty("valueFollowingProbability",!1),w},_decisionTreeGenerateColorsMixture=function(t,e,n,r,o){var i,s,a,l=createListWithSameElement(o[0],r[0]);for(a=1;null!=r[a];a++)l=l.concat(createListWithSameElement(o[a],r[a]));for(i=0;i<e;i++)for(s=0;s<n;s++)a=4*(i+s*e),t.fillStyle=l.getRandomElement(),t.fillRect(i,s,1,1)},allListsSameLength=function(t){if(null==t)return null;var e,n=t.length,r=t[0].length;for(e=1;e<n;e++)if(t[e].length!=r)return!1;return!0},getListsWithoutRepetition=function(t){if(null!=t){var e,n=t.length,r=new T;for(e=0;e<n;e++)r[e]=t[e].getWithoutRepetitions();return r.downcast()}},getNumberOfDifferentElementsOfLists=function(t,e){if(null!=t){var n,r=t.length,o=new nL;for(o.name="(proportion)",n=0;n<r;n++)o[n]=t[n].countDifferentElements(),e&&(o[n]/=t[n].length);return o}},buildInformationObjectForTable=function(t,e){if(null!=t){if(1==(e=null==e||e)&&null!=t.infoObject)return t.infoObject;var n,r,o=t.length,i=999999999999,s=-999999999999,a=0,l=!0,u={type:t.type,name:t.name,length:o,kind:"mixed",allListsSameLength:!0,allListsSameSize:!0,allListsSameType:!0,allListsSameKind:!0,listsInfoObjects:new L,names:new sL,lengths:new nL,types:new sL,kinds:new sL};for(n=0;n<o;n++)r=buildInformationObjectForList(t[n],e),u.listsInfoObjects[n]=r,r.containsNulls&&(u.containsNulls=!0),u.names[n]=r.name,u.types[n]=r.type,u.kinds[n]=r.kind,u.lengths[n]=r.length,"categories"!=r.kind&&"integer numbers"!=r.kind&&(l=!1),n>0&&(u.lengths[n]!=u.lengths[n-1]&&(u.allListsSameLength=!1),u.types[n]!=u.types[n-1]&&(u.allListsSameType=!1),u.kinds[n]!=u.kinds[n-1]&&(u.allListsSameKind=!1),u.lengths[n]!=u.lengths[n-1]&&(u.allListsSameType=!1)),"nL"==r.type&&(i=Math.min(i,r.min),s=Math.min(s,r.max),a+=r.average);if(0!==a&&(a/=u.length),u.allListsSameLength)u.minLength=u.lengths[0],u.maxLength=u.lengths[0],u.averageLength=u.lengths[0];else{var h=u.lengths.getInterval();u.minLength=h.x,u.maxLength=h.y,u.averageLength=.5*(h.x+h.y)}if(u.allListsSameKind)switch(u.kinds[0]){case"numbers":u.kind="numbers";break;case"integer numbers":u.kind="integer numbers";break;case"texts":u.kind="texts";break;case"categories":u.kind="categories"}else l?u.kind="integers and categories":u.allListsSameType&&"nL"==u.types[0]&&(u.kind="numbers");return t.infoObject=u,u}},getCategoricalLists=function(t){buildInformationObjectForTable(t);for(var e=new T,n=0;n<t.length;n++)t[n].infoObject.isCategorical&&e.push(t[n]);return e.downcast()},getTableSimplified=function(t,e,n,r){if(null==t||!(t.length>0))return null;var o;e=e||20;var i=t.length,s=new T;for(s.name=t.name,o=0;o<i;o++)s.push("nL"===t[o].type?t[o].getNumbersSimplified(1==r?6:2,e):t[o].getSimplified(e,n));return s.downcast()},concatTables=function(t,e){if(null!=t&&null!=e&&t.length==e.length){for(var n=new T,r=0;r<t.length;r++)n[r]=t[r].concat(e[r]),n[r].name=t[r].name;return n.downcast()}},concatRows=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;if(1==arguments.length)return arguments[0];var t,e,n,r,o,i=0;for(t=0;t<arguments.length;t++)if(null!=arguments[t]&&(i=Math.max(i,arguments[t].length),!arguments[t].isTable))return null;for(t=0;t<arguments.length;t++)if(null!=arguments[t]){var s=(n=arguments[t]).getLengths(),a=s.getMax(),l=s.getMin();for(a!=l&&(n=completeTable(n,a,null));n.length<i;)n.push(createListWithSameElement(a,null,""));if(0==t)r=n.clone();else for(e=0;e<r.length;e++)o=r[e].name,r[e]=r[e].concat(n[e]),r[e].name=""!=o?o:n[e].name}return r},concatLists=function(t){if(null!=t){for(var e=t[0],n=1;n<t.length;n++)e=e.concat(t[n]);return e}},unionListsFromTables=function(t){if(null!=t){var e,n,r,o=t[0].getWithoutRepetitions(),i=t.length;for(e=1;e<i;e++)for(r=t[e].length,n=0;n<r;n++)o.includes(t[e][n])||o.push(t[e][n]);return o}},intersectListsFromTables=function(t){if(null!=t){var e,n=t[0].getWithoutRepetitions(),r=t.length;for(e=1;e<r;e++)n=intersection(n,t[e]);return n}},encodeStringLists=function(t,e,n,r){if(null!=t){e=null==e?0:e,n=null==n?20:n,r=null==r||r;var o,i,s,a,l,u=new T;for(buildInformationObjectForTable(t,!0),o=0;o<t.length;o++)if(a=!1,"nL"!=(l=t[o]).type){if("sL"!=l.type&&(l=l.toStringList(),buildInformationObjectForList(l)),l.infoObject.numberDifferentElements<2||l.infoObject.numberDifferentElements>n)a=!0;else{for(s=encodeStringsAsNumericFeatures(l,e),i=0;i<s.length;i++)s[i].name=l.name+":"+s[i].name;u=concat(u,s)}a&&!r&&u.push(l.clone())}else u.push(l.clone());return u}},translateListsWithDictionary=function(t,e,n,r){if(null!=t&&null!=e){for(var o=new T,i=0;i<t.length;i++)o[i]=mapWithTable(t[i],e,n,r);return o.downcast()}},getModes=function(t,e=!0){if(null==t)return;e||(t=t.transpose());let n=toL(t.map((t=>t.getMode()))).downcast();return n.name="mode",n},getSubTables=function(t,e){if(null!=t){var n=new L;n.name="subtables";for(var r=0;r<e.length;r++)n.push(t.getColumns(e[r]));return n}},mapFunctionOnLists=function(t,e,n,r,o,i,s,a,l){if(null!=t){for(var u=new L,h=t.length,c=0;c<h;c++)u.push(mapWithFunction(t[c],e,n,r,null,o,i,s,a,l));return u.downcast()}},mapFunctionsOnLists=function(t,e,n,r,o,i,s,a,l){if(null!=t){for(var u=new L,h=Math.min(t.length,e.length),c=0;c<h;c++)u.push(mapWithFunction(t[c],e[c],n,r,null,o,i,s,a,l));return u.downcast()}},useVariablesDictionary=function(t,e){if(null!=t&&null!=e){for(var n=e.get("name",null,null,!0)||e[0],r=e.get("label",null,null,!0)||e[1],o=e.get("description",null,null,!0)||e[2],i=e.get("category",null,null,!0)||e[3],s=e.get("relevance",null,null,!0)||e[4],a=t.getNames(),l=(getFirstOccurrenceDictionaryForList(a),getFirstOccurrenceDictionaryForList(n)),u=(a.length,0);u<t.length;u++){var h=l[t[u].name];null!=h&&(t[u].label=r[h],t[u].description=o[h],t[u].category=i[h],t[u].relevance=s[h])}return t}},matrixToTwoColumns=function(t){var e=new T;e[0]=new sL,e[0].name=t[0].name,e[1]=new sL,e[1].name="related with";for(var n=1;n<t.length;n++)for(var r=0;r<t[0].length;r++)for(var o=0;o<t[n][r];o++)e[0].push(String(t[0][r])),e[1].push(t[n].name);return e},_preserveOrder=function(t,e){var n=e.getNames(),r=t.getNames().getWithoutElements(n);return t.getColumns(n.concat(r))},concatStrings=function(t,e){return null==e&&(e=""),sL.toL(t.join(e))},join=function(t,e="",n="",r="",o){if(null!=t)return o&&(e="\n"),n+t.join(e)+r},cleanTexts=function(t,e,n,r,o,i,s,a,l){if(null==t)return null;var u=new sL;u.name=t.name;for(var h=0;h<t.length;h++)u[h]=cleanText(t[h],e,n,r,o,i,s,a,l);return u},filterStringListByString=function(t,e,n,r){if(null==t||null==e)return null;var o,i,s=r?new nL:new sL,a=t.length;for(n&&(i=new RegExp("\\b"+e+"\\b")),o=0;o<a;o++)n?t[o].match(i).length>0&&s.push(r?o:t[o]):-1!=t[o].indexOf(e)&&s.push(r?o:t[o]);return s},replaceStringsInTexts=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;var o,i,s=t.length,a=e.length;for(o=0;o<s;o++)if(r[o]=t[o],null!=r[o])for(i=0;i<a;i++)r[o]=replaceStringInText(r[o],e[i],n);return r},replaceStringInTexts=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;var o,i=t.length;for(o=0;o<i;o++)r[o]=null==t[o]?null:replaceStringInText(t[o],e,n);return r},replaceStringsInTextsByStrings=function(t,e,n){if(null==t||null==e||null==n)return null;var r=new sL;r.name=t.name;var o,i,s=t.length,a=e.length;for(o=0;o<s;o++)if(r[o]=t[o],null!=r[o])for(i=0;i<a;i++)r[o]=replaceStringInText(r[o],e[i],n[i]);return r},countStringsOccurrencesOnTexts=function(t,e,n){if(null==t||null==e)return null;var r,o,i,s,a,l=new nT,u=t.length,h=e.length;for(r=0;r<u;r++){for(i=t[r],a=new RegExp("\\b"+i+"\\b"),(s=new nL).name=i,o=0;o<h;o++)s[o]=n?countRegexOccurrences(e[o],a):countOccurrences(e[o],i);l[r]=s}return l},getWordsInTextsOccurrencesTable=function(t,e,n=1,r,o=500,i=1e3,s,a=3,l,u=0,h){if(null!=t){var c,f,p,g=t.length;1==n&&(n=StringOperators_STOP_WORDS);var d,m=1==e,y=2==e||3==e||4==e;s=s||!0;var v,L={};for(c=0;c<g;c++)for(d=getWordsOccurrencesTable(t[c],n,r,o,a,h),f=0;f<d[0].length;f++)null==(v=L[d[0][f]])&&((v=new nT).push(new nL),v.push(new nL),L[d[0][f]]=v),v[0].push(c),v[1].push(d[1][f]);var w=new sL;for(var x in L)L.hasOwnProperty(x)&&(L[x][0].length<u*g?delete L[x]:w.push(x));for(p=createUniformTable(g+1,w.length,0),c=0;c<p.length;c++)0==c?p[c]=createListWithSameElement(w.length,"","words"):p[c].name="text "+(c-1);var b=0;for(var x in L)if(L.hasOwnProperty(x)){for(p[0][b]=x,v=L[x],c=0;c<v[0].length;c++)p[v[0][c]+1][b]+=v[1][c];b++}if(p[0].length>i&&(s=!0),p[0].name="words",y||s||l){var T,M=new nL;M=p[1].clone();var _=createListWithSameElement(p[0].length,0,"idf");for(c=1;c<p.length;c++)for((T=p[c]).name="text "+(c-1),f=0;f<T.length;f++)T[f]>0&&(c>1&&(M[f]+=T[f]),_[f]++);if(y)if(M=createListWithSameElement(p[0].length,0,"total tf-idf"),2==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]/=_[f],M[f]+=T[f];else if(3==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=Math.log(g/_[f]),M[f]+=T[f];else if(4==e)for(c=1;c<p.length;c++)for(T=p[c],f=0;f<T.length;f++)T[f]*=_[f],M[f]+=T[f];l&&(p.push(M),M.name="totals"),s&&(p=p.sortRowsByList(M,!1))}else for(c=1;c<p.length;c++)p[c].name="text "+(c-1);return m&&p.forEach((function(t,e){0!==e&&(p[e]=normalizeToSum(p[e]))})),i>0&&i<p[0].length&&(p=p.sliceRows(0,i-1)),p}},createShortTextsNetwork=function(t,e,n,r,o,i,s,a){if(null!=t&&null!=t.length&&0!==t.length){(new Date).getTime();var l,u,h,c,f,p,g,d,m,y=new Net,v=t.join(" *** ").toLowerCase().split(" *** "),L=t.length,w=0;if(null==a||a.isColorList||(a=a.toColorList()),n=n||.2,r=r||0,i){i[0]=i[0].toLowerCase();var x,b=i[1][0]}switch(r){case 0:d=function(t){return 1-Math.pow(2*t/(L-1)-1,2)};break;case 1:d=function(t){return 1/(t+1)};break;case 2:d=function(t){return 1-Math.pow(2*Math.pow(t/(L-1),.2)-1,2)};break;default:d=function(t){return 0===t?0:1/t}}for((new Date).getTime(),t.forEach((function(t,n){m=null==s||null==s[n]?"_"+n:s[n],M=new Nd("_"+n,m),y.addNode(M),M.content=t,null!=a&&(M.color=a[n]);var r=getWords(t,!0,e,!1,!1,0,3);for(f=r.length,p=new nL,u=0;null!=r[u];u++){h=r[u];var l=0;v.forEach((function(t,e){n!=e&&(l+=Number(-1!=t.indexOf(h)))})),0!==l?(p[u]=d(l),o&&(p[u]*=1-1/(countOccurrences(v[n],h)+1)),i&&(x=i[0].indexOf(h),p[u]*=-1==x?1:1-Math.pow(i[1][x]/b,.2)),w=Math.max(w,p[u])):(r.splice(u,1),u--)}c=Math.floor(3*Math.log(f+1)),(r=r.getSortedByList(p,!1).slice(0,c)).position={},r.forEach((function(t,e){r.position[t]=e})),p=p.getSorted(!1).slice(0,c),M.wordsTable=new T,M.wordsTable[0]=r,M.wordsTable[1]=p})),(new Date).getTime(),l=0;null!=y.nodes[l+1];l++){var M=y.nodes[l];for(u=l+1;null!=y.nodes[u];u++){var _=y.nodes[u];if(g=0,M.wordsTable[0].forEach((function(t,e){null!=(x=_.wordsTable[0].position[t])&&(g+=M.wordsTable[1][e]*_.wordsTable[1][x])})),(g=Math.sqrt(g/w/Math.max(M.wordsTable[0].length,_.wordsTable[0].length)))>n){var S=new Rel(M.id+"_"+_.id,M.id+"_"+_.id,M,_,g);y.addRelation(S)}}}return y}},splitStrings=function(t,e,n,r,o){if(null==t)return null;null==e&&(e=","),null==n&&(n=4),r=null==r||r,o=null==o?"":o;var i,s,a,l=new T;for(i=0;i<n;i++)l.push(new sL),l[i].name="Level "+(i+1);var u=new nL;for(i=0;i<t.length;i++){var h=splitString(t[i],e);if(null!=h){for(h=h.trim(),s=0;s<n;s++)if(s<h.length?(l[s][i]=h[s],s>=u.length&&u.push(s)):l[s][i]=null,r&&s==n-1&&h.length>n)for(a=s+1;a<h.length;a++)l[s][i]+=e+h[a]}else for(s=0;s<n;s++)l[s][i]=0==s?o:null}return 0==u.length?l=new T:u.length<l.length&&(l=l.getColumns(u)),l},encodeStringsAsNumericFeatures=function(t,e,n,r,o,i){if(null==t)return null;e=null==e?0:e,r=null!=r&&r,o=null!=o&&o,null==i&&(i=3!=e);var s,a,l,u={};"sL"!=t.type&&(t=t.toStringList()),r&&(t=t.toLowerCase()),s=null==n?t.getWithoutRepetitions().getSorted():(s=r?n.toLowerCase():n).getWithoutRepetitions().getSorted();for(var h=[],c=0;c<s.length;c++)u[s[c]]=c,h.push(s[c]);var f="";if(o&&(f=""==t.name?"":t.name+":"),a=new nT,0==e||3==e)for(c=0;c<s.length;c++)a.push(new nL),a[c].name=f+s[c];else if(1==e)a.push(new nL),a[0].name=""==t.name?"Code":t.name+" Code";else{var p=(s.length-1>>>0).toString(2).length;for(c=0;c<p;c++)a.push(new nL),a[c].name=f+"Bit "+c}if(0==e||3==e)for(c=0;c<t.length;c++)if(null!=(l=u[t[c]]))for(var g=0;g<a.length;g++)a[g].push(g==l?1:0);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}else if(1==e)for(c=0;c<t.length;c++)if(null!=(l=u[t[c]]))a[0].push(l);else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}else for(c=0;c<t.length;c++)if(null!=(l=u[t[c]])){var d=(l>>>0).toString(2),m=a.length-d.length;for(g=0;g<a.length;g++){var y=g-m<0?"0":d.substr(g-m,1);a[g].push(Number(y))}}else{if(i)throw new Error("Element in texts not found in sLComplete.");for(g=0;g<a.length;g++)a[g].push(0)}return 0==e&&a.length>1&&(a=a.getWithoutElementAtIndex(a.length-1)),a},correlationRatio=function(t,e,n){if(null==e||null==t)return null;if("L"==t.type&&(t=t.toStringList()),"nL"!=e.type)throw new Error("The first list must be a nL");if("sL"!=t.type)throw new Error("The second list must be a sL");if(e.length!=t.length)throw new Error("The two lists must have the same length");0!=(n=null==n?0:n)&&(e=normalizeByZScore(e));var r=new T;r.push(t),r.push(e),r=aggregateTable(r,0,[0,1],[0,7]);var o=e.getVariance()*e.length,i=e.getMean();if(0==o)return 0;for(var s,a=0,l=new e,u=0;u<r[1].length;u++)s=r[1][u].getMean(),l.push(s),a+=Math.pow(s-i,2)*r[1][u].length;var h=1;if(0!=n){var c=e.getInterval();l=normalizeToInterval(l,c);var f,p=0,g=1/0,d=-1/0;for(u=0;u<l.length;u++)for(var m=u+1;m<l.length;m++)p+=f=Math.abs(l[u]-l[m]),g=Math.min(g,f),d=Math.max(d,f);var y=l.length*(l.length-1)/2;1==n?h=10*g:2==n?h=10*p/y:3==n&&(h=10*d)}return Number((Math.abs(h)*Math.sqrt(a/o)).toFixed(5))},splitByEnter=function(t,e){if(null==t)return null;var n=splitString(t,"\n",null,e);return n.length>1||(n=splitString(t,ENTER2,null,e)).length>1||(n=splitString(t,ENTER3,null,e)).length>1?n:new sL(t)},replaceStringInText=function(t,e,n){if(null==t||null==e||null==n)return null;if("object"==typeof t)return t;if("[object RegExp]"!=Object.prototype.toString.call(e)){var r=(e=String(e)).match(/\/(.+)\/(.*)/);if(null==r)e=new RegExp(e,"g");else try{e=new RegExp(r[1],r[2])}catch(t){throw t}}return String(t).replace(e,n)},replaceStringsInText=function(t,e,n,r){if(null==t||null==e||null==n)return null;var o,i,s=t,a=e.length;for(o=0;o<a;o++)i=e[o],r&&"[object RegExp]"!=Object.prototype.toString.call(i)&&(i=new RegExp("\\b"+escapeForRegExp(i)+"\\b","g")),s=replaceStringInText(s,i,Array.isArray(n)?String(n[o]):n);return s},removeTextsBetweenStrings=function(t,e,n,r,o,i){if(null==t||null==e||null==n)return null;var s=function(t){var i=t.indexOf(e),s=t.indexOf(n,i);return-1==i||-1==s?null:t.substr(0,i-(r?e.length:0))+t.substr(s+(o?0:n.length))},a=s(t);a&&(t=a);var l=1;for(i=i>0?i:Number.MAX_SAFE_INTEGER;a&&l<i;)a=s(t=a),l++;return t},getWords=function(t,e,n,r,o,i,s,a){if(null==t)return null;var l;s=s||0,e=null==e||e,r=null==r||r,o=null==o||o,i=null==i?0:i,a=null==a||""==a?" ":a;var u,h,c,f=StringOperators_LINK_REGEX;if("string"!=typeof t&&(t=String(t)),o&&(l=t.match(f)),t=t.toLowerCase().replace(f,""),null==(h=" "==a?t.match(/[A-Za-z_0-9---]+/g):splitString(t,a,null,!0)))return new sL;if(h=(h=sL.toL(h)).getFilteredByFunction((function(t){return""!=t})),o&&null!=l&&(h=h.concat(l))," "==a&&(h=sL.toL(h).replace(/ /g,"")),null!=n){var p=!0;if(!0===n)n=StringOperators_STOP_WORDS,p=!1;else for(p=!1,y=0;y<n.length;y++)if("object"==typeof n[y]){p=!0;break}if(p){c=h.length;var g=n.length;for(u=0;u<c;u++)for(y=0;y<g;y++)if("string"==typeof n[y]){if(n[y]==h[u]){h.splice(u,1),u--,c=h.length;break}}else if(n[y].test(h[u])){h.splice(u,1),u--,c=h.length;break}}else c=(h=h.getWithoutElements(n)).length}if(s>0)for(c=h.length,u=0;u<c;u++)h[u].length<s&&(h.splice(u,1),u--,c=h.length);if(r){if(e)h=h.getFrequenciesTable(!0)[0];else{var d=h.getFrequenciesTable(),m=new sL;for(u=0;u<d[0].length;u++)for(var y=0;y<d[1][u];y++)m.push(d[0][u]);h=m}return 0!==i&&(h=h.splice(0,i)),h}return e&&(h=h.getWithoutRepetitions()),0!==i&&(h=h.splice(0,i)),h},substr=function(t,e,n){return null==t?null:(e=e||0,t.substr(e,n))},splitString=function(t,e,n,r){if(null==t)return null;if(null!=n&&!isNaN(n)&&0!=n){var o=t.match(/\w+/g);null==o&&(o=[t]);var i=!0,s=t.length/o.length/2;n>o.length&&(i=!1,s=0);for(var a,l,u,h=new h,c=t;c.length>0;){if(u=Math.max(1,Math.floor(c.length/(n-h.length)-s)),h.length==n-1){h.push(c);break}-1==(l=i?c.substring(u-1).search(/\s/):0)?l=u:l+=u,a=c.substring(0,l),h.push(a),c=c.substring(l)}return r?h.trim():h}return null==e&&(e=","),"string"==typeof e&&(e=e.replace("\\n","\n")),-1==t.indexOf(e)?new h(t):(h=h.toL(t.split(e)),r?h.trim():h)},getFirstTextBetweenStrings=function(t,e,n){if(null==t)return null;var r=t.indexOf(e);if(-1==r)return null;if(""===n||null==n)return t.substr(r+e.length);var o=t.indexOf(n,r+e.length+1);return-1==o?t.substring(r+e.length):t.substr(r+e.length,o-(r+e.length))},getAllTextsBetweenStrings=function(t,e,n){if(-1==t.indexOf(e))return new sL;var r,o,i,s=t.split(e),a=s.length,l=new sL;for(i=1;i<a;i++)r=s[i],n==e?l.push(r):(o=r.indexOf(n))>=0&&l.push(r.substr(0,o));return l},textContainsString=function(t,e,n,r){return t=r?e:t.toLowerCase(),e=r?e:e.toLowerCase(),n?t.match(new RegExp("\\b"+e+"\\b")).length>0:-1!=t.indexOf(e)},getParenthesisContents=function(t,e){for(var n=new sL,r=t,o=getFirstParenthesisContentWithIndexes(t,e),i=0;""!==o.content&&o.index1<r.length-1&&i<t.length;)n.push(o.content),r=r.substr(o.index1+2),o=getFirstParenthesisContentWithIndexes(r,e),i++;return n},getFirstParenthesisContent=function(t,e){return getFirstParenthesisContentWithIndexes(t,e).content},getFirstParenthesisContentWithIndexes=function(t,e){var n=e?"[":"(",r=e?"]":")",o=e?/\[/g:/\(/g,i=e?/\]/g:/\)/g,s=t.indexOf(n);if(-1==s)return{content:"",index0:0,index1:0};for(var a=t.indexOf(r),l=t.substring(s+1,a),u=l.match(o),h=l.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f=0;(c>0||-1==a)&&f<t.length;)a=t.indexOf(r,a),l=t.substring(s+1,a+1),a++,u=l.match(o),h=l.match(i),c=(null==u?0:u.length)-(null==h?0:h.length),f++;return{content:-1==(a=t.indexOf(r,a))?t.substring(s+1):t.substring(s+1,a),index0:s+1,index1:-1==a?t.length-1:a-1}},placeString=function(t,e,n){return t.substr(0,n)+e+t.substr(n+e.length)},insertString=function(t,e,n){return t.substr(0,n)+e+t.substr(n)},cleanText=function(t,e,n,r,o,i,s,a,l){return null==t?null:t.isList?cleanTexts(t,e,n,r,o,i,s,a,l):(e&&(t=removeEnters(t,r)),n&&(t=removeTabs(t,r)),o&&(t=removePunctuation(t)),i&&(t=t.toLowerCase()),null!=s&&(t=replaceStringsInText(t,s,"",!0)),a&&(t=removeDoubleSpaces(t)),l&&(t=removeAccentsAndDiacritics(t)),t)},removeEnters=function(t,e){return null==t?null:(e=null==e?"":e,t.replace(/(\r|\n)/g,e))},removeTabs=function(t,e){return null==t?null:(e=e||"",t.replace(/\t/g,e))},removePunctuation=function(t,e){return null==t?null:(e=e||"",t.replace(/[:,.;?!\(\)\"\']/gi,e))},removeDoubleSpaces=function(t){if(null==t)return null;for(var e=t,n=RegExp(/\s\s/g);n.test(e);)e=e.replace(n," ");return e},removeHtmlTags=function(t){var e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText},escapeForRegExp=function(t){return null==t?null:t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},removeLinks=function(t){return(t+=" ").replace(/https*:\/\/[a-zA-Z0-9\/\.]+( |:|;|\r|\t|\n|\v)/g," ").substr(0,t.length-2)},removeQuotes=function(t){return'"'==t.charAt(0)&&(t=t.substr(1)),'"'==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t},removeAccentsAndDiacritics=function(t){var e=t.replace(new RegExp(/[]/g),"a");return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(new RegExp(//g),"ae")).replace(new RegExp(//g),"c")).replace(new RegExp(/[]/g),"o")).replace(new RegExp(//g),"oe")).replace(new RegExp(/[]/g),"u")).replace(new RegExp(/[]/g),"y")).replace(new RegExp(/[]/g),"A")).replace(new RegExp(//g),"AE")).replace(new RegExp(//g),"c")).replace(new RegExp(/[]/g),"E")).replace(new RegExp(/[]/g),"I")).replace(new RegExp(/[]/g),"e")).replace(new RegExp(/[]/g),"i")).replace(new RegExp(//g),"n")).replace(new RegExp(//g),"N")).replace(new RegExp(/[]/g),"O")).replace(new RegExp(//g),"OE")).replace(new RegExp(/[]/g),"U")).replace(new RegExp(/[]/g),"Y")},getWordsOccurrencesTable=function(t,e,n,r,o,i){if(null!=t){if(0===t.length)return new T(new sL,new nL);1==e&&(e=StringOperators_STOP_WORDS);var s,a=getWords(t,!1,e,!1,n,null,o,i);return(s=null!=r?a.getFrequenciesTable(!0).sliceRows(0,r-1):a.getFrequenciesTable(!0))[0].name="Word",s[1].name="Frequency",s}},indexesOf=function(t,e,n){var r,o;if(n){var i;for(r=new nL,e=new RegExp("\\b"+e+"\\b"),-1!=(o=t.search(e))&&(t=t.substr(o));-1!=o;)r.push(o),i=o,o=t.search(e),t=t.substr(o+1),o>=0&&(o+=i);return r}if(-1==(o=t.indexOf(e)))return new nL;for(r=new nL(o),o=t.indexOf(e,o+1);-1!=o;)r.push(o),o=t.indexOf(e,o+1);return r},indexesOfString=function(t,e,n){return indexesOf(t,e,n)},repeatString=function(t,e){var n,r="";for(n=0;n<e;n++)r+=t;return r},countStringOccurrences=function(t,e,n){return countOccurrences(t,e,n)},countOccurrences=function(t,e,n){if(n)return countWordOccurrences(t,e);for(var r=0,o=t.indexOf(e);-1!=o;)r++,o=t.indexOf(e,o+e.length);return r},countWordOccurrences=function(t,e){var n=new RegExp("\\b"+e+"\\b");return countRegexOccurrences(t,n)},countRegexOccurrences=function(t,e){var n=t.match(e);return null==n?0:n.length},countStringsOccurrences=function(t,e,n){if(null!=t&&null!=e){var r,o=new nL,i=e.length;for(r=0;r<i;r++)o[r]=n?countRegexOccurrences(t,new RegExp("\\b"+e[r]+"\\b")):countOccurrences(t,e[r]);return o}},validateEmail=function(t){return StringOperators_MAIL_REGEX.test(t)},validateUrl=function(t){return StringOperators_LINK_REGEX.test(t)},getLevenshteinDistance=function(t,e,n){if(e=null==e?"":e,0===(t=null==t?"":t).length&&0===e.length)return 0;if(0===t.length)return n?1:e.length;if(0===e.length)return n?1:t.length;var r,o,i=[];for(r=0;r<=e.length;r++)i[r]=[r];for(o=0;o<=t.length;o++)i[0][o]=o;for(r=1;r<=e.length;r++)for(o=1;o<=t.length;o++)e.charAt(r-1)==t.charAt(o-1)?i[r][o]=i[r-1][o-1]:i[r][o]=Math.min(i[r-1][o-1]+1,Math.min(i[r][o-1]+1,i[r-1][o]+1));if(n){var s=i[e.length][t.length]/Math.max(t.length,e.length);return Number(s.toFixed(5))}return i[e.length][t.length]},getNgrams=function(t,e=2,n=2,r,o=0,i=0,s){var a,l,u;n<e&&(n=e),!0===r&&(r=StringOperators_STOP_WORDS),1!=(s=null==s?null==r?1:0:s)&&null==r&&(r=StringOperators_STOP_WORDS),1==s&&(r=null);var h=new sL;if(null==t||"string"!=typeof t)return h;var c=StringOperators_LINK_REGEX,f=(t=t.toLowerCase().replace(c,"")).match(/\w+|[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/g);if(null==f)return h;f=sL.toL(f);var p=/[\.,-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/;for(a=0;a<f.length;a++)if(u=f[a],!(r&&-1!=r.indexOf(f[a])||i&&f[a].length<i||1==f[a].length&&f[a].match(p))){for(1==e&&h.push(u),l=a+1;l<f.length&&l<a+n&&(!r||-1==r.indexOf(f[l])||0!=s)&&!(i&&f[l].length<i)&&(1!=f[l].length||!f[l].match(p));l++)if(l>=a+e-1){if(u=u+" "+f[l],2==s&&-1!=r.indexOf(f[l]))continue;if(h.push(u),0!==o&&h.length==o)break}else u=u+" "+f[l];if(0!==o&&h.length==o)break}return h},stringToFunction=function(string){if(null!=string){var realCode,myTempraryFunction,func;if(-1!=string.search(/function\(/))return realCode="myTempraryFunction = "+string,eval(realCode),myTempraryFunction;for(var i=0;i<methods.length;i++)if(methods[i].methodName==string){if(methods[i].isPrototype){var funcName=string;func=function(t,e,n,r,o,i,s){return null==t[funcName]?null:t[funcName](e,n,r,o,i,s)}}else func=methods[i].func;break}return null!=func?func:(realCode="myTempraryFunction = function(x){return "+string+"}",eval(realCode),myTempraryFunction)}},stringFormat=function(t,e,n,r){if(null==t||null==e||null==n)return null;var o,i;if(r=null==r?0:r,"sL"==t.type||"Array"==_typeOf(t)){var s=new sL;for(s.name=t.name,o=0;o<t.length;o++)s.push(stringFormat(t[o],e,n,r));return s}if(t="string"!=typeof t?String(t):t,e="string"!=typeof e?String(e):e,n="string"!=typeof n?String(n):n,t.length!=e.length){if(0==r)return t;if(1==r)return null;throw new Error("Input string must be same length as the input pattern")}if(new Set(e).size!=e.length)throw new Error("All characters in the input pattern must be unique");var a=n;for(o=0;o<n.length;o++)-1!=(i=e.indexOf(n[o]))&&(a=a.substring(0,o)+t[i]+a.substring(o+1));return a},createListWithSameElement=function(t,e,n){if(null==t)return null;var r,o;switch(Array.isArray(t)&&(t=t.length),_typeOf(e)){case"number":r=new nL;break;case"L":r=new T;break;case"nL":r=new nT;break;case"Rec":r=new recL;break;case"string":r=new sL;break;default:r=new L}for(o=0;o<t;o++)r[o]=e;return null!=n&&(r.name=n),r},createIterationSequence=function(t,e,n){for(var r=createListWithSameElement(1,e),o=1;o<t;o++)r[o]=n(r[o-1]);return r},createListWithUniqueElements=function(t,e=0,n,r,o=5){var i,s,a;if(i=""==(n=null==n?"":n)&&1==e?new nL:new sL,null!=r&&(i.name=r),0==e){for(var l=1,u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h=u.length;t>Math.pow(h,l);)l++;var c,f=createListWithSameElement(l,0);for(s=0;s<t;s++){for(c="",a=0;a<f.length;a++)c=u[f[a]]+c;for(i.push(n+c),a=0;a<f.length&&(f[a]++,f[a]==h);a++)f[a]=0}}else if(1==e)for(s=0;s<t;s++)""==n?i.push(s+1):i.push(n+(s+1));else if(2==e)for(s=0;s<t;s++)c=StringOperators_WORDLISTS.lorem.getRandomElements(o).join(" "),i.push(c);return i},replaceChomasInTextLine=function(t,e){var n,r,o=t.split('"');if(o.length<2)return t;for(e=null==e?",":e,r=new RegExp("\\"+e,"g"),n=0;null!=o[n];n++).5*n!=Math.floor(.5*n)&&(o[n]=o[n].replace(r,"*CHOMA*"));return t=sL.toL(o).getConcatenated("")},_replaceSpacesInLine=function(t){var e,n=t.split('"');if(n.length<2)return t;for(e=0;null!=n[e];e++).5*e!=Math.floor(.5*e)&&(n[e]=n[e].replace(/ /g,"*SPACE*"));return t=sL.toL(n).getConcatenated('"')},NetworkToTable=function(t,e,n,r){if(null!=t){e=null==e||e,r=null==r?0:r;var o,i=n?new T:new nT,s=e?t.nodes.getIds():t.nodes.getNames();s.name="node names",n&&(i[0]=s);var a,l,u=t.nodes.length,h=t.relations.length,c={},f=n?1:0;for(a=0;a<u;a++)(o=createListWithSameElement(u,0)).name=s[a],i.push(o),c[t.nodes[a].id]=a;for(a=0;a<h;a++)l=t.relations[a],0===r?i[c[l.node0.id]+f][c[l.node1.id]]++:i[c[l.node0.id]+f][c[l.node1.id]]+=l.weight;return i}},TableToNetworkPairs=function(t,e,n=0,r,o,i,s=","){if(null==t||!t.isTable||null==t[0]||null==t[1])return;var a,l,u,h,c,f,p,g,d,m=new Net;if("nT"==t.type&&t.length>2&&t.length==t[0].length){for(a=t.length,p=0;p<a;p++)l=new Nd(h=null==i?null==t[p].name||""==t[p].name?"node_"+p:t[p].name:i[p],h),m.addNode(l);for(p=0;p<a;p++)for(d=t[p],l=m.nodes[p],g=0;g<a;g++)u=m.nodes[g],d[g]>n&&(f=new Rel(p+"_"+g,p+"_"+g,l,u,d[g]),m.addRelation(f));return m}let y=createSortedNumberList(t[0]);if(y.name="indexes",t[0].join("").includes(s)){let e=toT(t);t.push(y);var v=disAggregateTable(e,e.getWithoutElementAtIndex(0).getNames(),0);v.setNames(e.getNames()),y=v.get("indexes"),t=v=(v=v.getWithoutElement(y)).getColumns(3==v.length?[2,0,1]:[1,0])}if(t[1].join("").includes(s)){let e=toT(t);e.push(y),(v=disAggregateTable(e,e.getWithoutElementAtIndex(1).getNames(),1)).setNames(t.getNames()),y=v.get("indexes"),t=v=(v=v.getWithoutElement(y)).getColumns(3==v.length?[2,0,1]:[1,0])}if(null==r&&(r=!1),t.length<2)return null;a=null==e?Math.min(t[0].length,t[1].length):Math.min(t[0].length,t[1].length,e.length),null==e&&t.length>2&&"nL"==_typeOf(t[2])&&t[2].length>=a&&(e=t[2]),_typeOf(t[0])==ndL&&(_typeOf(t[1]),NodeList);var L,w=new ndL;for(p=0;p<a;p++)h=""+t[0][p],c=""+t[1][p],null==(l=m.nodes.get(h))?(l=new Nd(h,h),m.addNode(l),l.color="rgb(255,140,80)",l.kind=t[0].name,l.indexes=new nL):l.weight++,l.indexes.push(y[p]),null==(u=m.nodes.get(c))?(u=new Nd(c,c),m.addNode(u),u.color="rgb(60,180,255)",u.kind=t[1].name,u.indexes=new nL):(u.weight++,"rgb(200,100,0)"==u.color&&(u.color="rgb(100,100,100)")),u.indexes.push(y[p]),null==e?r?(f=new Rel(L=h+"_"+c+"_"+p,h+"_"+c,l,u,1),m.addRelation(f)):(L=h+"_"+c+"_",null==(f=w.get(L))||r?(f=new Rel(L,L,l,u,1),w.addNode(f)):f.weight++):e[p]>n&&(f=new Rel(h+"_"+c,h+"_"+c,l,u,e[p]),m.addRelation(f)),i&&(f.content=i[p]);if(m.nodes.forEach((t=>t.indexes=t.indexes.getWithoutRepetitions())),null==e)if(r)for(p=0;p<w.length;p++)m.addRelation(w[p]);else for(p=0;p<w.length;p++)w[p].weight>n&&m.addRelation(w[p]);if(o)for(p=0;null!=m.nodes[p];p++)m.nodes[p].relations.length<o&&(m.removeNode(m.nodes[p]),p--);return m},matrixToNetwork=function(t){for(var e,n,r,o,i=new Net,s=1;s<t.length;s++){null==(e=i.get(t[s].name))&&(e=new Nd(t[s].name,t[s].name),i.addNode(e));for(var a=0;a<t[0].length;a++)t[s][a]>0&&(o=String(t[0][a]),null==(n=i.get(o))&&(n=new Nd(o,o),i.addNode(n)),r=new Rel(o=s-1+"_"+a,e.name+"_"+n.name,e,n,t[s][a]),i.addRelation(r))}return i},CSVToTable=function(t,e=!0,n,r,o,i){if(null==t)return null;if(o=null!=o&&o,-1==t.indexOf("\n")&&-1==t.indexOf(",")&&-1==t.indexOf(";"))throw 0===t.indexOf("http:/")||0===t.indexOf("https:/")||0===t.indexOf("fttp:/")||0===t.indexOf("fttps:/")?new Error("The provided string seems to be a url, not a csv<br><br>Use <b>CSVLoader</b> to upload and decode csv files"):new Error("the provided string doesn't seem to be a csv, it contains no enters or chomas");var s,a=2==e;if(a&&(e=!0),null==t)return null;if(""===t)return new T;var l=(t=t.replace(/\$/g,"")).split('"');for(D=1;null!=l[D];D+=2)l[D]=l[D].replace(/\n|\r/g,"*ENTER*");var u=(t=l.join('"')).split(/\n|\r/g);if(1==u.length&&e)throw new Error("CSV contains only one line and firstRowIsHeader is true, a T can't be build");if("auto"==n){var h,c,f=[",",";",":","|","\t","+","-","_"],p=u.slice(0,11).join("\n"),g=0,d=",";for(D=0;D<f.length;D++){try{h=CSVToTable(p,e,f[D])}catch(t){h=null}if(null!=h&&0!=h.length){if(buildInformationObjectForTable(h),c=h.length,e)c-=h.getNames().getElementNumberOfOccurrences("");var m=h.reduce((function(t,e){return t+e.getElementNumberOfOccurrences(null)}),0),y=h.reduce((function(t,e){return t+e.length}),0);c-=0==y?0:m/y,h.infoObject.allListsSameLength||c--,c>g&&(g=c,d=f[D])}}n=d}"\\t"!=(n=null==n||""===n?",":n)&&"tab"!=n||(n="\t");var v=new T,w=n;if(null==t||""===t||" "==t||0===u.length)return null;var x,b,M,_,S,N,R=0;if(e)if(R=1,a)for(x=replaceChomasInTextLine(u[0],n).split(","),D=0;D<x.length;D++)x[D]=x[D].replace("*CHOMA*",n);else x=u[0].split(w);for(D=0,N=R;N<u.length;N++)if(!(u[N].length<2)){for(S=replaceChomasInTextLine(u[N],n).split(w),s=0;s<S.length;s++)v[s]=null==v[s]?new L:v[s],e&&0===D&&(v[s].name=(null==x[s]?"":_removeQuotes(x[s])).trim()),null!=(M=""===(M=S[s].replace(/\*CHOMA\*/g,n).replace(/\*ENTER\*/g,"\n"))?r:M)?(M=String(M),"string"==typeof(b=(_=Number(M.replace(",",".")))||0===_&&""!==M?_:M)&&(b=_removeQuotes(b))):b=null,v[s][D]=b;D++}for(D=0;null!=v[D];D++)v[D]=v[D].downcast(),o&&"L"==v[D].type&&(v[D]=toStringList(v[D]));if((v=v.downcast()).name=i,a){for(var E=!0,C=0,D=0;D<v.length;D++)if("nL"==v[D].type&&(C++,String(Number(v[D].name))!=Number(v[D].name))){E=!1;break}if(!E)return v;var O=0,P=0;for(D=0;D<v.length;D++){if("nL"!=v[D].type)if(P++,v[D].includes(v[D].name))O++;else v[D].getWithoutRepetitions().length==v[D].length&&O++}if(P>0&&(O+C)/v.length>.3)for(D=0;D<v.length;D++)v[D].unshift(v[D].name),v[D].name="col "+D}return v},_removeQuotes=function(t){return 0===t.length||'"'!=t.charAt(0)&&"'"!=t.charAt(0)||'"'!=t.charAt(t.length-1)&&"'"!=t.charAt(t.length-1)||(t=t.substr(1,t.length-2)),t},TableToCSV=function(t,e,n,r,o){if(null!=t){var i,s,a,l;if(e=e||",",null==t)return null;var u,h=createListWithSameElement(t[0].length,"");for(i=0;null!=t[i];i++)for(l=(a=t[i]).type,u=i!=t.length-1,s=0;s<a.length;s++){if(null!==a[s])if("nL"===l)h[s]+=a[s];else h[s]+=null!=r?String(a[s]).replace(/,/g,r):'"'+a[s]+'"';u&&(h[s]+=e)}var c="";if(n){for(i=0;null!=t[i];i++)a=t[i],c+=null!=r?a.name.replace(/,/g,r):'"'+a.name+'"',i!=t.length-1&&(c+=e);c+="\n"}return(o?t.getTypes().join(e)+"\n":"")+c+h.getConcatenated("\n")}},TableToJSONString=function(t,e){if(null==t)return"";for(var n=t.slice(0),r=t.getNames(),o=t.getTypes(),i=[],s=0;s<t.length;s++)void 0===t[s].containsNulls?i.push(null):i.push(t[s].containsNulls);var a={data:n,name:t.name,type:t.type,handle:t.handle,names:r,types:o,nulls:i};if(void 0!==t.containsNulls&&(a.containsNulls=t.containsNulls),e)return a;try{return JSON.stringify(a)}catch(t){return JSON.stringify({error:"cannot convert."})}},JSONStringToTable=function(t){if(null==t||0==t.length)return new T;var e,n,r;if("object"==typeof t)e=t;else try{e=JSON.parse(t)}catch(t){return null}if((r="nT"==e.type?nT.toL(e.data):T.toL(e.data)).name=null==e.name?e.name:String(e.name),r.type=e.type,null!=e.handle&&(r.handle=e.handle),null!=e.containsNulls&&(r.containsNulls=e.containsNulls),e.types&&e.types.length>0){for(n=0;n<e.types.length;n++)if(r[n])switch(e.types[n]){case"sL":r[n]=sL.toL(r[n],!1);break;case"nL":r[n]=nL.toL(r[n],!1);break;case"dL":r[n]=dL.toL(r[n],!0);break;case"iL":r[n]=iL.toL(r[n],!1)}}else for(n=0;n<r.length;n++)if(r[n]=r[n].downcast(),"sL"==r[n].type){for(var o=!0,i=0;o&&i<r[n].length;i++)o=!isNaN(r[n][i])&&""!==r[n][i].trim();o&&(r[n]=toNumberList(r[n]))}if(e.names)for(n=0;n<e.names.length;n++)r[n]&&(r[n].name=String(e.names[n]));if(e.nulls)for(n=0;n<e.nulls.length;n++)r[n]&&null!=e.nulls[n]&&(r[n].containsNulls=e.nulls[n]);return r},NumberListToPolygon=function(t){if(0===t.length)return null;for(var e=new Pol,n=0;null!=t[n+1];n+=2)e.push(new P(t[n],t[n+1]));return e},NumberListToStringList=function(t){var e,n=new sL;for(e=0;null!=t[e];e++)n[e]=String(t[e]);return n.name=t.name,n},ObjectToTable=function(t,e){if(null==t)return null;var n,r,o,i,s,a;if(Array.isArray(t)){if(n=1,!e)for(r in e=[],t[0])t[0].hasOwnProperty(r)&&e.push(r)}else{var l=[];for(r in t)l.push(r);if(1==l.length&&Array.isArray(t[l[0]])){if(n=1,t=t[l[0]],!e)for(r in e=[],t[0])e.push(r)}else n=3,e||(e=l)}var u=new T;for(i=0;i<e.length;i++){var h=e[i];o=new L,u[i]=o,o.name=h}if(1==n)for(i=0;i<t.length;i++){var c=t[i];for(s=0;s<e.length;s++)u[s].push(c[e[s]])}else for(s=0;s<e.length;s++)for(o=t[e[s]],i=0;i<o.length;i++)u[s].push(o[i]);for(i=0;i<u.length;i++){var f=u[i].getTypeOfElements();if(""==f||"Object"==f){var p=!0,g="";for(a=0;a<u[i].length&&p;a++)if(null!==u[i][a]){if("Object"!=_typeOf(u[i][a])){p=!1;break}""==g?g=getObjectStructure(u[i][a]):g!=getObjectStructure(u[i][a])&&(p=!1)}p||(f="")}if("Object"==f){var d=ObjectToTable(u[i]),m=u[i].name;for(a=0;a<d.length;a++)d[a].name=m+"_"+d[a].name;u=T.toL(u.slice(0,i).concat(d).concat(u.slice(i+1))),i--}}for(i=0;i<u.length;i++)u[i]=u[i].downcast();return u=u.downcast()},ObjectToList=function(t,e){var n=ObjectToTable(t,e);if(1==n.getLengths.getMax())return n.getRow(0)},objectToString=function(t){try{return JSON.stringify(t)}catch(t){return JSON.stringify({error:"cannot convert."})}},conversor=function(t,e){if(null!=t&&null!=e){var n,r;switch(_typeOf(t)+"_"+e){case"Array_List":return ArrayToList(t);case"NumberTablePolygon":var o=new Pol,i=t.length>1;for(n=0;null!=t[0][n];n++)o[n]=new P(t[0][n],i?t[1][n]:0);return o;case"date_string":return dateToString(t);case"string_date":return stringToDate(t);case"date_number":return t.getTime();case"number_date":return new Date(t);case"List_StringList":case"NumberList_StringList":return NumberListToStringList(t);case"DateList_StringList":return DateListToStringList(t);case"StringList_NumberList":return StringListToNumberList(t);case"Object_string":return JSON.stringify(t,null,"\t");case"string_Object":return JSON.parse(t);case"string_ColorScale":return ColorScales[t];case"string_Table":return CSVToTable(t);case"StringList_DateList":return r=new dL,t.forEach((function(t){r.push(stringToDate(t))})),r.name=t.name,r;case"DateList_NumberList":return t.getTimes();case"Table_Network":return TableToNetworkPairs(t,null,0,!1)}switch(e){case"string":return t.toString();case"number":return Number(t)}return null}},ArrayToList=function(t){if(null!=t)return L.toL(t).downcast()},angleFromTwoPoints=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},dot=function(t,e){return t.x*e.x+t.y*e.y},twoPointsInterpolation=function(t,e,n){return new P((1-n)*t.x+n*e.x,(1-n)*t.y+n*e.y)},pointMultiplication=function(t,e){return new P(t.x*e.x-t.y*e.y,t.y*e.x+t.x*e.y)},normalizeTableToMax=function(t,e){if(null!=t){e=null==e?1:e;var n,r=new nT,o=e/t.getMax();for(n=0;null!=t[n];n++)r[n]=t[n].factor(o);return r.name=t.name,r}},normalizeLists=function(t,e,n){if(null!=t&&t.length&&t[0].length){n=null==n?"min-max":n;var r,o=instanceSameType(t);for(r=0;null!=t[r];r++)"nL"==t[r].type?"min-max"==n?o[r]=normalizeToMax(t[r],e):"z-score"==n&&(o[r]=normalizeByZScore(t[r])):o[r]=t[r].clone();return o.name=t.name,o}},normalizeListsToMax=function(t,e){if(null!=t&&t[0].length){var n,r,o=new nT,i=t.length;for(r=0;r<i;r++)n=t[r],o[r]=normalizeToMax(n,e);return o.name=t.name,o}},normalizeListsToSum=function(t,e){if(null!=t&&t[0].length){var n,r,o=new nT,i=t.length;for(r=0;r<i;r++)n=t[r],o[r]=normalizeToSum(n,e);return o.name=t.name,o}},averageSmootherOnLists=function(t,e,n){if(null!=t&&t[0].length){e=e||.5,n=n||1;var r=new nT;return r.name=t.name,t.forEach((function(o,i){r[i]=averageSmoother(t[i],e,n)})),r}},kMeans=function(t,e,n,r,o){if(null==t||null==t[0]||null==e||e<=0||0!==t.getLengths().getInterval().getAmplitude())return null;n=null==n?0:n,r=null==r||r<=0?1e3:r;var i,s,a,l,u,h,c,f,p=new nT;p.name="k-means clusters";var g,d,m,y,v=new nT,w=t.length,x=t[0].length,b=t.transpose(),T=p.clone();if(e>=b.length)return b;var M,_,S,N,R=function(t,e){var n=e.length;for(i=0;i<n;i++)if(containSameElements(t,e[i]))return!0;return!1};for(s=0;s<e;s++)if(o&&s<o.length)v[s]=b[o[s]].clone();else{for(u=b.getRandomElement(),y=0;R(u,v)&&y<100;)u=b.getRandomElement(),y++;if(100==y){e=s;break}v[s]=u.clone()}for(f=0;f<r;f++){for(s=0;s<e;s++)p[s]=new nL,p[s].name="-means cluster "+s;for(i=0;i<x;i++){for(u=b[i],c=99999999,l=0,s=0;s<e;s++)(h=distance(u,v[s]))<c&&(c=h,l=s);p[l].push(i)}for(i=0;i<p.length;i++)if(0==p[i].length)for(s=0;s<p.length;s++)if(!(s==i||p[s].length<2)){var E=p[s].length-1;p[i].push(p[s][E]),p[s]=p[s].getWithoutElementAtIndex(E);break}if(p.isEqual(T))break;for(T=p.clone(),s=0;s<e;s++){for(g=(d=p[s]).length,v[s]=new nL,v[s].name="k-means mean "+s,m=v[s],u=b[d[0]],a=0;a<w;a++)m[a]=u[a]/g;for(i=1;i<g;i++)for(u=b[d[i]],a=0;a<w;a++)m[a]+=u[a]/g}}if(1==n||5==n)for((M=new nL).name="mean index",i=0;i<e;i++)for(S=(_=p[i]).length,s=0;s<S;s++)M[_[s]]=i;if(2==n||5==n){(N=new cL).name="mean color";var C=createDefaultCategoricalColorList(e);for(i=0;i<e;i++)for(S=(_=p[i]).length,s=0;s<S;s++)N[_[s]]=C[i]}var D=new L;if(4==n||5==n)for(i=0;i<e;i++){for(D[i]=new nT,D[i].name="k-means subtable_"+i,S=(_=p[i]).length,s=0;s<S;s++)D[i].push(b[_[s]]);D[i]=D[i].transpose()}switch(n){case 0:return p;case 1:return M;case 2:return N;case 3:return v;case 4:return D;case 5:return{indexes:p,means:v,meanNumber:M,colors:N,subtables:D}}return null},product=function(t,e){if(null!=t&&null!=e){var n=t.length,r=t[0].length;if(0!==n&&0!==r&&n==e[0].length&&r==e.length){var o,i,s,a,l=new nT;for(o=0;o<n;o++)for(l[o]=new nL,i=0;i<n;i++){for(a=0,s=0;s<r;s++)a+=t[o][s]*e[s][i];l[o][i]=a}return l}}},getCovarianceMatrix=function(t){if(null!=t)return product(t,t.transpose()).factor(1/t.length)},generateNumberTable=function(t,e,n,r){t=null==t?0:t,n=null==n?e:n,r=null==r?1:r;var o,i=new i;switch(t){case 0:o=function(t,e){return t==e?r:0};break;case 1:o=function(t,e){return r};break;case 2:o=function(t,e){return Math.random()*r};break;case 3:o=function(t,e){return t==e?Math.random()*r:0}}for(var s=0;s<e;s++){i[s]=new nL,i[s].name="col_"+s;for(var a=0;a<n;a++)i[s][a]=o(s,a)}return i},identity=function(t){return t},mergeObjects=function(t,e){if(null==t)return null;if(null==e)return t;var n=Object.assign(cloneObject(t),e);return isEqual(t,n)?t:n},cloneObject=function(t){if(null==t)return null;var e;if(t.clone&&"function"==typeof t.clone)return t.clone();try{e=JSON.stringify(t)}catch(n){e=JSON.stringify(serliazeObject(t))}return JSON.parse(e)},serliazeObject=function(t){if(null==t)return null;var e,n,r;if(t.isTable){for(e=t.toArray(),n=t.length,r=0;r<n;r++)e[r]=serliazeObject(t[r]);return e}return t.isList?t.toArray():t},getInterval=function(t){if(null!=t)return null!=t.getInterval?t.getInterval():void 0},getFrame=function(t,e){var n;if(t.getFrame)return n=t.getFrame(),null!=e&&(n=n.expand(e)),n},getInfo=function(t,e){return null==t?null:(t.isTable?n=buildInformationObjectForTable(t,e):t.isList?n=buildInformationObjectForList(t,e):t.getInfo&&(n=t.getInfo()),null==n?null:(n.objectType=n.type,n.type=null,n));var n},getObjectStructure=function(t){var e=replaceValuesByNull(t);return objectToString(e)},replaceValuesByNull=function(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){if("object"==typeof t[n]&&null!=t[n]){e[n]=replaceValuesByNull(t[n]);continue}e[n]=null}return e},getLength=function(t,e){if(null!=t&&null!=t.length){if((e=null!=e&&e)&&null!=t.length){for(var n=0,r=0;r<t.length;r++)r in t&&n++;return n}return t.length}},includes=function(t,e){if(null!=t)return t.includes(e)},getPropertyValue=function(t,e){if(null!=t){for(var n="string"==typeof e?e.split("."):e,r=t[n[0]],o=1;null!=n[o];){if(null==r)return null;r=r[n[o]],o++}return r}},getPropertyValues=function(t,e,n){if(null!=t&&null!=t.length){if(t.isList)return t.getPropertyValues(e,n);var r,o=new L;o.name=e;for(var i=t.length,s=0;s<i;s++)r=getPropertyValue(t[s],e),o[s]=null==r?n:r;return o.downcast()}},getMultiplePropertyValues=function(){if(null==arguments||0===arguments.length||null==arguments[0])return null;for(var t=arguments[0],e=[],n=1;n<arguments.length;n++){var r={name:"value"+(n-1),description:arguments[n]?"The value of property "+arguments[n]:""};r.value=arguments[n]?getPropertyValue(t,arguments[n]):null,r.type=null==r.value?"Object":_typeOf(r.value),e.push(arguments[n]?r:null)}return e.isOutput=!0,e},getName=function(t){if(null!=t)return t.name},isPropertyValue=function(t,e){if(null==t)return!1;for(var n in t)if(t[n]===e)return!0;return!1},getPropertiesNames=function(t){if(null!=t){var e=sL.toL(Object.getOwnPropertyNames(t));return e.removeElement("__ob__"),e}},getPropertiesNamesAndValues=function(t){if(null!=t){var e=new T;return e[0]=getPropertiesNames(t),e[1]=new L,e[0].forEach((function(n,r){e[1][r]=t[n]})),e[1]=e[1].downcast(),e}},setPropertyValue=function(t,e,n,r,o){if(null!=t&&null!=e){var i=r?t:cloneObject(t);if(o&&null==n)return i;for(var s="string"==typeof e?e.split("."):e,a=i,l=0;l<s.length-1;l++)a=a[s[l]]=a[s[l]]||{};return a[s[l]]=n,i}},interpolateObjects=function(t,e,n,r){var o,i,s=_typeOf(t),a=1-(n=null==n?.5:n);if(s!=_typeOf(e))return n<.5?t:e;switch(s){case"number":return r&&Math.abs(t-e)<=r?e:a*t+n*e;case"I":return r&&Math.abs(t.x-e.x)+Math.abs(t.y-e.y)<=r?e:new I(a*t.x+n*e.x,a*t.y+n*e.y);case"nL":var l=Math.min(t.length,e.length),u=new nL;for(i=0,o=0;o<l;o++)u[o]=a*t[o]+n*e[o],i+=Math.pow(e[o]-u[o],2);return r&&i<r*r?e:u;case"Pol":l=Math.min(t.length,e.length);var h=new Pol;for(o=0;o<l;o++)h[o]=twoPointsInterpolation(t[o],e[o],n);return h;case"T":case"nT":var c=instanceSameType(e),f=(l=Math.min(t.length,e.length),!0);for(o=0;o<l;o++)c[o]=interpolateObjects(t[o],e[o],n,r),f=f&&c[o]==e[o];return f?e:c}return n<.5?t:e},replaceObject=function(t,e,n){return t==e?n:t},toList=function(t){return L.toL(t).downcast()},floor=function(t){return"number"==typeof t?Math.floor(t):t.floor?t.floor():null},addition=function(){var t,e;if(arguments.length<2){if(1==arguments.length&&null!=arguments[0]&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=addition(t,arguments[0][e]);return t}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.addition);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnObjectWithList(arguments[0],arguments[1],ObjectOperators.addition);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=!1;i<o&&"string"!=i&&"string"!=o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r),s=!0);var a=o+"_"+i;switch(a){case"boolean_boolean":return n&&r;case"date_string":return s?r+dateToString(n):dateToString(n)+r;case"number_string":case"string_string":case"string_number":case"boolean_number":case"number_number":return n+r;case"PointPoint":return new P(n.x+r.x,n.y+r.y);case"Point3DPoint3D":return new P3D(n.x+r.x,n.y+r.y,n.z+r.z);case"numberPoint":return new P(n.x+r,n.y+r);case"numberPoint3D":return new P3D(n.x+r,n.y+r,n.z+r);case"Interval_number":return new I(n.x+r,n.y+r);case"IntervalPoint":return new P(n.getMin()+r.x,n.getMax()+r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x+r.x,n.y+r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()+r.x,n.getMax()+r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x+r.x,n.y+r.y,n.width+r.width,n.height+r.height);case"date_number":return new Date(n.getTime()+r/DateOperators_millisecondsToDays);case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(addition(n,r.date0),addition(n,r.date1));case"DateInterval_number":return new dI(addition(n.date0,r),addition(n.date1,r));case"DateInterval_Interval":return new dI(addition(n.date0,r.min),addition(n.date1,r.max));case"DateInterval_DateInterval":return new dI(addition(n.date0,r.date0),addition(n.date1,r.date1));case"string_StringList":return r.append(n,!1);case"StringList_string":return r.append(n,!0);default:return null}return n+r}for(t=arguments[0],e=1;e<arguments.length;e++)t=addition(t,arguments[e]);return t},multiplication=function(){var t,e;if(arguments.length<2){if(1==arguments.length&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=multiplication(t,arguments[0][e]);return t}return null}var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r),s=o+"_"+i;if(2==arguments.length){if(null==arguments[0])return null;if("NumberTable_NumberTable"==s)return product(n,r);if(arguments[0].isList&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.multiplication);if(arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.multiplication);switch(i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r)),s=o+"_"+i){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n*r;case"PointPoint":return pointMultiplication(n,r);case"Point3DPoint3D":return new P3D(n.x*r.x,n.y*r.y,n.z*r.z);case"numberPoint":return new P(n.x*r,n.y*r);case"numberPoint3D":return new P3D(n.x*r,n.y*r,n.z*r);case"Interval_number":return new I(n.getMin()*r,n.getMax()*r);case"IntervalPoint":return new P(n.getMin()*r.x,n.getMax()*r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x*r.x,n.y*r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()*r.x,n.getMax()*r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x*r.x,n.y*r.y,n.width*r.width,n.height*r.height);case"date_number":return new Date(n.getTime()*(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(multiplication(n,r.date0),multiplication(n,r.date1));case"DateInterval_number":return new dI(multiplication(n.date0,r),multiplication(n.date1,r));case"DateInterval_Interval":return new dI(multiplication(n.date0,r.min),multiplication(n.date1,r.max));case"DateInterval_DateInterval":return new dI(multiplication(n.date0,r.date0),multiplication(n.date1,r.date1));default:return null}return n*r}for(t=arguments[0],e=1;e<arguments.length;e++)t=multiplication(t,arguments[e]);return t},division=function(){var t,e;if(arguments.length<2){if(1==arguments.length&&arguments[0]&&arguments[0].isList){for(t=arguments[0][0],e=1;null!=arguments[0][e];e++)t=division(t,arguments[0][e]);return t}return null}if(2==arguments.length){if(null!=arguments[0]&&arguments[0].isList&&null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnLists(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[0]&&arguments[0].isList)return _applyBinaryOperatorOnListWithObject(arguments[0],arguments[1],ObjectOperators.division);if(null!=arguments[1]&&arguments[1].isList)return _applyBinaryOperatorOnListWithObject(arguments[1],arguments[0],ObjectOperators.division);var n=arguments[0],r=arguments[1],o=_typeOf(n),i=_typeOf(r);i<o&&(r=arguments[0],o=_typeOf(n=arguments[1]),i=_typeOf(r));var s=o+"_"+i;switch(s){case"number_number":case"boolean_boolean":case"boolean_number":case"Date_string":case"number_string":case"string_string":return n/r;case"PointPoint":return new P(n.x/r.x,n.y/r.y);case"Point3DPoint3D":return new P3D(n.x/r.x,n.y/r.y,n.z/r.z);case"numberPoint":return new P(n.x/r,n.y/r);case"numberPoint3D":return new P3D(n.x/r,n.y/r,n.z/r);case"Interval_number":return new I(n.getMin()/r,n.getMax()/r);case"IntervalPoint":return new P(n.getMin()/r.x,n.getMax()/r.y);case"Interval_Interval":return new P(n.getMin()+r.getMin(),n.getMax()+r.getMax());case"Point_Rectangle":return new Rec(n.x/r.x,n.y/r.y,r.width,r.height);case"Interval_Rectangle":return new Rec(n.getMin()/r.x,n.getMax()/r.y,r.width,r.height);case"Rectangle_Rectangle":return new Rec(n.x/r.x,n.y/r.y,n.width/r.width,n.height/r.height);case"date_number":return new Date(n.getTime()/(r/DateOperators_millisecondsToDays));case"date_date":return new Date(Number(n.getTime()+r.getTime()));case"date_DateInterval":return new dI(division(n,r.date0),division(n,r.date1));case"DateInterval_number":return new dI(division(n.date0,r),division(n.date1,r));case"DateInterval_Interval":return new dI(division(n.date0,r.min),division(n.date1,r.max));case"DateInterval_DateInterval":return new dI(division(n.date0,r.date0),division(n.date1,r.date1));default:return null}return n/r}for(t=arguments[0],e=1;e<arguments.length;e++)t=division(t,arguments[e]);return t},applyFunctionOnInput=function(t,e,n,r,o,i,s){if(null!=t&&null!=e)return"string"==typeof e&&(e=stringToFunction(e)),e.apply(this,[t,n,r,o,i,s])},isEqual=function(t,e){return _recursiveEqual(t,e)},_recursiveEqual=function(t,e){if(t==e)return!0;var n=_typeOf(t);if("string"==n||"number"==n||"boolean"==n||"null"==n)return!1;if(null==t||null==e)return!1;if(Object.keys(t).length!=Object.keys(e).length)return!1;for(var r in t)if(!_recursiveEqual(t[r],e[r]))return!1;return 0!=Object.keys(t).length||null==t.toString||null==e.toString||t.toString()==e.toString()},arrayOfArraysToTable=function(t,e,n){if(null==t)return null;e=null==e||e,n=null==n||n;for(var r=new T,o=e?1:0,i=0;i<t.length;i++){r[i]=new L,e&&t[i].length>0?r[i].name=String(t[i][0]):r[i].name="_";for(var s=o;s<t[i].length;s++)if(r[i][s-o]=t[i][s],n&&null!==r[i][s-o]){var a=String(r[i][s-o]),l=Number(a.replace(",",".")),u=l||0===l&&""!==a?l:a;"string"==typeof u&&(u=_removeQuotes(u)),r[i][s-o]=u}r[i]=r[i].downcast()}return r.downcast()},operate=function(operation,x,y,factor,mapFunction,name,numIterations){if(numIterations>1){var accumulated=x.isList?new T:new L;accumulated.push(x);for(var i=0;i<numIterations;i++)x=operate(operation,x,y,factor,mapFunction,name),accumulated.push(x);return accumulated.downcast()}if(numIterations<=-1)return operate(operation,operate(operation,x,y,factor,mapFunction,name,numIterations+1),y,factor,mapFunction,name);var f=null!=mapFunction?mapFunction:[_sum,_multiplication,_pow2,_pow3,Math.pow,Math.sqrt,Math.log,_logSum,Math.log2,_log2Sum,_log_y,Math.cos,_cosSum,Math.sin,_sinSum,Math.tan,_tanSum,Math.atan2,Math.floor,Math.round,Math.ceil,Math.abs,_modulo,_subtract,_divide][operation];factor=null==factor?1:factor;var type_x=null==x?"object":x.isTable?"table":x.isList?"list":"object",type_y=null==y?"object":y.isTable?"table":y.isList?"list":"object",combinedType=type_x+"_"+type_y,i,nL,nT,l;switch("string"==_typeOf(f)&&eval("f = function(x,y){ return "+f+"}"),combinedType){case"object_list":for(nL=new L,nL.name=null==name?y.name:name,i=0;i<y.length;i++)nL[i]=1==factor?f(x,y[i]):factor*f(x,y[i]);return nL.downcast();case"list_object":for(nL=new L,nL.name=null==name?x.name:name,i=0;i<x.length;i++)nL[i]=1==factor?f(x[i],y):factor*f(x[i],y);return nL.downcast();case"list_list":for(nL=new L,nL.name=null==name?y.name:name,l=Math.min(x.length,y.length),i=0;i<l;i++)nL[i]=1==factor?f(x[i],y[i]):factor*f(x[i],y[i]);return nL.downcast();case"object_table":for(nT=new T,nT.name=name,i=0;i<y.length;i++)nT[i]=operate(operation,x,y[i],factor,mapFunction);return nT.downcast();case"table_object":for(nT=new T,nT.name=name,i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y,factor,mapFunction);return nT.downcast();case"list_table":case"table_list":case"table_table":for(nT=new T,nT.name=name,l=Math.min(x.length,y.length),i=0;i<x.length;i++)nT[i]=operate(operation,x[i],y[i],factor,mapFunction);return nT.downcast();default:return 1==factor?f(x,y):factor*f(x,y)}},_sum=function(t,e){return t+e},_multiplication=function(t,e){return t*e},_pow2=function(t){return Math.pow(t,2)},_pow3=function(t){return Math.pow(t,2)},_logSum=function(t,e){return Math.log(t+e)},_log2Sum=function(t,e){return Math.log2(t+e)},_log_y=function(t,e){return Math.log(t)/Math.log(e)},_cosSum=function(t,e){return Math.cos(t+e)},_sinSum=function(t,e){return Math.sin(t+e)},_tanSum=function(t,e){return Math.tan(t+e)},_modulo=function(t,e){return t%e},_subtract=function(t,e){return t-e},_divide=function(t,e){return t/e},numberToString=function(t,e){var n=t.toFixed(e);if(0==e)return n;for(;"0"==n.charAt(n.length-1);)n=n.substring(0,n.length-1);return"."==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},getRandomWithSeed=function(t){return(t=(9301*(t=null==t?1:t)+49297)%233280)/233280},numberFromBinaryPositions=function(t){var e,n=0;for(e=0;null!=t[e];e++)n+=Math.pow(2,t[e]);return n},numberFromBinaryValues=function(t){for(var e=0,n=t.length,r=0;r<n;r++)e+=1==t[r]?Math.pow(2,n-(r+1)):0;return e},powersOfTwoDecomposition=function(t,e){for(var n,r=new nL;0<t;)r[n=Math.floor(Math.log(t)/Math.LN2)]=1,t-=Math.pow(2,n);e=Math.max(r.length,null==e?0:e);for(var o=0;o<r.length;o++)r[o]=r[o]?1:0;for(;r.length<e;)r.unshift(0);return r},toBinary=function(t,e,n=!0){var r=powersOfTwoDecomposition(t,e);return n||(r=r.getReversed()),r},binaryToNumber=function(t,e=!0){if(null!=t){for(var n=e?t.getReversed():t,r=0,o=n.length,i=0;i<o;i++)r+=0==Number(n[i])?0:Math.pow(2,o-(i+1));return r}},positionsFromBinaryValues=function(t){var e,n=new nL;for(e=0;null!=t[e];e++)1==t[e]&&n.push(e);return n},_Alea=function(){return function(t){var e=0,n=0,r=0,o=1;0===t.length&&(t=[+new Date]);var i=_Mash();e=i(" "),n=i(" "),r=i(" ");for(var s=0;s<t.length;s++)(e-=i(t[s]))<0&&(e+=1),(n-=i(t[s]))<0&&(n+=1),(r-=i(t[s]))<0&&(r+=1);i=null;var a=function(){var t=2091639*e+2.3283064365386963e-10*o;return e=n,n=r,r=t-(o=0|t)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.version="Alea 0.9",a.args=t,a}(Array.prototype.slice.call(arguments))},_Mash=function(){var t=4022871197,e=function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e.version="Mash 0.9",e},random=function(){return new _Alea},randomSeed=function(t){NumberOperators_stackRandom.push(NumberOperators_random),NumberOperators_stackRandom.length>100&&NumberOperators_stackRandom.shift(),NumberOperators_random=new _Alea("my",t,"seeds"),NumberOperators_lastNormal=NaN},randomSeedPop=function(){NumberOperators_stackRandom.length>0&&(NumberOperators_random=NumberOperators_stackRandom.pop())},decimalPlaces=function(t){var e=String(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},logistic=function(t,e,n,r){return null==t||isNaN(t)?null:(n=null==n?0:n,r=null==r?1:r,(e=null==e?1:e)/(1+Math.exp(-r*(t-n))))},formatShort=function(t,e){if(null!=t){if(0==t||t==1/0)return String(t);if(isNaN(t))return t;if(e=null==e||e<1?2:e,String(t).length<=e)return String(t);var n=parseFloat(t.toPrecision(e)),r=Math.floor(Math.log10(n)),o="";return r>=15?(n=parseFloat((n/Math.pow(10,r)).toPrecision(e)),o="e"+r):r>=12?(n/=Math.pow(10,12),o="t"):r>=9?(n/=Math.pow(10,9),o="b"):r>=6?(n/=Math.pow(10,6),o="m"):r>=3?(n/=Math.pow(10,3),o="k"):r<-3&&(n=parseFloat((n/Math.pow(10,r)).toPrecision(e)),o="e"+r),(n=parseFloat(n.toPrecision(12)))+o}},numberToPosition=function(t){var e=t%10,n=t%100;return 1==e&&11!=n?t+"st":2==e&&12!=n?t+"nd":3==e&&13!=n?t+"rd":t+"th"},getSoftenControlPoints=function(t,e,n,r){r=r||10;var o=angleFromTwoPoints(t,n);return[new P(e.x-r*Math.cos(o),e.y-r*Math.sin(o)),new P(e.x+r*Math.cos(o),e.y+r*Math.sin(o))]},bezierCurvePoints=function(t,e,n,r,o,i,s,a,l){let u=1-l,h=u*n+l*o,c=u*r+l*i;return new P(l*(u*h+l*(u*o+l*s))+u*(u*(u*t+l*n)+l*h),l*(u*c+l*(u*i+l*a))+u*(u*(u*e+l*r)+l*c))},triangleContainsPoint=function(t,e,n,r){var o=(t.x-r.x)*(e.y-r.y)-(e.x-r.x)*(t.y-r.y),i=(e.x-r.x)*(n.y-r.y)-(n.x-r.x)*(e.y-r.y),s=(n.x-r.x)*(t.y-r.y)-(t.x-r.x)*(n.y-r.y);return o>0&&i>0&&s>0||o>=0&&i>=0&&s>=0},triangleArea=function(t){return Math.abs(t.a.x*(t.b.y-t.c.y)+t.b.x*(t.c.y-t.a.y)+t.c.x*(t.a.y-t.b.y))/2},lineFromTwoPoints=function(t,e){if(t.x==e.x)return new P(1/0,t.x);var n=(e.y-t.y)/(e.x-t.x);return new P(n,t.y-n*t.x)},distancePointToLine=function(t,e){var n,r;0===e.x?(n=1/0,r=t.x):(n=-1/e.x,r=t.y-n*t.x);var o=intersectionLines(e,new P(n,r));return Math.sqrt(Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2))},distancePointToSegment=function(t,e,n){var r,o,i=e.x==n.x?1/0:(n.y-e.y)/(n.x-e.x),s=i==1/0?new P(1/0,e.x):new P(i,e.y-i*e.x);0===s.x?(r=1/0,o=t.x):(r=-1/s.x,o=t.y-r*t.x);var a=intersectionLines(s,new P(r,o));return a.x>=Math.min(e.x,n.x)&&a.x<=Math.max(e.x,n.x)?t.distanceToPoint(a):Math.min(t.distanceToPoint(e),t.distanceToPoint(n))},intersectionLines=function(t,e){if(t.x==e.x)return t.y==e.y?t.x==1/0?new P(t.y,0):new P(0,t.y):null;if(t.x==1/0)return new P(t.y,e.x*t.y+e.y);if(e.x==1/0)return new P(e.y,t.x*e.y+t.y);var n=(e.y-t.y)/(t.x-e.x);return new P(n,t.x*n+t.y)},numberTableToPolygon=function(t){if(null==t||t.length<2)return null;var e,n=Math.min(t[0].length,t[1].length),r=new Pol;for(e=0;e<n;e++)r[e]=new P(t[0][e],t[1][e]);return r},numberTableToColorList=function(t,e){if(null!=t){if(e=null==e||e,"T"!=t.type&&"nT"!=t.type)throw new Error("Input must be a table");if(t.length<3)throw new Error("T must have at least 3 lists");for(var n,r,o,i=new i,s=0;s<t[0].length;s++){if(e)n=Math.max(0,Math.min(255,Math.round(t[0][s]))),r=Math.max(0,Math.min(255,Math.round(t[1][s]))),o=Math.max(0,Math.min(255,Math.round(t[2][s])));else{var a=HSVtoRGB(t[0][s],t[1][s],t[2][s]);n=Math.max(0,Math.min(255,Math.round(a[0]))),r=Math.max(0,Math.min(255,Math.round(a[1]))),o=Math.max(0,Math.min(255,Math.round(a[2])))}if(isNaN(n)||isNaN(r)||isNaN(o))throw new Error("Invalid format. T cells must be numbers in range [0,255]");i.push("rgb("+n+","+r+","+o+")")}return i}},numberTableToNetwork=function(t,e,n){n=null==n?0:n;var r,o,i,s,a,l,u,h,c=new Net;if(0===e)for(i=0;null!=t[i+1];i++)for(r=t[i],0===i?(a=new Nd(r.name,r.name),c.addNode(a)):a=c.nodes[i],s=i+1;null!=t[s];s++)o=t[s],0===i?(l=new Nd(o.name,o.name),c.addNode(l)):l=c.nodes[s],o=t[s],(h=1/(1+standardDeviationTwoNumberLists(r,o)))>=n&&(u=new Rel(i+"_"+s,a.name+"_"+l.name,a,l,h),c.addRelation(u));return c},buildDendrogramFromPolygon=function(t){var e,n,r,o=new Tr,i=new ndL,s=new Pol;t.forEach((function(t,n){(e=new Nd("point_"+n,"point_"+n)).weight=1,e.barycenter=t,e.point=t,e.polygon=new Pol(t),o.addNode(e),s.push(e),i.push(e)})),o.nodes=o.nodes.getReversed();for(var a,l=function(t,e){var r=new Nd("("+t.id+","+e.id+")","("+t.id+","+e.id+")");return r.polygon=t.polygon.concat(e.polygon),r.weight=r.polygon.length,n=t.weight+e.weight,r.barycenter=new P((t.weight*t.barycenter.x+e.weight*e.barycenter.x)/n,(t.weight*t.barycenter.y+e.weight*e.barycenter.y)/n),o.addNode(r),o._newCreateRelation(r,t),o._newCreateRelation(r,e),r};s.length>1;)a=_findClosestNodes(s),(r=l(s[a[0]],s[a[1]])).distance=a.distance,s.splice(a[0],1),s.splice(a[1]-1,1),s.push(r);o.nodes=o.nodes.getReversed();var u=function(t,e){t.level=e+1,t.to.forEach((function(e){u(e,t.level)}))};return u(o.nodes[0],-1),o.leaves=i,o},_findClosestNodes=function(t){var e,n,r,o,i=9999999999;for(e=0;null!=t[e+1];e++)for(n=e+1;null!=t[n];n++)(r=Math.pow(t[e].barycenter.x-t[n].barycenter.x,2)+Math.pow(t[e].barycenter.y-t[n].barycenter.y,2))<i&&(i=r,o=[e,n]);return o.distance=i,o},sortOnXY=function(t){return t.sort((function(t,e){return t.x<e.x||t.x==e.x&&t.y<e.y?-1:1}))},expandFromBarycenter=function(t,e){for(var n=new Pol,r=t.getBarycenter(),o=0;null!=t[o];o++)n[o]=t[o].expandFromPoint(r,e);return n},simplifyPolygon=function(t,e){e=null==e||0===e||void 0===e?1:e;var n,r,o,i,s,a=t.clone(),l=t.length;for(s=0;s<l;s++)n=a[s],r=a[(s+1)%l],o=a[(s+2)%l],i=lineFromTwoPoints(n,o),distancePointToLine(r,i)<e&&(a=a.getWithoutElementAtIndex((s+1)%l),s--),l=a.length;return a},bezierPolygonContainsPoint=function(t,e,n,r){var o=t.getFrame();r.clearContext(),r.context.fillStyle="black",r.context.fillRect(0,0,o.width,o.height),null!=n&&(r.context.strokeStyle="black",r.context.lineWidth=n),r.context.fillStyle="white",r.context.beginPath(),r.drawBezierPolygon(t,-o.x,-o.y),r.context.fill(),null!=n&&r.context.stroke();var i=r.context.getImageData(e.x-o.x,e.y-o.y,1,1).data;return r.clearContext(),i[0]>0},placePointsInsidePolygon=function(t,e,n){var r=new Pol,o=t.getFrame();if(0===(n=n||0)){for(var i;r.length<e;)i=new P(o.x+Math.random()*o.width,o.y+Math.random()*o.height),polygonContainsPoint(t,i)&&r.push(i);return r}},placePointsInsideBezierPolygon=function(t,e,n,r){var o=new Pol,i=t.getFrame();if(0===(n=n||0)){for(var s,a=0;o.length<e&&a<1e3;)s=new P(i.x+Math.random()*i.width,i.y+Math.random()*i.height),a++,bezierPolygonContainsPoint(t,s,r)&&(o.push(s),a=0);return o}},geoCoordinateToDecimal=function(t){return Math.floor(t)+1.66667*(t-Math.floor(t))},geoDistance=function(t,e){var n=Math.pow(Math.sin(.5*(e.y-t.y)*gradToRad),2)+Math.cos(t.y*gradToRad)*Math.cos(e.y*gradToRad)*Math.pow(Math.sin(.5*(e.x-t.x)*gradToRad),2);return GeoOperators_EARTH_DIAMETER*Math.atan2(Math.sqrt(n),Math.sqrt(1-n))},polygonLength=function(t){if(t.length<2)return 0;for(var e=geoDistance(t[0],t[1]),n=2;null!=t[n];n++)e+=geoDistance(t[n-1],t[n]);return e},minRect=function(){if(null==arguments||arguments.length<1)return null;var t,e=arguments[0].clone();for(e.width=e.getRight(),e.height=e.getBottom(),t=1;null!=arguments[t];t++)e.x=Math.min(e.x,arguments[t].x),e.y=Math.min(e.y,arguments[t].y),e.width=Math.max(arguments[t].getRight(),e.width),e.height=Math.max(arguments[t].getBottom(),e.height);return e.width-=e.x,e.height-=e.y,e},packingCircles=function(t,e,n){if(null==t||0===t.length)return null;var r=function(t,e,n,r,o){for(var i,s=0;null!=t[s];s++)if(i=t[s],Math.pow(i.x-e,2)+Math.pow(i.y-n,2)<Math.pow(i.z+r+o,2))return!0;return!1};n=null==n?0:n;for(var o,i,s,a=_.normalizeToMax(t).sqrt(),l=new Pol3D,u=0,h=0,c=0,f=0,p=e.getCenter(),g=100*a[0],d=e.width/e.height,m=0;m<a.length;m++){if(o=100*a[m],0===m)c=p.x,f=p.y,i=o;else{for(u=0,h=i+o+n+.1;r(l,c,f,o,n);)u+=.005*(h+=.1),c=p.x+d*h*Math.cos(u),f=p.y+h*Math.sin(u);g=Math.max(g,d*h+100*a[m])}l[m]=new _.P3D(c,f,o)}for(d=.5*e.width/(g+.001),m=0;null!=l[m];m++)(s=l[m]).x=p.x+(s.x-p.x)*d,s.y=p.y+(s.y-p.y)*d,s.z*=d;return l},packingRectangles=function(t,e,n,r){switch(null==n&&(n=new Rec(0,0,1,1)),e=e||0){case 0:return squarify(n,t);case 1:var o=t.getInterval();o.min<0&&(t=t.add(-o.min),o=new I(0,o.max-o.min));var i,s,a=t.getSum(),l=new L,u=n.y,h=n.height/a;for(s=0;null!=t[s];s++)i=h*t[s],l.push(new Rec(n.x,u,n.width,i)),u+=i;return l;case 2:(o=t.getInterval()).min<0&&(t=t.add(-o.min),o=new I(0,o.max-o.min)),a=t.getSum(),l=new L;var c,f=n.x,p=n.width/a;for(s=0;null!=t[s];s++)c=p*t[s],l.push(new Rec(f,n.y,c,n.height)),f+=c;return l;case 3:if(t.length<6);else if(6==t.length){var g=new Rec(.44,.36,.16,.45),d=new Rec(.6,.15,.3,.3),m=new Rec(.72,.45,.28,.32),y=new Rec(.38,.04,.22,.32),v=new P(.6,.36);g=expandRectangle(g,Math.sqrt(t[0]),v),d=expandRectangle(d,Math.sqrt(t[1]),v),y=expandRectangle(y,Math.sqrt(t[3]),v),m.x=d.x+.5*d.width,m.y=d.bottom;var w=new P(m.x+.3*m.width,d.bottom);(m=expandRectangle(m,Math.sqrt(t[2]),w)).y+=.2*m.height;var x=new P(.26,.36+Math.max(.3*g.height,.2*y.height)),b=new Rec(.1,x.y-.4,.2,.4),T=new Rec(.22,x.y,.16,.5);b=expandRectangle(b,Math.sqrt(t[4]),x),T=expandRectangle(T,Math.sqrt(t[5]),x);var M=.2*Math.max(y.width,g.width,T.right-x.x,b.right-x.x),_=Math.min(y.x,g.x)-Math.max(b.right,T.right)-M;return T.x+=_,b.x+=_,new L(g,d,m,y,b,T)}case 4:case 5:var S;S=0===(r=r||0)?Math.round(Math.sqrt(t.length)):Math.round(t.length/r);var N=Math.ceil(t.length/S),R=S*N-t.length,E=t.getMean(),C=concat(t,createListWithSameElement(R,E)),D=slidingWindowOnList(C,N,N,0),O=D.getSums(),k=this.packingRectangles(O,2,n);for(l=L(),s=0;s<S;s++)l=concat(l,this.packingRectangles(D[s],1,k[s]));return l}return null},squarify=function(t,e,n,r){if(null!=e){if(0===e.length)return new recL;if(1===e.length)return new recL(t);var o,i;r=r||!1,o=(n=n||!1)?e:normalizeToSum(e),r||(i=null==e.positions?o.getSortIndexes():e.positions,o=null==o.sortedWeights?o.getSorted(!1):o.sortedWeights);var s,a,l,u,h,c,f,p,g,d,m=t.width*t.height,y=new recL,v=t.clone(),w=new L,x=0,b=new Rec,T=e.length;if(T>2)for(p=x;p<T;p++)if(l=Number.MAX_VALUE,0===o[p])y.push(new Rec(b.x,b.y,0,0));else{for(g=1;g<T&&(s=nL.toL(o.slice(p,p+g)),a=w.slice(),h=(d=s.getSum())*m,b.x=v.x,b.y=v.y,v.width>v.height?(b.width=h/v.height,b.height=v.height):(b.width=v.width,b.height=h/v.width),!(l<=(u=(w=partitionRectangle(b,s,d)).highestRatio)));g++)l=u;if(0===a.length){if(y.push(new Rec(v.x,v.y,v.width,v.height)),y.length==T){if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}x++}else{if((y=y.concat(a)).length==T){if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}x+=a.length,c=a[a.length-1],v.width>v.height?(v.x=c.width+c.x,v.width-=c.width):(v.y=c.height+c.y,v.height-=c.height)}p=x-1}else 2==T?(s=o.clone(),b=t.clone(),y=partitionRectangle(b,s,s.getSum())):y[0]=new Rec(t.x,t.y,t.width,t.height);if(!r){for(f=new L,p=0;null!=y[p];p++)f[i[p]]=y[p];return f}return y}},partitionRectangle=function(t,e,n){var r,o,i,s=t.width*t.height,a=new L,l=new Rec(t.x,t.y,t.width,t.height),u=1,h=e.length;for(o=0;o<h;o++)r=e[o]*s/n,t.width>t.height?(i=new Rec(l.x,l.y,r/l.height,l.height),a.push(i),l.x+=r/l.height):(i=new Rec(l.x,l.y,l.width,r/l.width),a.push(i),l.y+=r/l.width),i.ratio=Math.max(i.width,i.height)/Math.min(i.width,i.height),u=Math.max(u,i.ratio);return a.highestRatio=u,a},_getHighestRatio=function(t){var e,n,r=1;for(n=0;n<t.length;n++)e=t[n],r=Math.max(r,e.getRatio());return r},simplifyPolygons=function(t,e,n){for(var r,o=new polL,i=0;null!=t[i];i++)((r=simplifyPolygon(t[i],e)).length>0||!n)&&o.push(r);return o},createPolygon=function(t,e,n){var r=new Pol;if(0===e)for(var o=0;o<t;o++)r.push(new P(n.x+n.width*Math.random(),n.y+n.height*Math.random()));return r},twoNumberListsToPolygon=function(t,e){for(var n=Math.min(t.length,e.length),r=new Pol,o=0;o<n;o++)r[o]=new P(t[o],e[o]);return r},colorListFromColorScale=function(t,e){return t.getColorList.apply(t,[e])},colorListFromColorScaleFunction=function(t,e){var n,r=new cL;for(n=0;n<e;n++)r[n]=t(n/(e-1));return r},colorsLinearCombination=function(t,e){if(null!=t&&0!=t.length){if(1==t.length)return t[0];null==e&&(e=createListWithSameElement(t.length,1)),e=normalizeToSum(e);for(var n,r=colorStringToRGB(t[0],e[0]),o=1;o<t.length;o++)n=colorStringToRGB(t[o],e[o]),r[0]+=n[0],r[1]+=n[1],r[2]+=n[2];return"rgb("+Math.floor(r[0])+","+Math.floor(r[1])+","+Math.floor(r[2])+")"}},polygon3DToColorList=function(t){var e,n=t.length,r=new cL;for(e=0;e<n;e++)r.push(point3DToColor(t[e]));return r},colorListToPolygon3D=function(t){var e,n=t.length,r=new Pol3D;for(e=0;e<n;e++)r.push(colorToPoint3D(t[e]));return r},randomColor=function(t){return t=null==t?1:t,"rgba("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+t+")"},getFlowTable=function(t,e,n){if(null!=t){e=e||!1;var r,o,i,s,a,l,u=t.length,h=t[0].length,c=new nL,f=new nL,p=new nL,g=-9999999,d=9999999,m=-9999999;for(a=0;a<h;a++){for(o=9999999,i=-9999999,s=0,l=0;l<u;l++){if((r=t[l]).length!=h)return;i=Math.max(i,r[a]),o=Math.min(o,r[a]),s+=r[a]}c.push(o),f.push(i),p.push(s),d=Math.min(d,o),g=Math.max(g,i),m=Math.max(m,s)}var y,v,L,w=m-d,x=new nT,b=n?1:0;if(e&&n)return x=new nT(t.length+1),t[0].forEach((function(){x[0].push(0)})),t.forEach((function(t,e){t.forEach((function(t,n){var r=p[n];x[e+1][n]=t/(0===r?1e-5:r)+x[e][n]}))})),x;for(x=new nT,e?v=Math.max(d,0):(v=d,L=w),a=0;a<u;a++)y=new nL,x.push(y);for(n&&x.push(new nL),a=0;a<h;a++)for(r=t[0],e&&(L=p[a]-v),n&&(x[0][a]=0),0===L&&(L=1e-5),x[b][a]=(r[a]-v)/L,l=1;l<u;l++)r=t[l],x[l+b][a]=(r[a]-v)/L+x[l-1+b][a];return x}},getFlowTableIntervals=function(t,e,n,r){if(null==t)return null;var o,i,s,a,l,u,h=getFlowTable(t,e,!0),c=new T,f=h.length,p=h[0].length,g=new nL;for(o=1;o<f;o++)for(h[o],s=new L,c[o-1]=s,i=0;i<p;i++)s.push(new I(h[o-1][i],h[o][i])),o==f-1&&(g[i]=h[o][i]);if(n)for(i=0;i<p;i++){for(l=new nL,s=c[o],o=0;o<f-1;o++)l.push(c[o][i].getAmplitude());var d=l.getSortIndexes();for(u=e||r?0:.5*(1-g[i]),o=0;o<f-1;o++)(a=c[d[o]][i]).y=u+a.getAmplitude(),a.x=u,u=a.y}else if(!e)for(i=0;i<p;i++)for(o=0;o<f-1;o++)a=c[o][i],r?(c[o][i].x=1-c[o][i].x,c[o][i].y=1-c[o][i].y):c[o][i]=a.add(.5*(1-g[i]));return c},scaleIntervals=function(t,e){if(null!=t){e=null==e?1:e;var n,r=new L,o=t.length;for(r.name=t.name,n=0;n<o;n++)r[n]=t[n].getScaled(e);return r}},nlsToIntervalList=function(t,e,n){if(null!=t&&null!=e){n=null!=n&&n;var r,o=Math.min(t.length,e.length),i=new iL;for(n&&(e=addition(t,e)),r=0;r<o;r++)i.push(new I(t[r],e[r]));return i}},fillTextRectangle=function(t,e,n,r,o,i,s,a,l,u,h){u=null!=u&&u,h=null!=h&&h;var c=textWordWrapReturnLines(t,r,o,i,a,l);h&&(n+=((null==o?600:o)-(null==i?16:i)*c.length)/2);var f=l.context.textAlign;u&&(l.context.textAlign="center",e+=(null==r?100:r)/2);var p=fillTextRectangleWithTextLines(c,e,n,o,i,s,l);return l.context.textAlign=f,p},fillTextRectangleWithTextLines=function(t,e,n,r,o,i,s){r=0===r||null==r?99999:r;for(var a=0;null!=t[a]&&(s.context.fillText(t[a],e,n+a*o),!((a+2)*o>r));a++);return i?t.length*o:t.length},textWordWrapReturnLines=function(t,e,n,r,o,i){e=e||100,n=n||600;var s=0===(r=r||16)?-1:Math.floor(n/r),a=new sL;if(e<=0)return a.push(t),a;var l,u,h,c,f,p,g=t.split(/\\n|\n/);for(l=0;l<g.length;l++)if(""!==g[l])if(i.context.measureText(g[l]).width<e&&a.length<s)a.push(g[l]);else{for(u=g[l].split(" "),h=1;u.length>0&&h<=u.length;)if(c=u.slice(0,h).join(" "),(f=i.context.measureText(c).width)>e){if(1==h&&(h=2),""!==(p=u.slice(0,h-1).join(" "))&&a.push(p),a.length==s){if(o){var d=a[a.length-1];i.context.measureText(d+"").width<=e?a[a.length-1]+="":(p=(u=d.split(" ")).slice(0,u.length-1).join(" ")+"",a.push(p))}return a}u=u.splice(h-1),h=1}else h++;h>0&&""!==(p=u.join(" "))&&a.push(p)}else a.push("");return a.width=1==a.length?f:e,a},getMaxTextWidth=function(t,e){for(var n=e.getTextW(t[0]),r=1;null!=t[r];r++)n=Math.max(n,e.getTextW(t[r]));return n},stringToObject=function(t){try{return JSON.parse(t)}catch(t){}if(null==t)return null;for(var e,n=t.split(/\r?\n/),r="[",o=!1,i=0;i<n.length;i++)if(0!=n[i].trim().length){if("{"==n[i]){for(e="";"}"!=n[i]&&i<n.length;)e+=" "+n[i],i++;e+="}"}else e=n[i];e=(o?",\r\n":"\r\n")+e,o=!0,r+=e}r+="\r\n]";try{return JSON.parse(r)}catch(t){return null}},stringToHash=function(t,e,n){if(null==t)return null;e=null==e?4294967295:e,n=null==n?1:n;var r,o,i,s,a,l=2166136261;for(o=0,a=t.length;o<a;++o)(s=65280&(i=t.charCodeAt(o)))&&(l=_fnv_multiply(l^s>>8)),l=_fnv_multiply(l^255&i);r=(l=_fnv_mix(l))%e;var u=1==n?0:_fnv_mix(_fnv_multiply(l)),h=new h;for(o=0;o<n;o++)h.push(r<0?r+e:r),r=(r+u)%e;return 1==n?h[0]:h},_fnv_multiply=function(t){return t+(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)},_fnv_mix=function(t){return t+=t<<13,t^=t>>>7,t+=t<<3,t^=t>>>17,4294967295&(t+=t<<5)},decodeIdentedTree=function(t,e,n){e=null==e?"":e,n=null==n?"\t":n;var r,o,i,s,a,l,u,h,c,f=new Tr,p=splitByEnter(t),g=p.length;if(0===g||1==g&&(null==p[0]||""===p[0]))return null;for(""!==e&&null!=e&&(c=new Nd(e,e),f.addNodeToTree(c,null)),r=0;r<g;r++){for(s=(i=p[r]).length,o=0;o<s;o++)if(i.charAt(o)!=n){a=i.substr(o);break}u=new Nd(i,a),0===o?null!=c?f.addNodeToTree(u,c):f.addNodeToTree(u,null):(l=o+1-Number(null==c),h=null!=f.getLevel(l-1)&&f.getLevel(l-1).length>0?f.getLevel(l-1)[f.getLevel(l-1).length-1]:null,f.addNodeToTree(u,h))}return f.assignDescentWeightsToNodes(),f},TableToTree=function(t,e,n,r,o,i,s,a){if(null!=t){if(0===t.length)throw new Error("T has no Lists");if(null===t[0])throw new Error("table[0] is null");if(null!=i&&i.length!=t[0].length)throw new Error("weightsList must have a value for each row in the table");if(null!=s&&s.length!=t[0].length)throw new Error("colors list must have a value for each row in the table");e=null==e?t[0].name:e,r=null==r?0:r,o=null==o||""==o?"rgb(255,255,255)":o,a=null==a?0:a,null!=i&&i.getMin()<0&&(i=normalizeToInterval(i,new I(0,1)));var l,u,h,c=new Tr,f=new Nd(e,e);c.addNodeToTree(f,null);var p,g,d,m,y,v,L=t.length;if(n)if(y=0==r?L-1:0,s){var w=T.toL([t[y],s]);v=buildDictionaryObjectForDictionary(w)}else v=createCategoricalColorListForList(t[y])[4].value;if(1==a){if(2!=t.length)throw new Error("T must have 2 Lists for parent-child mode");var x,b,M,_=difference(t[0].getWithoutRepetitions(),t[1].getWithoutRepetitions());if(0==_.length)throw new Error("Invalid data for a tree. Likely has loops in the relationships.");for(p=0;p<_.length;p++)l=new Nd(String(_[p]),String(_[p])),c.addNodeToTree(l,f);for(;_.length>0;){for(x=new sL,p=0;p<t[0].length;p++)if(-1!=_.indexOfElement(t[0][p])){if(null==(M=c.nodes.get(String(t[0][p])))&&new Error("Invalid data for a tree. Nd "+String(t[0][p])+" not found as parent"),null!=(b=c.nodes.get(String(t[1][p]))))throw new Error("Invalid data for a tree. Nd "+String(t[1][p])+" has multiple parents.");b=new Nd(String(t[1][p]),String(t[1][p])),n&&0==r?b.color=v[String(t[1][p])]:!n||1!=r&&2!=r||(b.color=v[String(t[1][p])]),x.push(String(t[1][p])),c.addNodeToTree(b,M),null!=i&&(b.weight=i[p])}_=x.clone()}}else for(p=0;p<L;p++)if(null!=t[p])for(d=t[p],g=0;g<d.length;g++)null!=(m=d[g])&&(h=_getId(t,p,g),null==(l=c.nodes.get(h))?(l=new Nd(h,String(m)),n&&p==L-1&&0==r?l.color=v[m]:!n||1!=r&&2!=r||(l.color=v[t[0][g]]),0===p?c.addNodeToTree(l,f):(u=c.nodes.get(_getId(t,p-1,g)),c.addNodeToTree(l,u)),l.firstIndexInTable=g,l.indexesInTable=new nL(g),null!=i&&(l.weight=i[g])):(null!=i?l.weight+=i[g]:l.weight++,l.indexesInTable.push(g)));if(n&&2==r)for(p=0;p<c.nodes.length;p++)0==(l=c.nodes[p]).level?l.color=o:l.color=interpolateColors(l.color,o,(l.level-1)/(c.nLevels-1));c.assignDescentWeightsToNodes();var S=function(t){var e;if(0===t.to.length)return t.indexesInTable;for(t.indexesInTable=new nL,e=0;null!=t.to[e];e++)t.indexesInTable=t.indexesInTable.concat(S(t.to[e]));return t.indexesInTable};return S(c.nodes[0]),c}},_getId=function(t,e,n){for(var r=1,o="_"+String(t[0][n]);r<=e;)o+="_"+String(t[r][n]),r++;return o},TreeToTable=function(t,e,n){if(null!=t){e=null==e||e,n=null!=n&&n;var r,o,i=new T,s=t.getLeaves(),a=function(t,e,n){if(0==t)return!1;for(var r=0;r<i[t].length;r++)if(i[t][r]==e&&i[t-1][r]!=n)return!0;return!1};n||(a=function(){return!1});for(var l=0;l<s.length;l++){(r=t.getAncestorsOf(s[l]).reverse()).addNode(s[l]),e||(r=r.slice(1));for(var u=r.length-1;u>=0;u--){for(null==i[u]&&(i[u]=new sL),o=r[u].name;a(u,o,u>0?r[u-1].name:"");)o+="";i[u][l]=o}}return i}},treeToObject=function(t,e){if(null==t||"Tr"!=t.type)return null;var n,r={},o=[r],i=["name","id","level","weight","color"];t.traverse(null,null,(function(t){for(var s in 0==t.level?n=r:(n={},o[t.level].push(n)),t)"type"==s&&0==t.level||(e||i.includes(s))&&"object"!=typeof t[s]&&null!=t[s]&&(n[s]=t[s]);return t.to.length>0&&(n.children=[],o[t.level+1]=n.children),!0}));return r},objectToTree=function(t){if(null==t)return null;var e=new Tr,n=function(t,e,r){var o=null!=r.name?r.name:"",i=null!=r.id?r.id:"_"+o;null!=t.nodes.get(i)&&(i=t.nodes.getNewId());var s=new Nd(i,o);t.addNodeToTree(s,e);var a=!0;for(var l in r)if("id"!=l&&"name"!=l)if("[object Array]"!=Object.prototype.toString.call(r[l]))s[l]=r[l];else if(a){for(var u=0;u<r[l].length;u++)n(t,s,r[l][u]);a=!1}else s[l]=JSON.parse(JSON.stringify(r[l]))};return n(e,null,t),e},filterNetworkByRelationsWeight=function(t,e=0,n,r,o){let i,s=new _.Net;switch(e){case 0:i=t.relations.getSortedByProperty("weight",!1).slice(0,n);break;case 1:i=t.relations.filter((t=>t.weight>n))}return i.forEach((t=>{let e=s.createNode(t.node0.name),n=s.createNode(t.node1.name);r&&r.forEach((r=>{e[r]=t.node0[r],n[r]=t.node1[r]}));let i=s.createRelation(e,n);o&&o.forEach((e=>{i[e]=t[e]})),i.weight=t.weight,i.color=t.color})),s},filterNodesByMinDegree=function(t,e){var n;for(n=0;null!=t.nodes[n];n++)t.nodes[n].nodes.length<e&&(t.removeNode(t.nodes[n]),n--);return null},degreeBetweenNodes=function(t,e,n){if(null==t||null==e||null==n)return null;if(e==n)return 0;for(var r,o,i,s=e.nodes,a=1;null==s.get(n.id);){for(r=s.clone(),i=s.length,o=0;o<i;o++)r=concat(r,s[o].nodes);if(r=r.getWithoutRepetitions(),s.length==r.length)return-1;s=r,a++}return a},getNodesBetweenTwoNodes=function(t,e,n){var r,o,i=new ndL,s=t.nodes.length;for(r=0;r<s;r++)(o=t.nodes[r]).id!=e.id&&o.id!=n.id&&null!=e.nodes.get(o.id)&&null!=n.nodes.get(o.id)&&i.addNode(o);return i},getSubNetwork=function(t,e,n,r){for(var o,i,s,a=new Net,l=0;l<e.length;l++)if(o=new Nd(e[l].id,e[l].name),a.addNode(o),n)for(var u=0;u<n.length;u++)o[n[u]]=e[l][n[u]];for(l=0;l<t.relations.length;l++)if(o=a.nodes.get(t.relations[l].node0.id),i=a.nodes.get(t.relations[l].node1.id),null!=o&&null!=i&&(s=new Rel(t.relations[l].id,t.relations[l].name,o,i,t.relations[l].weight),a.addRelation(s),r))for(u=0;u<r.length;u++)s[r[u]]=t.relations[l][r[u]];return a},shortestPath=function(t,e,n,r){if(null==t||null==e||null==n)return null;var o=spanningTree(t,e,n),i=new ndL;r&&i.addNode(n);var s=o.nodes.get(n.id);if(null==s)return null;for(;s.parent.id!=e.id;)if(i.addNode(s.parent.node),null==(s=s.parent))return null;return r&&i.addNode(e),i.getReversed()},shortestPaths=function(t,e,n,r,o){if(null==t||null==e||null==n)return null;var i,s=new T;if(null!=e.nodes.get(n.id))return s.push(new ndL(e,n)),s;null==o&&(o=spanningTree(t,e,n));var a,l,u=o.nLevels,h=new ndL(n),c=adjacentNodeList(t,h,!1),f=intersection(c,o.getLevel(u-2)),p=new T;for(p.push(getRelationsBetweenNodeLists(t,f,h,!1));u>2;)u--,f=intersection(adjacentNodeList(t,h=f,!1),o.getLevel(u-2)),a=getRelationsBetweenNodeLists(t,f,h,!1),p.push(a);for(p=p.getReversed(),i=0;null!=p[0][i];i++)s.push(new ndL(e,p[0][i].getOther(e)));for(var g,d,m,y=function(t,e){var n,r=new T,o=t[t.length-1];return e.forEach((function(e){o.relations.get(e.id)&&((n=t.clone()).addNode(e.getOther(o)),r.push(n))})),r};s[0].length<o.nLevels;){for(l=new T,d=s.length,i=0;i<d;i++)g=y(m=s[i],p[m.length-1]),l=l.concat(g);s=l}return s},getRelationsBetweenNodeLists=function(t,e,n,r=!0){if(null==e||null==n)return null;var o,i,s=new relL,a=t.relations.length;for(i=0;i<a;i++)o=t.relations[i],(null!=e.get(o.node0.id)&&null!=n.get(o.node1.id)||!r&&null!=e.get(o.node1.id)&&null!=n.get(o.node0.id))&&s.addRelation(o);return s},_extendPaths=function(t,e,n){if(t[0].length>=n)return t;var r,o,i,s,a,l,u=new T,h=t.length;for(r=0;r<h;r++)for(l=(i=(s=t[r])[s.length-1].nodes.getWithoutRepetitions()).length,o=0;o<l;o++)null==s.get(i[o].id)&&((a=s.clone()).addNode(i[o]),u.push(a));return _extendPaths(t=u,e,n)},loops=function(t,e){if(null==t)return null;var n,r,o,i,s=new T;for(n=0;null!=t.nodes[n];n++){for(i=_getLoopsOnNode(t.nodes[n]),o=0;null!=s[o];o++)for(r=0;null!=i[r];r++)_sameLoop(i[r],s[o])&&(i.splice(r,1),r--);s=s.concat(i)}return e&&(s=s.getFilteredByPropertyValue("length",e,"greater")),s.sort((function(t,e){return t.length>e.length?-1:1})),s},_getLoopsOnNode=function(t){if(0===t.to.length||0===t.from.length)return[];var e,n,r,o,i=new T,s=new ndL;for(s.addNode(t),i.push(s),_loopsColumns(t.to,1,i,1),e=1;i[e];e++)for(n=1;null!=i[n];n++)for(r=0;null!=i[n][r];r++)delete(o=i[n][r]).onColumn,0===o.to.length&&(i[n].removeNodeAtIndex(r),r--);var a,l=new T;for(n=1;null!=i[n];n++)for(r=0;null!=i[n][r];r++)null!=(o=i[n][r]).to.get(t.id)&&(a=new ndL(o),l.push(a),_pathsToCentral(i,n,a,l));return l.sort((function(t,e){return t.length>e.length?-1:1})),l},_pathsToCentral=function(t,e,n,r){if(!n.finished)if(0!==e){var o,i,s,a,l=n[0],u=!0,h=t[e-1].clone();h.addNodes(t[e]);var c=t[e-1].length;for(o=0;null!=h[o];o++)l==(i=h[o])||null!=n.get(i.id)||null!=s&&null!=s.get(i.id)||null!=i.to.get(l.id)&&(u?(s=n.clone(),n.unshift(i),n.ids[i.id]=i,_pathsToCentral(t,o<c?e-1:e,n,r),u=!1):(a=s.clone(),r.push(a),a.unshift(i),a.ids[i.id]=i,_pathsToCentral(t,o<c?e-1:e,a,r)))}else n.finished=!0},_loopsColumns=function(t,e,n){var r;null==n[e]&&(n[e]=new ndL);for(var o=new ndL,i=0;null!=t[i];i++)(r=t[i]).onColumn||(r.onColumn=!0,n[e].addNode(r),o.addNodes(r.to));for(o=o.getWithoutRepetitions(),i=0;i<o.length;i++)o[i].onColumn&&(o.removeNodeAtIndex(i),i--);o.length>0&&_loopsColumns(o,e+1,n)},spanningTree=function(t,e,n,r){if(null!=t){if(r>0)return _spanningTree2(e,r,n);e=null==e?t.nodes[0]:e,r=null==r?0:r;var o,i,s,a,l,u=new Tr,h=new Nd(e.id,e.name);h.node=e,u.addNodeToTree(h);var c=(o=e.nodes).length,f=!1;for(a=0;a<c;a++)(s=new Nd(o[a].id,o[a].name)).id!=h.id&&(s.node=o[a],u.addNodeToTree(s,h),null!=n&&s.id==n.id&&(f=!0));if(f)return u;var p=o.clone();p.addNode(e);for(var g=0;;){for(i=0==r?new ndL:o.clone(),a=0;null!=o[a];a++)i.addNodes(o[a].nodes);if((i=i.getWithoutRepetitions()).removeElements(p),0===i.length)return u;for(a=0;a<i.length;a++){(s=new Nd(i[a].id,i[a].name)).node=i[a];var d=i[a].nodes;if(null!=d&&0!=d.length){for(var m=0;null!=d[m];m++)if(l=d[m].id,null!=o.get(l)&&s.id!=l){u.addNodeToTree(s,u.nodes.get(l));break}null!=n&&s.id==n.id&&(f=!0)}}if(f&&(f=!0),f)return u;if(o=i,p=p.concat(i),++g>t.nodes)return null}return u}},_spanningTree2=function(t,e,n){e=null==e?0:e;var r=new Tr,o=function(t,i){if(!n||t.id!=n.id){var s=r.nodes.get(t.id);if(null==s){var a;switch(s=new Nd(t.id,t.name),r.addNodeToTree(s,i),e){case 0:a=t.nodes;break;case 1:a=t.to;break;case 2:a=t.from}for(var l=0;l<a.length;l++)o(a[l],s)}}};if(Array.isArray(t)){var i=new Nd("root","root");r.addNodeToTree(i),t.forEach((t=>o(t,i)))}else o(t,null);return r},influenceLevels=function(t,e,n=!0){let r,o=new T,i=new T,s=new relL,a=null!=e.length,l=a?e:new ndL;a||l.addNode(e);let u=Math.random();l.forEach((t=>{t.__mark=u,t.__level=-1}));let h=function(t,e,o=0){r.push(t);let i=function(t,e,r){if(0==t.length)return null;let o,i,a=new ndL,l=e==n;return t.forEach((t=>{t.__level=r,o=e?t.toRelationList:t.fromRelationList,o?.forEach((t=>{i=e?t.node1:t.node0,t._onImpactTo=!0,i.__mark!=u&&(i.__mark=u,l&&s.addRelation(t),a.addNode(i))}))})),a}(t,e,o);if(0!=i.length)return h(i,e,o+1),i};n?(r=o,h(l,!0),r=i,h(l,!1)):(r=o,h(l,!1),r=i,h(l,!0));let c=[];for(let e=0;e<t.nodes.length;e++)t.nodes[e].__mark!=u&&(c.push(t.nodes[e]),t.nodes[e].__level=-1);let f=new relL;for(let e=0;e<t.relations.length;e++)t.relations[e].node1?.__level-t.relations[e].node0?.__level==1&&f.addRelation(t.relations[e]);return{levelsTableMain:o,levelsTableSecondary:i,notImpacted:c,influenceRelations:s,extendedInfluenceRelations:f}},adjacentNodeList=function(t,e,n,r){if(null==t||null==e)return null;var o,i,s,a,l=n?e.clone():new ndL;if(r){for(o=0;o<e.length;o++)for(i=0;i<e[o].to.length;i++)a=e[o].to[i].id,null==e.get(a)&&null==l.get(a)&&l.addNode(a);return l}for(o=0;o<e.length;o++)for(i=0;null!=e[o].relations[i];i++)s=e[o].relations[i].node0,a=e[o].relations[i].node1,null==e.get(s.id)&&null==l.get(s.id)&&l.addNode(s),null==e.get(a.id)&&null==l.get(a.id)&&l.addNode(a);return l},degreesPartition=function(t,e){var n,r,o,i,s=new ndL(e),a=e.nodes,l=new T(s),u=a.length>0;u&&l.push(a);var h=a.clone();for(h.push(e);u;){for(r=new ndL,o=0;null!=a[o];o++)for(n=a[o].nodes,i=0;i<n.length;i++)h.includes(n[i])||(r.push(n[i]),h.push(n[i]));(u=r.length>0)&&(a=r,l.push(a))}return l},getNodes=function(t){return null==t?null:null!=t.nodes?t.nodes:"Rel"==typeOf(t)?new ndL(t.node0,t.node1):null},buildDendrogram=function(t){if(null==t)return null;var e,n,r,o,i,s,a=new Tr,l=new ndL,u=t.nodes.length,h=2*t.relations.length/(u*(u-1));for(s=0;s<u;s++)(o=new Nd("["+t.nodes[s].id+"]","["+t.nodes[s].id+"]")).nodes=new ndL(t.nodes[s]),a.addNode(o),l[s]=o;for(;l.length>1;){for(n=l[(e=_getClosestPair(l,!0,h))[0]],r=l[e[1]],(o=new Nd(i="["+n.id+"-"+r.id+"]",i)).weight=e.strength,a.addNode(o),a.createRelation(o,n,i+"-"+n.id),a.createRelation(o,r,i+"-"+r.id),o.node=new Nd(i,i),o.nodes=n.nodes.concat(r.nodes),s=0;s<n.nodes.length;s++)o.node.nodes.addNode(n.nodes[s]),o.node.relations.addRelation(n.relations[s]);for(s=0;s<r.nodes.length;s++)o.node.nodes.addNode(r.nodes[s]),o.node.relations.addRelation(r.relations[s]);l.removeElement(n),l.removeElement(r),l.addNode(o)}for(s=0;s<a.nodes.length;s++)(n=a.nodes[s]).nodes.length>1&&(n.level=Math.max(n.nodes[0].level,n.nodes[1].level)+1);return a},_getClosestPair=function(t,e,n){var r,o,i,s,a;if(2==t.length){var l=t[0].nodes.indexOf(t[1]);return e?((r=[0,1]).strength=-1==l?0:t[0].relations[l].weight,r):((t=new ndL(t[0],t[1])).strength=-1==l?0:t[0].relations[l].weight,t)}var u=-1;for(o=0;o<t.length-1;o++)for(s=t[o].nodes,i=o+1;i<t.length;i++)(a=_strengthBetweenSets(s,t[i].nodes,n))>u&&(r=[o,i],u=a);return r.strength=u,e?r:((t=new ndL(t[r[0]],t[r[1]])).strength=u,t)},_strengthBetweenSets=function(t,e,n){var r,o,i,s=0;for(r=0;r<t.length;r++)for(i=t[r],o=0;o<i.nodes.length;o++)e.includes(i.nodes[o])&&(s+=i.relations[o].weight);return s/(t.length*e.length*n)},buildNetworkClusters=function(t,e,n,r,o,i){if(null!=t){var s,a,l,u,h,c;if(null==e||0===e?s=_buildNetworkClustersLvn(t):(null!=t._dendrogramTree&&(n=t._dendrogramTree),null==n&&(n=buildDendrogram(t)),t._dendrogramTree=n,r=r||.5,s=new T,_iterativeBuildClusters(n.nodes[n.nodes.length-1],s,r)),o)for(a=createDefaultCategoricalColorList(s.length),h=s.length,l=0;l<h;l++)for(c=s[l].length,u=0;u<c;u++)s[l][u].color=a[l];if(1==i){var f=new sL;for(f.name="clusters names",l=0;l<t.nodes.length;l++)t.nodes[l]._index=l;for(l=0;l<s.length;l++)for(c=s[l].length,u=0;u<c;u++)f[s[l][u]._index]="cluster_"+l;return f}return s}},_iterativeBuildClusters=function(t,e,n){1!=t.nodes.length?(1==t.nodes[0].nodes.length||t.nodes[0].weight>n?e.push(t.nodes[0].nodes):_iterativeBuildClusters(t.nodes[0],e,n),1==t.nodes[1].nodes.length||t.nodes[1].weight>n?e.push(t.nodes[1].nodes):_iterativeBuildClusters(t.nodes[1],e,n)):e.push(new ndL(t.node))},_buildNetworkClustersLvn=function(t){if(null==t)return t;var e,n=[];for(e=0;e<t.nodes.length;e++)n.push("n"+t.nodes[e].id);var r=[];for(e=0;e<t.relations.length;e++){var o={source:"n"+t.relations[e].node0.id,target:"n"+t.relations[e].node1.id,weight:t.relations[e].weight};r.push(o)}var i=_jLvn().nodes(n).edges(r)(),s=new T;if(i)for(e=0;e<t.nodes.length;e++){var a=i["n"+t.nodes[e].id];null==s[a]&&(s[a]=new ndL),s[a].addNode(t.nodes[e])}else for(e=0;e<t.nodes.length;e++)s.push(new ndL(t.nodes[e]));return s},getNodesPageRanks=function(t,e,n){return addPageRankToNodes(t,e,n)},fusionNetworks=function(t,e,n,r){e=null==e?1:e,n=null==n?1:n;var o,i,s,a,l,u=new Net,h=new T,c=createDefaultCategoricalColorList(t.length).getInterpolated("black",.17).getInterpolated("white",.55);for(t.forEach((function(t,e){h[e]=new ndL,t.nodes.forEach((function(t){null==(o=u.nodes.get(t.id))?((o=new Nd(t.id,t.name)).basicId=t.basicId,o.mapId="map_"+e,o.mapsIds=[o.mapId],o.color=null==t.color?t.color:c[e],o.nMaps=1,o.weight=t.weight,o.kind=t.kind,r&&r.forEach((e=>o[e]=t[e])),u.addNode(o),h[e].addNode(o)):(o.nMaps+=1,o.mapsIds.push("map_"+e),o.color=null==o.color?"rgb(200,200,200)":o.color,t.weight&&null==o.weight&&(o.weight=t.weight),t.kind&&null==o.kind&&(o.kind=t.kind),r&&r.forEach((e=>{t[e]&&null==o[e]&&(o[e]=t[e])})))}))})),t.forEach((function(t){t.relations.forEach((function(t){(i=new Rel(t.id,t.name,u.nodes.get(t.node0.id),u.nodes.get(t.node1.id))).color=t.color,i.content=t.content,i.description=t.description,i.weight=t.weight,u.addRelation(i)}))})),s=0;null!=u.nodes[s];s++)for(l=u.nodes[s],a=s+1;null!=u.nodes[a];a++)l.name==u.nodes[a].name&&((i=new Rel(l.id+"_"+u.nodes[a].id,"same variable",l,u.nodes[a])).color="black",i.distanceFactor=e,i.forceWeight=n,u.addRelation(i),(i=new Rel(u.nodes[a].id+"_"+l.id,"same variable",u.nodes[a],l)).color="black",i.distanceFactor=e,i.forceWeight=n,u.addRelation(i),i.node0.nMaps+=1,i.node1.nMaps+=1);for(s=0;null!=u.nodes[s];s++)u.nodes[s].hubWeight=Math.sqrt(u.nodes[s].nMaps-1);return u.mapsCluster=h,u},_jLvn=function(){var t,e,n,r={};function o(t){var e={};return t.forEach((function(t){e[t]=!0})),Object.keys(e)}function i(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function s(t,e){var n=t._assoc_mat[e]?Object.keys(t._assoc_mat[e]):[],r=0;return n.forEach((function(n){var o=t._assoc_mat[e][n]||1;e==n&&(o*=2),r+=o})),r}function a(t,e){return void 0===t._assoc_mat[e]?[]:Object.keys(t._assoc_mat[e])}function l(t,e,n){return t._assoc_mat[e]?t._assoc_mat[e][n]:void 0}function u(t){var e={};return t.forEach((function(t){e[t.source]=e[t.source]||{},e[t.source][t.target]=t.weight,e[t.target]=e[t.target]||{},e[t.target][t.source]=t.weight})),e}function h(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var n in t)e[n]=h(t[n]);return e}function c(t,e,n){e.nodes_to_com={},e.total_weight=0,e.internals={},e.degrees={},e.gdegrees={},e.loops={},e.total_weight=function(t){var e=0;return t.edges.forEach((function(t){e+=t.weight})),e}(t),void 0===n?t.nodes.forEach((function(n,r){e.nodes_to_com[n]=r;var o=s(t,n);if(o<0)throw"Bad graph type, use positive weights!";e.degrees[r]=o,e.gdegrees[n]=o,e.loops[n]=l(t,n,n)||0,e.internals[r]=e.loops[n]})):t.nodes.forEach((function(r){var o=n[r];e.nodes_to_com[r]=o;var i=s(t,r);e.degrees[o]=(e.degrees[o]||0)+i,e.gdegrees[r]=i;var l=0;a(t,r).forEach((function(e){var i=t._assoc_mat[r][e];if(i<=0)throw"Bad graph type, use positive weights";n[e]==o&&(l+=e==r?i:i/2)})),e.internals[o]=(e.internals[o]||0)+l}))}function f(t){var e=t.total_weight,n=0;return o(i(t.nodes_to_com)).forEach((function(r){var o=t.internals[r]||0,i=t.degrees[r]||0;e>0&&(n=n+o/e-Math.pow(i/(2*e),2))})),n}function p(t,e,n){var r={};return a(e,t).forEach((function(o){if(o!=t){var i=e._assoc_mat[t][o]||1,s=n.nodes_to_com[o];r[s]=(r[s]||0)+i}})),r}function g(t,e,n,r){r.nodes_to_com[t]=+e,r.degrees[e]=(r.degrees[e]||0)+(r.gdegrees[t]||0),r.internals[e]=(r.internals[e]||0)+n+(r.loops[t]||0)}function d(t,e,n,r){r.degrees[e]=(r.degrees[e]||0)-(r.gdegrees[t]||0),r.internals[e]=(r.internals[e]||0)-n-(r.loops[t]||0),r.nodes_to_com[t]=-1}function m(t){var e=0,n=h(t),r={};return Object.keys(t).forEach((function(o){var i=t[o],s=void 0===r[i]?-1:r[i];-1==s&&(r[i]=e,s=e,e+=1),n[o]=s})),n}function y(t,e){for(var n=!0,r=0,o=f(e),i=o;n&&-1!=r&&(o=i,n=!1,r+=1,t.nodes.forEach((function(r){var o=e.nodes_to_com[r],i=(e.gdegrees[r]||0)/(2*e.total_weight),s=p(r,t,e);d(r,o,s[o]||0,e);var a=o,l=0;Object.keys(s).forEach((function(t){var n=s[t]-(e.degrees[t]||0)*i;n>l&&(l=n,a=t)})),g(r,a,s[a]||0,e),a!=o&&(n=!0)})),!((i=f(e))-o<1e-7)););}function v(t,e){var n,r,s={nodes:[],edges:[],_assoc_mat:{}},a=i(t);return s.nodes=s.nodes.concat(o(a)),e.edges.forEach((function(e){r=e.weight||1;var o=t[e.source],i=t[e.target];n=l(s,o,i)||0,function(t,e){!function(t,e){t._assoc_mat[e.source]=t._assoc_mat[e.source]||{},t._assoc_mat[e.source][e.target]=e.weight,t._assoc_mat[e.target]=t._assoc_mat[e.target]||{},t._assoc_mat[e.target][e.source]=e.weight}(t,e);var n=t.edges.map((function(t){return t.source+"_"+t.target})).indexOf(e.source+"_"+e.target);-1!=n?t.edges[n].weight=e.weight:t.edges.push(e)}(s,{source:o,target:i,weight:n+r})})),s}var L=function(){var t=function(t,e){if(0===t.edges.length){var n={};return t.nodes.forEach((function(t){n[t]=t})),n}var o={};c(r,o,e);var i=f(o),s=[];y(r,o);var a=f(o),l=m(o.nodes_to_com);s.push(l),i=a;var u=v(l,r);for(c(u,o);y(u,o),!((a=f(o))-i<1e-7);)l=m(o.nodes_to_com),s.push(l),i=a,c(u=v(l,u),o);return s}(r,n);return function(t,e){for(var n=h(t[0]),r=1;r<e+1;r++)Object.keys(n).forEach((function(e){var o=e,i=n[e];n[o]=t[r][i]}));return n}(t,t.length-1)};return L.nodes=function(e){return arguments.length>0&&(t=e),L},L.edges=function(n){if(void 0===t)throw"Please provide the graph nodes first!";if(arguments.length>0){e=n;var o=u(n);r={nodes:t,edges:e,_assoc_mat:o}}return L},L.partition_init=function(t){return arguments.length>0&&(n=t),L},L},getNodesCentralities=function(t,e,n,r){if(null!=t){var o=new nL;0===(e=null==e?0:e)&&addEigenvectorCentralityToNodes(t,n,r),1===e&&addBetweennessCentralityToNodes(t,n,r);for(var i=0;i<t.nodes.length;i++)o[i]=0==e?t.nodes[i].eigenvectorCentrality:t.nodes[i].betweennessCentrality;return o}},addCentralitiesToNodes=function(t,e,n,r){if(null!=t)return 0!==(e=null==e?0:e)&&10!=e||addEigenvectorCentralityToNodes(t,n,r),1!==e&&10!=e||addBetweennessCentralityToNodes(t,n,r),t},addEigenvectorCentralityToNodes=function(t,e,n){if(null==t)return t;void 0===e&&(e=!0),void 0===n&&(n=!0);var r={};function o(t){var e=[];for(var n in t)e.push(t[n]);for(var r=0,o=0;o<e.length;o++)r+=e[o];var i=1/(r||1);for(var s in t)t[s]*=i}var i=_getAdjacencyMap(t,null,n);randomSeed(1);for(var s={},a=0;a<t.nodes.length;a++)s[t.nodes[a].id]=random();o(s),randomSeedPop();for(a=0;a<100;a++){var l=s;s={};for(var u in l)s[u]=0;for(var h in s)for(var c in i[h])s[h]+=.01+l[c]*i[h][c]*(r[p]?r[p]:1);o(s);var f=0;for(var p in s)f+=Math.abs(s[p]-l[p]);if(f<1e-4*t.nodes.length){if(e){var g=[];for(var u in s)g.push(s[u]);var d=Math.max.apply(Math,g)||1;for(var m in s)s[m]/=d}for(var m in s){t.nodes.get(m).eigenvectorCentrality=s[m]}return t}}for(a=0;a<t.nodes.length;a++)t.nodes[a].eigenvectorCentrality=0;return t},addBetweennessCentralityToNodes=function(t,e,n){if(null==t)return t;void 0===e&&(e=!0),void 0===n&&(n=!1);for(var r,o,i,s=function(){this.init=function(){this.k=[],this.w=[],this.length=0},this.init(),this.push=function(t,e){for(var n=0;n<=this.w.length&&e<(this.w[n]||1/0);)n++;return this.k.splice(n,0,t),this.w.splice(n,0,e),this.length+=1,!0},this.pop=function(){return this.length-=1,this.w.pop(),this.k.pop()}},a=_getAdjacencyMap(t,null,!0),l={},u=0;u<t.nodes.length;u++)l[t.nodes[u].id]=0;for(u=0;u<t.nodes.length;u++){for(var h=t.nodes[u].id,c=new s,f={},p={},g=0;g<t.nodes.length;g++)p[t.nodes[g].id]=[];var d={id:0};c.push([0,h,h],0);var m=[],y={};for(g=0;g<t.nodes.length;g++)y[t.nodes[g].id]=0;for(y[h]=1;c.length;){var v=c.pop();if(r=v[0],o=v[1],!((i=v[2])in f))for(var L in f[i]=r,m.push(i),y[i]+=y[o],a[i]){var w=f[i]+a[i][L];L in f||L in d&&!(w<d[L])?w==d[L]&&(p[L].push(i),y[L]=y[L]+y[i]):(d[L]=w,c.push([w,i,L],w),p[L]=[i],y[L]=0)}}var x={};for(g=0;g<t.nodes.length;g++)x[t.nodes[g].id]=0;for(;m.length;){for(L=m.pop(),g=0;g<p[L].length;g++)x[i=p[L][g]]+=(1+x[L])*y[i]/y[L];L!=h&&(l[L]+=x[L])}}if(e){var b=[];for(var T in l)b.push(l[T]);var M=Math.max.apply(Math,b)||1;for(var h in l)l[h]/=M}for(var h in l){var _=t.nodes.get(h);_.betweennessCentrality=l[h],_.betweennessCentralityDegreeRatio=_.betweennessCentrality/(_.nodes.length+.001)}return t},getLeaves=function(t){if(null!=t)return null!=t.getLeaves?t.getLeaves():null},createNetworkFromListAndFunction=function(t,e,n,r,o,i){if(null!=t&&null!=e){var s,a,l,u,h,c=new Net,f=t.length;for(r=null==r?.3:r,s=0;s<f;s++)(u=new Nd("n_"+s,null==n?"n_"+s:n[s])).element=t[s],u.i=s,c.addNode(u);if(i)for(s=0;s<f;s++)for(u=c.nodes[s],a=s+1;a<f;a++)h=c.nodes[a],(l=e(t[s],t[a]))>r&&(o>0&&(l-=r),2==o&&(l/=1-r),c.addRelation(new Rel(s+"_"+a,s+"_"+a,u,h,l)));else for(s=0;s<f;s++)for(u=c.nodes[s],a=0;a<f;a++)s!=a&&(h=c.nodes[a],(l=e(t[s],t[a]))>r&&(o>0&&(l-=r),2==o&&(l/=1-r),c.addRelation(new Rel(s+"_"+a,s+"_"+a,u,h,l))));return c}},createRandomNetwork=function(t,e,n,r,o){if(null==t||null==e)return null;var i,s,a;i=null!=o?function(){return o++,getRandomWithSeed(o)}:Math.random,n=null==n?0:n;var l,u=new Net;for(s=0;s<t;s++)u.addNode(new Nd("n"+s,"n"+s));switch(n){case 0:if(e<1)for(s=0;s<t-1;s++)for(l=u.nodes[s],a=s+1;a<t;a++)i()<e&&u.addRelation(new Rel(s+"_"+a,s+"_"+a,l,u.nodes[a],r?i():1));else for(e=Math.min(e,t*(t-1)*.5);u.relations.length<e;)(s=Math.floor(i()*t))!=(a=Math.floor(i()*t))&&null==u.relations.get(s+"_"+a)&&u.addRelation(new Rel(s+"_"+a,s+"_"+a,u.nodes[s],u.nodes[a],r?i():1));return u;case 1:var h,c,f,p=t*(t-1)*.5;for(s=0;s<p;s++)if(i()<e)for(h=!0;h;)if(l=u.nodes[Math.floor(u.nodes.length*i())],i()<(l.nodes.length+1)/1)for(;h;)c=u.nodes[Math.floor(u.nodes.length*i())],f=l.id+"_"+c.id,null==u.relations.get(f)&&null==u.relations.get(c.id+"_"+l.id)&&i()<(c.nodes.length+1)/1&&(u.addRelation(new Rel(f,f,l,c,r?i():1)),h=!1);return u}},imageToTableOfRGBA=function(t,e){if(null==t||t.width<=0)return null;e=null!=e&&e;var n,r,o,i=_getPixelData(t);if(null==i)return null;if(e){n=new T;for(var s=0;s<t.width;s++){n.push(new cL);for(var a=0;a<t.height;a++)n[s].push("")}}else n=createUniformTable(t.width,t.height,[]);for(var l=0;l<i.length;l+=4)r=l/4%t.width,o=Math.floor(l/4/t.width),n[r][o]=e?"rgba("+i[l]+","+i[l+1]+","+i[l+2]+","+i[l+3]/255+")":[i[l],i[l+1],i[l+2],i[l+3]/255];return n},invertImageColors=function(t){if(null==t||t.width<=0)return null;var e=_getPixelData(t);if(null==e)return null;for(var n=0;n<e.length;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2];var r=new ImageData(e,t.width,t.height);return _makeImageFromData(r)},grayscaleImage=function(t){if(null==t||t.width<=0)return null;var e=_getPixelData(t);if(null==e)return null;for(var n=0;n<e.length;n+=4){var r=.2126*e[n]+.7152*e[n+1]+.0722*e[n+2];e[n]=e[n+1]=e[n+2]=r}var o=new ImageData(e,t.width,t.height);return _makeImageFromData(o)},cropImage=function(t,e,n,r,o){if(null==t||t.width<=0)return null;if(t.isList){for(var i=new L,s=0;s<t.length;s++){var a=cropImage(t[s],e,n,r,o);i=i.concat(a)}return i}e=null==e?0:e,n=null==n?0:n,r=null==r?t.width:r,o=null==o?t.height:o;var l=document.createElement("canvas"),u=l.getContext("2d");l.width=t.width,l.height=t.height,u.drawImage(t,0,0);var h=u.getImageData(e,n,r,o);return _makeImageFromData(h)},resizeImage=function(t,e,n,r,o){if(null==t||t.width<=0)return null;r=null==r||0!=r&&1!=r?0:r,o=null==o?"topleft":o;var i,s=new MetaCanvas({container:null,dimensions:{width:e=null==e||Math.round(e)<=0?200:Math.round(e),height:n=null==n||Math.round(n)<=0?Math.round(e/t.width*t.height):Math.round(n)},noLoop:!0,noStart:!0});if(0==r){var a,l,u,h,c=o;if("topleft"==c.toLowerCase()){var f=_getPixelData(t);c="rgba("+f[0]+","+f[1]+","+f[2]+","+(f[3]/255).toFixed(2)+")"}s.fill(c),s.fRect(0,0,e,n),a=(e-(u=(h=Math.min(n,e*t.height/t.width))*t.width/t.height))/2,l=(n-h)/2,s.drawImage(t,0,0,t.width,t.height,a,l,u,h),i=s.captureCanvas()}else 1==r&&(s.drawImage(t,0,0,t.width,t.height,0,0,e,n),i=s.captureCanvas());return i},getDataURL=function(t,e){if(null==t||t.width<=0)return null;var n=new MetaCanvas({container:null,dimensions:{width:t.width,height:t.height},noLoop:!0,noStart:!0});n.drawImage(t,0,0);var r=n.captureCanvas();return e?'<img src="'+r.src+'">':r.src},_getPixelData=function(t){if(null==t||t.width<=0)return null;var e;try{var n=document.createElement("canvas"),r=n.getContext("2d");n.width=t.width,n.height=t.height,r.drawImage(t,0,0),e=r.getImageData(0,0,t.width,t.height).data}catch(t){throw t}return e},_makeImageFromData=function(t){if(null==t||null==t.width||t.width<=0||t.height<=0)return null;try{var e=document.createElement("canvas"),n=e.getContext("2d");e.width=t.width,e.height=t.height,n.putImageData(t,0,0);var r=document.createElement("img");r.src=e.toDataURL("image/png")}catch(t){throw t}return r},expandSimpleHtml=function(t,e){if(null==t||""===t)return"";var n;if(t.split("<").length!=t.split(">").length)return t;var r,o,i,s=t;if(-1!=s.indexOf("<fs"))for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fs",">"))&&(s=s.replace("<fs"+n+">",'<font style="font-size:'+Number(n)+'px">')),-1==s.indexOf(">")&&(n=null);for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<ff",">"))&&(s=s.replace("<ff"+n+">",'<font face="'+n+'">'));for(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(//,"<br/>")).replace(/<fcBlack>/g,'<font color="#000000">')).replace(/<.White>/g,'<font color="#FFFFFF">')).replace(/<fcRed>/g,'<font color="#FF0000">')).replace(/<fcGreen>/g,'<font color="#00FF00">')).replace(/<fcBlue>/g,'<font color="#0000FF">')).replace(/<fcOrange>/g,'<font color="#FFAA00">')).replace(/<fcCyan>/g,'<font color="#00FFFF">')).replace(/<fcYellow>/g,'<font color="#FFFF00">')).replace(/<fcMagenta>/g,'<font color="#FF00FF">'),n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fcuint",">"))&&(s=s.replace("<fcuint"+n+">",'<font color="'+uinttoHEX(n)+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fccolor",">"))&&(s=s.replace("<fccolor"+n+">",'<font color="'+colorStringToHEX(n)+'">'));for(n="";null!=n;)if(null!=(n=getFirstTextBetweenStrings(s,"<frgb",">"))){var a=n.split(".");s=s.replace("<frgb"+n+">",'<font color="'+RGBtoHEX(Number(a[0]),Number(a[1]),Number(a[2]))+'">')}if(-1!=s.indexOf("<fc"))for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<fc",">"))&&(s=s.replace("<fc"+n+">",'<font color="'+("#"==n[0]?"":"#")+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<tl",">"))&&(s=s.replace("<tl"+n+">",'<textformat leftmargin="'+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<tv",">"))&&(s=s.replace("<tv"+n+">",'<textformat leading="'+n+'">'));for(n="";null!=n;)null!=(n=getFirstTextBetweenStrings(s,"<e",">"))&&(r=n.split("*")[0],o=n.split("*")[1],i=n.split("*").length>2&&"s"==n.split("*")[2]?"_self":"_blank",s="http://"==r.substr(0,7)||"https://"==r.substr(0,8)?s.replace("<e"+n+">","<u><a href='"+r+"' target='"+i+"'>"+o+"</a></u>"):s.replace("<e"+n+">","<u><a href='javascript:clickLink(\""+r+'","'+e+"\")' FastHtml.onclick='event.preventDefault(); clickLink(\""+r+'","'+e+"\"); return false; '>"+o+"</a></u>"));return s=(s=(s=(s=(s=(s=s.replace(/<pl>/g,'<p align="left">')).replace(/<pc>/g,'<p align="center">')).replace(/<pr>/g,'<p align="right">')).replace(/<pj>/g,'<p align="justify">')).replace(/<\/f>/g,"</font>")).replace(/<\/t>/g,"</textformat>")},clickLink=function(t,e){for(var n=0;n<FastHtml_clickLinkFunctionsToCall.length;n++)FastHtml_clickLinkFunctionsToCall[n].call(FastHtml_clickLinkTargetsToCall[n],t,e)},_typeDict={L:L,iL:iL,cL:cL,P:P,P3D:P3D,Pol:Pol,Pol3D:Pol3D,Rec:Rec,T:T,nT:nT,polL:polL,Nd:Nd,sL:sL,ndL:ndL,relL:relL,recL:recL,Rel:Rel,Net:Net,Tr:Tr,dI:dI,dL:dL,nL:nL,I:I,pol3DL:pol3DL,cScale:cScale,MetaCanvas:MetaCanvas,Engine3D:Engine3D,Forces:Forces},TwoPi=6.28318530718;function ifDef(t,e){return null!=t?t:e}function typeOf(t){if(null==t)return null;var e=typeof t;return"object"!==e?e:null!=t.type?t.type:"[object Array]"==Object.prototype.toString.call(t)?"Array":null!=t.getDate?"date":"Object"}var _typeOf=function(t){if(null==t)return null;var e=typeof t;return"object"!==e?e:null!=t.type?t.type:"[object Array]"==Object.prototype.toString.call(t)?"Array":null!=t.getDate?"date":"Object"},noOperation=function(){};function resizeThrottler(t,e){var n;return function(r){n||(n=setTimeout((function(){n=null,t(r)}),e))}}function instantiate(t,e){switch(t){case"number":case"string":return window[t](e);case"date":if(!e||0===e.length)return new Date;if(1==e.length){if(e[0].match(/d*.-d*.-d*Dd*.:d*.:d*/)){var n=e[0].split(" ");return n[0]=n[0].split("-"),n[1]?n[1]=n[1].split(":"):n[1]=new Array(0,0,0),new Date(Date.UTC(n[0][0],Number(n[0][1])-1,n[0][2],n[1][0],n[1][1],n[1][2]))}return"NaN"!=Number(e[0])?new Date(Number(e[0])):new Date(e[0])}return new Date(Date.UTC.apply(null,e));case"boolean":return window[t]("false"!=e&&"0"!=e);case"L":case"T":case"sL":case"nL":case"nT":case"ndL":case"relL":case"Pol":case"Pol3D":case"polL":case"dL":case"cL":case"iL":return _typeDict[t].apply(new _typeDict[t],e);case null:case void 0:case"undefined":return null}var r,o,i;return i=window[t],(o=function(){}).prototype=i.prototype,r=new o,i.apply(r,e),r}function instanceSameType(t,e){return instantiate(typeOf(t),e)}var plasma=createColorScaleFromColors(cL.toL(["rgb(13,8,135)","rgb(125,3,168)","rgb(203,70,121)","rgb(248,148,65)","rgb(240,249,33)"]),[.25,.5,.75]),viridis=createColorScaleFromColors(cL.toL(["rgb(68,1,84)","rgb(59,81,139)","rgb(33,144,141)","rgb(92,200,99)","rgb(253,231,37)"]),[.25,.5,.75]),_HARDCODED_CATEGORICAL_COLORS=["#d62728","#1f77b4","#2ca02c","#ff7f00","#9467bd","#bcbd22","#8c564b","#17becf","#dd4411","#206010","#e377c2","#3330ff","#dd8811","#ff220e","#1f66a3","#8c453a","#2ba01c","#dfc500","#945600","#ff008b","#e37700","#7f7f7f"],DateOperators_millisecondsToHours=1/36e5,DateOperators_millisecondsToDays=1/864e5,DateOperators_millisecondsToWeeks=1/6048e5,DateOperators_millisecondsToYears=3169e-14,DateOperators_MONTH_NAMES=["january","february","march","april","may","june","july","august","september","october","november","december"],DateOperators_MONTH_NAMES_SHORT=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],DateOperators_MONTH_NDAYS=[31,28,31,30,31,30,31,31,30,31,30,31],DateOperators_WEEK_NAMES=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],StringOperators_ENTER=String.fromCharCode(13),StringOperators_ENTER2=String.fromCharCode(10),StringOperators_ENTER3=String.fromCharCode(8232),StringOperators_SPACE=String.fromCharCode(32),StringOperators_SPACE2=String.fromCharCode(160),StringOperators_TAB=" ",StringOperators_TAB2=String.fromCharCode(9),StringOperators_LINK_REGEX=/(^|\s+)(https*\:\/\/\S+[^\.\s+])/,StringOperators_MAIL_REGEX=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,StringOperators_STOP_WORDS="t,s,mt,rt,re,m,http,amp,a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your".split(","),StringOperators_WORDLISTS={},NetworkEncodings_nodeNameSeparators=["|",":"," is "," are ",".",","],NumberOperators_stackRandom=[],NumberOperators_lastNormal=NaN,NumberOperators_random=Math.random,NumberOperators_lastNormal=NaN,NumberOperators_lastNormal=1,NumberOperators_SG_MAGICCONST=1+Math.log(4.5),NumberOperators_LOG4=Math.log(4),TableEncodings_ENTER=String.fromCharCode(13),TableEncodings_ENTER2=String.fromCharCode(10),TableEncodings_ENTER3=String.fromCharCode(8232),TableEncodings_SPACE=String.fromCharCode(32),TableEncodings_SPACE2=String.fromCharCode(160),TableEncodings_TAB="  ",TableEncodings_TAB2=String.fromCharCode(9),GeoOperators_EARTH_RADIUS=6371009,GeoOperators_EARTH_DIAMETER=2*GeoOperators_EARTH_RADIUS,DrawTexts_POINT_TO_PIXEL=1.3333,DrawTexts_PIXEL_TO_POINT=.75,FastHtml_clickLinkFunctionsToCall=[],FastHtml_clickLinkTargetsToCall=[],FastHtml_target=null,FastHtml_linkFunction=null,_parseData=function(t,e,n){switch(e){case"csv":return toT(t,n);case"json":return JSON.parse(t);default:return t}};exports._parseData=_parseData,exports.loadData=function(t,e,n,r){var o=_parseData;fetch(t).then((t=>t.text())).then((i=>e({result:o(i,n,r),path:t})))},exports.loadDatas=function(t,e,n,r,o){var i=0,s=t[i],a=new L,l=_parseData,u=function(){fetch(s).then((t=>t.text())).then((h=>{let c={result:l(h,r,o),path:s,nFile:i};a.push(c),e?.(c,a),i<t.length-1?(s=t[++i],u()):n?.(a.downcast())}))};u()},exports.loadImage=function(t,e){if(null!=t){var n=document.createElement("img");n.onload=function(){let r={path:t,result:n};e.call(this,r)},n.src=t}};var downloadData=function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(t)),n.setAttribute("download",e),document.body.appendChild(n),n.click()},downloadTable=function(t,e){let n=TableToCSV(t,",",!0);downloadData(n,e)};exports.LOG=function(...t){if(null!=t&&null!=t[0])if(t[0].isTable){var e={};t[0].forEach((t=>{e[t.name]=t.serial()}))}else if(!t[0].isList)return"Net"==t[0].type?(t[0].nodes.forEach((t=>{t.nodes.forEach((t=>t.color?console.log("%c  "+t.name,"color:"+t.color):console.log("  "+t.name)))})),void console.groupEnd()):void("-"!=t[0]?console.log.apply(null,t):console.table("----------------------------------------------"))},exports.passPropertiesObjects=function(t,e,n,r){n.forEach((n=>t.forEach(((t,o)=>{r&&null!=t[n]||(t[n]=e[o][n])}))))},exports.passPropertiesToNodes=function(t,e,n,r=!1){n.forEach((n=>e.nodes.forEach((e=>{let o=t.get(e.id);o&&(r&&null!=o[n]||(o[n]=e[n]))}))))};let toL=function(t){return L.toL(t).downcast()},tosL=function(t){return sL.toL(t)},tonL=function(t){return nL.toL(t)},toT=function(t){if("string"==typeof t)return CSVToTable.apply(null,arguments);t=t[0].isList?t:t.map((t=>t.toL()));return T.toL(t).downcast()},tonT=function(t){return nT.toL(t)},serial=function(t){return t.isTable?t.map((t=>t.slice())):t.isList?t.slice():void 0};Array.prototype.toL=function(){return toL(this)},Array.prototype.tosL=function(){return tosL(this)},Array.prototype.tonL=function(){return tonL(this)},Array.prototype.toT=function(){return toT(this)},Array.prototype.tonT=function(){return tonT(this)},Array.prototype.serial=function(){return serial(this)},exports.toL=toL,exports.tosL=tosL,exports.tonL=tonL,exports.toT=toT,exports.tonT=tonT,exports.serial=serial,L.prototype._filter=Array.prototype.filter,L.prototype.filter=function(...t){return LOG(""),this._filter(t).toL()},L.prototype.pushNew=function(){for(let t=0;t<arguments.length;t++)this.includes(arguments[t])||this.push(arguments[t])},L.prototype.concatNew=function(t){let e=[];return t.forEach((t=>{this.includes(t)||e.push(t)})),this.concat(e)},exports.deepAssign=function(t,e,n=0){for(var r in n++,t)if(null!=e[r])if(e[r]instanceof Array)t[r]=e[r];else{var o=typeof e[r];!("number"==o||"string"==o||"boolean"==o)?exports.deepAssign(t[r],e[r],n):t[r]=e[r]}},exports.expandTags=function(t,e){return e=e??",",t.join(e).getWithoutElement().split(e).tosL().trim()};var TableToNetwork=function(t,e,n,r=!0){let o,i,s=new Net;if(Array.isArray(e)||(e=t.get(e)),e.forEach(((e,n)=>{o=s.createNode(e,e),t.forEach((t=>{"name"!=t.name&&"id"!=t.name&&(i=t.name.replace(" ","_").toLowerCase(),o[i]=t[n])}))})),n){let t;s.nodes.forEach(((e,o)=>{s.nodes.forEach(((i,a)=>{if(o!=a&&(r||!(a<o))&&(t=n(e,i),t)){let n=s.createRelation(e,i,e.name+"_"+i.name);for(let e in t)n[e]=t[e]}}))}))}return s};Net.prototype.createNode=function(t,e){var n=this.nodes.get(t);return n||(n=new Nd(t,e),this.addNode(n),n)},Net.prototype.filter=function(t){for(var e=this.nodes.filter((e=>t(e))),n=0;n<this.nodes.length;n++)e.includes(this.nodes[n])||(this.removeNode(this.nodes[n]),n--)},MetaCanvas.prototype.fTexts=function(t,e,n,r=null,o=null){t.forEach(((t,i)=>{r&&(this.fontSize=r[i]),o&&(this.fontColor=o[i]),this.fText(t,e[i],n[i])}))},MetaCanvas.prototype.fCircles=function(t,e,n,r=null){t.forEach(((t,o)=>{r&&this.fill(r[o]),this.fCircle(t,e[o],n[o])}))},MetaCanvas.prototype._setDragZoomTransformation=function(t){this.applyTransformationFunctions((t=>t*this.ZOOM+this.x0),(t=>t*this.ZOOM+this.y0))},MetaCanvas.prototype.setDRAGGABLE=function(t){this.DRAGGABLE=t,t?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.ZOOMABLE?this.x0=this.y0=0:this.resetTransformation()},MetaCanvas.prototype.setZOOMABLE=function(t,e=50,n=.1){this.ZOOMABLE=t,this.MAX_ZOOM=e,this.MIN_ZOOM=n,t?(this.x0=this.x0??0,this.y0=this.y0??0,this.ZOOM=this.ZOOM??1,this._setDragZoomTransformation()):this.DRAGGABLE?this.ZOOM=1:this.resetTransformation()},exports.buildTagsNetwork=function(t,e=",",n=1){if(null!=t){var r=new Net;if(1==t.length||!t.isTable&&t.isList){var o=t.isTable?t[0]:t,i={};let s,a;o.forEach(((t,n)=>{if(null==t)return;let r=t.split(e);for(let t=0;t<r.length;t++)for(let e=t+1;e<r.length;e++){r[t]<r[e]?(s=r[t],a=r[e]):(s=r[e],a=r[t]);let o=i[s+"_"+a];null==o&&(o=i[s+"_"+a]={count:0,indexes:[],indexesDic:{}}),o.count++,o.indexesDic["_"+n]||(o.indexes.push(n),o.indexesDic["_"+n]=!0)}}));new nL;let l,u,h,c=1,f=1;for(let t in i){let e=i[t].count;if(e>=n){let o=t.split("_");l=r.createNode(o[0]),u=r.createNode(o[1]),null==l.indexes&&(l.indexes=[]),null==u.indexes&&(u.indexes=[]),l.indexes=l.indexes.concat(i[t].indexes),u.indexes=u.indexes.concat(i[t].indexes),l.weight++,u.weight++,c=Math.max(c,l.weight,u.weight),h=r.createRelation(l,u),h.weight=1+e-n,h.count=e,f=Math.max(f,h.weight)}}return r.nodes.forEach((t=>{t.weight=.5+.5*t.weight/c,t.indexes=_.tonL(t.indexes).getWithoutRepetitions()})),r.relations.forEach((t=>t.weight=.2+.8*t.weight/f)),r}var s=t[0];o=t[1];return s.forEach((t=>{var e=new Nd(t,t);r.addNode(e),e.kind=nameActor??"actor",e.color="blue"})),o.forEach(((t,e)=>{if(null!=t){var n=r.nodes[e];t.split(",").toL().trim().forEach((t=>{var e=r.createNode(t,t);e.kind=nameTags??"tag",e.color="red",r.createRelation(n,e)}))}})),r}},exports.expandForBarycenters=function(t,e){if(t){var n=new PolL;return n.name=t.name,t.forEach((t=>n.push(expandForBarycenter(t,e)))),n}},exports.closestPointToLine=function(t,e,n,r,o,i){let s=o-n,a=i-r,l=((t-n)*s+(e-r)*a)/(s**2+a**2);return new _.P(n+s*l,r+a*l)},exports.distanceToLine2=function(t,e,n,r,o,i){let s=this.closestPointToLine(t,e,n,r,o,i);return(s.x-t)**2+(s.y-e)**2},exports.distanceToLine=function(t,e,n,r,o,i){let s=this.closestPointToLine(t,e,n,r,o,i);return Math.sqrt((s.x-t)**2+(s.y-e)**2)},exports.dataDropper=function(t,e,n){if(!t)return;if(!e)return;let r;n?n?.startsWith("DATA")&&(r="https://moebio.protozoo.com/data/"+n.substr(5),n="../data/"+n.substr(5)):r="https://moebio.protozoo.com/dataDropper/"+(n="data/"),""==n||n.endsWith("/")||(n+="/",r+="/"),n+=e,r+=e;var o=new XMLHttpRequest;o.onreadystatechange=function(){console.log("dataDropper | this.readyState: "+this.readyState),4==this.readyState&&console.log("sent")},o.open("POST","https://moebio.protozoo.com/dataDropper/storeData.php",!0);o.send(n+"<***>"+t);return r},L.prototype.getRandomElement=function(){return this[Math.floor(this.length*Math.random())]},random=Math.random,NumberOperators_random=Math.random,exports.L=L,exports.iL=iL,exports.cL=cL,exports.P=P,exports.P3D=P3D,exports.Pol=Pol,exports.Pol3D=Pol3D,exports.Rec=Rec,exports.T=T,exports.nT=nT,exports.polL=polL,exports.Nd=Nd,exports.sL=sL,exports.ndL=ndL,exports.relL=relL,exports.recL=recL,exports.Rel=Rel,exports.Net=Net,exports.Tr=Tr,exports.dI=dI,exports.dL=dL,exports.nL=nL,exports.I=I,exports.pol3DL=pol3DL,exports.cScale=cScale,exports.MetaCanvas=MetaCanvas,exports.Engine3D=Engine3D,exports.Forces=Forces,exports.interpolateColors=interpolateColors,exports.interpolateColorsRGB=interpolateColorsRGB,exports.distanceColorsRGB=distanceColorsRGB,exports.addAlpha=addAlpha,exports.invertColor=invertColor,exports.stringToColor=stringToColor,exports.HEXtoRGB=HEXtoRGB,exports.RGBtoHEX=RGBtoHEX,exports.RGBArrayToString=RGBArrayToString,exports.colorStringToHEX=colorStringToHEX,exports.numberToHex=numberToHex,exports.uinttoRGB=uinttoRGB,exports.uinttoHEX=uinttoHEX,exports.RGBtouint=RGBtouint,exports.HEXtouint=HEXtouint,exports.grayByLevel=grayByLevel,exports.HEXtoHSV=HEXtoHSV,exports.HSVtoHEX=HSVtoHEX,exports.HSLtoHEX=HSLtoHEX,exports.RGBtoHSV=RGBtoHSV,exports.HSVtoRGB=HSVtoRGB,exports.HSLtoRGB=HSLtoRGB,exports.invertColorRGB=invertColorRGB,exports.toHex=toHex,exports.getRandomColor=getRandomColor,exports.colorStringToRGB=colorStringToRGB,exports.createSortedNumberList=createSortedNumberList,exports.createNumberListWithinInterval=createNumberListWithinInterval,exports.createRandomNormalDistribution=createRandomNormalDistribution,exports.createRandomBetaPERTDistribution=createRandomBetaPERTDistribution,exports.createRandomBimodalDistribution=createRandomBimodalDistribution,exports.createRandomNumbers=createRandomNumbers,exports.createUniformTable=createUniformTable,exports.dotProduct=dotProduct,exports.linearRegression=linearRegression,exports.distance=distance,exports.cosineSimilarity=cosineSimilarity,exports.covariance=covariance,exports.standardDeviationTwoNumberLists=standardDeviationTwoNumberLists,exports.numericCorrelation=numericCorrelation,exports.slidingWindowCorrelation=slidingWindowCorrelation,exports.normalizeToSum=normalizeToSum,exports.normalizeByZScore=normalizeByZScore,exports.normalizeToMax=normalizeToMax,exports.normalizeToInterval=normalizeToInterval,exports.trimNumberList=trimNumberList,exports.getAccumulativeSum=getAccumulativeSum,exports.shorten=shorten,exports.simplify=simplify,exports.segmentNumberList=segmentNumberList,exports.averageSmoother=averageSmoother,exports.closestValue=closestValue,exports.filterNumberListByInterval=filterNumberListByInterval,exports.filterNumberListByNumber=filterNumberListByNumber,exports.frameFromTwoNumberLists=frameFromTwoNumberLists,exports.rangeCounts=rangeCounts,exports.simpleCompression=simpleCompression,exports.regression=regression,exports.getDecimalsInterval=getDecimalsInterval,exports.setDecimals=setDecimals,exports.getDistributionHeights=getDistributionHeights,exports.kNearestNeighbours=kNearestNeighbours,exports.skewness=skewness,exports.TableToObject=TableToObject,exports.ArrayOfArraysToTable=ArrayOfArraysToTable,exports.tableToHtml=tableToHtml,exports.tableToList=tableToList,exports.createColorScaleFromColors=createColorScaleFromColors,exports.blackScale=blackScale,exports.grayscale=grayscale,exports.antiGrayscale=antiGrayscale,exports.antiTemperature=antiTemperature,exports.temperature=temperature,exports.lightTemperature=lightTemperature,exports.sqrtTemperature=sqrtTemperature,exports.sqrt4Temperature=sqrt4Temperature,exports.quadraticTemperature=quadraticTemperature,exports.cubicTemperature=cubicTemperature,exports.greenToRed=greenToRed,exports.greenToBlue=greenToBlue,exports.grayToOrange=grayToOrange,exports.sqrt4GrayToOrange=sqrt4GrayToOrange,exports.blueToRed=blueToRed,exports.whiteToRed=whiteToRed,exports.redToBlue=redToBlue,exports.greenWhiteRed=greenWhiteRed,exports.blueWhiteRed=blueWhiteRed,exports.blueBlackRed=blueBlackRed,exports.grayBlackOrange=grayBlackOrange,exports.grayWhiteOrange=grayWhiteOrange,exports.solar=solar,exports.antiSolar=antiSolar,exports.get=get,exports.getFirstElements=getFirstElements,exports.containSameElements=containSameElements,exports.fractionOfSameElements=fractionOfSameElements,exports.getCorrespondenceBetweenLists=getCorrespondenceBetweenLists,exports.getConfusionMatrix=getConfusionMatrix,exports.indexOf=indexOf,exports.replaceElement=replaceElement,exports.replaceElementAtIndex=replaceElementAtIndex,exports.replaceNullsInList=replaceNullsInList,exports.concat=concat,exports.reverse=reverse,exports.getBooleanDictionaryForList=getBooleanDictionaryForList,exports.getFirstOccurrenceDictionaryForList=getFirstOccurrenceDictionaryForList,exports.getIndexesDictionary=getIndexesDictionary,exports.getIndexesTable=getIndexesTable,exports.buildDictionaryObjectForDictionary=buildDictionaryObjectForDictionary,exports.mapWithTable=mapWithTable,exports.mapWithObject=mapWithObject,exports.sortListByNumberList=sortListByNumberList,exports.getRankingsList=getRankingsList,exports.sortListByIndexes=sortListByIndexes,exports.concatWithoutRepetitions=concatWithoutRepetitions,exports.slidingWindowOnList=slidingWindowOnList,exports.getNewListForObjectType=getNewListForObjectType,exports.union=union,exports.intersection=intersection,exports.difference=difference,exports.symmetricDifference=symmetricDifference,exports.jaccardIndex=jaccardIndex,exports.jaccardDistance=jaccardDistance,exports.filterList=filterList,exports.mapWithFunction=mapWithFunction,exports.mapFunctionsOnList=mapFunctionsOnList,exports.aggregateList=aggregateList,exports.subCategoricalAnalysis=subCategoricalAnalysis,exports.getListEntropy=getListEntropy,exports.getListDiversity=getListDiversity,exports.getInformationGain=getInformationGain,exports.groupElements=groupElements,exports.groupElementsByPropertyValue=groupElementsByPropertyValue,exports._groupElements_Base=_groupElements_Base,exports.repeatElements=repeatElements,exports._isCategorical=_isCategorical,exports.buildInformationObjectForList=buildInformationObjectForList,exports.kCombinations=kCombinations,exports.allSubLists=allSubLists,exports.crossCombineLists=crossCombineLists,exports.characterizeList=characterizeList,exports.createDefaultCategoricalColorList=createDefaultCategoricalColorList,exports.colorsForCategoricalList=colorsForCategoricalList,exports.createCategoricalColorListForList=createCategoricalColorListForList,exports.createColorListFromColorScale=createColorListFromColorScale,exports.createColorListFromNumberList=createColorListFromNumberList,exports.createSymmetricalColorListFromNumberList=createSymmetricalColorListFromNumberList,exports.createColorListWithSingleColor=createColorListWithSingleColor,exports.createColorListBetweenTwoColors=createColorListBetweenTwoColors,exports.createColorListSpectrum=createColorListSpectrum,exports.stringsToColors=stringsToColors,exports.createCategoricalColors=createCategoricalColors,exports._sortingVariation=_sortingVariation,exports._evaluationFunction=_evaluationFunction,exports.createCategoricalColorListDictionaryObject=createCategoricalColorListDictionaryObject,exports.stringToDate=stringToDate,exports.dateToString=dateToString,exports.clearHoursMinutesSeconds=clearHoursMinutesSeconds,exports.currentDate=currentDate,exports.addDaysToDate=addDaysToDate,exports.addMillisecondsToDate=addMillisecondsToDate,exports.parseDate=parseDate,exports.parseDates=parseDates,exports.hoursBetweenDates=hoursBetweenDates,exports.daysBetweenDates=daysBetweenDates,exports.weeksBetweenDates=weeksBetweenDates,exports.yearsBetweenDates=yearsBetweenDates,exports.nDayInYear=nDayInYear,exports.getDateDaysAgo=getDateDaysAgo,exports.getWeekInYear=getWeekInYear,exports.getNDaysInMonth=getNDaysInMonth,exports.getDecimalDate=getDecimalDate,exports.convertFromDecimalDate=convertFromDecimalDate,exports.extractPropertiesFromDate=extractPropertiesFromDate,exports.StringListToNumberList=StringListToNumberList,exports.toDateList=toDateList,exports._y=_y,exports._m=_m,exports._d=_d,exports._h=_h,exports._mn=_mn,exports._s=_s,exports._ms=_ms,exports.getDateLists=getDateLists,exports.buildSummaryTableFromDates=buildSummaryTableFromDates,exports.transformDateList=transformDateList,exports.changeTimeResolution=changeTimeResolution,exports.getElementFromTable=getElementFromTable,exports.getSubTable=getSubTable,exports.sliceColumns=sliceColumns,exports.filterTable=filterTable,exports.filterColumns=filterColumns,exports.getSubTableByElementOnList=getSubTableByElementOnList,exports.getSubTableByElementsOnList=getSubTableByElementsOnList,exports.getRandomRows=getRandomRows,exports.transpose=transpose,exports.replaceElementInTable=replaceElementInTable,exports.replaceSectionInTable=replaceSectionInTable,exports.replaceNullsInTable=replaceNullsInTable,exports.testClassificationModel=testClassificationModel,exports.getRows=getRows,exports.sortListsByNumberList=sortListsByNumberList,exports.aggregateTable=aggregateTable,exports.disAggregateTable=disAggregateTable,exports.deSegmentTable=deSegmentTable,exports.pivotTable=pivotTable,exports.unpivotTable=unpivotTable,exports.getCountPairsMatrix=getCountPairsMatrix,exports.getPairsFrequencyTable=getPairsFrequencyTable,exports.concatenateRowElements=concatenateRowElements,exports.filterTableByElementInList=filterTableByElementInList,exports.filterTableByElementsInList=filterTableByElementsInList,exports.selectRows=selectRows,exports.joinTables=joinTables,exports.joinMultipleTables=joinMultipleTables,exports.combineLists=combineLists,exports.completeTable=completeTable,exports.getNumberTableFromTable=getNumberTableFromTable,exports.getVariablesInformationGain=getVariablesInformationGain,exports.splitTableByCategoricList=splitTableByCategoricList,exports.buildCorrelationsNetwork=buildCorrelationsNetwork,exports.buildSimpleDecisionTree=buildSimpleDecisionTree,exports.buildDecisionTree=buildDecisionTree,exports._buildDecisionTreeNode=_buildDecisionTreeNode,exports._decisionTreeGenerateColorsMixture=_decisionTreeGenerateColorsMixture,exports.allListsSameLength=allListsSameLength,exports.getListsWithoutRepetition=getListsWithoutRepetition,exports.getNumberOfDifferentElementsOfLists=getNumberOfDifferentElementsOfLists,exports.buildInformationObjectForTable=buildInformationObjectForTable,exports.getCategoricalLists=getCategoricalLists,exports.getTableSimplified=getTableSimplified,exports.concatTables=concatTables,exports.concatRows=concatRows,exports.concatLists=concatLists,exports.unionListsFromTables=unionListsFromTables,exports.intersectListsFromTables=intersectListsFromTables,exports.encodeStringLists=encodeStringLists,exports.translateListsWithDictionary=translateListsWithDictionary,exports.getModes=getModes,exports.getSubTables=getSubTables,exports.mapFunctionOnLists=mapFunctionOnLists,exports.mapFunctionsOnLists=mapFunctionsOnLists,exports.useVariablesDictionary=useVariablesDictionary,exports.matrixToTwoColumns=matrixToTwoColumns,exports._preserveOrder=_preserveOrder,exports.concatStrings=concatStrings,exports.join=join,exports.cleanTexts=cleanTexts,exports.filterStringListByString=filterStringListByString,exports.replaceStringsInTexts=replaceStringsInTexts,exports.replaceStringInTexts=replaceStringInTexts,exports.replaceStringsInTextsByStrings=replaceStringsInTextsByStrings,exports.countStringsOccurrencesOnTexts=countStringsOccurrencesOnTexts,exports.getWordsInTextsOccurrencesTable=getWordsInTextsOccurrencesTable,exports.createShortTextsNetwork=createShortTextsNetwork,exports.splitStrings=splitStrings,exports.encodeStringsAsNumericFeatures=encodeStringsAsNumericFeatures,exports.correlationRatio=correlationRatio,exports.splitByEnter=splitByEnter,exports.replaceStringInText=replaceStringInText,exports.replaceStringsInText=replaceStringsInText,exports.removeTextsBetweenStrings=removeTextsBetweenStrings,exports.getWords=getWords,exports.substr=substr,exports.splitString=splitString,exports.getFirstTextBetweenStrings=getFirstTextBetweenStrings,exports.getAllTextsBetweenStrings=getAllTextsBetweenStrings,exports.textContainsString=textContainsString,exports.getParenthesisContents=getParenthesisContents,exports.getFirstParenthesisContent=getFirstParenthesisContent,exports.getFirstParenthesisContentWithIndexes=getFirstParenthesisContentWithIndexes,exports.placeString=placeString,exports.insertString=insertString,exports.cleanText=cleanText,exports.removeEnters=removeEnters,exports.removeTabs=removeTabs,exports.removePunctuation=removePunctuation,exports.removeDoubleSpaces=removeDoubleSpaces,exports.removeHtmlTags=removeHtmlTags,exports.escapeForRegExp=escapeForRegExp,exports.removeLinks=removeLinks,exports.removeQuotes=removeQuotes,exports.removeAccentsAndDiacritics=removeAccentsAndDiacritics,exports.getWordsOccurrencesTable=getWordsOccurrencesTable,exports.indexesOf=indexesOf,exports.indexesOfString=indexesOfString,exports.repeatString=repeatString,exports.countStringOccurrences=countStringOccurrences,exports.countOccurrences=countOccurrences,exports.countWordOccurrences=countWordOccurrences,exports.countRegexOccurrences=countRegexOccurrences,exports.countStringsOccurrences=countStringsOccurrences,exports.validateEmail=validateEmail,exports.validateUrl=validateUrl,exports.getLevenshteinDistance=getLevenshteinDistance,exports.getNgrams=getNgrams,exports.stringToFunction=stringToFunction,exports.stringFormat=stringFormat,exports.createListWithSameElement=createListWithSameElement,exports.createIterationSequence=createIterationSequence,exports.createListWithUniqueElements=createListWithUniqueElements,exports.replaceChomasInTextLine=replaceChomasInTextLine,exports._replaceSpacesInLine=_replaceSpacesInLine,exports.NetworkToTable=NetworkToTable,exports.TableToNetwork=TableToNetwork,exports.TableToNetworkPairs=TableToNetworkPairs,exports.matrixToNetwork=matrixToNetwork,exports.CSVToTable=CSVToTable,exports._removeQuotes=_removeQuotes,exports.TableToCSV=TableToCSV,exports.TableToJSONString=TableToJSONString,exports.JSONStringToTable=JSONStringToTable,exports.NumberListToPolygon=NumberListToPolygon,exports.NumberListToStringList=NumberListToStringList,exports.ObjectToTable=ObjectToTable,exports.ObjectToList=ObjectToList,exports.objectToString=objectToString,exports.conversor=conversor,exports.ArrayToList=ArrayToList,exports.angleFromTwoPoints=angleFromTwoPoints,exports.dot=dot,exports.twoPointsInterpolation=twoPointsInterpolation,exports.pointMultiplication=pointMultiplication,exports.normalizeTableToMax=normalizeTableToMax,exports.normalizeLists=normalizeLists,exports.normalizeListsToMax=normalizeListsToMax,exports.normalizeListsToSum=normalizeListsToSum,exports.averageSmootherOnLists=averageSmootherOnLists,exports.kMeans=kMeans,exports.product=product,exports.getCovarianceMatrix=getCovarianceMatrix,exports.generateNumberTable=generateNumberTable,exports.identity=identity,exports.mergeObjects=mergeObjects,exports.cloneObject=cloneObject,exports.serliazeObject=serliazeObject,exports.getInterval=getInterval,exports.getFrame=getFrame,exports.getInfo=getInfo,exports.getObjectStructure=getObjectStructure,exports.replaceValuesByNull=replaceValuesByNull,exports.getLength=getLength,exports.includes=includes,exports.getPropertyValue=getPropertyValue,exports.getPropertyValues=getPropertyValues,exports.getMultiplePropertyValues=getMultiplePropertyValues,exports.getName=getName,exports.isPropertyValue=isPropertyValue,exports.getPropertiesNames=getPropertiesNames,exports.getPropertiesNamesAndValues=getPropertiesNamesAndValues,exports.setPropertyValue=setPropertyValue,exports.interpolateObjects=interpolateObjects,exports.replaceObject=replaceObject,exports.toList=toList,exports.floor=floor,exports.addition=addition,exports.multiplication=multiplication,exports.division=division,exports.applyFunctionOnInput=applyFunctionOnInput,exports.isEqual=isEqual,exports._recursiveEqual=_recursiveEqual,exports.arrayOfArraysToTable=arrayOfArraysToTable,exports.operate=operate,exports._sum=_sum,exports._multiplication=_multiplication,exports._pow2=_pow2,exports._pow3=_pow3,exports._logSum=_logSum,exports._log2Sum=_log2Sum,exports._log_y=_log_y,exports._cosSum=_cosSum,exports._sinSum=_sinSum,exports._tanSum=_tanSum,exports._modulo=_modulo,exports._subtract=_subtract,exports._divide=_divide,exports.numberToString=numberToString,exports.getRandomWithSeed=getRandomWithSeed,exports.numberFromBinaryPositions=numberFromBinaryPositions,exports.numberFromBinaryValues=numberFromBinaryValues,exports.powersOfTwoDecomposition=powersOfTwoDecomposition,exports.toBinary=toBinary,exports.binaryToNumber=binaryToNumber,exports.positionsFromBinaryValues=positionsFromBinaryValues,exports._Alea=_Alea,exports._Mash=_Mash,exports.random=random,exports.randomSeed=randomSeed,exports.randomSeedPop=randomSeedPop,exports.decimalPlaces=decimalPlaces,exports.logistic=logistic,exports.formatShort=formatShort,exports.numberToPosition=numberToPosition,exports.getSoftenControlPoints=getSoftenControlPoints,exports.bezierCurvePoints=bezierCurvePoints,exports.triangleContainsPoint=triangleContainsPoint,exports.triangleArea=triangleArea,exports.lineFromTwoPoints=lineFromTwoPoints,exports.distancePointToLine=distancePointToLine,exports.distancePointToSegment=distancePointToSegment,exports.intersectionLines=intersectionLines,exports.numberTableToPolygon=numberTableToPolygon,exports.numberTableToColorList=numberTableToColorList,exports.numberTableToNetwork=numberTableToNetwork,exports.buildDendrogramFromPolygon=buildDendrogramFromPolygon,exports._findClosestNodes=_findClosestNodes,exports.sortOnXY=sortOnXY,exports.expandFromBarycenter=expandFromBarycenter,exports.simplifyPolygon=simplifyPolygon,exports.bezierPolygonContainsPoint=bezierPolygonContainsPoint,exports.placePointsInsidePolygon=placePointsInsidePolygon,exports.placePointsInsideBezierPolygon=placePointsInsideBezierPolygon,exports.geoCoordinateToDecimal=geoCoordinateToDecimal,exports.geoDistance=geoDistance,exports.polygonLength=polygonLength,exports.minRect=minRect,exports.packingCircles=packingCircles,exports.packingRectangles=packingRectangles,exports.squarify=squarify,exports.partitionRectangle=partitionRectangle,exports._getHighestRatio=_getHighestRatio,exports.simplifyPolygons=simplifyPolygons,exports.createPolygon=createPolygon,exports.twoNumberListsToPolygon=twoNumberListsToPolygon,exports.colorListFromColorScale=colorListFromColorScale,exports.colorListFromColorScaleFunction=colorListFromColorScaleFunction,exports.colorsLinearCombination=colorsLinearCombination,exports.polygon3DToColorList=polygon3DToColorList,exports.colorListToPolygon3D=colorListToPolygon3D,exports.randomColor=randomColor,exports.getFlowTable=getFlowTable,exports.getFlowTableIntervals=getFlowTableIntervals,exports.scaleIntervals=scaleIntervals,exports.nlsToIntervalList=nlsToIntervalList,exports.fillTextRectangle=fillTextRectangle,exports.fillTextRectangleWithTextLines=fillTextRectangleWithTextLines,exports.textWordWrapReturnLines=textWordWrapReturnLines,exports.getMaxTextWidth=getMaxTextWidth,exports.stringToObject=stringToObject,exports.stringToHash=stringToHash,exports._fnv_multiply=_fnv_multiply,exports._fnv_mix=_fnv_mix,exports.decodeIdentedTree=decodeIdentedTree,exports.TableToTree=TableToTree,exports._getId=_getId,exports.TreeToTable=TreeToTable,exports.treeToObject=treeToObject,exports.filterNetworkByRelationsWeight=filterNetworkByRelationsWeight,exports.objectToTree=objectToTree,exports.filterNodesByMinDegree=filterNodesByMinDegree,exports.degreeBetweenNodes=degreeBetweenNodes,exports.getNodesBetweenTwoNodes=getNodesBetweenTwoNodes,exports.getSubNetwork=getSubNetwork,exports.shortestPath=shortestPath,exports.shortestPaths=shortestPaths,exports.getRelationsBetweenNodeLists=getRelationsBetweenNodeLists,exports._extendPaths=_extendPaths,exports.loops=loops,exports._getLoopsOnNode=_getLoopsOnNode,exports._pathsToCentral=_pathsToCentral,exports._loopsColumns=_loopsColumns,exports.spanningTree=spanningTree,exports.influenceLevels=influenceLevels,exports._spanningTree2=_spanningTree2,exports.adjacentNodeList=adjacentNodeList,exports.degreesPartition=degreesPartition,exports.getNodes=getNodes,exports.buildDendrogram=buildDendrogram,exports._getClosestPair=_getClosestPair,exports._strengthBetweenSets=_strengthBetweenSets,exports.buildNetworkClusters=buildNetworkClusters,exports._iterativeBuildClusters=_iterativeBuildClusters,exports._buildNetworkClustersLvn=_buildNetworkClustersLvn,exports.getNodesPageRanks=getNodesPageRanks,exports.fusionNetworks=fusionNetworks,exports._jLvn=_jLvn,exports.getNodesCentralities=getNodesCentralities,exports.addCentralitiesToNodes=addCentralitiesToNodes,exports.addEigenvectorCentralityToNodes=addEigenvectorCentralityToNodes,exports.addBetweennessCentralityToNodes=addBetweennessCentralityToNodes,exports.getLeaves=getLeaves,exports.createNetworkFromListAndFunction=createNetworkFromListAndFunction,exports.createRandomNetwork=createRandomNetwork,exports.imageToTableOfRGBA=imageToTableOfRGBA,exports.invertImageColors=invertImageColors,exports.grayscaleImage=grayscaleImage,exports.cropImage=cropImage,exports.resizeImage=resizeImage,exports.getDataURL=getDataURL,exports._getPixelData=_getPixelData,exports._makeImageFromData=_makeImageFromData,exports.expandSimpleHtml=expandSimpleHtml,exports.clickLink=clickLink,exports.downloadData=downloadData,exports.downloadTable=downloadTable}));